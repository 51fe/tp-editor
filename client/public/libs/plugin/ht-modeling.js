!function(L,F,g){"use strict";function R(F,D){this.position=F,this.$22n=D}var H="ht",P=L[H],m=null,n=Math,p=n.PI,l=n.cos,h=n.sin,x=n.abs,K=n.max,t=n.sqrt,C=1e-5,$=P.Default,G=$.def,Z=$.startAnim,k=$.createMatrix,E=$.transformVec,O=$.getInternal(),S=O.addMethod,J=O.superCall,q=O.toPointsArray,B=O.createNormals,z=O.toFloatArray,X=O.glMV,A=(O.glPop,P.graph3d.Graph3dView,P.Math),s=A.Vector3,o=A.Matrix4,T=A.Euler,M=(A.Quaternion,O.batchShape),j=O.createNodeMatrix,v=O.getFaceInfo,W=O.transformAppend,f=O.drawFaceInfo,u=O.createAnim,c=O.cube(),y=c.is,N=c.vs,i=c.uv,e=O.ui(),r=P.Node,w=P.Shape,V="h",Q="v",Y="front",b="back",_="left",D="right",d="top",I="bottom",a="dw.expanded",U=".expanded",hi="dw.angle",Ij=".angle",hb=function(j,_,t){G(H+"."+j,_,t)},Cm=function(O,i,T){T?O.push(i.x,i.y):O.push(i.x,i.y,i.z)},Lo=function(){var r=new P.Math.Vector3,Y=new P.Math.Vector3,i=new P.Math.Vector3;return function(U,$,V,P,j){if(r.copy($.$24n),Y.copy(V.$24n),i.copy(P.$24n),!(i.equals(r)||Y.equals(r)||Y.equals(i))){if(!$.$22n||!V.$22n||!P.$22n){var w=Y.sub(r).cross(i.sub(r)).normalize().multiplyScalar(1).toArray();$.$22n||($.$22n=new Kq(w)),V.$22n||(V.$22n=new Kq(w)),P.$22n||(P.$22n=new Kq(w))}U.push(new es([$,V,P],j))}}}(),dh=function(Q,v,I,F){var B,w,Z,A,j=0,U=[];if(F)for(B=F.length;B>j;j+=3)w=F[j],Z=F[j+1],A=F[j+2],Lo(U,new Cl([v[3*w],v[3*w+1],v[3*w+2]],null,I?[I[2*w],I[2*w+1],0]:m),new Cl([v[3*Z],v[3*Z+1],v[3*Z+2]],null,I?[I[2*Z],I[2*Z+1],0]:m),new Cl([v[3*A],v[3*A+1],v[3*A+2]],null,I?[I[2*A],I[2*A+1],0]:m),Q);else for(B=v.length/3;B>j;j+=3)w=j,Z=j+1,A=j+2,Lo(U,new Cl([v[3*w],v[3*w+1],v[3*w+2]],null,I?[I[2*w],I[2*w+1],0]:m),new Cl([v[3*Z],v[3*Z+1],v[3*Z+2]],null,I?[I[2*Z],I[2*Z+1],0]:m),new Cl([v[3*A],v[3*A+1],v[3*A+2]],null,I?[I[2*A],I[2*A+1],0]:m),Q);return U},rg=[_,Y,D,b,d,I],Br=["",d,I],td=rg.concat("csg"),Vp=[0,6,12,18,24,30],dq=function(P,Z,b){var u=j(P),H=[];P.appendAnchorMatrix3d(u);var $,B=Z?Z.getData3dUI(P):null;if(B&&B.s("shape3d")&&!B.s("csg.cull.box")&&($=B.shapeModel,B.shapeModel||($=O.getShapeModel(B,B.s("shape3d"))),$))for(var M=O.createNormalMatrix(u),R=0,F=Br.length;F>R;R++){var J=Br[R],k=J.length?J+"_":J,G=$[k+"vs"],v=$[k+"uv"],r=$[k+"is"],X=$[k+"ns"];if(G&&G.length)for(var o,h,f,a=0,W=r?r.length:G.length/3;W>a;a+=3)r?(o=r[a],h=r[a+1],f=r[a+2]):(o=a,h=a+1,f=a+2),Lo(H,new Cl(E([G[3*o],G[3*o+1],G[3*o+2]],u),X?E([X[3*o],X[3*o+1],X[3*o+2]],M):null,[v[2*o],v[2*o+1],0]),new Cl(E([G[3*h],G[3*h+1],G[3*h+2]],u),X?E([X[3*h],X[3*h+1],X[3*h+2]],M):null,[v[2*h],v[2*h+1],0]),new Cl(E([G[3*f],G[3*f+1],G[3*f+2]],u),X?E([X[3*f],X[3*f+1],X[3*f+2]],M):null,[v[2*f],v[2*f+1],0]),P)}if(!$)for(var R=0;6>R;R++)for(var J=rg[R],x=Vp[R],v=b?Z.getFaceUv(P,J):m,L=b?Z.getFaceUvScale(P,J):m,z=b?Z.getFaceUvOffset(P,J):m,w=0;2>w;w++){var n,I,q,p=y[x+3*w],D=y[x+3*w+1],U=y[x+3*w+2];if(b){if(v){var Y=8*R;n=[v[2*p-Y],v[2*p+1-Y],0],I=[v[2*D-Y],v[2*D+1-Y],0],q=[v[2*U-Y],v[2*U+1-Y],0]}else n=[i[2*p],i[2*p+1],0],I=[i[2*D],i[2*D+1],0],q=[i[2*U],i[2*U+1],0];L&&(n[0]*=L[0],n[1]*=L[1],I[0]*=L[0],I[1]*=L[1],q[0]*=L[0],q[1]*=L[1]),z&&(n[0]+=z[0],n[1]+=z[1],I[0]+=z[0],I[1]+=z[1],q[0]+=z[0],q[1]+=z[1])}Lo(H,new Cl(E([N[3*p],N[3*p+1],N[3*p+2]],u),null,n),new Cl(E([N[3*D],N[3*D+1],N[3*D+2]],u),null,I),new Cl(E([N[3*U],N[3*U+1],N[3*U+2]],u),null,q),P)}return Xb.$15n(H)},kl=function(d,T){var b,A=d.data.getAttaches();if(A&&A.each(function(V){V instanceof Rq&&V.s("attach.operation")&&(b||(b=[]),b.push(V))}),b){var F;rg.forEach(function(T){var C=dh(T,d[T].vs,d[T].tuv);F=F?F.concat(C):C}),F=Xb.$15n(F),b.forEach(function($){var T=$.s("attach.operation");F[T]&&(F=F[T](dq($,d.gv,d.csg.tuv)))}),rg.forEach(function(a){a=d[a],a.vs=[],a.ns=[],a.tuv&&(a.tuv=[])}),d.csg&&!d.csg.ns&&(d.csg.ns=[]);var W=[];if(F.$19n().forEach(function(s){var q,J=s.$10n;if(J instanceof Rq){if(J.s("attach.cull"))return;q=J.s("csg.cull.color"),q&&(q=O.toColorArray(q)),J="csg"}for(var H=d[J],$=H.vs,C=H.ns,P=H.tuv,R=s.$9n,w=2;w<R.length;w++)if(Cm($,R[0].$24n),Cm($,R[w-1].$24n),Cm($,R[w].$24n),C&&(Cm(C,R[0].$22n),Cm(C,R[w-1].$22n),Cm(C,R[w].$22n)),P&&(Cm(P,R[0].uv,!0),Cm(P,R[w-1].uv,!0),Cm(P,R[w].uv,!0)),q)for(var K=4*($.length/3),g=0;3>g;g++)W[--K]=q[3],W[--K]=q[2],W[--K]=q[1],W[--K]=q[0]}),W.length){for(var s=O.toColorArray(d.csg.color),U=0,N=4*(d.csg.vs.length/3);N>U;U+=4)W[U]==g&&(W[U]=s[0],W[U+1]=s[1],W[U+2]=s[2],W[U+3]=s[3]);d.csg.cs=W}}td.forEach(function(L){var n=d[L];n.visible&&n.vs.length?(n.ns&&n.ns.length?z(n,"ns"):n.ns=B(n.vs),z(n,"vs"),z(n,"tuv"),n.cs&&z(n,"cs")):delete d[L]}),T&&(M(d,m,T),d.clear())};S($,{createFrameModel:function(i,Q,O,L){i=i==m?.07:i,Q=Q==m?i:Q,O=O==m?i:O,L=L?L:{};var l=L.top,j=L.bottom,u=L.left,F=L.right,y=L.front,k=L.back,G=[],q=[];return y===!0?(G.push(-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5),q.push(0,0,0,1,1,1,1,1,1,0,0,0)):y===!1||(G.push(-.5,.5,.5,-.5,-.5,.5,-.5+i,-.5,.5,-.5+i,-.5,.5,-.5+i,.5,.5,-.5,.5,.5,.5-i,.5,.5,.5-i,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5-i,.5,.5,-.5+i,.5,.5,-.5+i,.5-Q,.5,.5-i,.5-Q,.5,.5-i,.5-Q,.5,.5-i,.5,.5,-.5+i,.5,.5,-.5+i,-.5+Q,.5,-.5+i,-.5,.5,.5-i,-.5,.5,.5-i,-.5,.5,.5-i,-.5+Q,.5,-.5+i,-.5+Q,.5),q.push(0,0,0,1,i,1,i,1,i,0,0,0,1-i,0,1-i,1,1,1,1,1,1,0,1-i,0,i,0,i,Q,1-i,Q,1-i,Q,1-i,0,i,0,i,1-Q,i,1,1-i,1,1-i,1,1-i,1-Q,i,1-Q)),k===!0?(G.push(-.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5),q.push(1,0,0,1,1,1,0,1,1,0,0,0)):k===!1||(G.push(-.5,.5,-.5,-.5+i,-.5,-.5,-.5,-.5,-.5,-.5+i,-.5,-.5,-.5,.5,-.5,-.5+i,.5,-.5,.5-i,.5,-.5,.5,-.5,-.5,.5-i,-.5,-.5,.5,-.5,-.5,.5-i,.5,-.5,.5,.5,-.5,-.5+i,.5,-.5,.5-i,.5-Q,-.5,-.5+i,.5-Q,-.5,.5-i,.5-Q,-.5,-.5+i,.5,-.5,.5-i,.5,-.5,-.5+i,-.5+Q,-.5,.5-i,-.5,-.5,-.5+i,-.5,-.5,.5-i,-.5,-.5,-.5+i,-.5+Q,-.5,.5-i,-.5+Q,-.5),q.push(1,0,1-i,1,1,1,1-i,1,1,0,1-i,0,i,0,0,1,i,1,0,1,i,0,0,0,1-i,0,i,Q,1-i,Q,i,Q,1-i,0,i,0,1-i,1-Q,i,1,1-i,1,i,1,1-i,1-Q,i,1-Q)),u===!0?(G.push(-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5),q.push(0,0,0,1,1,1,1,1,1,0,0,0)):u===!1||(G.push(-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5+O,-.5,-.5,-.5+O,-.5,.5,-.5+O,-.5,.5,-.5,-.5,.5,.5-O,-.5,-.5,.5-O,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5-O,-.5,.5,-.5+O,-.5,.5-Q,-.5+O,-.5,.5-Q,.5-O,-.5,.5-Q,.5-O,-.5,.5,.5-O,-.5,.5,-.5+O,-.5,-.5+Q,-.5+O,-.5,-.5,-.5+O,-.5,-.5,.5-O,-.5,-.5,.5-O,-.5,-.5+Q,.5-O,-.5,-.5+Q,-.5+O),q.push(0,0,0,1,O,1,O,1,O,0,0,0,1-O,0,1-O,1,1,1,1,1,1,0,1-O,0,O,0,O,Q,1-O,Q,1-O,Q,1-O,0,O,0,O,1-Q,O,1,1-O,1,1-O,1,1-O,1-Q,O,1-Q)),F===!0?(G.push(.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5),q.push(1,0,0,1,1,1,0,1,1,0,0,0)):F===!1||(G.push(.5,.5,-.5,.5,-.5,-.5+O,.5,-.5,-.5,.5,-.5,-.5+O,.5,.5,-.5,.5,.5,-.5+O,.5,.5,.5-O,.5,-.5,.5,.5,-.5,.5-O,.5,-.5,.5,.5,.5,.5-O,.5,.5,.5,.5,.5,-.5+O,.5,.5-Q,.5-O,.5,.5-Q,-.5+O,.5,.5-Q,.5-O,.5,.5,-.5+O,.5,.5,.5-O,.5,-.5+Q,-.5+O,.5,-.5,.5-O,.5,-.5,-.5+O,.5,-.5,.5-O,.5,-.5+Q,-.5+O,.5,-.5+Q,.5-O),q.push(1,0,1-O,1,1,1,1-O,1,1,0,1-O,0,O,0,0,1,O,1,0,1,O,0,0,0,1-O,0,O,Q,1-O,Q,O,Q,1-O,0,O,0,1-O,1-Q,O,1,1-O,1,O,1,1-O,1-Q,O,1-Q)),l===!0?(G.push(.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5),q.push(1,1,1,0,0,0,0,0,0,1,1,1)):l===!1||(G.push(.5,.5,.5,.5,.5,-.5,.5-i,.5,-.5,.5-i,.5,-.5,.5-i,.5,.5,.5,.5,.5,-.5+i,.5,.5,-.5+i,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5+i,.5,.5,.5-i,.5,.5,.5-i,.5,.5-O,-.5+i,.5,.5-O,-.5+i,.5,.5-O,-.5+i,.5,.5,.5-i,.5,.5,.5-i,.5,-.5+O,.5-i,.5,-.5,-.5+i,.5,-.5,-.5+i,.5,-.5,-.5+i,.5,-.5+O,.5-i,.5,-.5+O),q.push(1,1,1,0,1-i,0,1-i,0,1-i,1,1,1,i,1,i,0,0,0,0,0,0,1,i,1,1-i,1,1-i,1-O,i,1-O,i,1-O,i,1,1-i,1,1-i,O,1-i,0,i,0,i,0,i,O,1-i,O)),j===!0?(G.push(.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5),q.push(1,0,0,1,1,1,0,1,1,0,0,0)):j===!1||(G.push(.5,-.5,.5,.5-i,-.5,-.5,.5,-.5,-.5,.5-i,-.5,-.5,.5,-.5,.5,.5-i,-.5,.5,-.5+i,-.5,.5,-.5,-.5,-.5,-.5+i,-.5,-.5,-.5,-.5,-.5,-.5+i,-.5,.5,-.5,-.5,.5,.5-i,-.5,.5,-.5+i,-.5,.5-O,.5-i,-.5,.5-O,-.5+i,-.5,.5-O,.5-i,-.5,.5,-.5+i,-.5,.5,.5-i,-.5,-.5+O,-.5+i,-.5,-.5,.5-i,-.5,-.5,-.5+i,-.5,-.5,.5-i,-.5,-.5+O,-.5+i,-.5,-.5+O),q.push(1,0,1-i,1,1,1,1-i,1,1,0,1-i,0,i,0,0,1,i,1,0,1,i,0,0,0,1-i,0,i,O,1-i,O,i,O,1-i,0,i,0,1-i,1-O,i,1,1-i,1,i,1,1-i,1-O,i,1-O)),{vs:G,uv:q}}}),S(P.Style,{"csg.cull.color":g,"csg.cull.box":!0,"dw.flip":!1,"dw.s3":[.999,.999,.5],"dw.t3":g,"dw.expanded":!1,"dw.toggleable":!0,"dw.axis":"left","dw.start":0,"dw.end":p/2,"dw.angle":0,"attach.cull":!1,"attach.operation":"subtract"},!0),rg.forEach(function(K){var Z={};Z[K+U]=!1,Z[K+".toggleable"]=!1,Z[K+".axis"]=_,Z[K+".start"]=0,Z[K+".end"]=p/2,Z[K+Ij]=0,S(P.Style,Z,!0)});var Xb=function(){this.$4n=[]};Xb.$15n=function(K){var _=new Xb;return _.$4n=K,_},Xb.prototype={clone:function(){var I=new Xb;return I.$4n=this.$4n.map(function(j){return j.clone()}),I},$19n:function(){return this.$4n},union:function(l){var F=new $p(this.clone().$4n),M=new $p(l.clone().$4n);return F.$3n(M),M.$3n(F),M.$6n(),M.$3n(F),M.$6n(),F.$7n(M.$2n()),Xb.$15n(F.$2n())},subtract:function(v){var h=new $p(this.clone().$4n),n=new $p(v.clone().$4n);return h.$6n(),h.$3n(n),n.$3n(h),n.$6n(),n.$3n(h),n.$6n(),h.$7n(n.$2n()),h.$6n(),Xb.$15n(h.$2n())},intersect:function(Y){var A=new $p(this.clone().$4n),I=new $p(Y.clone().$4n);return A.$6n(),I.$3n(A),I.$6n(),A.$3n(I),I.$3n(A),A.$7n(I.$2n()),A.$6n(),Xb.$15n(A.$2n())},inverse:function(){var S=this.clone();return S.$4n.map(function(M){M.flip()}),S}},Xb.cube=function(I){I=I||{};var R=new Kq(I.center||[0,0,0]),m=I.radius?I.radius.length?I.radius:[I.radius,I.radius,I.radius]:[1,1,1];return Xb.$15n([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(Q){return new es(Q[0].map(function(F){var I=new Kq(R.x+m[0]*(2*!!(1&F)-1),R.y+m[1]*(2*!!(2&F)-1),R.z+m[2]*(2*!!(4&F)-1));return new Cl(I,new Kq(Q[1]))}))}))},Xb.sphere=function(c){function i(Y,g){Y*=2*p,g*=p;var w=new Kq(l(Y)*h(g),l(g),h(Y)*h(g));X.push(new Cl(Q.$20n(w.$21n(t)),w))}c=c||{};for(var X,Q=new Kq(c.center||[0,0,0]),t=c.radius||1,V=c.slices||16,K=c.stacks||8,k=[],e=0;V>e;e++)for(var r=0;K>r;r++)X=[],i(e/V,r/K),r>0&&i((e+1)/V,r/K),K-1>r&&i((e+1)/V,(r+1)/K),i(e/V,(r+1)/K),k.push(new es(X));return Xb.$15n(k)},Xb.cylinder=function(G){function A(O,e,$){var C=2*e*p,H=Y.$21n(l(C)).$20n(s.$21n(h(C))),a=S.$20n(X.$21n(O)).$20n(H.$21n(K)),J=H.$21n(1-x($)).$20n(q.$21n($));return new Cl(a,J)}G=G||{};for(var S=new Kq(G.start||[0,-1,0]),u=new Kq(G.end||[0,1,0]),X=u.$13n(S),K=G.radius||1,Q=G.slices||16,q=X.$14n(),I=x(q.y)>.5,Y=new Kq(I,!I,0).cross(q).$14n(),s=Y.cross(q).$14n(),$=new Cl(S,q.$11n()),d=new Cl(u,q.$14n()),w=[],v=0;Q>v;v++){var g=v/Q,D=(v+1)/Q;w.push(new es([$,A(0,g,-1),A(0,D,-1)])),w.push(new es([A(0,D,0),A(0,g,0),A(1,g,0),A(1,D,0)])),w.push(new es([d,A(1,D,1),A(1,g,1)]))}return Xb.$15n(w)};var Kq=function(h,m,H){var b=this;3==arguments.length?(b.x=h,b.y=m,b.z=H):"x"in h?(b.x=h.x,b.y=h.y,b.z=h.z):(b.x=h[0],b.y=h[1],b.z=h[2])};Kq.prototype={clone:function(){return new Kq(this.x,this.y,this.z)},$11n:function(){return new Kq(-this.x,-this.y,-this.z)},$20n:function(Y){return new Kq(this.x+Y.x,this.y+Y.y,this.z+Y.z)},$13n:function(V){return new Kq(this.x-V.x,this.y-V.y,this.z-V.z)},$21n:function(Y){return new Kq(this.x*Y,this.y*Y,this.z*Y)},$16n:function(Z){return new Kq(this.x/Z,this.y/Z,this.z/Z)},dot:function(F){return this.x*F.x+this.y*F.y+this.z*F.z},lerp:function(o,c){return this.$20n(o.$13n(this).$21n(c))},length:function(){return t(this.dot(this))},$14n:function(){return this.$16n(this.length())},cross:function(T){var v=this;return new Kq(v.y*T.z-v.z*T.y,v.z*T.x-v.x*T.z,v.x*T.y-v.y*T.x)}};var Cl=function(n,l,E){var J=this;J.$24n=new Kq(n),J.$22n=l?new Kq(l):null,J.uv=E?new Kq(E):null};Cl.prototype={clone:function(){var U=this;return new Cl(U.$24n.clone(),U.$22n.clone(),U.uv?U.uv.clone():null)},flip:function(){this.$22n=this.$22n.$11n()},$18n:function(F,n){var k=this;return new Cl(k.$24n.lerp(F.$24n,n),k.$22n.lerp(F.$22n,n),k.uv?k.uv.lerp(F.uv,n):null)}};var je=function(L,T){this.$22n=L,this.w=T};je.$17n=function(O,c,z){var v=c.$13n(O).cross(z.$13n(O)).$14n();return new je(v,v.dot(O))},je.prototype={clone:function(){return new je(this.$22n.clone(),this.w)},flip:function(){var I=this;I.$22n=I.$22n.$11n(),I.w=-I.w},$5n:function(c,X,B,s,N){for(var M=this,w=0,V=1,u=2,S=3,y=0,d=[],E=0;E<c.$9n.length;E++){var n=M.$22n.dot(c.$9n[E].$24n)-M.w,f=-C>n?u:n>C?V:w;y|=f,d.push(f)}switch(y){case w:(M.$22n.dot(c.$8n.$22n)>0?X:B).push(c);break;case V:s.push(c);break;case u:N.push(c);break;case S:for(var g=[],t=[],E=0;E<c.$9n.length;E++){var H=(E+1)%c.$9n.length,h=d[E],l=d[H],q=c.$9n[E],J=c.$9n[H];if(h!=u&&g.push(q),h!=V&&t.push(h!=u?q.clone():q),(h|l)==S){var n=(M.w-this.$22n.dot(q.$24n))/M.$22n.dot(J.$24n.$13n(q.$24n)),a=q.$18n(J,n);g.push(a),t.push(a.clone())}}g.length>=3&&s.push(new es(g,c.$10n)),t.length>=3&&N.push(new es(t,c.$10n))}}};var es=function(t,W){var D=this;D.$9n=t,D.$10n=W,D.$8n=je.$17n(t[0].$24n,t[1].$24n,t[2].$24n)};es.prototype={clone:function(){var Q=this.$9n.map(function(O){return O.clone()});return new es(Q,this.$10n)},flip:function(){this.$9n.reverse().map(function(Z){Z.flip()}),this.$8n.flip()}};var $p=function(d){var Q=this;Q.$8n=null,Q.front=null,Q.back=null,Q.$4n=[],d&&Q.$7n(d)};$p.prototype={clone:function(){var K=this,U=new $p;return U.$8n=K.$8n&&K.$8n.clone(),U.front=K.front&&K.front.clone(),U.back=K.back&&K.back.clone(),U.$4n=K.$4n.map(function(X){return X.clone()}),U},$6n:function(){for(var F=this,W=0;W<F.$4n.length;W++)F.$4n[W].flip();F.$8n&&F.$8n.flip(),F.front&&F.front.$6n(),F.back&&F.back.$6n();var Y=F.front;F.front=F.back,F.back=Y},$1n:function(G){var A=this;if(!A.$8n)return G.slice();for(var y=[],R=[],t=0;t<G.length;t++)A.$8n.$5n(G[t],y,R,y,R);return A.front&&(y=A.front.$1n(y)),R=A.back?A.back.$1n(R):[],y.concat(R)},$3n:function(O){var M=this;M.$4n=O.$1n(M.$4n),M.front&&M.front.$3n(O),M.back&&M.back.$3n(O)},$2n:function(){var S=this,U=S.$4n.slice();return S.front&&(U=U.concat(S.front.$2n())),S.back&&(U=U.concat(S.back.$2n())),U},$7n:function(Y){var s=this;if(Y.length){s.$8n||(s.$8n=Y[0].$8n.clone());for(var x=[],n=[],i=0;i<Y.length;i++)this.$8n.$5n(Y[i],s.$4n,s.$4n,x,n);x.length&&(s.front||(s.front=new $p),this.front.$7n(x)),n.length&&(s.back||(s.back=new $p),s.back.$7n(n))}}};var Jm="symbol",Gr=P.Symbol=function(Y,y,M){var W=this;J(Gr,W),W.s3(20,20,20),W.s({"all.visible":!1,shape:"rect"}),W.setIcon(Y,y,M)};hb("Symbol",r,{setIcon:function(e,T,K){var _,q=this;return Gr.superClass.setIcon.call(q,e),e?(_={for3d:!0,face:"center",position:44,names:[e]},K&&(_.transaprent=!0),T&&(_.autorotate=T),q.addStyleIcon(Jm,_)):q.removeStyleIcon(Jm),q.setWidth(O.getImageWidth($.getImage(e),q)||20),_}});var Rq=P.CSGNode=function(){J(Rq,this),this.s({shape:"rect","attach.thickness":1.001,"2d.attachable":!0})},Bi={position:1,width:1,height:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,tall:1,elevation:1,anchor:1,anchorElevation:1,"s:attach.cull":1,"s:attach.operation":1};hb("CSGNode",r,{_22Q:function(){return $q},onPropertyChanged:function(q){var e=this,S=e.getHost();Rq.superClass.onPropertyChanged.call(e,q),Bi[q.property]&&(S instanceof Yc||S instanceof Rq)&&S.fp("csgNodeChange",!0,!1)}});var $q=function(X,P){J($q,this,[X,P])};G($q,e.Node3dUI,{_80o:function(J,x,h){var i=this;i._shape3d?$q.superClass._80o.call(i,J,x,h):(X(i.gv),td.forEach(function(w){f(i,J,x,w,h)}))},validate:function(B,K){var c=this,h=c.gv,_=c.data;if(_.s("shape3d"))return $q.superClass.validate.call(c,B,K),c._shape3d=!0,void 0;c._shape3d=!1;var k=j(_,h.getMat(_));_.appendAnchorMatrix3d(k);var A=B&&B.uv;c.vf2("csg",A);for(var T=0;6>T;T++)for(var X=rg[T],V=Vp[T],l=c.vf2(X,A,K),I=l.mat||k,Q=l.vs,b=l.uv,F=l.tuv,p=0;2>p;p++){var e=y[V+3*p],q=y[V+3*p+1],R=y[V+3*p+2];if(W(Q,I,[N[3*e],N[3*e+1],N[3*e+2]]),W(Q,I,[N[3*q],N[3*q+1],N[3*q+2]]),W(Q,I,[N[3*R],N[3*R+1],N[3*R+2]]),F)if(b){var o=8*T;F.push(b[2*e-o],b[2*e+1-o],b[2*q-o],b[2*q+1-o],b[2*R-o],b[2*R+1-o])}else F.push(i[2*e],i[2*e+1],i[2*q],i[2*q+1],i[2*R],i[2*R+1])}kl(c,B,K)},vf2:function(x,f,i){var y,u=this,N=u.gv.getFaceVisible(u.data,x);return y=v(u,x,i),y.vs=[],y.tuv=N&&(y.texture||f)?[]:m,y.visible=N,y}});var Yc=P.CSGShape=function(){var G=this;J(Yc,G),G.s({"shape.background":m,"2d.hostable":!0,"shape.border.width":8}),G.setTall(240),G.setElevation(120),G.setThickness(14)};hb("CSGShape",w,{IRotatable:!1,_22Q:function(){return El},setRotationX:function(){},setRotation:function(){},setRotationZ:function(){},setSegments:function(){}});var El=function(k,Q){J(El,this,[k,Q])};G(El,e.Shape3dUI,{_80o:function(z,e,a){var B=this;B.undrawable||(X(B.gv),td.forEach(function(t){f(B,z,e,t,a)}))},validate:function(j,s){var t=this,x=t.data,F=x.getPoints();if(t.undrawable=F.size()<2)return t.clear(),void 0;var D=x.isClosePath(),M=K(x._thickness/2,C),S=q(F,m,m,D);td.forEach(function(i){t.vf(i,j&&j.uv,!0,s)}),D&&(t.left.visible=!1,t.right.visible=!1),t._12O(S,M),t._20Q(S);var c=x.getPointsMatrix3d(),f=P.Math.requestVector3();rg.forEach(function(N){if(t[N])for(var X=t[N].vs,D=0,x=X.length;x>D;D+=3)f.set(X[D],X[D+1],X[D+2]).applyMatrix4(c),X[D]=f.x,X[D+1]=f.y,X[D+2]=f.z}),P.Math.releaseVector3(f),kl(t,j,s)}});var mg=P.DoorWindow=function(){var X=this;J(mg,X),X.setElevation(100),X.s3(100,200,14)};hb("DoorWindow",Rq,{IDoorWindow:!0,toggle:function(O){this.setExpanded(!this.s(a),O)},isExpanded:function(){return this.s(a)},setExpanded:function(S,Y){var y=this,e=y.$25n,n=y.s(a);if(e&&(e.stop(!0),delete y.$25n),n!==S){y.beginTransaction();var t=S?y.s("dw.end"):y.s("dw.start");y.s(a,S),Y=u(Y),Y?(n=y.s(hi),Y.action=function(j){y.s(hi,n+(t-n)*j)},Y.finishFunc=function(){y.endTransaction()},y.$25n=Z(Y)):(y.s(hi,t),y.endTransaction())}},getMat:function(){var A=this,S=A.s("dw.s3"),W=A.s("dw.t3"),s=A.s("dw.flip"),b=A.s(hi);if(S||b||W||s){var g=[];if(s&&g.push({r3:[0,p,0]}),S&&g.push({s3:S}),b){S=A.getFinalScale3d();var M=A.s("dw.axis"),$=S[0]/2,c=S[1]/2;S[2]/2,M===_?g.push({t3:[$,0,0]},{r3:[0,-b,0]},{t3:[-$,0,0]}):M===D?g.push({t3:[-$,0,0]},{r3:[0,b,0]},{t3:[$,0,0]}):M===d?g.push({t3:[0,-c,0]},{r3:[-b,0,0]},{t3:[0,c,0]}):M===I?g.push({t3:[0,c,0]},{r3:[b,0,0]},{t3:[0,-c,0]}):M===Q?g.push({r3:[0,b,0]}):M===V&&g.push({r3:[b,0,0]})}return W&&g.push({t3:W}),k(g)}return m}});var hd=P.CSGBox=function(){var H=this;J(hd,H),H.setElevation(100),H.s3(100,200,100)};hb("CSGBox",Rq,{ICSGBox:!0,toggleFace:function(j,s){this.setFaceExpanded(j,!this.s(j+U),s)},isFaceExpanded:function(d){return this.s(d+U)},setFaceExpanded:function(E,G,I){var i=this,L=i.$25n,D=i.s(E+U);if(L&&(L.stop(!0),delete i.$25n),D!==G){var R=G?i.s(E+".end"):i.s(E+".start");i.s(E+U,G),I=u(I),I?(D=i.s(E+Ij),I.action=function(k){i.s(E+Ij,D+(R-D)*k)},i.$25n=Z(I)):i.s(E+Ij,R)}},getFaceMat:function(G){var C=this,E=C.s(G+Ij);if(!E)return m;var g,w,e,$,y,X,h=C.s(G+".axis"),F=C.getFinalScale3d(),I=C.getAnchor3d(),u=F[0]*I.x,N=F[1]*I.y,Z=F[2]*I.z,r=F[0]-u,z=F[1]-N,v=F[2]-Z,O=G+"_"+h;switch(O){case"front_left":g=-u,w=0,e=v,$=0,y=-E,X=0;break;case"front_right":g=r,w=0,e=v,$=0,y=E,X=0;break;case"front_top":g=0,w=z,e=v,$=-E,y=0,X=0;break;case"front_bottom":g=0,w=-N,e=v,$=E,y=0,X=0;break;case"front_h":g=0,w=0,e=v,$=E,y=0,X=0;break;case"front_v":g=0,w=0,e=v,$=0,y=E,X=0;break;case"back_left":g=r,w=0,e=-Z,$=0,y=-E,X=0;break;case"back_right":g=-u,w=0,e=-Z,$=0,y=E,X=0;break;case"back_top":g=0,w=z,e=-Z,$=E,y=0,X=0;break;case"back_bottom":g=0,w=-N,e=-Z,$=-E,y=0,X=0;break;case"back_h":g=0,w=0,e=-Z,$=E,y=0,X=0;break;case"back_v":g=0,w=0,e=-Z,$=0,y=E,X=0;break;case"left_left":g=-u,w=0,e=-Z,$=0,y=-E,X=0;break;case"left_right":g=-u,w=0,e=v,$=0,y=E,X=0;break;case"left_top":g=-u,w=z,e=0,$=0,y=0,X=-E;break;case"left_bottom":g=-u,w=-N,e=0,$=0,y=0,X=E;break;case"left_h":g=-u,w=0,e=0,$=0,y=0,X=E;break;case"left_v":g=-u,w=0,e=0,$=0,y=E,X=0;break;case"right_left":g=r,w=0,e=v,$=0,y=-E,X=0;break;case"right_right":g=r,w=0,e=-Z,$=0,y=E,X=0;break;case"right_top":g=r,w=z,e=0,$=0,y=0,X=E;break;case"right_bottom":g=r,w=-N,e=0,$=0,y=0,X=-E;break;case"right_h":g=r,w=0,e=0,$=0,y=0,X=E;break;case"right_v":g=r,w=0,e=0,$=0,y=E,X=0;break;case"top_left":g=-u,w=z,e=0,$=0,y=0,X=E;break;case"top_right":g=r,w=z,e=0,$=0,y=0,X=-E;break;case"top_top":g=0,w=z,e=-Z,$=-E,y=0,X=0;break;case"top_bottom":g=0,w=z,e=v,$=E,y=0,X=0;break;case"top_h":g=0,w=z,e=0,$=E,y=0,X=0;break;case"top_v":g=0,w=z,e=0,$=0,y=0,X=E;break;case"bottom_left":g=-u,w=-N,e=0,$=0,y=0,X=-E;break;case"bottom_right":g=r,w=-N,e=0,$=0,y=0,X=E;break;case"bottom_top":g=0,w=-N,e=v,$=-E,y=0,X=0;break;case"bottom_bottom":g=0,w=-N,e=-Z,$=E,y=0,X=0;break;case"bottom_h":g=0,w=-N,e=0,$=E,y=0,X=0;break;case"bottom_v":g=0,w=-N,e=0,$=0,y=0,X=E}return k([{t3:[-g,-w,-e]},{r3:[$,y,X]},{t3:[g,w,e]}])}});var Dr=function(E,B,p,y,V){function f(){var M,b=[],_=new s,U=new s;for(h.eachShapeModel(function(i,P,t){for(var y=0,e=P?P.length:i.length/3;e>y;y++)P?(_.fromArray(i,3*P[y]),U.fromArray(t,3*P[y])):(_.fromArray(i,3*y),U.fromArray(t,3*y)),n(b,_,U)}),b=T(b,w.set(1,0,0)),b=T(b,w.set(-1,0,0)),b=T(b,w.set(0,1,0)),b=T(b,w.set(0,-1,0)),b=T(b,w.set(0,0,1)),b=T(b,w.set(0,0,-1)),M=0;M<b.length;M++){var x=b[M];i.push(.5+x.position.x/V.x,.5-x.position.y/V.y),x.position.applyMatrix4(I),P.push(x.position.x,x.position.y,x.position.z),$.push(x.$22n.x,x.$22n.y,x.$22n.z)}}function n(W,V,c){V.applyMatrix4(Q),V.applyMatrix4(L),c.transformDirection(Q),c.transformDirection(L),W.push(new R(V.clone(),c.clone()))}function T(v,w){for(var N=[],L=.5*Math.abs(V.dot(w)),d=0;d<v.length;d+=3){var R,q,K,$,E,c,J,T=0,O=v[d+0].position.dot(w)-L,z=v[d+1].position.dot(w)-L,Q=v[d+2].position.dot(w)-L;switch(R=O>0,q=z>0,K=Q>0,T=(R?1:0)+(q?1:0)+(K?1:0)){case 0:N.push(v[d]),N.push(v[d+1]),N.push(v[d+2]);break;case 1:if(R&&($=v[d+1],E=v[d+2],c=j(v[d],$,w,L),J=j(v[d],E,w,L)),q){$=v[d],E=v[d+2],c=j(v[d+1],$,w,L),J=j(v[d+1],E,w,L),N.push(c),N.push(E.clone()),N.push($.clone()),N.push(E.clone()),N.push(c.clone()),N.push(J);break}K&&($=v[d],E=v[d+1],c=j(v[d+2],$,w,L),J=j(v[d+2],E,w,L)),N.push($.clone()),N.push(E.clone()),N.push(c),N.push(J),N.push(c.clone()),N.push(E.clone());break;case 2:R||($=v[d].clone(),E=j($,v[d+1],w,L),c=j($,v[d+2],w,L),N.push($),N.push(E),N.push(c)),q||($=v[d+1].clone(),E=j($,v[d+2],w,L),c=j($,v[d],w,L),N.push($),N.push(E),N.push(c)),K||($=v[d+2].clone(),E=j($,v[d],w,L),c=j($,v[d+1],w,L),N.push($),N.push(E),N.push(c));break;case 3:}}return N}function j(p,f,J,E){var V=p.position.dot(J)-E,O=f.position.dot(J)-E,k=V/(V-O),H=new R(new s(p.position.x+k*(f.position.x-p.position.x),p.position.y+k*(f.position.y-p.position.y),p.position.z+k*(f.position.z-p.position.z)),new s(p.$22n.x+k*(f.$22n.x-p.$22n.x),p.$22n.y+k*(f.$22n.y-p.$22n.y),p.$22n.z+k*(f.$22n.z-p.$22n.z)));return H}var P=[],$=[],i=[],w=new s,h=E.getData3dUI(B);if(h.mat){var Q=(new o).fromArray(h.mat),m=new o;m.makeRotationFromEuler(y),m.setPosition(p);var L=(new o).getInverse(m),I=(new o).scale({x:1/V.x,y:1/V.y,z:1/V.z});return f(),{vs:P,ns:$,uv:i}}};R.prototype.clone=function(){return new R(this.position.clone(),this.$22n.clone())};var vl=function(Z,C,S,u){var m=this,a=m.getDataAt(Z);if(a){var z=m.intersectObject(Z,a);if(z){"object"==typeof C?C=C.x?new s(C.x,C.y,C.z):new s(C[0],C[1],C[2]):(C=C||20,C=new s(C,C,C)),S=S===g?.1:S;var h=new s(m.getUp()),M=new s(m.getCenter()).sub(new s(m.getEye())).normalize(),x="cross",K=M.clone()[x](h).normalize();h.copy(K)[x](M).normalize(),u&&h.applyAxisAngle(z.worldNormal,-u);var F=new P.Node,l=z.worldNormal.clone().setLength(S).add(z.world),e=(new o).lookAt(z.worldNormal.clone(),new s(0,0,0),h),q=(new T).setFromRotationMatrix(e),H=Dr(m,a,z.world.clone(),q,C);return F.p3(l.x,l.y,l.z),F.setEuler(q),F.s3(C.x,C.y,C.z),F.s({shape3d:H,"shape3d.reverse.flip":!0}),F}}};S(P.graph3d.Graph3dView,{createDecal:vl})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);