!function(u,b,E){"use strict";function r(g,d){if("function"!=typeof d&&null!==d)throw new TypeError("Super expression must either be null or a function");g.prototype=b.create(d&&d.prototype,{constructor:{value:g,writable:!0,configurable:!0}}),d&&xl(g,d)}function R(z){var j=b.prototype.toString.call(z);return"Array]"===j.substring(j.length-6)}function i(B,E,J,M,c,e){E=E||[],J=J||[],M=M||[];try{E.push(B);var N=Function.apply(0,E);return J[J.length]="return "+N,Function.apply(0,J).apply(0,M)}catch(r){return e&&e(r),c}}function l(C){var q={};return{get:function(I){if(q[I]!==E)return q[I];var F;switch(I){case"WEBGL_depth_texture":F=C.getExtension("WEBGL_depth_texture")||C.getExtension("MOZ_WEBGL_depth_texture")||C.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":F=C.getExtension("EXT_texture_filter_anisotropic")||C.getExtension("MOZ_EXT_texture_filter_anisotropic")||C.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":F=C.getExtension("WEBGL_compressed_texture_s3tc")||C.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||C.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":F=C.getExtension("WEBGL_compressed_texture_pvrtc")||C.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":F=C.getExtension("WEBGL_compressed_texture_etc1");break;default:F=C.getExtension(I)}return q[I]=F,F}}}function U(_,G,c){function l(){if(g!==E)return g;var X=G.get("EXT_texture_filter_anisotropic");return g=null!==X?_.getParameter(X.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function v(Z){if("highp"===Z){if(_.getShaderPrecisionFormat(_.VERTEX_SHADER,_.HIGH_FLOAT).precision>0&&_.getShaderPrecisionFormat(_.FRAGMENT_SHADER,_.HIGH_FLOAT).precision>0)return"highp";Z="mediump"}return"mediump"===Z&&_.getShaderPrecisionFormat(_.VERTEX_SHADER,_.MEDIUM_FLOAT).precision>0&&_.getShaderPrecisionFormat(_.FRAGMENT_SHADER,_.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var g;c=c||{};var D="undefined"!=typeof WebGL2RenderingContext&&_ instanceof WebGL2RenderingContext,C=c.precision!==E?c.precision:"highp",$=v(C);$!==C&&(console.warn("WebGL:",C,"not supported, using",$,"instead."),C=$);var d,f=c.logarithmicDepthBuffer===!0,L=_.getParameter(_.MAX_TEXTURE_IMAGE_UNITS),s=_.getParameter(_.MAX_VERTEX_TEXTURE_IMAGE_UNITS),N=_.getParameter(_.MAX_TEXTURE_SIZE),P=_.getParameter(_.MAX_CUBE_MAP_TEXTURE_SIZE),h=_.getParameter(_.MAX_VERTEX_ATTRIBS),W=_.getParameter(_.MAX_VERTEX_UNIFORM_VECTORS),U=_.getParameter(_.MAX_VARYING_VECTORS),M=_.getParameter(_.MAX_FRAGMENT_UNIFORM_VECTORS),Q=s>0,y=D||!!G.get("OES_texture_float"),m=(D||!!G.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,K=Q&&y,S=D?_.getParameter(_.MAX_SAMPLES):0,k=!1;return D?k=!0:(d=G.get("ANGLE_instanced_arrays"))&&(k=!0,_.vertexAttribDivisor=function(R,M){return d.vertexAttribDivisorANGLE(R,M)},_.drawElementsInstanced=function(G,U,i,n,$){return d.drawElementsInstancedANGLE(G,U,i,n,$)},_.drawArraysInstanced=function(w,Y,J,W){return d.drawArraysInstancedANGLE(w,Y,J,W)}),{getMaxAnisotropy:l,getMaxPrecision:v,precision:C,logarithmicDepthBuffer:f,maxTextures:L,maxVertexTextures:s,maxTextureSize:N,maxCubemapSize:P,maxAttributes:h,maxVertexUniforms:W,maxVaryings:U,maxFragmentUniforms:M,vertexTextures:Q,floatFragmentTextures:y,elementTypeUint:m,floatVertexTextures:K,maxSamples:S,instancedArray:k}}function Q(w,_){return w.z!==_.z?_.z-w.z:w.id-_.id}var K="ht";if(!u[K]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),u.performance&&u.performance.now||function(){var N=Date.now();u.performance||(u.performance={}),u.performance.now=function(){return Date.now()-N}}();for(var d=Date.now(),H=16,C=["ms","moz","webkit","o"],O=0;O<C.length&&!u.requestAnimationFrame;++O)u.requestAnimationFrame=u[C[O]+"RequestAnimationFrame"],u.cancelAnimationFrame=u[C[O]+"CancelAnimationFrame"]||u[C[O]+"CancelRequestAnimationFrame"];u.requestAnimationFrame||(u.requestAnimationFrame=function(P){var E=Date.now(),o=H+d-E;return 0>o&&(o=0),d=E,u.setTimeout(function(){d=Date.now(),P(performance.now())},o)}),u.cancelAnimationFrame||(u.cancelAnimationFrame=function(C){return u.clearTimeout(C)}),b.assign===E&&(b.assign=function(i){if(i===E||null===i)throw new TypeError("Cannot convert undefined or null to object");for(var u=b(i),j=1;j<arguments.length;j++){var A=arguments[j];if(A!==E&&null!==A)for(var c in A)b.prototype.hasOwnProperty.call(A,c)&&(u[c]=A[c])}return u}),u.btoa===E&&(u.btoa=function(k){for(var s,o,x=String(k),g=0,J="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",W="";x.charAt(0|g)||(J="=",g%1);W+=J.charAt(63&s>>8-8*(g%1))){if(o=x.charCodeAt(g+=.75),o>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");s=s<<8|o}return W})}();var y,$,s,I,d=u.location,Y=d&&u.document,f=null,A=E,H=u[K]={},z=u[K+"config"],L=H.Default=z&&z.Default||{},W=H.Style=z&&z.Style||{},M=H.Attr=z&&z.Attr||{},X=function(){return!0},t=function(){return!1},F=function(f){return f},T=function(T){return!T},D=H.Color=z&&z.Color||{},g=H.IsGetter=z&&z.IsGetter||{};!function(){var n=!1;try{var c=b.defineProperty({},"passive",{get:function(){return n=!0,E}});d&&(s=y=d)&&u.addEventListener("test",c,c),d&&(I=$=d)&&u.removeEventListener("test",c,c)}catch(P){n=!1}L.passiveSupported=n}();var n,o,V,c,S=L.passiveSupported,v=L.eventListenerOptionsFalse=S?{passive:!1,capture:!1}:!1,C=L.eventListenerOptionsTrue=S?{passive:!1,capture:!0}:!0,w=function(z,a,x,r){z.addEventListener(a,x,r?C:v)},x=function(X,P,y,w){X.removeEventListener(P,y,w?C:v)},N=Math,P=N.round,j=N.floor,q=N.ceil,G=N.sqrt,p=N.max,h=N.min,a=N.abs,J=N.cos,Z=N.acos,B=N.sin,m=N.pow,e=N.asin,k=N.exp,O=N.PI,_=2*O,qq=O/2,Kc=N.tan,ts=N.atan2,ml=N.random,ak=N.log,He=function(M,t,u){return Math.max(t,Math.min(u,M))},wh=m(2,1),ne=!1,cm=u.parseInt||global.parseInt,Qr="2023-2-15",Gf=d&&(u.navigator?u.navigator.platform.indexOf("Win")>-1:!1),wk=function(D){return D*D},On=d&&u.setTimeout,Zh=d&&u.clearTimeout,em=d&&(u.navigator?u.navigator.userAgent.toLowerCase():""),vr=function(m){return m.test(em)},yf=vr(/msie/),xf=vr(/msie/)||vr(/trident/),Tn=vr(/msie 10/),dh=vr(/edge/),_o=vr(/firefox/),Zf=vr(/mac/),ol=vr(/mscAndroid/),dn=L.isTouchable===E?Gf?!1:Y?"ontouchend"in Y:!1:L.isTouchable,yd="default",To="single",ul="multiple",Bc="front",qo="back",re="left",ln="right",Fc="top",ab="bottom",bb="center",uh="eye",aj="middle",Kg="east",Xe="west",Wq="north",ae="none",qf="px",zh="absolute",_f="border",so="triangle",Bj="rect",Jq="circle",Fn="cylinder",pc="shape",bm="items",Hh="normal",xk="remove",$n="clear",Mj="width",_p="height",mf="ingroup",eb="check",Mo="uncheck",Ug="radio",fg="radioOn",Ym="radioOff",we="points",nl="values",sf="series",Rn="body",oc="label",jr="label2",Ap="note",uj="note2",cb="icons",vh="labelFont",Cr="labelColor",Fe="labelSelectColor",lb="note.expanded",pe="note2.expanded",Ne="edge.expanded",Ji="edge.points",uo="edge.type",ve="rotation",jc="hidden",Xh="visible",ei="tuv",om="no",gl="draw",xp="select",Cd="currentSubGraph",$m="selectBackground",Co="autoMakeVisible",Sh="autoHideScrollBar",Bf="scrollBarColor",We="scrollBarSize",lk="indent",qk="rowHeight",Ho="columnLineColor",ub="rowLineColor",Qo="columnLineVisible",Qg="rowLineVisible",hp="visibleFunc",wg="expandIcon",dj="collapseIcon",gq="checkMode",ib="sortFunc",Gh="editable",ir="batchEditable",mc="tristate",Gk="asc",Yc="desc",Cp="position",wc="__",Wi="elevation",Dh="children",Ml="translateX",Gq="translateY",Yk="dataModel",vk="maxSize",Ob="enc",sg="state",yq=Ob+"o"+"de",bc="shape3d",cq="shape3d.resolution",zk="shape3d.visible",mb="shape3d.from.visible",Tg="shape3d.to.visible",Rd="shape3d.top.visible",Hk="shape3d.bottom.visible",lg="repeat.uv.length",Io="serializeValue",oj="deserializeValue",kp="centerUniform",Ip="uniform",Wm="rgba(255,255,255,0)",Eh="style",Ei="attr",Bd="field",Vm="string",uk="boolean",lr="color",lh="int",Bl="number",Ek="ew-resize",Er="ns-resize",ig="pointer",mk="auto",Lb="mousedown",mo="mousemove",gh="mouseup",Qm="mouseout",Sk="touchstart",ic="touchmove",Wn="touchend",Sr="keydown",Yq="keyup",Ni=["DOMMouseScroll","mousewheel"],Xb=_o?Ni[0]:Ni[1],Nc=wc+K+wc+yq,Ed=[Sk,ic,Wn],pj=[Lb,mo,gh,Qm,Xb,"wheel","mouseenter","mouseleave","mouseover"],vn=[Sr,Yq,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],fr=dn?Ed.concat(vn):pj.concat(vn),Ad=f,an=f,yc=f,Yb=f,vj=!1,Ub=gh.length,Ok=function(){yc&&(Zh(yc.timeout),yc=f)},me=function(){yc&&op(yc.e,yc.info)};u.addEventListener&&(A=d)&&(dn||(w(u,Qm,function(){Ok()}),w(u,Xb,function(){Dq()})),w(u,Yq,function(n){91===n.keyCode?Go={}:delete Go[n.keyCode]},!0),w(u,Sr,function(e){Go[e.keyCode]=!0},!0),w(u,"blur",function(){Go={}}));var og,qi,Cj,Lj=0,Mb=f,el=function(y,T){var V=On(function(){delete Mb[V],cc(Mb)&&(Mb=f),y()},T);return V},Do=f,sc=f,Bs={},ih={},gb={},Xo={},ld={},Go={},ee={},Ak={},zg={},sd={},Cs=/.json$/,nh=/\.(json|bin)$/,Im=/^data:image\/svg\+xml/,Qf={},up=[],Cq={},Ij=f,Aq=f,vi=function(){},pm=function(){throw"Oops!"},Zj=[0,0,0],hq={x:0,y:0,width:0,height:0},hm=f,cl=f,ef=f,yj=function(w,Y){ih[w]=Y,Y&&Y.comps&&!Y.uuid&&(Y.uuid=H.Math.generateUUID()),nb[w]&&(Y.cacheRule=nb[w],delete nb[w])},yo=function(q){cl&&!q._72O&&(ef||(ef={}),ef[q._72O=Vi()]=q),og!=f?Kf()<.05&&c&&!qi&&(ji=Ok):ji=dk},jp=function(z,m,b,S){cl||(cl={});var j=cl[z];if(j){if(j.url===m)return;j.image?(j.image.onload=vi,j.image.onerror=vi):j.request&&(j.request.onload=vi,j.request.onerror=vi)}if(Cs.test(m)){var t=new yk;if(cl[z]={request:t,url:m},m=L.beforeLoadURL(m,z),m.data){var W=L.parse(m.data);yb(z,W),L.handleImageLoaded(z,W)}else{t.onload=function(){if(200===this.status||0===this.status){var E=L.parse(t.getResponseText());yb(z,E),L.handleImageLoaded(z,E)}else yb(z,L.handleUnfoundImage(z,m)||f)},t.onerror=function(){yb(z,L.handleUnfoundImage(z,m)||f)};var I={};I.url=encodeURI(m),I.sync=!1,t.send(I)}}else{var W=new Image;cl[z]={image:W,url:m},/^data:image/.test(m)||(m=L.beforeLoadURL(m,z),m=L.appendTimeStamp(m),m=encodeURI(m),W.crossOrigin=L.crossOrigin),L.convertImageSrc(m,function(B){xf&&(m.toLowerCase().indexOf(".svg")>0||Im.test(m))?(Y.body.appendChild(W),W.style.visibility="hidden",W.onload=function(){On(function(){if(b&&(W.width=b),S&&(W.height=S),!W.width||!W.height){var H=W.width||W.clientWidth,Q=W.height||W.clientHeight;W.width=H,W.height=Q}L.handleImageLoaded(z,W),yb(z,W),Y.body.removeChild(W),W.style.visibility=""},180)},W.onerror=function(){yb(z,L.handleUnfoundImage(z,m)||f),Y.body.removeChild(W),W.style.visibility=""}):(W.onload=function(){b&&(W.width=b),S&&(W.height=S),L.handleImageLoaded(z,W),yb(z,W)},W.onerror=function(){yb(z,L.handleUnfoundImage(z,m)||f)}),W.src=B})}},yb=function(L,x){if(yj(L,x),delete cl[L],cc(cl)&&(cl=f,ef)){for(var o in ef){var g=ef[o];g._2O&&g._2O[L]&&(g.deleteTexture(L),delete g._2O[L]),g.invalidateAll&&g.invalidateAll(E,"imageLoaded",L),g.redraw&&g.redraw(),g.iv(),x&&x.layoutAttach&&fi(g.dm)&&g.dm().updateLayoutAttach(L),delete g._72O}ef=f}if(x&&ef)for(var o in ef){var g=ef[o];g.invalidateAll&&g.invalidateAll(E,"imageLoading",L),g.redraw&&g.redraw(),g.iv(),x.layoutAttach&&fi(g.dm)&&g.dm().updateLayoutAttach(L)}},ek=function(){return ak=N&&Date,function(){return u.performance&&u.performance.now?u.performance.now():Date.now()}}(),Rb=function(K,g,u){return{width:K,height:g,comps:br(u)?u:[u]}},jb=function(h,X){return{type:Jq,rect:[h,X,1.6,1.6],borderWidth:1,borderColor:Dk,gradient:pk,gradientColor:Id,background:Dk}},km=function(e,A){return Rb(16,16,{type:so,rect:[4,4,10,8],background:e,rotation:A?1.57:3.14})},xd=function(h,l){return Rb(16,16,{type:so,rect:[4,4,8,7],background:h,rotation:l?3.14:0})},yl=function(i){var B=i._orientation;return"horizontal"===B||"h"===B},sr=function(y,X){var i=f||4,p=f||1,K=f||1;0>i?i=0:i>.25&&(i=.25);var c,w,a,q,n,P,Y,V=.5,U=[],Z=[],z=[],e=_/K,t=_/p,g=V-i;for(w=0;p>=w;w++)for(q=-O+w*t,P=J(q),n=B(q),c=0;K>=c;c++)a=c*e,Y=g+i*P,U.push(J(a)*Y,n*i,-B(a)*Y),(o=[y,X])&&Z.push(c/K,1-w/p);for(w=0;p>w;w++){var l=w*(K+1),Q=(w+1)*(K+1);for(c=0;K>c;c++)z.push(l+c,Q+c+1,Q+c,l+c,l+c+1,Q+c+1),cp.z=Rj.z=[y,X]}},on=function(h){var Q=2,C=0;for(var R in h)R.length===Q&&cm(R,32)===go&&(Ij=Aq=h[R]),C++;return C},Yh=function(z,$,u,Q){return u||(u=dn?5:3,u/=Q||1),{x:z-u,y:$-u,width:2*u,height:2*u}},Ui=function(g,s,E,F){var A=this;s||(s=dn?5:3,E=20,F=20);var L={x:g,y:s,width:E,height:F};if(E)for(var w=0;E>w;w++)if(3===E)F=20;else for(var J=0;F>J;J++)A=u?u:E;var o={x:O,y:2*O};if(Sj(L,o)){var G=_p[0]+Fc[0]+$n[1]+Gk.length,k=jc[0]+mc[0]+$n[1]+Rn.length;en[uh]=[A[G],A[k]],A[G]=fc[uh],A[k]=fc[bc]}},Ql=function(u){return(/ble$/.test(u)||/ed$/.test(u)||g[u]?"is":"get")+u.charAt(0).toUpperCase()+u.slice(1)},fc=function(K){return"set"+K.charAt(0).toUpperCase()+K.slice(1)},Vn=function(Y){return typeof Y===Vm||Y instanceof String},$c=function(y){return typeof y===Bl},dk=function(b){return typeof b===uk},Mr=function(m){return m&&"object"==typeof m},fi=function(e){return"function"==typeof e},br=function($){return $ instanceof Array},Zc=function(J){return J instanceof zp},vo=function(e){return br(e)?new zp(e):e},mq=function(d){return d instanceof jh},Op=function(d){return d instanceof Rl},Zd=function(Z){return Z instanceof Vg},vc=function(C,u){if(!(C instanceof H.Group))return!1;if(!u)return C.isExpanded();var w=u.getDataUI(C);return w&&w._88I?!0:!1},bd=function(y){return y instanceof If},ce=function(R){return R&&"IFRAME"===R.tagName},_i=function(x){return x==f||L.numberDigits==f?x:parseFloat(x.toFixed(L.numberDigits))},eq=function(R,i,e){var U,D=i.length;if(e)for(var q=0;e>q;q++)if(3===D)R.push(i[0]),R.push(i[1]),R.push(i[2]);else for(U=0;D>U;U++)R.push(i[U]);else if(3===D)R.push(i[0]),R.push(i[1]),R.push(i[2]);else for(U=0;D>U;U++)R.push(i[U])},Oj=function(R){return R?Mr(R)?R:{}:!1},Hi=function($,d,n){var j,f=Mr($)?$:$.prototype;for(j in d)n&&j in f?f[j]===E&&console.warn("class",f,"has own undefined property",j,", keep exist!"):f[j]=d[j];return $},Wf=function(F,N){if(!("wheelDelta"in N)){var k=N.deltaMode;N.wheelDelta=k===N.DOM_DELTA_PIXEL?-N.deltaY:k===N.DOM_DELTA_LINE?40*-N.deltaY:120*-N.deltaY}F.handle_mousewheel(N)},mp=function(M){return String.fromCharCode(M)},Ih=function(b){for(var z,D=0,J="";D<b.length;D++)z=b[b.length-1-D],"%"===z?z="'":"a"===z?z='"':"]"===z&&(z="\\"),J+=mp(z.charCodeAt(0)-1);return J},Hm=function(r,B,w){r.superClass.constructor.apply(B,w)},cc=function(V){for(var v in V)return!1;return!0},jj=function(_){return _?0===_.length:!0},nk=function(){var x="";return[Mo[0],ub[0],oc[0]].forEach(function(d){x+=fc(d).slice(3)}),Ip=Y&&Y[x]||kp,function(w,Q){return w===Q?!0:w.x===Q.x&&w.y===Q.y&&w.width===Q.width&&w.height===Q.height}}(),Ve=function(J,c,t){return c>J?c:J>t?t:J},Wd=function(y){return 0>y?-1:y>0?1:0},Kf=function(){var p=1e4*B(Ub++);return p-j(p)},Eo=function(W,z,V){return Tb(W.x,W.y,z.x,z.y,V.x,V.y,V.x+V.width,V.y,!0)||Tb(W.x,W.y,z.x,z.y,V.x+V.width,V.y,V.x+V.width,V.y+V.height,!0)||Tb(W.x,W.y,z.x,z.y,V.x+V.width,V.y+V.height,V.x,V.y+V.height,!0)||Tb(W.x,W.y,z.x,z.y,V.x,V.y+V.height,V.x,V.y,!0)},Tb=function(n,C,E,O,Y,d,q,l,R){var B=(q-Y)*(C-d)-(l-d)*(n-Y),u=(l-d)*(E-n)-(q-Y)*(O-C);if(0!==u){var L=B/u,$=n+L*(E-n),K=C+L*(O-C);return R&&($+_m<h(n,E)||$-_m>p(n,E)||$+_m<h(Y,q)||$-_m>p(Y,q)||K+_m<h(C,O)||K-_m>p(C,O)||K+_m<h(d,l)||K-_m>p(d,l))?f:[$,K]}return f},Wp=function(q,Y,S){if(q&&S)if(Y){if(Y===Eh)return q.getStyle(S);if(Y===Ei)return q.getAttr(S);if(Y===Bd)return q[S]}else if(S=Ql(S),q[S])return q[S]();return E},Pq=function(c,b,v,G){if(c&&v)if(b){if(b===Eh)c.s(v,G);else if(b===Ei)c.a(v,G);else if(b===Bd){var C=c[v];c[v]=G,c.fp("f:"+v,C,G)}}else v=fc(v),c[v]&&c[v](G)},jg=function(E,P,M){var K=100*Math.max(E.width,E.height);return P&&"top"!==P?"bottom"===P?{x:E.x-K,y:E.y-K,width:E.width+2*K,height:E.height*M+K}:"right"===P?{x:E.x-K,y:E.y-K,width:E.width*M+K,height:E.height+2*K}:"left"===P?{x:E.x+E.width*(1-M),y:E.y-K,width:E.width*M+K,height:E.height+2*K}:void 0:{x:E.x-K,y:E.y+E.height*(1-M),width:E.width+2*K,height:E.height*M+K}},tq=function(a,d,l,Y,x){d&&Nj(a,l,Y,1,x,d)},Kk=function(t,u,D,s){var U=1-t;return U*U*u+2*t*U*D+t*t*s},cp=function(E,a,c,d,I){var V=1-E;return V*V*V*a+3*V*V*E*c+3*V*E*E*d+E*E*E*I},Gn=function(X){var E,j,y,z,i=0;return X.forEach(function(P){if(E=P.length,E>0)for(j=P[0],z=1;E>z;z++)y=P[z],i+=Mp(j,y),j=y}),i},_e=function(f,O,F){var o="__"+f,t=function(O){("mousedown"===f||"mouseup"===f||"touchstart"===f||"touchend"===f)&&Md(O),F.disabled||F["handle_"+f](O)};F[o]||(F[o]=t,w(O,f,t))},qn=function(J,m,P){var Q="__"+J,Z=P[Q];Z&&(x(m,J,Z),delete P[Q])},Yf=function(g,o){var p="_"+o;g[Ql(o)]=function(){return this[p]},g[fc(o)]=function(g){var s=this[p];this[p]=g,this.fp(o,s,g)}},Be=function(f){return b.create(f)},ao=function(j){if(!j.element){var V,J;(V=j.textField)?J=dq(Ht.TextField,V):(V=j.textArea)?J=dq(Ht.TextArea,V):(V=j.button)?J=dq(Ht.Button,V):(V=j.comboBox)?J=dq(Ht.ComboBox,V):(V=j.checkBox)?J=dq(Ht.CheckBox,V):(V=j.radioButton)?J=dq(Ht.RadioButton,V):(V=j.slider)?J=dq(Ht.Slider,V):(V=j.colorPicker)?J=dq(Ht.ColorPicker,V):(V=j.image)&&(J=dq(Ht.Image,V)),J&&(j.element=J)}},Cg=function(y,J){var P=Rq(y);return P._ht=J,P},am=u.top===u?u.top:u||u.document,Rq=function(t,Z){var J=Y.createElement("div"),r=J.style;return J.tabIndex=-1,J.onkeydown=Lk,r.msTouchAction=ae,sn(J,f,0),dn&&r.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",f),t&&(r.overflow=jc),Z&&Zg(Z,J),J},Vq=function(A,M){var B=Y.createElement("canvas"),v=B.style;return v.msTouchAction=ae,M||(v.pointerEvents=ae),sn(B,f,0),A&&Zg(A,B),B},sn=function(n,x,N){var X=n.style;X.border=x?x+" solid 1px":0,X.outline=0,X.padding=N?"0 "+N+qf:0,Eq(n)},Eq=function(M){var p=M.style;p.position=zh,p.margin=0,p.setProperty("box-sizing","border-box",f),p.setProperty("-moz-box-sizing","border-box",f)},Zq=function(g,y,l,i){i||(i=od),y!=f&&(g.width=y*i,g.style.width=y+qf),l!=f&&(g.height=l*i,g.style.height=l+qf)},Zg=function(z,P,_){z.appendChild(P),_&&(P.style.position=zh)},je=function(f,k){k.split||(k+="");for(var U,x=k.split("\n"),Z=0,D=x.length,o=0;D>o;o++){var Q=vm(f.font,x[o]);Q.width>Z&&(Z=Q.width),U||(U=Q.height)}return f.ss=x,{width:Z,height:U*D}},fl=function(){var D=Y?Vq().getContext("2d"):f;return function(B,F,C,v,s,T){var c=B.split("\n"),l=[],r=vm(C,B).height;return v||(v=0),D.font=C,D.textBaseline=Fc,c.forEach(function(f){for(var L=0,h=1,y=0,i=f.length;i>=h;h++){var G=f.substring(L,h),U=s?D.measureText(f[h]):vm(C,G);s&&(y+=U.fontBoundingBoxDescent||r);var I=s?y+(G.length-1)*T:U.width+(G.length-1)*v;I>F&&(h-1===L?(l.push(f.substring(L,h)),L=h):(l.push(f.substring(L,h-1)),L=h-1,h--),y=0)}L!==h-1&&l.push(f.substring(L,h))}),l}}(),lj=function(l,i,C,f,A,v,T,X){l.font=C;var e=l.measureText(i);if(l.beginPath(),l.strokeStyle=f,l.lineWidth=1,"underline"===X){var E;E=e.actualBoundingBoxDescent?e.actualBoundingBoxDescent+1:vm(C,i).size/2,l.moveTo(A-T/2,v+E),l.lineTo(A+T/2,v+E)}else if("strikethrough"===X)l.moveTo(A-T/2,v),l.lineTo(A+T/2,v);else if("overline"===X){var E;E=e.fontBoundingBoxAscent?e.fontBoundingBoxAscent:vm(C,i).size/2,l.moveTo(A-T/2,v-E),l.lineTo(A+T/2,v-E)}l.stroke()},vb=function(E,M,y,w,J,D,$,k,P,x,p){var X=J.x,V=J.y,R=J.width,S=J.height;if(M!=f){var z=vm(y,M),U={};P&&(z.width+=(M.length-1)*P),U.y=$&&$!==aj?$===Fc?V+z.height/2:V+S-z.height/2:V+S/2,U.x=D&&D!==re?D===ln?X+R-z.width/2:X+R/2:X+z.width/2,Iq(E,M,U,y,w,P,x,p),k&&lj(E,M,y,w,U.x,U.y,z.width,k)}},Or=function(U,g,j,u,_,x,X,K,n,y){var o=g.length;if(1===o){var G=g[0];if(Iq(U,G,j,u,_,K,n,y),X){var e=vm(u,G);lj(U,G,u,_,j.x+j.width/2,j.y+j.height/2,e.width,X)}}else for(var v=j.height/o,c={x:j.x,y:j.y,width:j.width,height:v},M=0;M<g.length;M++){if(x)vb(U,g[M],u,_,c,x,null,X,K,n,y);else if(Iq(U,g[M],c,u,_,K,n,y),X){var e=vm(u,g[M]);lj(U,g[M],u,_,c.x+c.width/2,c.y+c.height/2,e.width,X)}c.y+=v}},Iq=function(J,t,Y,k,A,u,Q,I){J.font=k?k:Bh,J.fillStyle=A?A:Tk,J.textAlign=bb,J.textBaseline=aj;var b,p;Y?Y.width===E?(b=Y.x,p=Y.y):(b=Y.x+Y.width/2,p=Y.y+Y.height/2):(b=0,p=0);var T=Q&&I;if(T&&(J.strokeStyle=I,J.lineWidth=Q),u){var c=vm(k,t);b-=(c.width+u*(t.length-1))/2;for(var B=(t+"").length,V=0;B>V;V++){var s=t[V],m=J.measureText(s);T&&J.strokeText(s,P(b+(m.width+4)/2),P(p)),J.fillText(s,P(b+(m.width+4)/2),P(p)),b+=m.width+u}}else T&&J.strokeText(t,P(b),P(p)),J.fillText(t,P(b),P(p))},fn=function(B){B.getView&&(B=B.getView());var o=B.offsetWidth||B.scrollWidth;return!o&&B.style.width&&(o=cm(B.style.width)),o},yg=function(f){f.getView&&(f=f.getView());var t=f.offsetHeight||f.scrollHeight;return!t&&f.style.height&&(t=cm(f.style.height)),t},no=function(f,h,C){var B=h[0].toUpperCase()+h.substring(1,h.length);f["webkit"+B]=C,f["moz"+B]=C,f["ms"+B]=C,f["o"+B]=C,f[h]=C},sk=function(){var W=function(O){Lk(O),O.stopPropagation()},M=function(v){Lk(v)},e=[Sk,Sr,Lb];return function(i,o){var j=Rq(),T=j.style;return T.backgroundColor=L.disabledBackground,i&&(T.backgroundImage="url("+i+")",T.backgroundPosition="50% 50%",T.backgroundRepeat="no-repeat no-repeat"),o===!1?e.forEach(function(z){w(j,z,M)}):e.forEach(function(D){w(j,D,W)}),j}}(),Xn=function(H){var a=H.getContext("2d");return a.save(),a.lineCap=Am,a.lineJoin=Jm,a},ji=function(y,A,e,c){rn(y,A*od,e*od),c*=od,1!==c&&y.scale(c,c)},rn=function(y,j,V){y.translate(j,V)},bo=function(O,_){_&&O.rotate(_)},wj=function(q,s,X){s===E&&(s=1),X===E&&(X=1),(1!==s||1!==X)&&q.scale(s,X)},hg=!1,k=am[eb[1]+Ml[0]],xg=function(U){var Z=Y.activeElement;if(Y.activeElement!==U){Z&&Z.forceOnblur&&Z.forceOnblur();for(var i=[],n=U.parentNode;n;)i.push([n,n.scrollLeft,n.scrollTop]),n=n.parentNode;if(!hg){var v=[],R=[];try{for(var t=u.parent,a=u;t!==a;)v.push([t,t.scrollX,t.scrollY]),a=t,t=u.parent;var c=u.frameElement;if(c)for(var h=c.parentNode;h;)R.push([h,h.scrollLeft,h.scrollTop]),h=h.parentNode}catch(J){hg=!0}}if(dn)U.focus();else{var P=Kd(),O=P.target;U.focus(),O.scrollLeft=P.left,O.scrollTop=P.top}i.forEach(function(B){B[0].scrollLeft=B[1],B[0].scrollTop=B[2]}),hg||(v.forEach(function(m){m[0].scrollTo(m[1],m[2])}),R.forEach(function(Y){Y[0].scrollLeft=Y[1],Y[0].scrollTop=Y[2]}))}},kn=function(_){return _&&_.getView?_.getView():_},kq=function(m,b,n,t,$){if(2===arguments.length&&(n=b.y,t=b.width,$=b.height,b=b.x),m.isSelfViewEvent)m.setX(b),m.setY(n),m.setWidth(t),m.setHeight($);else{var o=kn(m),y=o.style;if((Y.fullscreenElement||Y.mozFullScreenElement||Y.webkitFullscreenElement||Y.msFullscreenElement)!==o)b!==E&&(y.left=b+qf),n!==E&&(y.top=n+qf),t!==E&&(y.width=t+qf),$!==E&&(y.height=$+qf);else{var l=L.getWindowInfo();y.left=(b=l.left)+qf,y.top=(n=l.top)+qf,y.width=(t=l.width)+qf,y.height=($=l.height)+qf}m.endEditing&&!dn&&m.endEditing(),m.redraw&&m.redraw(),m.invalidate&&m.invalidate(),m.onLayouted&&m.onLayouted(b,n,t,$),m.fireViewEvent&&m.fireViewEvent("layout")}},rg=function($){if(!$.touches)return $;var M=$.touches[0];return M?M:$.changedTouches[0]},Nr=function(D){return bj(D)?rg(D).target:D.target},bj=function(Z){return Z&&"object"==typeof Z&&"touches"in Z},io=function(e){L.popup&&L.popup.close(),L.popup=e},gk=f,Al=function(Q){gk.handleWindowTouchMove(Q)},Il=function(C){gk.handleWindowTouchEnd(C),x(u,ic,Al),x(u,Wn,Il),x(u,"blur",Il),gk=f},Vc=function(I){gk.handleWindowMouseMove(I)},Bn=function(w){gk.handleWindowMouseUp(w),x(u,mo,Vc),x(u,gh,Bn),x(u,"blur",Bn),gk=f},Tr=function(O){return 1===Ai(O)},vd=function(C,r){return r?r.keyCode===C:Go[C]},Qq=function(E){return vf(E)&&vd(65,E)},xh=function(n){return vd(46,n)||vd(8,n)},Mq=function(A){return function(t){return t?t.keyCode===A:Go[A]}},go=573,Sf=[65,83,68,87,37,38,39,40,32,13,27],wl=Mq(Sf[0]),dl=Mq(Sf[1]),Pe=Mq(Sf[2]),Nl=Mq(Sf[3]),Ff=Mq(Sf[4]),Tf=Mq(Sf[5]),Te=Mq(Sf[6]),rl=Mq(Sf[7]),Xc=Mq(Sf[8]),Ll=Mq(Sf[9]),le=Mq(Sf[10]),of={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},uf=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,5,5,5,5,5,17,107],gr=f,ng=f,Mn=function(H,l){gr||(gr=Vq()),Zq(gr,H,l,1);var T=Xn(gr);return T.clearRect(0,0,H,l),T},Fm=function(Q,$,e){if($&&Q){if("override"===e)return $;if("override_rgb"===e){var a=$r($);return Q=si(Q),"rgba("+P(255*a[0])+","+P(255*a[1])+","+P(255*a[2])+","+Q[3]/255+")"}if("override_a"===e){var a=$r($);return Q=si(Q),"rgba("+Q[0]+","+Q[1]+","+Q[2]+","+a[3]+")"}if("multiply_destinationAtop"===e){var p=ys($r(Q)),R=p[3],G=ys($r($)),H=G[3],d=ys(p),O=d[3],s=p.map(function(E,i){return E*G[i]}),c=1-R,t=1-H,l=t*R+H;return p=p.map(function(g,x){return(H*c*G[x]+H*R*s[x]+t*R*g)/l}),R=l,c=1-R,p=p.map(function(F,Y){return(O*d[Y]*c+R*F*O)/O}),R=O,"rgba("+P(255*p[0])+","+P(255*p[1])+","+P(255*p[2])+","+R+")"}var a=$r($);return Q=si(Q),"rgba("+P(Q[0]*a[0])+","+P(Q[1]*a[1])+","+P(Q[2]*a[2])+","+Q[3]/255*a[3]+")"}return Q},si=function(){var x,I={};for(var v in u){var R=ul.length;if(v.length==R&&v[0]===ul[2]&&v[1]===ae[1]&&v[4]===ul[3]&&v[5]===ul[4]&&v.substr(R-2)===ae[1]+ae[2]){var i=u[v];for(var r in i)r.length===R&&r.substr(0,3)===ln[3]+xk[3]+xp[0]&&r.substr(R-2)===ul[0]+Ap[3]&&(Ni=i[r])}}return function(J){var Q,c=I[J];return c||(x||(x=Vq(),Zq(x,1,1,1)),Q=x.getContext("2d"),Q.clearRect(0,0,1,1),Nj(Q,0,0,1,1,J),c=Q.getImageData(0,0,1,1).data,c=I[J]=[c[0],c[1],c[2],c[3]]),c}}(),$r=function(t){if(!Vn(t))return t;var X=si(t);return X.CA||(X.CA=[X[0]/255,X[1]/255,X[2]/255,X[3]/255]),X.CA},Dm=function(e,a,h,B,I){var Q=Vq();Q.width=h,Q.height=B;var y=Q.getContext("2d");y.drawImage(e,0,0,h,B);try{for(var w=y.getImageData(0,0,h,B),K=w.data,O=0,C=K.length;C>O;O+=4){var Z=K[O+0],D=K[O+1],A=K[O+2],i=K[O+3];"override_a"===I?K[O+3]=255*a[3]:"override_rgb"===I?(K[O+0]=255*a[0],K[O+1]=255*a[1],K[O+2]=255*a[2]):"override"===I?(K[O+0]=255*a[0],K[O+1]=255*a[1],K[O+2]=255*a[2],K[O+3]=255*a[3]):(K[O+0]=a[0]*Z,K[O+1]=a[1]*D,K[O+2]=a[2]*A,K[O+3]=a[3]*i)}y.putImageData(w,0,0)}catch(v){return e}return Q},en=function(w,h,M){return h&&(h="miter"===M?8*h+20:h+1,w&&Qd(w,h)),h},dp=function(R,n){if(n){var Y=new ph(n),b=R.width/2,P=R.height/2,e=Db([Y.tf(-b,-P),Y.tf(b,-P),Y.tf(b,P),Y.tf(-b,P)]);return e.x+=R.x+b,e.y+=R.y+P,e}return R},yi=function(k,Q,r,J,P,V,b,y){J*=Math.PI/180;var X={x:Math.cos(J)*(k.x-b.x)/2+Math.sin(J)*(k.y-b.y)/2,y:-Math.sin(J)*(k.x-b.x)/2+Math.cos(J)*(k.y-b.y)/2},_=Math.pow(X.x,2)/Math.pow(Q,2)+Math.pow(X.y,2)/Math.pow(r,2);_>1&&(Q*=Math.sqrt(_),r*=Math.sqrt(_));var t=(P==V?-1:1)*Math.sqrt((Math.pow(Q,2)*Math.pow(r,2)-Math.pow(Q,2)*Math.pow(X.y,2)-Math.pow(r,2)*Math.pow(X.x,2))/(Math.pow(Q,2)*Math.pow(X.y,2)+Math.pow(r,2)*Math.pow(X.x,2)));isNaN(t)&&(t=0);var v={x:t*Q*X.y/r,y:t*-r*X.x/Q},D={x:(k.x+b.x)/2+Math.cos(J)*v.x-Math.sin(J)*v.y,y:(k.y+b.y)/2+Math.sin(J)*v.x+Math.cos(J)*v.y},Y=function(N){return Math.sqrt(Math.pow(N[0],2)+Math.pow(N[1],2))},C=function(C,S){return(C[0]*S[0]+C[1]*S[1])/(Y(C)*Y(S))},E=function(h,H){return(h[0]*H[1]<h[1]*H[0]?-1:1)*Math.acos(C(h,H))},L=E([1,0],[(X.x-v.x)/Q,(X.y-v.y)/r]),I=[(X.x-v.x)/Q,(X.y-v.y)/r],i=[(-X.x-v.x)/Q,(-X.y-v.y)/r],H=E(I,i);C(I,i)<=-1&&(H=Math.PI),C(I,i)>=1&&(H=0);var C=Q>r?Q:r,B=Q>r?1:Q/r,d=Q>r?r/Q:1;if(null==y){var x={x:0,y:0,width:0,height:0};Qd(x,C),x.x*=B,x.width*=B,x.y*=d,x.height*=d;var S=new ph(J);return x=Db([S.tf(x.x,x.y),S.tf(x.x+x.width,x.y),S.tf(x.x+x.width,x.y+x.height),S.tf(x.x,x.y+x.height)]),x.x+=D.x,x.y+=D.y,[{x:x.x,y:x.y},{x:x.x+x.width,y:x.y},{x:x.x+x.width,y:x.y+x.height},{x:x.x,y:x.y+x.height}]}y.translate(D.x,D.y),y.rotate(J),y.scale(B,d),y.arc(0,0,C,L,L+H,1-V),y.scale(1/B,1/d),y.rotate(-J),y.translate(-D.x,-D.y)},gc=function(E,Y){E&&E.beginPath();for(var c,v,w,i=[],j=function(h){for(var l,Y=/(\-{0,1}[\d\.]+)/gi,X=[];l=Y.exec(h);)X.push(parseFloat(l[0]));return X},y=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,F={x:0,y:0};c=y.exec(Y);){var K=c[0],I=K.substr(0,1);if("M"===I||"m"===I){for(var k=j(K),s=0;s<k.length;s+=2){var t=k[s],f=k[s+1];"m"===I&&(t+=F.x,f+=F.y),E&&E.moveTo(t,f),i.push({x:t,y:f}),F.x=t,F.y=f}v=w=null}else if("H"===I||"h"===I){for(var k=j(K),s=0;s<k.length;s+=1){var t=k[s];"h"===I&&(t+=F.x),E&&E.lineTo(t,F.y),i.push({x:t,y:F.y}),F.x=t}v=w=null}else if("C"===I||"c"===I){for(var k=j(K),s=0;s<k.length;s+=6){var b=k[s],J=k[s+1],D=k[s+2],o=k[s+3],t=k[s+4],f=k[s+5];"c"===I&&(b+=F.x,J+=F.y,D+=F.x,o+=F.y,t+=F.x,f+=F.y),E&&E.bezierCurveTo(b,J,D,o,t,f),i.push({x:b,y:J}),i.push({x:D,y:o}),i.push({x:t,y:f}),F.x=t,F.y=f}v=[b,J,D,o,t,f],w=null}else if("S"===I||"s"===I){for(var k=j(K),s=0;s<k.length;s+=4){var b,J;v?(b=2*v[4]-v[2],J=2*v[5]-v[3]):(b=F.x,J=F.y);var D=k[s],o=k[s+1],t=k[s+2],f=k[s+3];"s"===I&&(D+=F.x,o+=F.y,t+=F.x,f+=F.y),E&&E.bezierCurveTo(b,J,D,o,t,f),i.push({x:b,y:J}),i.push({x:D,y:o}),i.push({x:t,y:f}),F.x=t,F.y=f}v=[b,J,D,o,t,f],w=null}else if("Q"===I||"q"===I){for(var k=j(K),s=0;s<k.length;s+=4){var b=k[s],J=k[s+1],t=k[s+2],f=k[s+3];"q"===I&&(b+=F.x,J+=F.y,t+=F.x,f+=F.y),E&&E.quadraticCurveTo(b,J,t,f),i.push({x:b,y:J}),i.push({x:t,y:f}),F.x=t,F.y=f}v=null,w=[b,J,t,f]}else if("T"===I||"t"===I){for(var k=j(K),s=0;s<k.length;s+=2){var b,J;w?(b=2*w[2]-w[0],J=2*w[3]-w[1]):(b=F.x,J=F.y);var t=k[s],f=k[s+1];"t"===I&&(t+=F.x,f+=F.y),E&&E.quadraticCurveTo(b,J,t,f),i.push({x:b,y:J}),i.push({x:t,y:f}),F.x=t,F.y=f}v=null,w=[b,J,t,f]}else if("V"===I||"v"===I){for(var k=j(K),s=0;s<k.length;s+=1){var f=k[s];"v"===I&&(f+=F.y),E&&E.lineTo(F.x,f),i.push({x:F.x,y:f}),F.y=f}v=w=null}else if("L"===I||"l"===I){for(var k=j(K),s=0;s<k.length;s+=2){var t=k[s],f=k[s+1];"l"===I&&(t+=F.x,f+=F.y),E&&E.lineTo(t,f),i.push({x:t,y:f}),F.x=t,F.y=f}v=w=null}else if("A"===I||"a"===I){for(var k=j(K),s=0;s<k.length;s+=7){var N=k[s],R=k[s+1],d=k[s+2],C=k[s+3],l=k[s+4],t=k[s+5],f=k[s+6];"a"===I&&(t+=F.x,f+=F.y);var G=yi(F,N,R,d,C,l,{x:t,y:f},E);G&&(i=i.concat(G)),F.x=t,F.y=f}v=w=null}var x=K.substr(K.length-1);("z"===x||"Z"===x)&&E&&E.closePath()}return i},Lf=function(j,s,X,i,D){var W,e=s[0];if(j.save(),br(s))if(e&&1===e.length){var p,v="L"===s[0],M=s.length;v?(j.transform(s[5],s[6],s[7],s[8],s[9],s[10]),W=j.createLinearGradient(s[1],s[2],s[3],s[4]),p=11):(j.transform(s[7],s[8],s[9],s[10],s[11],s[12]),W=j.createRadialGradient(s[1],s[2],s[3],s[4],s[5],s[6]),p=13);for(var c=j.compGray;M>p;){var J=s[p+1];J=X(J),W.addColorStop(s[p],c?L.toGrayColor(J):J),p+=2}}else{var p,v="linear"===e,f=D.x,G=D.y,t=D.width,O=D.height,M=s.length,c=j.compGray;if(v)W=j.createLinearGradient(f+t*s[1],G+O*s[2],f+t*s[3],G+O*s[4]),p=5;else{var u=Math.min(t,O),I=s[1]*t+f,$=s[2]*O+G,U=s[3]*u;if(Vn(s[5]))W=j.createRadialGradient(I,$,0,I,$,U),p=4;else{j.transform(s[7],s[8],s[9],s[10],s[11]+I,s[12]+$);var S=s[4]*t+f-I,d=s[5]*O+G-$,o=s[6]*u;W=j.createRadialGradient(0,0,U,S,d,o),p=13}}for(;M>p;){var J=s[p+1];J=X(J),W.addColorStop(s[p],c?L.toGrayColor(J):J),p+=2}}else W=s;return i?j.strokeStyle=W:j.fillStyle=W,W},Rj=function(){function w(a,F){var C=a.length,$=a[0];if(Vn(a)||$&&1!==$.length)return a;for(var P=new Array(C),X=0;C>X;X++)P[X]=a[X];var i,R,L,g,U,y,o,W,t,D,n,B,Y,E="L"===P[0];return i=E?5:7,R=P[i],L=P[i+1],g=P[i+2],U=P[i+3],y=P[i+4],o=P[i+5],W=F[0],t=F[1],D=F[2],n=F[3],B=F[4],Y=F[5],P[i]=W*R+D*L,P[i+1]=t*R+n*L,P[i+2]=W*g+D*U,P[i+3]=t*g+n*U,P[i+4]=W*y+D*o+B,P[i+5]=t*y+n*o+Y,P}return function(t,P){var I;(I=t.s("shape.gradient.pack"))&&t.s("shape.gradient.pack",w(I,P)),(I=t.s("shape.border.gradient.pack"))&&t.s("shape.border.gradient.pack",w(I,P))}}(),Ko=function(w,W,c,e){var S=!1;if(w.beginPath?w.beginPath():S=!0,Zc(W)&&(W=W._as),Zc(c)&&(c=c._as),c&&c.length){for(var k,f,K,v,p=0,i=0,u=c.length;u>i;i++)k=c[i],1===k?(f=W[p++],w.moveTo(f.x,S?-f.y:f.y)):2===k?(f=W[p++],w.lineTo(f.x,S?-f.y:f.y)):3===k?(f=W[p++],K=W[p++],w.quadraticCurveTo(f.x,S?-f.y:f.y,K.x,S?-K.y:K.y)):4===k?(f=W[p++],K=W[p++],v=W[p++],w.bezierCurveTo(f.x,S?-f.y:f.y,K.x,S?-K.y:K.y,v.x,S?-v.y:v.y)):5===k&&w.closePath();e&&5!==k&&w.closePath()}else{var U,Y,M,r=W.length;if(r>0){for(U=W[0],w.moveTo(U.x,S?-U.y:U.y),Y=1;r>Y;Y++)M=W[Y],w.lineTo(M.x,S?-M.y:M.y);e&&w.closePath()}}},Hc=function(c,M,w,p){if(Zc(c)&&(c=c._as),Zc(M)&&(M=M._as),M&&M.length){w=w||wo;for(var o,U,I,A,X,C,H,x,i=[],g=f,R=0,P=0,K=M.length;K>P;P++)if(o=M[P],1===o)i.push(g=[]),g.push(c[R++]);else if(2===o)g.push(c[R++]);else if(3===o){for(U=g[g.length-1],I=c[R++],A=c[R++],C=1;w>C;C++)H=Kk(C/w,U.x,I.x,A.x),x=Kk(C/w,U.y,I.y,A.y),g.push({x:H,y:x,b:!0});
g.push(A)}else if(4===o){for(U=g[g.length-1],I=c[R++],A=c[R++],X=c[R++],C=1;w>C;C++)H=cp(C/w,U.x,I.x,A.x,X.x),x=cp(C/w,U.y,I.y,A.y,X.y),g.push({x:H,y:x,b:!0});g.push(X)}else 5===o&&g.push(g[0]);return p&&5!==o&&g&&g.length>2&&g.push(g[0]),i}return p&&c.length>2&&(c=c.slice(),c.push(c[0])),c?[c]:[]},El=function(R,S,k,K,z,s){var y,J,p,g=si(S),D=K,Y=g[0],d=g[1],i=g[2];if(k){var N=si(k);y=N[0]-Y,J=N[1]-d,p=N[2]-i}else y=255-Y,J=255-d,p=255-i;for(s||(s=K>10?1:.5,s=1>z?h(s/z,2):s),R.save(),R.shadowOffsetX=0,R.shadowOffsetY=0,R.shadowBlur=0,R.shadowColor=0;(K-=s)>0;){var L=1-K/D,r=Y+y*L,t=d+J*L,n=i+p*L;r=h(q(r),255),t=h(q(t),255),n=h(q(n),255),R.strokeStyle="rgb("+r+","+t+","+n+")",R.lineWidth=K,R.stroke()}R.restore()},Si=function(){if(vj&&A){var N=A+""||Gk;ol=N.indexOf(jc.substr(0,2))>0&&N.indexOf(Fc+Fc.substr(1,1))>1?!0:!1}var J={};return function(Y,a){var g=Y+"-"+a,x=J[g];if(x)return x;var V,S,i,N=si(Y);return 0>a?(a=(100+a)/100,V=q(N[0]*a),S=q(N[1]*a),i=q(N[2]*a)):(a/=100,V=N[0],S=N[1],i=N[2],V+=(255-V)*a,S+=(255-S)*a,i+=(255-i)*a,V=h(q(V),255),S=h(q(S),255),i=h(q(i),255)),J[g]="rgb("+V+","+S+","+i+")"}}(),Nj=function(B,$,z,b,N,E){E&&(B.fillStyle=E),B.beginPath(),B.rect($,z,b,N),B.fill()},Dg=function(i,T,I,Y,p,k,g){i.beginPath(),Je[T](i,I.x,I.y,I.width,I.height,Y,p,k,g)},Le=function(V,x,$,a,D){var t=Je[$];V.fillStyle=t?t(V,x,a?a:Id,D.x,D.y,D.width,D.height):x},mn=function(U,n,p,R,Y,f){U.fillStyle=Tm(U,n,p,R,Y,f)},Ck=function(o,h,G,p,V,c){o.strokeStyle=Tm(o,h,G,p,V,c)},Tm=function(l,V,N,f,M,C){var Y;try{if(!V.tagName&&V.comps){V._cacheImage_||(V._cacheImage_={});var U;U="override"===f?"colors_override":"override_rgb"===f?"colors_override_rgb":"override_a"===f?"colors_override_a":"colors",V._cacheImage_[U]||(V._cacheImage_[U]={__count__:0});var v=V._cacheImage_[U][N];v||(V._cacheImage_[U].__count__>L.imageCacheThreshold&&(V._cacheImage_[U]={__count__:0}),v=H.Default.toCanvas(V,Bb(V),qh(V),null,M,C,N,null,f),V._cacheImage_[U][N]=v,V._cacheImage_[U].__count__++),V=v}Y=l.createPattern(V,"repeat")}catch(c){Y="black"}return Y},Yn=function(N){var A,r,q=[],W=0,w=N.length;for(A=0;65>A;A++)q[A]=A;for(A=0;65>A;A++)W=(W+q[A]+N.charCodeAt(A%w))%65,r=q[A],q[A]=q[W],q[W]=r;for(A=0;65>A;A++)q[A]=aq[q[A]];return q.join("")},oo=function(F){for(var p=8+xc.randomInt(8),o=aq[8*xc.randomInt(8)+(p-8)],x="",S=0;p>S;S++)x+=aq[xc.randomInt(64)];var J=Yn(x+K+wc+yq);return o+x+te.encode(F,J)},wr=function(q){var f=q[0],p=aq.indexOf(f);if(0>p)return"";p=8+(7&p);var s=q.slice(1,1+p),t=Yn(s+K+wc+yq);return te.decode(q,t,1+p)},Vp=function(J,o,f,H,S,M,t){J.save(),J.translate(o,f),J.scale(1,t/M),J.arc(0,0,M,H,S),J.restore()},gm=function(t,w,I,V,o,M,x,L){var z,U,s,_,u,C,r,E,R,c,m;if(a(o)>2*O&&(o=2*O),u=q(a(o)/(O/4)),z=o/u,U=-z,s=-V,u>0){C=w+J(V)*M,r=I+B(-V)*x,L?t.lineTo(C,r):t.moveTo(C,r);for(var d=0;u>d;d++)s+=U,_=s-U/2,E=w+J(s)*M,R=I+B(s)*x,c=w+J(_)*(M/J(U/2)),m=I+B(_)*(x/J(U/2)),t.quadraticCurveTo(c,m,E,R)}},Jf=function(v,J,U,i,m,I,D,t,Z){6===arguments.length&&(br(I)?(t=I[1],Z=I[2],D=I[3],I=I[0]):(D=I,t=I,Z=I));var a=J+i,H=U+m,h=m>i?2*i:2*m;I=h>I?I:h,D=h>D?D:h,t=h>t?t:h,Z=h>Z?Z:h,v.moveTo(J+i/2,U),v.arcTo(a,U,a,H,D),v.arcTo(a,H,J,H,Z),v.arcTo(J,H,J,U,t),v.arcTo(J,U,a,U,I),v.lineTo(J+i/2,U)},Df=function(A,m,D,x,z,B,b){m&&(D=P(D),x=P(x),b||(b=1),A.fillStyle=m,A.beginPath(),A.rect(D,x,b,B),A.rect(D,x,z,b),B-b>0&&A.rect(D,x+B-b,z,b),z-b>0&&A.rect(D+z-b,x,b,B),A.fill())},Sp=function(X,Y,V,v){var k=v.x,f=v.y,q=v.width,t=v.height;if(!(!Y||!V||0>=q||0>=t)){var I,T=Zk(Y),u=Pd(Y),P=V>0;1===V||-1===V?(X.fillStyle=P?T:u,X.beginPath(),X.rect(k,f,1,t),X.rect(k,f,q,1),X.fill(),X.fillStyle=P?u:T,X.beginPath(),X.rect(k,f+t-1,q,1),X.rect(k+q-1,f,1,t),X.fill()):(V=h(a(V),h(q/2,t/2)),I=X.createLinearGradient(k,f,k+V,f),I.addColorStop(0,P?T:u),I.addColorStop(1,Y),X.fillStyle=I,X.beginPath(),X.moveTo(k,f),X.lineTo(k+V,f+V),X.lineTo(k+V,f+t-V),X.lineTo(k,f+t),X.lineTo(k,f),X.fill(),I=X.createLinearGradient(k,f,k,f+V),I.addColorStop(0,P?T:u),I.addColorStop(1,Y),X.fillStyle=I,X.beginPath(),X.moveTo(k,f),X.lineTo(k+V,f+V),X.lineTo(k+q-V,f+V),X.lineTo(k+q,f),X.lineTo(k,f),X.fill(),I=X.createLinearGradient(k,f+t,k,f+t-V),I.addColorStop(0,P?u:T),I.addColorStop(1,Y),X.fillStyle=I,X.beginPath(),X.moveTo(k,f+t),X.lineTo(k+V,f+t-V),X.lineTo(k+q-V,f+t-V),X.lineTo(k+q,f+t),X.lineTo(k,f+t),X.fill(),I=X.createLinearGradient(k+q,f,k+q-V,f),I.addColorStop(0,P?u:T),I.addColorStop(1,Y),X.fillStyle=I,X.beginPath(),X.moveTo(k+q,f),X.lineTo(k+q-V,f+V),X.lineTo(k+q-V,f+t-V),X.lineTo(k+q,f+t),X.lineTo(k+q,f),X.fill())}},nr=function(C,N,i,X,o,l,p){var x=C.createLinearGradient(X,o,l,p);return x.addColorStop(0,i),x.addColorStop(1,N),x},nf=function(q,A,H,G,e,X,a){var g=q.createLinearGradient(G,e,X,a);return g.addColorStop(0,A),g.addColorStop(.5,H),g.addColorStop(1,A),g},iq=function(N,v,G,o,F,J,r){var c=N.createLinearGradient(o,F,J,r);return c.addColorStop(0,v),c.addColorStop(1/3,G),c.addColorStop(2/3,v),c.addColorStop(1,G),c},ms=function(L,V,X,j,T,x,z,F,q){var m=L.createRadialGradient(j+x*F,T+z*q,h(x,z)/24,j+x/2,T+z/2,p(x,z)/2);return m.addColorStop(0,X),m.addColorStop(1,V),m},Gr=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Je={polygon:function(D,z,Z,Y,c,M,g,x){(M==f||3>M)&&(M=6),g==f&&(g=0),x==f&&(x=!0);var r,R=h(Y,c),i=R/2,T=new pb(z+Y/2,Z+c/2),w=new pb,l=0,A=2*O/M,k=new pb(i,i);if(x===!1&&k.multiply({x:Y/R,y:c/R}),0===g)for(r=0;M>r;r++)w.set(J(l),B(l)).multiply(k).add(T),0===r?D.moveTo(w.x,w.y):D.lineTo(w.x,w.y),l+=A;else{var s=[];for(r=0;2>r;r++)s.push(new pb(J(l),B(l)).multiply(k).add(T)),l+=A;var X=s.shift(),L=s[0],t=new pb(J(l),B(l)).multiply(k).add(T),C=X.clone().sub(L),N=t.clone().sub(L),V=C.clone().normalize().dot(N.clone().normalize()),K=Math.sqrt((1-V)/(1+V)),G=g/K;for(C.setLength(G).add(L),D.moveTo(C.x,C.y),r=0;M>r;r++)s.push(new pb(J(l),B(l)).multiply(k).add(T)),l+=A,X=s.shift(),L=s[0],D.arcTo(X.x,X.y,L.x,L.y,g)}D.closePath()},arc:function(c,z,v,T,D,w,X,V,a){w==f&&(w=O),X==f&&(X=_),V==f&&(V=!0);var H=z+T/2,A=v+D/2;V&&c.moveTo(H,A),a?Vp(c,H,A,w,X,T/2,D/2):c.arc(H,A,h(T,D)/2,w,X),V&&c.closePath()},rect:function(h,$,O,j,z){h.rect($,O,j,z)},circle:function(T,F,X,Y,z){T.arc(F+Y/2,X+z/2,h(Y,z)/2,0,_,!0)},oval:function(o,K,U,R,d){Vp(o,K+R/2,U+d/2,0,_,R/2,d/2)},roundRect:function(N,C,L,Y,b,S){S==f&&(S=h(h(Y,b)/4,8)),Jf(N,C,L,Y,b,S),N.closePath()},star:function(I,s,z,$,_){var d=2*$,m=2*_,D=s+$/2,H=z+_/2;I.moveTo(D-d/4,H-m/12),I.lineTo(s+.306*$,z+.579*_),I.lineTo(D-d/6,H+m/4),I.lineTo(s+$/2,z+.733*_),I.lineTo(D+d/6,H+m/4),I.lineTo(s+.693*$,z+.579*_),I.lineTo(D+d/4,H-m/12),I.lineTo(s+.611*$,z+.332*_),I.lineTo(D+0,H-m/4),I.lineTo(s+.388*$,z+.332*_),I.closePath()},pentagram:function(N,r,C,Q,B){var T=.5*B,A=r+.5*Q,H=C+T,l=.5257311121191336*Q;l>T&&(l=T);var z=Gr,s=0;for(N.moveTo(A+l*z[s++],H+l*z[s++]);20>s;)N.lineTo(A+l*z[s++],H+l*z[s++]);N.closePath()},triangle:function(g,y,h,m,C){g.moveTo(y+m/2,h),g.lineTo(y+m,h+C),g.lineTo(y,h+C),g.closePath()},hexagon:function(e,I,F,N,R){e.moveTo(I,F+R/2),e.lineTo(I+N/4,F+R),e.lineTo(I+3*N/4,+F+R),e.lineTo(I+N,F+R/2),e.lineTo(I+3*N/4,F),e.lineTo(I+N/4,F),e.closePath()},pentagon:function(O,I,w,x,N){var d=2*x,p=2*N,X=I+x/2,u=w+N/2;O.moveTo(X-d/4,u-p/12),O.lineTo(X-d/6,u+p/4),O.lineTo(X+d/6,u+p/4),O.lineTo(X+d/4,u-p/12),O.lineTo(X+0,u-p/4),O.closePath()},diamond:function(E,w,v,l,z){E.moveTo(w+l/2,v),E.lineTo(w,v+z/2),E.lineTo(w+l/2,v+z),E.lineTo(w+l,v+z/2),E.closePath()},rightTriangle:function(P,x,b,r,e){P.moveTo(x,b),P.lineTo(x+r,b+e),P.lineTo(x,b+e),P.closePath()},parallelogram:function(G,k,z,s,y){var J=s/4;G.moveTo(k+J,z),G.lineTo(k+s,z),G.lineTo(k+s-J,z+y),G.lineTo(k,z+y),G.closePath()},trapezoid:function(G,B,q,X,P){var O=X/4;G.moveTo(B+O,q),G.lineTo(B+X-O,q),G.lineTo(B+X,q+P),G.lineTo(B,q+P),G.closePath()},"linear.southwest":function(X,j,o,i,t,c,z){return nr(X,j,o,i,t+z,i+c,t)},"linear.southeast":function(r,u,x,Q,v,c,n){return nr(r,u,x,Q+c,v+n,Q,v)},"linear.northwest":function(d,$,t,e,Q,F,J){return nr(d,$,t,e,Q,e+F,Q+J)},"linear.northeast":function(U,g,Q,H,y,O,z){return nr(U,g,Q,H+O,y,H,y+z)},"linear.north":function(i,u,j,W,n,K,F){return nr(i,u,j,W,n,W,n+F)},"linear.south":function(N,y,A,$,H,n,m){return nr(N,y,A,$,H+m,$,H)},"linear.west":function(j,I,O,d,y,J){return nr(j,I,O,d,y,d+J,y)},"linear.east":function(Q,K,w,J,$,q){return nr(Q,K,w,J+q,$,J,$)},"radial.center":function(N,h,d,F,e,W,V){return ms(N,h,d,F,e,W,V,.5,.5)},"radial.southwest":function(Q,T,D,c,v,u,b){return ms(Q,T,D,c,v,u,b,.25,.75)},"radial.southeast":function(Q,r,L,p,k,h,F){return ms(Q,r,L,p,k,h,F,.75,.75)},"radial.northwest":function(P,t,M,l,g,m,u){return ms(P,t,M,l,g,m,u,.25,.25)},"radial.northeast":function(N,B,K,q,J,c,n){return ms(N,B,K,q,J,c,n,.75,.25)},"radial.north":function(H,c,e,l,i,h,x){return ms(H,c,e,l,i,h,x,.5,.25)},"radial.south":function(c,V,x,A,C,M,I){return ms(c,V,x,A,C,M,I,.5,.75)},"radial.west":function(q,Q,J,_,r,w,k){return ms(q,Q,J,_,r,w,k,.25,.5)},"radial.east":function(K,t,z,n,W,b,Z){return ms(K,t,z,n,W,b,Z,.75,.5)},"spread.horizontal":function(P,V,u,I,W,o){return nf(P,V,u,I,W,I+o,W)},"spread.vertical":function(y,t,l,j,$,F,w){return nf(y,t,l,j,$,j,$+w)},"spread.diagonal":function(R,U,w,p,$,i,l){return nf(R,U,w,p+i,$,p,$+l)},"spread.antidiagonal":function(f,F,q,D,K,v,T){return nf(f,F,q,D,K,D+v,K+T)},"spread.north":function(S,W,b,I,R,o,A){return iq(S,W,b,I,R-A/4,I,R+A+A/4)},"spread.south":function(W,u,O,p,t,D,b){return iq(W,O,u,p,t-b/4,p,t+b+b/4)},"spread.west":function(i,t,o,J,S,I){return iq(i,t,o,J-I/4,S,J+I+I/4,S)},"spread.east":function(I,r,C,y,Y,T){return iq(I,C,r,y-T/4,Y,y+T+T/4,Y)}},Cf=function(x,r,W){return new ph(x).tf(r,W)},Zb=function(L){var P=L.touches[0],b=L.touches[1],m=P.clientX,Q=P.clientY,N=b.clientX,z=b.clientY;return G((m-N)*(m-N)+(Q-z)*(Q-z))},fq=function(S){var Z=S.touches[0],I=S.touches[1],g=Z.clientX,K=Z.clientY,r=I.clientX,A=I.clientY;return{x:(g+r)/2,y:(K+A)/2}},Yi=(function(){for(var a=0,z=Yc.split(""),O=0;O<z.length;O++)a=10*cm(z[O])+a;return sr(u[go.toString(8*O)+oc.substr(O)+3],u[go.toString(8*O)+oc.substr(O)+4]),a}(),function(Q,L,F){for(var q=0;q<F.size();q++){var C=F.get(q);Q.co(C)&&L.add(C)}for(q=0;q<F.size();q++)C=F.get(q),Yi(Q,L,C._children)}),fj=function(S,e,Z){for(var g=0;g<Z.size();g++){var i=Z.get(Z.size()-1-g);S.co(i)&&e.add(i)}for(g=0;g<Z.size();g++)i=Z.get(g),fj(S,e,i._children)},$k=function(A,K,X){for(var e=!1,G=0;G<X.size();G++){var i=X.get(G);A.co(i)?e&&K.add(i):e=1}for(G=0;G<X.size();G++)i=X.get(G),$k(A,K,i._children)},ie=function(d,x,V){for(var a=!1,h=0;h<V.size();h++){var t=V.get(V.size()-1-h);d.co(t)?a&&x.add(t):a=!0}for(h=0;h<V.size();h++)t=V.get(h),ie(d,x,t._children)},Lp=L.moveDatas=function(d,X,T,o){var y=o==f;if(0!==X||0!==T||!y&&0!==o){var Q=!0,R=[];if(d.forEach(function(B){Q&&(B._69O||Zd(B)||bd(B))&&(Q=!1)}),Q)R=d;else{var q={},V={};d.forEach(function(L){q[L._id]=!0});var p={},D=function(C){var $=C._id;return q[$]?(R.push(C),p[$]=!0):p[$]=!1},h=function(P){var W=P._id;if(V[W])return D(P);var $=p[W];if($!==E)return $;var m=P._parent;if(m&&(bd(m)||Zd(m))&&h(m))return p[W]=!0;var M=P._host;return M&&(V[W]=W,$=h(M),V[W]=E,$)?p[W]=!0:D(P)};d.forEach(function(T){h(T)})}R.forEach(function(s){if(mq(s))y?s.translate(X,T):s.translate3d(X,T,o);else{var r=s.s(Ji);if(!r||r.isEmpty())return;var A=new zp;r.each(function(u){u=ys(u),y?(u.x+=X,u.y+=T):(u.x+=X,u.y+=o,u.e==f?u.e=T:u.e+=T),A.add(u)}),s.s(Ji,A)}})}},Pm=function(){function Q(L,n){return n===L.substring(0,n.length)?!0:!1}function f(E){return parseFloat(E)||0}function U(m,u){if(u==E&&(u=new jf),Q(m,"matrix3d")){var T=m.substring(9,m.length-1).split(",");T=T.map(f),u.fromArray(T)}else if(Q(m,"matrix")){var T=m.substring(7,m.length-1).split(",");T=T.map(f),u.el[0]=T[0],u.el[1]=T[1],u.el[2]=0,u.el[3]=0,u.el[4]=T[2],u.el[5]=T[3],u.el[6]=0,u.el[7]=0,u.el[8]=0,u.el[9]=0,u.el[10]=1,u.el[11]=0,u.el[12]=T[4],u.el[13]=T[5],u.el[14]=0,u.el[15]=1}return u}function N(z,l){l==E&&(l=new np);var K=z.split(/\s+/);return K=K.map(f),l.set(K[0]||0,K[1]||0,K[2]||0),l}var k,b,n,x,_,J=function(w,v){k||(k=new jf,b=new np,n=new jf,x=new jf,_=new jf),v==E&&(v=new jf);var h=getComputedStyle(w);h.transform&&"none"!==h.transform&&(U(h.transform,k),N(h.transformOrigin,b),x.setPosition(b),b.negate(),_.setPosition(b),(xf||"preserve-3d"!==h.transformStyle)&&(k.el[8]=0,k.el[9]=0,k.el[10]=1,k.el[11]=0),v.multiplyMatrices(_,v),v.multiplyMatrices(k,v),v.multiplyMatrices(x,v)),!xf&&h.perspective&&"none"!==h.perspective&&(n.el[11]=-1/f(h.perspective),N(h.perspectiveOrigin,b),x.setPosition(b),b.negate(),_.setPosition(b),v.multiplyMatrices(_,v),v.multiplyMatrices(n,v),v.multiplyMatrices(x,v));for(var Z=w.offsetParent,p=w.offsetLeft,R=w.offsetTop,c=w.parentElement;c&&c!==Z;){var P=getComputedStyle(c);if("none"!==P.transform||"none"!==P.perspective)break;c=c.parentElement}return c==E&&w!==w.ownerDocument.documentElement&&"fixed"!==h.position&&(c=w.ownerDocument.documentElement),Z!=E&&Z!==c&&(p-=c.offsetLeft,R-=c.offsetTop),b.set(p,R,0),x.setPosition(b),v.multiplyMatrices(x,v),c&&J(c,v),v};return function(o,N){var _=o.parentElement;if(_){var C=_.updateAppendMatrix;if(C){delete _.updateAppendMatrix;var M=new jf;J(_,M);var S=new jf;S.getInverse(M),_._matrixAppend=S,_._maxrixPreAppend=M}return N?_._matrixAppend:_._maxrixPreAppend}}}(),mj=function(j,S){for(;j&&!j.hasOwnProperty(S);)j=b.getPrototypeOf(j);return j&&b.getOwnPropertyDescriptor(j,S)},dm=b.getPrototypeOf?function(K,T,C){var y=mj(T,C);y&&b.defineProperty(K,C,y)}:function(W,B,l){W[l]=B[l]},sh={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Nb=function(){var c={1:function(A,F){return{x:A.x-F.width/2,y:A.y-F.height/2}},2:function(Y,I){return{x:Y.x+I.width/2,y:Y.y-I.height/2}},3:function(l,Z){return{x:l.x+l.width/2,y:l.y-Z.height/2}},4:function(Z,t){return{x:Z.x+Z.width-t.width/2,y:Z.y-t.height/2}},5:function(P,G){return{x:P.x+P.width+G.width/2,y:P.y-G.height/2}},6:function(C){return{x:C.x,y:C.y}},7:function($){return{x:$.x+$.width/2,y:$.y}},8:function(W){return{x:W.x+W.width,y:W.y}},9:function(d,A){return{x:d.x-A.width/2,y:d.y+A.height/2}},10:function(W,m){return{x:W.x+m.width/2,y:W.y+m.height/2}},11:function(g,p){return{x:g.x+g.width/2,y:g.y+p.height/2}},12:function(y,g){return{x:y.x-g.width/2+y.width,y:y.y+g.height/2}},13:function(H,t){return{x:H.x+H.width+t.width/2,y:H.y+t.height/2}},14:function(R,H){return{x:R.x-H.width/2,y:R.y+R.height/2}},15:function(R){return{x:R.x,y:R.y+R.height/2}},16:function(y,R){return{x:y.x+R.width/2,y:y.y+y.height/2}},17:function(Q){return{x:Q.x+Q.width/2,y:Q.y+Q.height/2}},18:function(m,w){return{x:m.x+m.width-w.width/2,y:m.y+m.height/2}},19:function(l){return{x:l.x+l.width,y:l.y+l.height/2}},20:function(Q,I){return{x:Q.x+Q.width+I.width/2,y:Q.y+Q.height/2}},21:function(W,X){return{x:W.x-X.width/2,y:W.y+W.height-X.height/2}},22:function(D,Z){return{x:D.x+Z.width/2,y:D.y+D.height-Z.height/2}},23:function(v,n){return{x:v.x+v.width/2,y:v.y+v.height-n.height/2}},24:function(u,K){return{x:u.x+u.width-K.width/2,y:u.y+u.height-K.height/2}},25:function(n,K){return{x:n.x+n.width+K.width/2,y:n.y+n.height-K.height/2}},26:function(E){return{x:E.x,y:E.y+E.height}},27:function(M){return{x:M.x+M.width/2,y:M.y+M.height}},28:function(E){return{x:E.x+E.width,y:E.y+E.height}},29:function(D,F){return{x:D.x-F.width/2,y:D.y+D.height+F.height/2}},30:function(X,e){return{x:X.x+e.width/2,y:X.y+X.height+e.height/2}},31:function($,E){return{x:$.x+$.width/2,y:$.y+$.height+E.height/2}},32:function(V,G){return{x:V.x+V.width-G.width/2,y:V.y+V.height+G.height/2}},33:function(W,n){return{x:W.x+W.width+n.width/2,y:W.y+W.height+n.height/2}},34:function(_,t){return{x:_.x,y:_.y-t.height/2}},35:function(q,L){return{x:q.x+q.width,y:q.y-L.height/2}},36:function(J,x){return{x:J.x,y:J.y+J.height+x.height/2}},37:function(V,K){return{x:V.x+V.width,y:V.y+V.height+K.height/2}},38:function(b,w){return{x:b.x+b.width/4,y:b.y-w.height/2}},39:function(y,H){return{x:y.x+3*y.width/4,y:y.y-H.height/2}},40:function(g){return{x:g.x+g.width/4,y:g.y}},41:function(x){return{x:x.x+3*x.width/4,y:x.y}},42:function(B,e){return{x:B.x+B.width/4,y:B.y+e.height/2}},43:function(E,l){return{x:E.x+3*E.width/4,y:E.y+l.height/2}},44:function(D,C){return{x:D.x+D.width/2,y:D.y+D.height/2-C.height/2}},45:function($){return{x:$.x+$.width/4,y:$.y+$.height/2}},46:function(P,I){return{x:P.x+P.width/2-I.width/2,y:P.y+P.height/2}},47:function(g,H){return{x:g.x+g.width/2+H.width/2,y:g.y+g.height/2}},48:function(k){return{x:k.x+3*k.width/4,y:k.y+k.height/2}},49:function(R,g){return{x:R.x+R.width/2,y:R.y+R.height/2+g.height/2}},50:function(e,a){return{x:e.x+e.width/4,y:e.y+e.height-a.height/2}},51:function(H,h){return{x:H.x+3*H.width/4,y:H.y+H.height-h.height/2}},52:function(_){return{x:_.x+_.width/4,y:_.y+_.height}},53:function(G){return{x:G.x+3*G.width/4,y:G.y+G.height}},54:function(d,v){return{x:d.x+d.width/4,y:d.y+d.height+v.height/2}},55:function(v,r){return{x:v.x+3*v.width/4,y:v.y+v.height+r.height/2}}};return on(u)?function(w,A,e){return c[w](A,e?e:hq)}:void 0}();Hi(D,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Mh=D.reverse,Jh=D.transparent,Gl=D.rectSelectBackground,pp=D.dash,md=D.titleBackground,hn=D.titleIconBackground,ff=D.headerBackground,kg=D.headerIconBackground,fd=D.headerSeparator,Pn=D.headerLine,De=D.contentIconBackground,Zr=D.contentLine,kj=(D.widgetIconHighlight,D.widgetIconBorder),Dk=(D.widgetIconGradient,D.imageBackground),Id=D.imageGradient,to=D.highlight,ck=D.label,Ze=D.labelSelect;if(Qr&&!u.shutAlert1){var Ro=new Date,tb=Qr.split("-"),qs=new Date(Ro.getFullYear(),Ro.getMonth(),Ro.getDate()),Qr=new Date(cm(tb[0],10),cm(tb[1],10)-1,cm(tb[2],10)),Eb=qs.getTime(),Qj=Qr.getTime(),Fi=K+"_try",bl=u.alert;try{var td=u.localStorage;if(td&&bl)if(Qj>Eb&&1728e6>Qj-Eb){var Np=(Qj-Eb)/864e5;td&&td[Fi]!=Np&&(td[Fi]=Np,u.htWillExpire?bl(u.htWillExpire.replace("{{day}}",Np)):bl("HT for Web free trial license will expire in "+Np+" days, please apply for a new license!"))}else Eb>=Qj&&(u.htExpired?bl(u.htExpired):bl("Your free trial of HT for Web has expired!")),td&&delete td[Fi]}catch(vq){}}Math.sign===E&&(Math.sign=function(n){return 0>n?-1:n>0?1:+n});var aq="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",te={encode:function(d,h){var M,G,w,D,U,O,C,x="",v=0;for(d=unescape(encodeURIComponent(d));v<d.length;)M=d.charCodeAt(v++),G=d.charCodeAt(v++),w=d.charCodeAt(v++),D=M>>2,U=(3&M)<<4|G>>4,O=(15&G)<<2|w>>6,C=63&w,isNaN(G)?O=C=64:isNaN(w)&&(C=64),x=x+h.charAt(D)+h.charAt(U)+h.charAt(O)+h.charAt(C);return x},decode:function(o,q,p){for(var L,d,a,v,u,F,Z,n="",r=p||0;r<o.length;)v=q.indexOf(o.charAt(r++)),u=q.indexOf(o.charAt(r++)),F=q.indexOf(o.charAt(r++)),Z=q.indexOf(o.charAt(r++)),L=v<<2|u>>4,d=(15&u)<<4|F>>2,a=(3&F)<<6|Z,n+=String.fromCharCode(L),64!=F&&(n+=String.fromCharCode(d)),64!=Z&&(n+=String.fromCharCode(a));return n=decodeURIComponent(escape(n))},_utf8_encode:function(d){d=d.replace(/\r\n/g,"\n");for(var N="",U=0;U<d.length;U++){var s=d.charCodeAt(U);128>s?N+=String.fromCharCode(s):s>127&&2048>s?(N+=String.fromCharCode(192|s>>6),N+=String.fromCharCode(128|63&s)):(N+=String.fromCharCode(224|s>>12),N+=String.fromCharCode(128|63&s>>6),N+=String.fromCharCode(128|63&s))}return N},_utf8_decode:function(I){for(var W="",U=0,Z=0,j=0,i=0;U<I.length;)Z=I.charCodeAt(U),128>Z?(W+=String.fromCharCode(Z),U++):Z>191&&224>Z?(j=I.charCodeAt(U+1),W+=String.fromCharCode((31&Z)<<6|63&j),U+=2):(j=I.charCodeAt(U+1),i=I.charCodeAt(U+2),W+=String.fromCharCode((15&Z)<<12|(63&j)<<6|63&i),U+=3);return W}},tk=[],Fq=[],xc=H.Math={generateUUID:function(){for(var n=[],e=0;256>e;e++)n[e]=(16>e?"0":"")+e.toString(16).toUpperCase();return function(){var R=0|4294967295*Math.random(),f=0|4294967295*Math.random(),T=0|4294967295*Math.random(),N=0|4294967295*Math.random();return n[255&R]+n[255&R>>8]+n[255&R>>16]+n[255&R>>24]+"-"+n[255&f]+n[255&f>>8]+"-"+n[64|15&f>>16]+n[255&f>>24]+"-"+n[128|63&T]+n[255&T>>8]+"-"+n[255&T>>16]+n[255&T>>24]+n[255&N]+n[255&N>>8]+n[255&N>>16]+n[255&N>>24]}}(),clamp:function(n,r,z){return Math.max(r,Math.min(z,n))},fequal:function(s,K,D){return null==D&&(D=1e-8),Math.abs(s-K)<D},generateIncreasingID:function(){var y=0;return function(){return++y}}(),encodeBase64:function(j,N){return te.encode(j,N||aq)},decodeBase64:function(Z,y){return te.decode(Z,y||aq)},randomArray:function(U,h){h=h||U.length;for(var P=h-1;P>0;P--){var t=Math.floor(Math.random()*(P+1)),I=U[P];U[P]=U[t],U[t]=I}return U},randomInt:function(v,V){return V===E&&(V=v,v=0),v+Math.floor(Math.random()*(V-v))},randomFloat:function(V,O){return O===E&&(O=V,V=0),V+Math.random()*(O-V)},isPOT:function(_){return _>0&&0===(_-1&_)},nearestPOT:function(l){if(!l)return 1;var s=l;s--,s|=s>>1,s|=s>>2,s|=s>>4,s|=s>>8,s|=s>>16,s++;var B=s>>1;return l-B>s-l?s:B},requestMatrix4:function(){return tk.length>0?tk.pop():new xc.Matrix4},releaseMatrix4:function(g){tk.push(g)},requestVector3:function(){return Fq.length>0?Fq.pop():new xc.Vector3},releaseVector3:function(s){Fq.push(s)}},Uo=H.Matrix=H.Math.Matrix2d=function(n,O,U,V,Y){this.setFromTransform(n,O,U,V,Y)},ph=Uo;Uo.prototype={},Uo.prototype.constructor=Uo,Uo.prototype.set=function(n,Z,K,B,e,k){return this.a=n,this.b=Z,this.c=K,this.d=B,this.tx=e,this.ty=k,this},Uo.prototype.setFromTransform=function(O,D,C,S,z){var y=this;if(O===E)return y.a=1,y.b=0,y.c=0,y.d=1,y.tx=0,y.ty=0,void 0;var p,G;return O?(p=B(O),G=J(O)):(p=0,G=1),S=S||1,z=z||1,y.a=G*S,y.b=p*S,y.c=-p*z,y.d=G*z,y.tx=D||0,y.ty=C||0,y},Uo.prototype.apply=function(c,Z){Z=Z||new pb;var y=c.x,Y=c.y;return Z.x=this.a*y+this.c*Y+this.tx,Z.y=this.b*y+this.d*Y+this.ty,Z},Uo.prototype.applyInverse=function(f,l){l=l||new pb;var o=1/(this.a*this.d+this.c*-this.b),K=f.x,V=f.y;return l.x=this.d*o*K+-this.c*o*V+(this.ty*this.c-this.tx*this.d)*o,l.y=this.a*o*V+-this.b*o*K+(-this.ty*this.a+this.tx*this.b)*o,l},Uo.prototype.translate=function(U,C){return this.tx+=U,this.ty+=C,this},Uo.prototype.scale=function(M,U){return this.a*=M,this.d*=U,this.c*=M,this.b*=U,this.tx*=M,this.ty*=U,this},Uo.prototype.rotate=function(T){var M=Math.cos(T),n=Math.sin(T),Z=this.a,u=this.c,q=this.tx;return this.a=Z*M-this.b*n,this.b=Z*n+this.b*M,this.c=u*M-this.d*n,this.d=u*n+this.d*M,this.tx=q*M-this.ty*n,this.ty=q*n+this.ty*M,this},Uo.prototype.appendTranslate=function(y,o){return this.tx+=this.a*y+this.c*o,this.ty+=this.b*y+this.d*o,this},Uo.prototype.appendScale=function(O,A){return this.a*=O,this.d*=A,this.c*=A,this.b*=O,this},Uo.prototype.appendRotate=function(I){if(!I)return this;var d=Math.cos(I),M=Math.sin(I),V=this.a,$=this.b;return this.a=V*d+this.c*M,this.b=$*d+this.d*M,this.c=-V*M+this.c*d,this.d=-$*M+this.d*d,this},Uo.prototype.append=function(f){var s=this.a,O=this.b,K=this.c,_=this.d;return this.a=f.a*s+f.b*K,this.b=f.a*O+f.b*_,this.c=f.c*s+f.d*K,this.d=f.c*O+f.d*_,this.tx=f.tx*s+f.ty*K+this.tx,this.ty=f.tx*O+f.ty*_+this.ty,this},Uo.prototype.setTransform=function(s,G,D,H,q,X,u,V,P){var C,y,$,F,k,Y,K,n,L,l;return k=Math.sin(u),Y=Math.cos(u),K=Math.cos(P),n=Math.sin(P),L=-Math.sin(V),l=Math.cos(V),C=Y*q,y=k*q,$=-k*X,F=Y*X,this.a=K*C+n*$,this.b=K*y+n*F,this.c=L*C+l*$,this.d=L*y+l*F,this.tx=s+(D*C+H*$),this.ty=G+(D*y+H*F),this},Uo.prototype.prepend=function(D){var o=this.tx;if(1!==D.a||0!==D.b||0!==D.c||1!==D.d){var $=this.a,S=this.c;this.a=$*D.a+this.b*D.c,this.b=$*D.b+this.b*D.d,this.c=S*D.a+this.d*D.c,this.d=S*D.b+this.d*D.d}return this.tx=o*D.a+this.ty*D.c+D.tx,this.ty=o*D.b+this.ty*D.d+D.ty,this},Uo.prototype.transform=Uo.prototype.prepend,Uo.prototype.invert=function(){var q=this.a,Z=this.b,d=this.c,a=this.d,H=this.tx,i=q*a-Z*d;return this.a=a/i,this.b=-Z/i,this.c=-d/i,this.d=q/i,this.tx=(d*this.ty-a*H)/i,this.ty=-(q*this.ty-Z*H)/i,this},Uo.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Uo.prototype.clone=function(){var $=new Uo;return $.a=this.a,$.b=this.b,$.c=this.c,$.d=this.d,$.tx=this.tx,$.ty=this.ty,$},Uo.prototype.copy=function(b){return b.a=this.a,b.b=this.b,b.c=this.c,b.d=this.d,b.tx=this.tx,b.ty=this.ty,b},Uo.prototype.tf=function(h,H){1===arguments.length&&(H=h.y,h=h.x);var c=this;return{x:c.a*h+c.c*H+c.tx,y:c.b*h+c.d*H+c.ty}},Uo.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},Uo.prototype.fromArray=function(N){return this.a=N[0],this.b=N[1],this.c=N[2],this.d=N[3],this.tx=N[4],this.ty=N[5],this},Uo.prototype.toArray9=function(){return[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]},Uo.prototype.tfi=function(V,f){1===arguments.length&&(f=V.y,V=V.x);var E=this,u=1/(E.a*E.d+E.c*-E.b);return{x:E.d*u*V+-E.c*u*f+(E.ty*E.c-E.tx*E.d)*u,y:E.a*u*f+-E.b*u*V+(-E.ty*E.a+E.tx*E.b)*u}},Uo.IDENTITY=new Uo,Uo.TEMP_MATRIX=new Uo;var _n=H.Math.Quaternion=function($,k,C,_){this.set($,k,C,_)};b.assign(_n.prototype,{set:function(P,D,y,i){var e=this;return e._x=P||0,e._y=D||0,e._z=y||0,e._w=i!==E?i:1,e},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(Z){var w=this;return w._x=Z._x,w._y=Z._y,w._z=Z._z,w._w=Z._w,w},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(T){return this._x*T._x+this._y*T._y+this._z*T._z+this._w*T._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var y=this.length();return 0===y?(this._x=0,this._y=0,this._z=0,this._w=1):(y=1/y,this._x=this._x*y,this._y=this._y*y,this._z=this._z*y,this._w=this._w*y),this},fromArray:function(T,z){z===E&&(z=0);var v=this;return v._x=T[z],v._y=T[z+1],v._z=T[z+2],v._w=T[z+3],this},slerp:function(k,Y){if(0===Y)return this;if(1===Y)return this.copy(k);var H=this._x,C=this._y,K=this._z,s=this._w,n=s*k._w+H*k._x+C*k._y+K*k._z;if(0>n?(this._w=-k._w,this._x=-k._x,this._y=-k._y,this._z=-k._z,n=-n):this.copy(k),n>=1)return this._w=s,this._x=H,this._y=C,this._z=K,this;var t=Math.sqrt(1-n*n);if(Math.abs(t)<.001)return this._w=.5*(s+this._w),this._x=.5*(H+this._x),this._y=.5*(C+this._y),this._z=.5*(K+this._z),this;var E=Math.atan2(t,n),w=Math.sin((1-Y)*E)/t,i=Math.sin(Y*E)/t;return this._w=s*w+this._w*i,this._x=H*w+this._x*i,this._y=C*w+this._y*i,this._z=K*w+this._z*i,this},setFromAxisAngle:function(J,A){var p=A/2,U=Math.sin(p);return this._x=J.x*U,this._y=J.y*U,this._z=J.z*U,this._w=Math.cos(p),this},setFromEuler:function(N){var H=N._x,e=N._y,o=N._z,b=N._order,d=Math.cos,K=Math.sin,m=d(H/2),L=d(e/2),E=d(o/2),r=K(H/2),c=K(e/2),a=K(o/2);return"XYZ"===b?(this._x=r*L*E+m*c*a,this._y=m*c*E-r*L*a,this._z=m*L*a+r*c*E,this._w=m*L*E-r*c*a):"YXZ"===b?(this._x=r*L*E+m*c*a,this._y=m*c*E-r*L*a,this._z=m*L*a-r*c*E,this._w=m*L*E+r*c*a):"ZXY"===b?(this._x=r*L*E-m*c*a,this._y=m*c*E+r*L*a,this._z=m*L*a+r*c*E,this._w=m*L*E-r*c*a):"ZYX"===b?(this._x=r*L*E-m*c*a,this._y=m*c*E+r*L*a,this._z=m*L*a-r*c*E,this._w=m*L*E+r*c*a):"YZX"===b?(this._x=r*L*E+m*c*a,this._y=m*c*E+r*L*a,this._z=m*L*a-r*c*E,this._w=m*L*E-r*c*a):"XZY"===b&&(this._x=r*L*E-m*c*a,this._y=m*c*E-r*L*a,this._z=m*L*a+r*c*E,this._w=m*L*E+r*c*a),this},setFromRotationMatrix:function(q){var G,A=q.el,n=A[0],t=A[4],u=A[8],s=A[1],W=A[5],$=A[9],X=A[2],D=A[6],b=A[10],M=n+W+b;return M>0?(G=.5/Math.sqrt(M+1),this._w=.25/G,this._x=(D-$)*G,this._y=(u-X)*G,this._z=(s-t)*G):n>W&&n>b?(G=2*Math.sqrt(1+n-W-b),this._w=(D-$)/G,this._x=.25*G,this._y=(t+s)/G,this._z=(u+X)/G):W>b?(G=2*Math.sqrt(1+W-n-b),this._w=(u-X)/G,this._x=(t+s)/G,this._y=.25*G,this._z=($+D)/G):(G=2*Math.sqrt(1+b-n-W),this._w=(s-t)/G,this._x=(u+X)/G,this._y=($+D)/G,this._z=.25*G),this},setFromToVectors:function(){var J,I;return function(c,K){return J===E&&(J=new np),I=c.dot(K)+1,1e-7>I?(I=0,Math.abs(c.x)>Math.abs(c.z)?J.set(-c.y,c.x,0):J.set(0,-c.z,c.y)):J.crossVectors(c,K),this._x=J.x,this._y=J.y,this._z=J.z,this._w=I,this.normalize()}}(),setFromUnitVectors:function(){var C,l,t=1e-6;return function(y,v){return C===E&&(C=new np),l=y.dot(v)+1,t>l?(l=0,Math.abs(y.x)>Math.abs(y.z)?C.set(-y.y,y.x,0):C.set(0,-y.z,y.y)):C.crossVectors(y,v),this._x=C.x,this._y=C.y,this._z=C.z,this._w=l,this.normalize()}}(),multiply:function(x){return this.multiplyQuaternions(this,x)},premultiply:function(G){return this.multiplyQuaternions(G,this)},multiplyQuaternions:function(X,t){var G=X._x,P=X._y,I=X._z,s=X._w,f=t._x,_=t._y,l=t._z,S=t._w;return this._x=G*S+s*f+P*l-I*_,this._y=P*S+s*_+I*f-G*l,this._z=I*S+s*l+G*_-P*f,this._w=s*S-G*f-P*_-I*l,this},toArray:function(n,U){return n||(n=[]),U=U||0,n[U]=this._x,n[U+1]=this._y,n[U+2]=this._z,n[U+3]=this._w,n}});var Wg=H.Math.Vector4=function(Q,z,b,V){this.x=Q||0,this.y=z||0,this.z=b||0,this.w=V!==E?V:1};b.assign(Wg.prototype,{isVector4:!0,set:function(C,M,i,J){return this.x=C,this.y=M,this.z=i,this.w=J,this},setScalar:function(j){return this.x=j,this.y=j,this.z=j,this.w=j,this},setX:function(u){return this.x=u,this},setY:function(D){return this.y=D,this},setZ:function($){return this.z=$,this},setW:function(q){return this.w=q,this},setComponent:function(n,F){switch(n){case 0:this.x=F;break;case 1:this.y=F;break;case 2:this.z=F;break;case 3:this.w=F;break;default:throw new Error("index is out of range: "+n)}return this},getComponent:function(D){switch(D){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+D)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(z){return this.x=z.x,this.y=z.y,this.z=z.z,this.w=z.w!==E?z.w:1,this},add:function(K,S){return S!==E?this.addVectors(K,S):(this.x+=K.x,this.y+=K.y,this.z+=K.z,this.w+=K.w,this)},addScalar:function(f){return this.x+=f,this.y+=f,this.z+=f,this.w+=f,this},addVectors:function(R,$){return this.x=R.x+$.x,this.y=R.y+$.y,this.z=R.z+$.z,this.w=R.w+$.w,this},addScaledVector:function(a,F){return this.x+=a.x*F,this.y+=a.y*F,this.z+=a.z*F,this.w+=a.w*F,this},sub:function(C,Q){return Q!==E?this.subVectors(C,Q):(this.x-=C.x,this.y-=C.y,this.z-=C.z,this.w-=C.w,this)},subScalar:function(O){return this.x-=O,this.y-=O,this.z-=O,this.w-=O,this},subVectors:function(p,l){return this.x=p.x-l.x,this.y=p.y-l.y,this.z=p.z-l.z,this.w=p.w-l.w,this},multiplyScalar:function(n){return this.x*=n,this.y*=n,this.z*=n,this.w*=n,this},applyMatrix4:function(F){var d=this.x,q=this.y,a=this.z,R=this.w,D=F.el;return this.x=D[0]*d+D[4]*q+D[8]*a+D[12]*R,this.y=D[1]*d+D[5]*q+D[9]*a+D[13]*R,this.z=D[2]*d+D[6]*q+D[10]*a+D[14]*R,this.w=D[3]*d+D[7]*q+D[11]*a+D[15]*R,this},divideScalar:function(W){return this.multiplyScalar(1/W)},setAxisAngleFromQuaternion:function(P){this.w=2*Math.acos(P.w);var O=Math.sqrt(1-P.w*P.w);return 1e-4>O?(this.x=1,this.y=0,this.z=0):(this.x=P.x/O,this.y=P.y/O,this.z=P.z/O),this
},setAxisAngleFromRotationMatrix:function(c){var l,b,S,d,w=.01,o=.1,N=c.el,e=N[0],m=N[4],f=N[8],C=N[1],T=N[5],Q=N[9],y=N[2],h=N[6],J=N[10];if(Math.abs(m-C)<w&&Math.abs(f-y)<w&&Math.abs(Q-h)<w){if(Math.abs(m+C)<o&&Math.abs(f+y)<o&&Math.abs(Q+h)<o&&Math.abs(e+T+J-3)<o)return this.set(1,0,0,0),this;l=Math.PI;var L=(e+1)/2,P=(T+1)/2,R=(J+1)/2,a=(m+C)/4,Y=(f+y)/4,X=(Q+h)/4;return L>P&&L>R?w>L?(b=0,S=.707106781,d=.707106781):(b=Math.sqrt(L),S=a/b,d=Y/b):P>R?w>P?(b=.707106781,S=0,d=.707106781):(S=Math.sqrt(P),b=a/S,d=X/S):w>R?(b=.707106781,S=.707106781,d=0):(d=Math.sqrt(R),b=Y/d,S=X/d),this.set(b,S,d,l),this}var q=Math.sqrt((h-Q)*(h-Q)+(f-y)*(f-y)+(C-m)*(C-m));return Math.abs(q)<.001&&(q=1),this.x=(h-Q)/q,this.y=(f-y)/q,this.z=(C-m)/q,this.w=Math.acos((e+T+J-1)/2),this},min:function(u){return this.x=Math.min(this.x,u.x),this.y=Math.min(this.y,u.y),this.z=Math.min(this.z,u.z),this.w=Math.min(this.w,u.w),this},max:function(l){return this.x=Math.max(this.x,l.x),this.y=Math.max(this.y,l.y),this.z=Math.max(this.z,l.z),this.w=Math.max(this.w,l.w),this},clamp:function(t,y){return this.x=Math.max(t.x,Math.min(y.x,this.x)),this.y=Math.max(t.y,Math.min(y.y,this.y)),this.z=Math.max(t.z,Math.min(y.z,this.z)),this.w=Math.max(t.w,Math.min(y.w,this.w)),this},clampScalar:function(){var v,b;return function(u,Y){return v===E&&(v=new Wg,b=new Wg),v.set(u,u,u,u),b.set(Y,Y,Y,Y),this.clamp(v,b)}}(),clampLength:function(D,p){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(D,Math.min(p,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(X){return this.x*X.x+this.y*X.y+this.z*X.z+this.w*X.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(X){return this.normalize().multiplyScalar(X)},lerp:function(t,Z){return this.x+=(t.x-this.x)*Z,this.y+=(t.y-this.y)*Z,this.z+=(t.z-this.z)*Z,this.w+=(t.w-this.w)*Z,this},lerpVectors:function(w,Q,z){return this.subVectors(Q,w).multiplyScalar(z).add(w)},equals:function(M){return M.x===this.x&&M.y===this.y&&M.z===this.z&&M.w===this.w},fromArray:function(q,u){return u===E&&(u=0),this.x=q[u],this.y=q[u+1],this.z=q[u+2],this.w=q[u+3],this},toArray:function(m,i){return m===E&&(m=[]),i===E&&(i=0),m[i]=this.x,m[i+1]=this.y,m[i+2]=this.z,m[i+3]=this.w,m},fromBufferAttribute:function(x,w){return this.x=x.getX(w),this.y=x.getY(w),this.z=x.getZ(w),this.w=x.getW(w),this}});var np=H.Math.Vector3=function(R,I,c){R===E?(this.x=0,this.y=0,this.z=0):"object"==typeof R?this.copy(R):this.set(R,I==E?R:I,c==E?R:c)},Fb=H.Math.Vector3;b.assign(np.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(J,c,m){return this.x=J,this.y=c,this.z=m,this},equals:function(D){return D&&this.x===D.x&&this.y===D.y&&this.z===D.z},setScalar:function(C){return this.x=C,this.y=C,this.z=C,this},setX:function(E){return this.x=E,this},setY:function(J){return this.y=J,this},setZ:function(P){return this.z=P,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(x){return x.x===E?(this.x=x[0],this.y=x[1],this.z=x[2]):(this.x=x.x,this.y=x.y,this.z=x.z||0),this},add:function(H){return this.x+=H.x,this.y+=H.y,this.z+=H.z,this},addScalar:function(x){return this.x+=x,this.y+=x,this.z+=x,this},addVectors:function(m,o){return this.x=m.x+o.x,this.y=m.y+o.y,this.z=m.z+o.z,this},addScaledVector:function(o,Y){return this.x+=o.x*Y,this.y+=o.y*Y,this.z+=o.z*Y,this},sub:function(s){return this.x-=s.x,this.y-=s.y,this.z-=s.z,this},subScalar:function(o){return this.x-=o,this.y-=o,this.z-=o,this},subVectors:function(Q,r){return this.x=Q.x-r.x,this.y=Q.y-r.y,this.z=Q.z-r.z,this},divide:function(Q){return this.x/=Q.x,this.y/=Q.y,this.z/=Q.z,this},multiply:function(Z){return this.x*=Z.x,this.y*=Z.y,this.z*=Z.z,this},multiplyScalar:function(x){return this.x*=x,this.y*=x,this.z*=x,this},divideScalar:function(H){if(0!==H){var S=1/H;this.x*=S,this.y*=S,this.z*=S}else this.x=0,this.y=0,this.z=0;return this},distanceTo:function(U){return Math.sqrt(this.distanceToSquared(U))},distanceToSquared:function(k){var Z=this.x-k.x,M=this.y-k.y,p=this.z-k.z;return Z*Z+M*M+p*p},distanceToSquared2:function(L){var u=this.x-L[0],W=this.y-L[1],G=this.z-L[2];return u*u+W*W+G*G},divideVectors:function(j,a){return this.x=j.x/a.x,this.y=j.y/a.y,this.z=j.z/a.z,this},multiplyVectors:function(j,I){return this.x=j.x*I.x,this.y=j.y*I.y,this.z=j.z*I.z,this},transformDirection:function(B){var R=this.x,t=this.y,E=this.z,_=B.el;return this.x=_[0]*R+_[4]*t+_[8]*E,this.y=_[1]*R+_[5]*t+_[9]*E,this.z=_[2]*R+_[6]*t+_[10]*E,this.normalize()},applyAxisAngle:function(){var T=new _n;return function(C,K){return this.applyQuaternion(T.setFromAxisAngle(C,K))}}(),applyEuler:function(){var V=new _n;return function(H){return this.applyQuaternion(V.setFromEuler(H))}}(),applyQuaternion:function(m){var A=this.x,F=this.y,j=this.z,Z=m._x,K=m._y,T=m._z,b=m._w,E=b*A+K*j-T*F,y=b*F+T*A-Z*j,r=b*j+Z*F-K*A,c=-Z*A-K*F-T*j;return this.x=E*b+c*-Z+y*-T-r*-K,this.y=y*b+c*-K+r*-Z-E*-T,this.z=r*b+c*-T+E*-K-y*-Z,this},applyMatrix4:function(M){var r=this.x,k=this.y,u=this.z,A=M.el,F=1/(A[3]*r+A[7]*k+A[11]*u+A[15]);return this.x=(A[0]*r+A[4]*k+A[8]*u+A[12])*F,this.y=(A[1]*r+A[5]*k+A[9]*u+A[13])*F,this.z=(A[2]*r+A[6]*k+A[10]*u+A[14])*F,this},applyMatrix3:function(M){var a=this.x,Q=this.y,A=this.z,q=M.el;return this.x=q[0]*a+q[3]*Q+q[6]*A,this.y=q[1]*a+q[4]*Q+q[7]*A,this.z=q[2]*a+q[5]*Q+q[8]*A,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var u=new np;return function(q){return this.sub(u.copy(q).multiplyScalar(2*this.dot(q)))}}(),dot:function(w){return this.x*w.x+this.y*w.y+this.z*w.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var z=this.length();return z?this.multiplyScalar(1/z):this},setLength:function(k){return this.normalize().multiplyScalar(k)},fromArray:function(A,R){return R===E&&(R=0),this.x=A[R],this.y=A[R+1],this.z=A[R+2],this},toArray:function(O,P){return O===E&&(O=[0,0,0]),P===E&&(P=0),O[P]=this.x,O[P+1]=this.y,O[P+2]=this.z,O},cross:function(P){return this.crossVectors(this,P)},angleTo:function(C){var i=this.dot(C)/Math.sqrt(this.lengthSq()*C.lengthSq());return i>1||-1>i?0:Math.acos(i)},lerp:function(n,D){return this.x+=(n.x-this.x)*D,this.y+=(n.y-this.y)*D,this.z+=(n.z-this.z)*D,this},lerpVectors:function(T,O,d){return this.subVectors(O,T).multiplyScalar(d).add(T)},crossVectors:function(o,z){var H=o.x,B=o.y,T=o.z,m=z.x,P=z.y,u=z.z;return this.x=B*u-T*P,this.y=T*m-H*u,this.z=H*P-B*m,this},min:function(G){return this.x=Math.min(this.x,G.x),this.y=Math.min(this.y,G.y),this.z=Math.min(this.z,G.z),this},max:function(Q){return this.x=Math.max(this.x,Q.x),this.y=Math.max(this.y,Q.y),this.z=Math.max(this.z,Q.z),this},setFromMatrixPosition:function(_){return this.setFromMatrixColumn(_,3)},setFromMatrixScale:function(t){var V=this.setFromMatrixColumn(t,0).length(),b=this.setFromMatrixColumn(t,1).length(),x=this.setFromMatrixColumn(t,2).length();return this.x=V,this.y=b,this.z=x,this},setFromMatrixColumn:function(t,u){return this.fromArray(t.el,4*u)}}),np.UP=new np(0,1,0),np.AxisX=new np(1,0,0),np.AxisY=new np(0,1,0),np.AxisZ=new np(0,0,1),np.normalizeArray=function(){var l=new np;return function(o){return l.copy(o).normalize().toArray()}}();var pb=H.Math.Vector2=function(d,s,F){"object"==typeof d&&(d.x!=E?(s=d.y,F=d.e,d=d.x):(F=d[2],s=d[1],d=d[0])),this.set(d||0,s||0,F)};pb.prototype={},pb.prototype.constructor=pb;var _c=pb;b.defineProperties(pb.prototype,{width:{get:function(){return this.x},set:function(x){this.x=x}},height:{get:function(){return this.y},set:function(Q){this.y=Q}}}),pb.prototype.clone=function(){return new pb(this.x,this.y,this.e)},pb.prototype.copy=function(P){return this.set(P.x,P.y,P.e),this},pb.prototype.equals=function(J){return J.x===this.x&&J.y===this.y&&J.e===this.e},pb.prototype.set=function(e,N,y){return this.x=e||0,this.y=N||(0!==N?this.x:0),y!=E&&(this.e=y),this},pb.prototype.setScalar=function(t){return this.x=t,this.y=t,this.e=t,this},pb.prototype.setX=function(S){return this.x=S||0,this},pb.prototype.setY=function(K){return this.y=K||0,this},pb.prototype.setE=function(K){return this.e=K||0,this},pb.prototype.add=function(Q){return this.x+=Q.x,this.y+=Q.y,this},pb.prototype.addVectors=function(N,t){return this.x=N.x+t.x,this.y=N.y+t.y,this},pb.prototype.addScalar=function(W){return this.x+=W,this.y+=W,this},pb.prototype.addScaledVector=function(u,r){return this.x+=u.x*r,this.y+=u.y*r,this},pb.prototype.sub=function(S){return this.x-=S.x,this.y-=S.y,this},pb.prototype.subScalar=function(n){return this.x-=n,this.y-=n,this},pb.prototype.subVectors=function(F,s){return this.x=F.x-s.x,this.y=F.y-s.y,this},pb.prototype.multiply=function(Y){return this.x*=Y.x,this.y*=Y.y,this},pb.prototype.multiplyScalar=function(M){return this.x*=M,this.y*=M,this},pb.prototype.divide=function(B){return this.x/=B.x,this.y/=B.y,this},pb.prototype.divideScalar=function(f){return this.multiplyScalar(1/f)},pb.prototype.min=function(k){return this.x=Math.min(this.x,k.x),this.y=Math.min(this.y,k.y),this},pb.prototype.max=function(X){return this.x=Math.max(this.x,X.x),this.y=Math.max(this.y,X.y),this},pb.prototype.fromArray=function(A,X){return X===E&&(X=0),this.x=A[X],this.y=A[X+1],this},pb.prototype.clamp=function(M,t){return this.x=Math.max(M.x,Math.min(t.x,this.x)),this.y=Math.max(M.y,Math.min(t.y,this.y)),this},pb.prototype.clampScalar=function(){var N,e;return function(u,q){return N===E&&(N=new pb,e=new pb),N.set(u,u),e.set(q,q),this.clamp(N,e)}}(),pb.prototype.clampLength=function(g,W){var M=this.length();return this.multiplyScalar(Math.max(g,Math.min(W,M))/M)},pb.prototype.dot=function(Z){return this.x*Z.x+this.y*Z.y},pb.prototype.cross=function(P){return this.x*P.y-this.y*P.x},pb.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},pb.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},pb.prototype.normalize=function(){return this.divideScalar(this.length())},pb.prototype.angle=function(){var n=Math.atan2(this.y,this.x);return 0>n&&(n+=2*Math.PI),n},pb.prototype.distanceTo=function(G){return Math.sqrt(this.distanceToSquared(G))},pb.prototype.distanceToSquared=function(E){var Q=this.x-E.x,G=this.y-E.y;return Q*Q+G*G},pb.prototype.isNearEnough=function(U){return this.distanceToSquared(U)<1e-8},pb.prototype.setLength=function(D){var S=this.length();return S?this.multiplyScalar(D/S):this},pb.prototype.lerp=function(K,Q){return this.x+=(K.x-this.x)*Q,this.y+=(K.y-this.y)*Q,"number"==typeof K.e&&"number"==typeof this.e&&(this.e+=(K.e-this.e)*Q),this},pb.prototype.lerpVectors=function(h,Y,q){return this.subVectors(Y,h).multiplyScalar(q).add(h)},pb.prototype.rotateAround=function(_,Q){var A=_?_.x:0,W=_?_.y:0,w=Math.cos(Q),U=Math.sin(Q),F=this.x-A,D=this.y-W;return this.x=F*w-D*U+A,this.y=F*U+D*w+W,this};var Om=H.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]};b.assign(Om.prototype,{isMatrix3:!0,set:function(d,l,t,N,r,Q,J,a,W){var h=this.el;return h[0]=d,h[1]=N,h[2]=J,h[3]=l,h[4]=r,h[5]=a,h[6]=t,h[7]=Q,h[8]=W,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(f){var j=this.el,a=f.el;return j[0]=a[0],j[1]=a[1],j[2]=a[2],j[3]=a[3],j[4]=a[4],j[5]=a[5],j[6]=a[6],j[7]=a[7],j[8]=a[8],this},setFromMatrix4:function(J){var t=J.el;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},applyToBufferAttribute:function(){var l=new np;return function(z){for(var N=0,F=z.count;F>N;N++)l.x=z.getX(N),l.y=z.getY(N),l.z=z.getZ(N),l.applyMatrix3(this),z.setXYZ(N,l.x,l.y,l.z);return z}}(),multiply:function(Y){return this.multiplyMatrices(this,Y)},premultiply:function(D){return this.multiplyMatrices(D,this)},multiplyMatrices:function(i,N){var d=i.el,F=N.el,b=this.el,U=d[0],X=d[3],$=d[6],v=d[1],x=d[4],m=d[7],B=d[2],r=d[5],I=d[8],M=F[0],a=F[3],_=F[6],o=F[1],K=F[4],D=F[7],w=F[2],e=F[5],t=F[8];return b[0]=U*M+X*o+$*w,b[3]=U*a+X*K+$*e,b[6]=U*_+X*D+$*t,b[1]=v*M+x*o+m*w,b[4]=v*a+x*K+m*e,b[7]=v*_+x*D+m*t,b[2]=B*M+r*o+I*w,b[5]=B*a+r*K+I*e,b[8]=B*_+r*D+I*t,this},multiplyScalar:function(X){var x=this.el;return x[0]*=X,x[3]*=X,x[6]*=X,x[1]*=X,x[4]*=X,x[7]*=X,x[2]*=X,x[5]*=X,x[8]*=X,this},determinant:function(){var x=this.el,F=x[0],A=x[1],s=x[2],L=x[3],o=x[4],Y=x[5],l=x[6],k=x[7],M=x[8];return F*o*M-F*Y*k-A*L*M+A*Y*l+s*L*k-s*o*l},getInverse:function(p){var U=p.el,W=this.el,L=U[0],g=U[1],T=U[2],A=U[3],Q=U[4],t=U[5],_=U[6],H=U[7],s=U[8],w=s*Q-t*H,S=t*_-s*A,P=H*A-Q*_,d=L*w+g*S+T*P;if(0===d)return this.identity();var B=1/d;return W[0]=w*B,W[1]=(T*H-s*g)*B,W[2]=(t*g-T*Q)*B,W[3]=S*B,W[4]=(s*L-T*_)*B,W[5]=(T*A-t*L)*B,W[6]=P*B,W[7]=(g*_-H*L)*B,W[8]=(Q*L-g*A)*B,this},transpose:function(){var P,q=this.el;return P=q[1],q[1]=q[3],q[3]=P,P=q[2],q[2]=q[6],q[6]=P,P=q[5],q[5]=q[7],q[7]=P,this},getNormalMatrix:function(K){return this.setFromMatrix4(K).getInverse(this).transpose()},transposeIntoArray:function(y){var n=this.el;return y[0]=n[0],y[1]=n[3],y[2]=n[6],y[3]=n[1],y[4]=n[4],y[5]=n[7],y[6]=n[2],y[7]=n[5],y[8]=n[8],this},setUvTransform:function(e,d,q,j,h,p,y){var H=Math.cos(h),U=Math.sin(h);this.set(q*H,q*U,-q*(H*p+U*y)+p+e,-j*U,j*H,-j*(-U*p+H*y)+y+d,0,0,1)},scale:function(W,G){var U=this.el;return U[0]*=W,U[3]*=W,U[6]*=W,U[1]*=G,U[4]*=G,U[7]*=G,this},rotate:function(u){var W=Math.cos(u),_=Math.sin(u),B=this.el,Y=B[0],p=B[3],x=B[6],F=B[1],U=B[4],w=B[7];return B[0]=W*Y+_*F,B[3]=W*p+_*U,B[6]=W*x+_*w,B[1]=-_*Y+W*F,B[4]=-_*p+W*U,B[7]=-_*x+W*w,this},translate:function(p,H){var Y=this.el;return Y[0]+=p*Y[2],Y[3]+=p*Y[5],Y[6]+=p*Y[8],Y[1]+=H*Y[2],Y[4]+=H*Y[5],Y[7]+=H*Y[8],this},equals:function(M){for(var o=this.el,D=M.el,d=0;9>d;d++)if(o[d]!==D[d])return!1;return!0},fromArray:function(H,c){c===E&&(c=0);for(var B=0;9>B;B++)this.el[B]=H[B+c];return this},toArray:function(p,C){p===E&&(p=[]),C===E&&(C=0);var u=this.el;return p[C]=u[0],p[C+1]=u[1],p[C+2]=u[2],p[C+3]=u[3],p[C+4]=u[4],p[C+5]=u[5],p[C+6]=u[6],p[C+7]=u[7],p[C+8]=u[8],p}});var ze=H.Math.Plane=function(i,m){this.normal=i!==E?i:new np(1,0,0),this.constant=m!==E?m:0};b.assign(ze.prototype,{set:function(y,W){return this.normal.copy(y),this.constant=W,this},setComponents:function(P,j,c,$){return this.normal.set(P,j,c),this.constant=$,this},setFromNormalAndCoplanarPoint:function(z,E){return this.normal.copy(z),this.constant=-E.dot(this.normal),this},setFromCoplanarPoints:function(){var Y=new np,L=new np;return function(i,q,o){var $=Y.subVectors(o,q).cross(L.subVectors(i,q)).normalize();return this.setFromNormalAndCoplanarPoint($,i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(g){return this.normal.copy(g.normal),this.constant=g.constant,this},normalize:function(){var n=1/this.normal.length();return this.normal.multiplyScalar(n),this.constant*=n,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(E){return this.normal.dot(E)+this.constant},distanceToSphere:function(Q){return this.distanceToPoint(Q.center)-Q.radius},projectPoint:function(f,t){return t===E&&(t=new np),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(f)).add(f)},intersectLine:function(){var N=new np;return function(f,m){m===E&&(m=new np);var Y=f.delta(N),y=this.normal.dot(Y);if(0===y)return 0===this.distanceToPoint(f.start)?m.copy(f.start):E;var b=-(f.start.dot(this.normal)+this.constant)/y;return 0>b||b>1?E:m.copy(Y).multiplyScalar(b).add(f.start)}}(),intersectsLine:function(p){var x=this.distanceToPoint(p.start),V=this.distanceToPoint(p.end);return 0>x&&V>0||0>V&&x>0},intersectsBox:function(g){return g.intersectsPlane(this)},intersectsSphere:function(g){return g.intersectsPlane(this)},coplanarPoint:function(M){return M===E&&(M=new np),M.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var W=new np,O=new Om;return function(c,q){var f=q||O.getNormalMatrix(c),N=this.coplanarPoint(W).applyMatrix4(c),t=this.normal.applyMatrix3(f).normalize();return this.constant=-N.dot(t),this}}(),translate:function(b){return this.constant-=b.dot(this.normal),this},equals:function(X){return X.normal.equals(this.normal)&&X.constant===this.constant}});var ci=H.Math.Ray=function(N,Q){this.origin=N!==E?N.clone():new np,this.direction=Q!==E?Q.clone():new np};b.assign(ci.prototype,{set:function(t,O){return this.origin.copy(t),this.direction.copy(O),this},clone:function(){return(new this.constructor).copy(this)},copy:function(u){return this.origin.copy(u.origin),this.direction.copy(u.direction),this.maxHitLen=u.maxHitLen,this},at:function(f,Y){var J=Y||new np;return J.copy(this.direction).multiplyScalar(f).add(this.origin)},setMaxHitLength:function(o){this.maxHitLen=o},lookAt:function(m){return this.direction.copy(m).sub(this.origin).normalize(),this},applyMatrix4:function(j){var K=this.maxHitLen;if(K){var y=this.direction.clone().multiplyScalar(K).add(this.origin);y.applyMatrix4(j)}return this.origin.applyMatrix4(j),this.direction.transformDirection(j),K&&(this.maxHitLen=this.origin.distanceTo(y)),this},distanceToPlane:function(m){var x=m.normal.dot(this.direction);if(0===x)return 0===m.distanceToPoint(this.origin)?0:null;var b=-(this.origin.dot(m.normal)+m.constant)/x;return b>=0?b:null},intersectPlane:function(W,z){var h=this.distanceToPlane(W);return null===h?null:this.at(h,z)},intersectSphere:function(){var l=new np;return function(r,b){l.subVectors(r.center,this.origin);var i=l.dot(this.direction),D=l.dot(l)-i*i,d=r.radius*r.radius;if(D>d)return null;var z=Math.sqrt(d-D),n=i-z,N=i+z;return 0>n&&0>N?null:0>n?this.at(N,b):this.at(n,b)}}(),intersectEllipsoid:function(){var h=new np,s=new np;return function(H,y){h.subVectors(H.center,this.origin),h.divide(H.radius),s.divideVectors(this.direction,H.radius);var W=s.lengthSq(),F=h.dot(s),S=h.dot(h)*W-F*F;if(S>W)return null;var g=Math.sqrt(W-S),B=(F-g)/W,A=(F+g)/W;return 0>B&&0>A?null:0>B?this.at(A,y):this.at(B,y)}}(),intersectBox:function(W,i){var h,p,d,e,a,C,G=1/this.direction.x,k=1/this.direction.y,n=1/this.direction.z,z=this.origin;if(G>=0?(h=(W.min.x-z.x)*G,p=(W.max.x-z.x)*G):(h=(W.max.x-z.x)*G,p=(W.min.x-z.x)*G),k>=0?(d=(W.min.y-z.y)*k,e=(W.max.y-z.y)*k):(d=(W.max.y-z.y)*k,e=(W.min.y-z.y)*k),h>e||d>p)return null;if((d>h||h!==h)&&(h=d),(p>e||p!==p)&&(p=e),n>=0?(a=(W.min.z-z.z)*n,C=(W.max.z-z.z)*n):(a=(W.max.z-z.z)*n,C=(W.min.z-z.z)*n),h>C||a>p)return null;if((a>h||h!==h)&&(h=a),(p>C||p!==p)&&(p=C),0>p)return null;var D=h>=0?h:p,N=this.maxHitLen;return N&&D>N?null:this.at(D,i)},intersectTriangle:function(){var r=new np,a=new np,y=new np,S=new np;return function(s,g,X,B,Y){a.subVectors(g,s),y.subVectors(X,s),S.crossVectors(a,y);var u,P=this.direction.dot(S);if(P>0){if(B)return null;u=1}else{if(!(0>P))return null;u=-1,P=-P}r.subVectors(this.origin,s);var k=u*this.direction.dot(y.crossVectors(r,y));if(0>k)return null;var d=u*this.direction.dot(a.cross(r));if(0>d||k+d>P)return null;var i=-u*r.dot(S);if(0>i)return null;var p=i/P,I=this.maxHitLen;return I&&p>I?null:this.at(p,Y)}}()});var us=H.Math.Box3=function(M,I){this.min=M!==E?M:new np(1/0,1/0,1/0),this.max=I!==E?I:new np(-1/0,-1/0,-1/0)};b.assign(us.prototype,{set:function(h,i){return this.min.copy(h),this.max.copy(i),this},setFromArray:function(H){for(var P=1/0,p=1/0,m=1/0,R=-1/0,x=-1/0,A=-1/0,_=0,T=H.length;T>_;_+=3){var I=H[_],M=H[_+1],Z=H[_+2];P>I&&(P=I),p>M&&(p=M),m>Z&&(m=Z),I>R&&(R=I),M>x&&(x=M),Z>A&&(A=Z)}return this.min.set(P,p,m),this.max.set(R,x,A),this},setFromPoints:function(P){this.makeEmpty();for(var A=0,C=P.length;C>A;A++)this.expandByPoint(P[A]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(F){return F.max.x<this.min.x||F.min.x>this.max.x||F.max.y<this.min.y||F.min.y>this.max.y||F.max.z<this.min.z||F.min.z>this.max.z?!1:!0},copy:function(B){return this.min.copy(B.min),this.max.copy(B.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(U){return this.min.min(U),this.max.max(U),this},expandByBox:function(M){return this.min.min(M.min),this.max.max(M.max),this},applyMatrix4:function(){var H=[new np,new np,new np,new np,new np,new np,new np,new np];return function(T){return this.isEmpty()?this:(H[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(T),H[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(T),H[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(T),H[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(T),H[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(T),H[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(T),H[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(T),H[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(T),this.setFromPoints(H),this)}}()});var ar=H.Math.Sphere=function($,T){this.center=$!==E?$:new np,this.radius=T!==E?T:0};b.assign(ar.prototype,{set:function(O,s){return this.center.copy(O),this.radius=s,this},setFromPoints:function(){var C=new us;return function(K,z){var x=this.center;z!==E?x.copy(z):C.setFromPoints(K).getCenter(x);for(var S=0,m=0,U=K.length;U>m;m++)S=Math.max(S,x.distanceToSquared(K[m]));return this.radius=Math.sqrt(S),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(J){return J.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(Y){return Y.distanceTo(this.center)-this.radius},intersectsSphere:function(B){var Q=this.radius+B.radius;return B.center.distanceToSquared(this.center)<=Q*Q},intersectsBox:function(J){return J.intersectsSphere(this)},intersectsPlane:function(D){return Math.abs(D.distanceToPoint(this.center))<=this.radius},clampPoint:function(p,i){var T=this.center.distanceToSquared(p);return i===E&&(i=new np),i.copy(p),T>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i},getBoundingBox:function(L){return L===E&&(L=new us),L.set(this.center,this.center),L.expandByScalar(this.radius),L},applyMatrix4:function(q){return this.center.applyMatrix4(q),this.radius=this.radius*q.getMaxScaleOnAxis(),this},translate:function(r){return this.center.add(r),this},equals:function(o){return o.center.equals(this.center)&&o.radius===this.radius}});var lc=H.Math.Frustum=function(p,q,S,y,A,$){this.planes=[p!==E?p:new ze,q!==E?q:new ze,S!==E?S:new ze,y!==E?y:new ze,A!==E?A:new ze,$!==E?$:new ze]};b.assign(lc.prototype,{set:function(J,g,T,W,K,Y){var E=this.planes;return E[0].copy(J),E[1].copy(g),E[2].copy(T),E[3].copy(W),E[4].copy(K),E[5].copy(Y),this},clone:function(){return(new this.constructor).copy(this)},copy:function(c){for(var Q=this.planes,C=0;6>C;C++)Q[C].copy(c.planes[C]);return this},setFromMatrix:function(C){var v=this.planes,Y=C.el,z=Y[0],Q=Y[1],e=Y[2],j=Y[3],n=Y[4],u=Y[5],D=Y[6],P=Y[7],J=Y[8],T=Y[9],R=Y[10],l=Y[11],M=Y[12],y=Y[13],f=Y[14],N=Y[15];return v[0].setComponents(j-z,P-n,l-J,N-M).normalize(),v[1].setComponents(j+z,P+n,l+J,N+M).normalize(),v[2].setComponents(j+Q,P+u,l+T,N+y).normalize(),v[3].setComponents(j-Q,P-u,l-T,N-y).normalize(),v[4].setComponents(j-e,P-D,l-R,N-f).normalize(),v[5].setComponents(j+e,P+D,l+R,N+f).normalize(),this},intersectsObject:function(){var D=new ar;return function($){var F=$.geometry;return null===F.boundingSphere&&F.computeBoundingSphere(),D.copy(F.boundingSphere).applyMatrix4($.matrixWorld),this.intersectsSphere(D)}}(),intersectsSprite:function(){var J=new ar;return function(f){return J.center.set(0,0,0),J.radius=.7071067811865476,J.applyMatrix4(f.matrixWorld),this.intersectsSphere(J)}}(),intersectsSphere:function(x){for(var G=this.planes,n=x.center,P=-x.radius,p=0;6>p;p++){var s=G[p].distanceToPoint(n);if(P>s)return!1}return!0},intersectsBox:function(){var T=new np;return function(x){for(var H=this.planes,J=0;6>J;J++){var K=H[J];if(T.x=K.normal.x>0?x.max.x:x.min.x,T.y=K.normal.y>0?x.max.y:x.min.y,T.z=K.normal.z>0?x.max.z:x.min.z,K.distanceToPoint(T)<0)return!1}return!0}}(),containsPoint:function(v){for(var i=this.planes,k=0;6>k;k++)if(i[k].distanceToPoint(v)<0)return!1;return!0}});var jf=H.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};b.assign(jf.prototype,{set:function(S,d,s,j,K,Y,g,G,v,h,T,X,O,V,a,H){var u=this.el;return u[0]=S,u[4]=d,u[8]=s,u[12]=j,u[1]=K,u[5]=Y,u[9]=g,u[13]=G,u[2]=v,u[6]=h,u[10]=T,u[14]=X,u[3]=O,u[7]=V,u[11]=a,u[15]=H,this},clone:function(){return(new jf).fromArray(this.el)},fromArray:function(m,_){_===E&&(_=0);for(var Q=this.el,b=0;16>b;b++)Q[b]=m[b+_];return this},getElements:function(){return this.el},scale:function(w){var K=this.el,z=w.x,M=w.y,G=w.z;return K[0]*=z,K[4]*=M,K[8]*=G,K[1]*=z,K[5]*=M,K[9]*=G,K[2]*=z,K[6]*=M,K[10]*=G,K[3]*=z,K[7]*=M,K[11]*=G,this},makeRotationFromEuler:function(H){var K=this.el,t=H._x,S=H._y,u=H._z,X=H._order,O=Math.cos(t),Q=Math.sin(t),h=Math.cos(S),D=Math.sin(S),z=Math.cos(u),G=Math.sin(u);if("XYZ"===X){var l=O*z,r=O*G,d=Q*z,W=Q*G;K[0]=h*z,K[4]=-h*G,K[8]=D,K[1]=r+d*D,K[5]=l-W*D,K[9]=-Q*h,K[2]=W-l*D,K[6]=d+r*D,K[10]=O*h}else if("YXZ"===X){var x=h*z,Y=h*G,o=D*z,s=D*G;K[0]=x+s*Q,K[4]=o*Q-Y,K[8]=O*D,K[1]=O*G,K[5]=O*z,K[9]=-Q,K[2]=Y*Q-o,K[6]=s+x*Q,K[10]=O*h}else if("ZXY"===X){var x=h*z,Y=h*G,o=D*z,s=D*G;K[0]=x-s*Q,K[4]=-O*G,K[8]=o+Y*Q,K[1]=Y+o*Q,K[5]=O*z,K[9]=s-x*Q,K[2]=-O*D,K[6]=Q,K[10]=O*h}else if("ZYX"===X){var l=O*z,r=O*G,d=Q*z,W=Q*G;K[0]=h*z,K[4]=d*D-r,K[8]=l*D+W,K[1]=h*G,K[5]=W*D+l,K[9]=r*D-d,K[2]=-D,K[6]=Q*h,K[10]=O*h}else if("YZX"===X){var _=O*h,f=O*D,w=Q*h,a=Q*D;K[0]=h*z,K[4]=a-_*G,K[8]=w*G+f,K[1]=G,K[5]=O*z,K[9]=-Q*z,K[2]=-D*z,K[6]=f*G+w,K[10]=_-a*G}else if("XZY"===X){var _=O*h,f=O*D,w=Q*h,a=Q*D;K[0]=h*z,K[4]=-G,K[8]=D*z,K[1]=_*G+a,K[5]=O*z,K[9]=f*G-w,K[2]=w*G-f,K[6]=Q*z,K[10]=a*G+_}return K[3]=0,K[7]=0,K[11]=0,K[12]=0,K[13]=0,K[14]=0,K[15]=1,this},makeRotationFromQuaternion:function(L){var v=this.el,M=L._x,b=L._y,s=L._z,m=L._w,W=M+M,o=b+b,d=s+s,w=M*W,G=M*o,O=M*d,q=b*o,$=b*d,u=s*d,N=m*W,g=m*o,a=m*d;return v[0]=1-(q+u),v[4]=G-a,v[8]=O+g,v[1]=G+a,v[5]=1-(w+u),v[9]=$-N,v[2]=O-g,v[6]=$+N,v[10]=1-(w+q),v[3]=0,v[7]=0,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(A){var r=this.el,x=A.el,F=x[0],n=x[1],W=x[2],Z=x[3],t=x[4],Q=x[5],k=x[6],M=x[7],G=x[8],i=x[9],b=x[10],J=x[11],H=x[12],E=x[13],C=x[14],z=x[15],B=i*C*M-E*b*M+E*k*J-Q*C*J-i*k*z+Q*b*z,o=H*b*M-G*C*M-H*k*J+t*C*J+G*k*z-t*b*z,Y=G*E*M-H*i*M+H*Q*J-t*E*J-G*Q*z+t*i*z,p=H*i*k-G*E*k-H*Q*b+t*E*b+G*Q*C-t*i*C,j=F*B+n*o+W*Y+Z*p;if(0===j)return this.identity();var e=1/j;return r[0]=B*e,r[1]=(E*b*Z-i*C*Z-E*W*J+n*C*J+i*W*z-n*b*z)*e,r[2]=(Q*C*Z-E*k*Z+E*W*M-n*C*M-Q*W*z+n*k*z)*e,r[3]=(i*k*Z-Q*b*Z-i*W*M+n*b*M+Q*W*J-n*k*J)*e,r[4]=o*e,r[5]=(G*C*Z-H*b*Z+H*W*J-F*C*J-G*W*z+F*b*z)*e,r[6]=(H*k*Z-t*C*Z-H*W*M+F*C*M+t*W*z-F*k*z)*e,r[7]=(t*b*Z-G*k*Z+G*W*M-F*b*M-t*W*J+F*k*J)*e,r[8]=Y*e,r[9]=(H*i*Z-G*E*Z-H*n*J+F*E*J+G*n*z-F*i*z)*e,r[10]=(t*E*Z-H*Q*Z+H*n*M-F*E*M-t*n*z+F*Q*z)*e,r[11]=(G*Q*Z-t*i*Z-G*n*M+F*i*M+t*n*J-F*Q*J)*e,r[12]=p*e,r[13]=(G*E*W-H*i*W+H*n*b-F*E*b-G*n*C+F*i*C)*e,r[14]=(H*Q*W-t*E*W-H*n*k+F*E*k+t*n*C-F*Q*C)*e,r[15]=(t*i*W-G*Q*W+G*n*k-F*i*k-t*n*b+F*Q*b)*e,this},makeRotationAxis:function(F,H){var g=Math.cos(H),I=Math.sin(H),B=1-g,O=F.x,n=F.y,t=F.z,Q=B*O,y=B*n;return this.set(Q*O+g,Q*n-I*t,Q*t+I*n,0,Q*n+I*t,y*n+g,y*t-I*O,0,Q*t-I*n,y*t+I*O,B*t*t+g,0,0,0,0,1),this},multiply:function($){return this.multiplyMatrices(this,$)},premultiply:function(h){return this.multiplyMatrices(h,this)},multiplyMatrices:function(N,U){var e=N.el,E=U.el,v=this.el,d=e[0],r=e[4],R=e[8],y=e[12],I=e[1],Y=e[5],J=e[9],Q=e[13],B=e[2],x=e[6],A=e[10],C=e[14],c=e[3],n=e[7],b=e[11],P=e[15],k=E[0],a=E[4],u=E[8],Z=E[12],w=E[1],i=E[5],W=E[9],S=E[13],D=E[2],T=E[6],F=E[10],m=E[14],j=E[3],l=E[7],s=E[11],G=E[15];return v[0]=d*k+r*w+R*D+y*j,v[4]=d*a+r*i+R*T+y*l,v[8]=d*u+r*W+R*F+y*s,v[12]=d*Z+r*S+R*m+y*G,v[1]=I*k+Y*w+J*D+Q*j,v[5]=I*a+Y*i+J*T+Q*l,v[9]=I*u+Y*W+J*F+Q*s,v[13]=I*Z+Y*S+J*m+Q*G,v[2]=B*k+x*w+A*D+C*j,v[6]=B*a+x*i+A*T+C*l,v[10]=B*u+x*W+A*F+C*s,v[14]=B*Z+x*S+A*m+C*G,v[3]=c*k+n*w+b*D+P*j,v[7]=c*a+n*i+b*T+P*l,v[11]=c*u+n*W+b*F+P*s,v[15]=c*Z+n*S+b*m+P*G,this},lookAt:function(){var z=new np;return function(_,k,N){return z.subVectors(_,k),this.lookAtDirection(z,N)}}(),lookAtDirection:function(){var c=new np,J=new np,$=new np;return function(I,F){F||(F=np.UP);var E=this.el;return $.copy(I),0===$.lengthSq()&&($.z=1),$.normalize(),c.crossVectors(F,$),0===c.lengthSq()&&(1===Math.abs(F.z)?$.x+=1e-4:$.z+=1e-4,$.normalize(),c.crossVectors(F,$)),c.normalize(),J.crossVectors($,c),E[0]=c.x,E[4]=J.x,E[8]=$.x,E[1]=c.y,E[5]=J.y,E[9]=$.y,E[2]=c.z,E[6]=J.z,E[10]=$.z,this}}(),extractScale:function(){var D;return function(z){D===E&&(D=new np),z===E&&(z=new np);var g=D.setFromMatrixColumn(this,0).length(),G=D.setFromMatrixColumn(this,1).length(),r=D.setFromMatrixColumn(this,2).length();return z.set(g,G,r),z}}(),extractRotation:function(){var f;return function(c){f===E&&(f=new np),c===E&&(c=new jf);var r=this.el,L=c.el,s=1/f.setFromMatrixColumn(c,0).length(),n=1/f.setFromMatrixColumn(c,1).length(),A=1/f.setFromMatrixColumn(c,2).length();return r[0]=L[0]*s,r[1]=L[1]*s,r[2]=L[2]*s,r[4]=L[4]*n,r[5]=L[5]*n,r[6]=L[6]*n,r[8]=L[8]*A,r[9]=L[9]*A,r[10]=L[10]*A,this}}(),multiplyScalar:function(C){var g=this.el;return g[0]*=C,g[4]*=C,g[8]*=C,g[12]*=C,g[1]*=C,g[5]*=C,g[9]*=C,g[13]*=C,g[2]*=C,g[6]*=C,g[10]*=C,g[14]*=C,g[3]*=C,g[7]*=C,g[11]*=C,g[15]*=C,this},getPosition:function(t){return t===E&&(t=new np),t.setFromMatrixColumn(this,3)},setPosition:function(Y){var N=this.el;return N[12]=Y.x,N[13]=Y.y,N[14]=Y.z,this},toArray:function(j,C){j===E&&(j=[]),C===E&&(C=0);var Y=this.el;return j[C]=Y[0],j[C+1]=Y[1],j[C+2]=Y[2],j[C+3]=Y[3],j[C+4]=Y[4],j[C+5]=Y[5],j[C+6]=Y[6],j[C+7]=Y[7],j[C+8]=Y[8],j[C+9]=Y[9],j[C+10]=Y[10],j[C+11]=Y[11],j[C+12]=Y[12],j[C+13]=Y[13],j[C+14]=Y[14],j[C+15]=Y[15],j},determinant:function(){var s=this.el,K=s[0],w=s[4],Q=s[8],k=s[12],e=s[1],G=s[5],J=s[9],j=s[13],R=s[2],v=s[6],h=s[10],c=s[14],t=s[3],Y=s[7],B=s[11],I=s[15];return t*(+k*J*v-Q*j*v-k*G*h+w*j*h+Q*G*c-w*J*c)+Y*(+K*J*c-K*j*h+k*e*h-Q*e*c+Q*j*R-k*J*R)+B*(+K*j*v-K*G*c-k*e*v+w*e*c+k*G*R-w*j*R)+I*(-Q*G*R-K*J*v+K*G*h+Q*e*v-w*e*h+w*J*R)},copy:function(W){var V=this.el,H=W.el;return V[0]=H[0],V[1]=H[1],V[2]=H[2],V[3]=H[3],V[4]=H[4],V[5]=H[5],V[6]=H[6],V[7]=H[7],V[8]=H[8],V[9]=H[9],V[10]=H[10],V[11]=H[11],V[12]=H[12],V[13]=H[13],V[14]=H[14],V[15]=H[15],this},compose:function(K,M,E){var V=this.el,Q=M._x,D=M._y,F=M._z,$=M._w,y=Q+Q,N=D+D,S=F+F,d=Q*y,X=Q*N,J=Q*S,o=D*N,U=D*S,L=F*S,I=$*y,w=$*N,m=$*S,k=E.x,s=E.y,T=E.z;return V[0]=(1-(o+L))*k,V[1]=(X+m)*k,V[2]=(J-w)*k,V[3]=0,V[4]=(X-m)*s,V[5]=(1-(d+L))*s,V[6]=(U+I)*s,V[7]=0,V[8]=(J+w)*T,V[9]=(U-I)*T,V[10]=(1-(d+o))*T,V[11]=0,V[12]=K.x,V[13]=K.y,V[14]=K.z,V[15]=1,this
},decompose:function(){var F=new np,$=new jf;return function(I,q,P){var d=this.el,Y=F.set(d[0],d[1],d[2]).length(),Z=F.set(d[4],d[5],d[6]).length(),i=F.set(d[8],d[9],d[10]).length(),A=this.determinant();0>A&&(Y=-Y),I.x=d[12],I.y=d[13],I.z=d[14],$.copy(this);var g=1/Y,R=1/Z,U=1/i;return $.el[0]*=g,$.el[1]*=g,$.el[2]*=g,$.el[4]*=R,$.el[5]*=R,$.el[6]*=R,$.el[8]*=U,$.el[9]*=U,$.el[10]*=U,q.setFromRotationMatrix($),P.x=Y,P.y=Z,P.z=i,this}}()});var No=H.Math.Triangle=function(b,l,Z){this.a=b!==E?b:new np,this.b=l!==E?l:new np,this.c=Z!==E?Z:new np};b.assign(No,{barycoordFromPoint:function(){var h=new np,B=new np,g=new np;return function(W,d,s,l,w){h.subVectors(l,d),B.subVectors(s,d),g.subVectors(W,d);var t=h.dot(h),T=h.dot(B),U=h.dot(g),F=B.dot(B),i=B.dot(g),S=t*F-T*T,M=w||new np;if(0===S)return M.set(-2,-1,-1);var f=1/S,j=(F*U-T*i)*f,$=(t*i-T*U)*f;return M.set(1-j-$,$,j)}}(),uvIntersection:function(){var Z=new np;return function(r,M,u,f,p,v,_){return No.barycoordFromPoint(r,M,u,f,Z),p.multiplyScalar(Z.x),v.multiplyScalar(Z.y),_.multiplyScalar(Z.z),p.add(v).add(_),p.clone()}}()});var Fk=H.Math.Euler=function(q,f,Z,o,$){this.set(q,f,Z,o,$)};Fk.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Fk.DefaultOrder="XYZ",Fk.ReverseOrder=function(){var c={xyz:"ZYX",xzy:"YZX",yxz:"ZXY",yzx:"XZY",zxy:"YXZ",zyx:"XYZ"};return function(s){return c[s]}}(),b.defineProperties(Fk.prototype,{x:{get:function(){return this._x},set:function(X){this._x=X,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(K){this._y=K,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(N){this._z=N,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(T){this._order=T,this.onChangeCallback()}}}),b.assign(Fk.prototype,{set:function(H,G,U,x,Z){return br(H)&&(Z=U,x=G,U=H[2],G=H[1],H=H[0]),x?Z&&(x=Fk.ReverseOrder(x)):x="ZYX",this._x=H||0,this._y=G||0,this._z=U||0,this._order=x||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(N){return this._x=N._x,this._y=N._y,this._z=N._z,this._order=N._order,this.onChangeCallback(),this},setFromRotationMatrix:function(Z,o,Q){var K=H.Math.clamp,z=Z.el||Z,r=z[0],G=z[4],m=z[8],a=z[1],N=z[5],$=z[9],B=z[2],w=z[6],F=z[10];return o=o||this._order,"XYZ"===o?(this._y=Math.asin(K(m,-1,1)),Math.abs(m)<.99999?(this._x=Math.atan2(-$,F),this._z=Math.atan2(-G,r)):(this._x=Math.atan2(w,N),this._z=0)):"YXZ"===o?(this._x=Math.asin(-K($,-1,1)),Math.abs($)<.99999?(this._y=Math.atan2(m,F),this._z=Math.atan2(a,N)):(this._y=Math.atan2(-B,r),this._z=0)):"ZXY"===o?(this._x=Math.asin(K(w,-1,1)),Math.abs(w)<.99999?(this._y=Math.atan2(-B,F),this._z=Math.atan2(-G,N)):(this._y=0,this._z=Math.atan2(a,r))):"ZYX"===o?(this._y=Math.asin(-K(B,-1,1)),Math.abs(B)<.99999?(this._x=Math.atan2(w,F),this._z=Math.atan2(a,r)):(this._x=0,this._z=Math.atan2(-G,N))):"YZX"===o?(this._z=Math.asin(K(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(-$,N),this._y=Math.atan2(-B,r)):(this._x=0,this._y=Math.atan2(m,F))):"XZY"===o?(this._z=Math.asin(-K(G,-1,1)),Math.abs(G)<.99999?(this._x=Math.atan2(w,N),this._y=Math.atan2(m,r)):(this._x=Math.atan2(-$,F),this._y=0)):console.warn("unsupported order: "+o),this._order=o,Q!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var U=new jf;return function(G,e,q){return U.makeRotationFromQuaternion(G),this.setFromRotationMatrix(U,e,q)}}(),setFromVector3:function(o,k){return this.set(o.x,o.y,o.z,k||this._order)},reorder:function(){var y=new _n;return function(z){return y.setFromEuler(this),this.setFromQuaternion(y,z)}}(),equals:function(U){return U._x===this._x&&U._y===this._y&&U._z===this._z&&U._order===this._order},fromArray:function(k){return this._x=k[0],this._y=k[1],this._z=k[2],k[3]!==E&&(this._order=k[3]),this.onChangeCallback(),this},toArray:function(G,y){return G===E&&(G=[]),y===E&&(y=0),G[y]=this._x,G[y+1]=this._y,G[y+2]=this._z,G[y+3]=this._order,G},toVector3:function($){return $?$.set(this._x,this._y,this._z):new np(this._x,this._y,this._z)},onChange:function(E){return this.onChangeCallback=E,this},onChangeCallback:function(){}});var ti={ms_ac:function(q,S){for(var M=S.ms_ac,z=0;z<M.length;z++)Yf(q,M[z])},ms_listener:function(g){g.addListeners=function(){var F=this,D=fr;L.mockTouch&&(D=Ed.concat(pj).concat(vn)),F.__events__=D;for(var G=0,U=D.length;U>G;G++){var c=D[G];"wheel"===c&&!F.handle_wheel&&F.handle_mousewheel&&(F.handle_wheel=function(Q){Wf(F,Q)}),F["handle_"+c]&&_e(c,F.getView(),F)}},g.removeListeners=function(){var f=this,G=f.__events__;if(G){f.__events__=E;for(var O=0,U=G.length;U>O;O++)f["handle_"+G[O]]&&qn(G[O],f.getView(),f)}}},ms_fire:function(z){z.mp=function(f,G,d){this.addPropertyChangeListener(f,G,d)},z.ump=function(N,l){this.removePropertyChangeListener(N,l)},z.fp=function(H,B,I,K,J){return this.firePropertyChange(H,B,I,K,J)},z.addPropertyChangeListener=function(F,a,K){var G=this;G._62I||(G._62I=new Ef),G._62I.add(F,a,K)},z.removePropertyChangeListener=function(B,s){this._62I&&this._62I.remove(B,s)},z.firePropertyChange=function(T,Y,J,U,i){if(U){if(U(Y,J))return!1}else if(Y===J)return!1;var z=this,F=i||{};return F.property=T,F.oldValue=Y,F.newValue=J,F.source=z,F.data=z,z._62I&&z._62I.fire(F),z.onPropertyChanged&&z.onPropertyChanged(F),!0}},ms_attr:function(A){A.a=function(m,A){var G=this;if(2===arguments.length)G.setAttr(m,A);else{if(!Mr(m))return G.getAttr(m);for(var X in m)G.setAttr(X,m[X])}return G},A.getAttr=function(c,J){if(J===E&&(J=1),this._attrObject&&c in this._attrObject)return this._attrObject[c];if(this.getImage){var z=this.getImage();if(Vn(z)&&(z=ih[z]),Mr(z)&&"dataBindings"in z)for(var p=z.dataBindings,A=p.length-1;A>=0;A--){var x=p[A];if(x.attr===c){if("defaultValue"in x)return x.defaultValue;break}}}return J?M[c]:E},A.setAttr=function(s,p){var W=this;W._attrObject||(W._attrObject={});var k=W._attrObject[s];p===E?delete W._attrObject[s]:W._attrObject[s]=p,W.fp&&W.fp("a:"+s,k,p)&&W.onAttrChanged&&W.onAttrChanged(s,k,p)},A.getSerializableAttrs=function(){var G,s={};for(G in this._attrObject)s[G]=1;return s}},ms_bnb:function(L){L.getBodyColor=function(y){return y.s("body.color")},L.getBorderColor=function(C){return C.s("border.color")}},_51o:function(M){M.mi=function(E,K,w){this.addInteractorListener(E,K,w)},M.umi=function(k,R){this.removeInteractorListener(k,R)},M.fi=function(F){this.fireInteractorEvent(F)},M.addInteractorListener=function(i,L,j){var Y=this;Y._63I||(Y._63I=new Ef),Y._63I.add(i,L,j)},M.removeInteractorListener=function(j,d){this._63I&&this._63I.remove(j,d)},M.fireInteractorEvent=function(f){this._63I&&this._63I.fire(f)},M.setInteractors=function(i){var z=this,A=z._interactors;A&&A.each(function(u){u.tearDown()}),br(i)&&(i=new zp(i)),z._interactors=i,i&&i.each(function(s){s.setUp()}),z.fp("interactors",A,i),z.invalidateSelection()},M.getInteractors=function(){return this._interactors}},_49o:function(p){p._44O=f,p._45O=f,p.getTopPainters=function(){return this._44O},p.getBottomPainters=function(){return this._45O},p.addTopPainter=function(G){var _=this;_._44O||(_._44O=new zp),_._44O.contains(G)||(_._44O.add(G),_.redraw&&_.redraw())},p.removeTopPainter=function(I){var u=this;u._44O&&(u._44O.remove(I),u.redraw&&u.redraw())},p.addBottomPainter=function(u){var F=this;F._45O||(F._45O=new zp),F._45O.contains(u)||(F._45O.add(u),F.redraw&&F.redraw())},p.removeBottomPainter=function(B){var g=this;g._45O&&(g._45O.remove(B),g.redraw&&g.redraw())},p._93db=function(G,e){var N=this;N._45O&&N._45O.each(function(W){W.draw?W.draw(G,e):W.call(N,G,e)})},p._92db=function(E,m){var u=this;u._44O&&u._44O.each(function(D){D.draw?D.draw(E,m):D.call(u,E,m)})}},ms_sm:function(k){k.sm=function(){return this.getSelectionModel()},k.setSelectableFunc=function(D){this.sm().setFilterFunc(D)},k.getSelectableFunc=function(){return this.sm().getFilterFunc()},k.getSelectionModel=function(){var Y=this;return Y._selectionModel?Y._selectionModel:Y.dm().sm()},k.isSelectionModelShared=function(){return!this._selectionModel},k.setSelectionModelShared=function(m){var v=this,Y=v.sm(),Z=!v._selectionModel,H=v.handleSelectionChange,_=v.dm();Z!==m&&(v.invalidateSelection&&v.invalidateSelection(),m?(_.sm().ms(H,v),v._selectionModel.ums(H,v),v._selectionModel.dispose(),v._selectionModel=f):(_.sm().ums(H,v),v._selectionModel=new Oc(_),v._selectionModel.ms(H,v)),v.onSelectionModelSharedChanged(),v.fp("selectionModelShared",Z,m),v.fireViewEvent({kind:"selectionModelSharedChange",oldValue:Z,newValue:m,oldSelectionModel:Y,newSelectionModel:v.sm()}))},k.onSelectionModelSharedChanged=function(){var Z=this;Z.redraw(),Z.invalidateSelection&&Z.invalidateSelection()},k.removeSelection=function(){var b=this.dm();b.beginTransaction(),this.sm().toSelection().each(b.remove,b),b.endTransaction()},k.selectAll=function(){var g=this;g.sm().ss(g.dm().toDatas(function(K){return g.isVisible(K)&&g.isSelectable(K)}))},k.isSelected=function(Z){return this.sm().co(Z)},k.isSelectedById=function(M){var u=this.dm().getDataById(M);return u?this.isSelected(u):!1},k.isSelectable=function(s){return this.sm().isSelectable(s)}},ms_tx:function(j){j._64I=0,j._65O=0,j.isScrollable=function(){return this.getWidth()<this._64I},j._40o=function(){return this.isScrollable()},j.getLogicalPoint=function(o){return Gm(o,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},j.tx=function(T){return T===E?this.getTranslateX():(this.setTranslateX(T),void 0)},j.getTranslateX=function(){return this._65O},j.setTranslateX=function(A){var I=this,R=I.getWidth()-I._64I;R>A&&(A=R),A>0&&(A=0),A=P(A);var H=I._65O;I._65O=A,I.fp(Ml,H,A)}},ms_ty:function(Z){Z._23Q=0,Z._66O=0,Z._41o=function(){return this.getHeight()<this._23Q},Z.getLogicalPoint=function(K){return Gm(K,this._canvas||this._view,this.tx?this.tx():0,this.ty())},Z.ty=function(_){return _===E?this.getTranslateY():(this.setTranslateY(_),void 0)},Z.getTranslateY=function(){return this._66O},Z.setTranslateY=function(G){var X=this,J=X.getHeight()-X._23Q;J>G&&(G=J),G>0&&(G=0),G=P(G);var B=X._66O;X._66O=G,X.fp(Gq,B,G)}},ms_txy:function($){$._65O=0,$._66O=0,$.tx=function(R){return R===E?this.getTranslateX():(this.setTranslateX(R),void 0)},$.ty=function(k){return k===E?this.getTranslateY():(this.setTranslateY(k),void 0)},$.onTranslateEnded=function(){},$.setTranslate=function(c,G,W){var z=this;if(W=Oj(W)){z._65I&&z._65I.stop(!0);var I=z.tx(),Y=z.ty();W.action=function(f){z.setTranslate(I+(c-I)*f,Y+(G-Y)*f)},W._37o=function(){delete z._66I,delete z._65I,z.onTranslateEnded()},z._66I=1,z._65I=xo(W)}else z.tx(c),z.ty(G)},$.getTranslateX=function(){return this._65O},$.setTranslateX=function(L){var i=this;L=i.adjustTranslateX(L);var e=i._65O;i._65O=L,i.fp(Ml,e,L)},$.getTranslateY=function(){return this._66O},$.setTranslateY=function(r){var Y=this;r=Y.adjustTranslateY(r);var D=Y._66O;Y._66O=r,Y.fp(Gq,D,r)},$.adjustTranslateX=function(i){return P(i)},$.adjustTranslateY=function(k){return P(k)},$.translate=function(a,o,G){this.setTranslate(this.tx()+a,this.ty()+o,G)},$.getLogicalPoint=function(T){var V=this;return Gm(T,this._canvas||V._view,V.tx(),V.ty())}},ms_dm:function(G){G.dm=function(A){return A?(this.setDataModel(A),void 0):this.getDataModel()},G.getDataModel=function(){return this._dataModel}},ms_lp:function(j){j.lp=function(i){return this.getLogicalPoint(i)}},ms_v:function(K){K._disabled=!1,K.setDisabled=function(Y,M){var n=this,O=n._disabled;O!==Y&&(O&&(bn(n._63O),delete n._63O),Y&&(Zg(n._view,n._63O=sk(M)),n.iv()),n._disabled=Y,n.fp("disabled",O,Y))},K.isDisabled=function(){return this._disabled},K.getDisabledDiv=function(){return this._63O},K.getView=function(){return this._view},K.addToDOM=function(G){var y=this,P=y.getView(),S=P.style;G=G||Y.body,G.appendChild(P),S.left="0",S.right="0",S.top="0",S.bottom="0",w(u,"resize",function(){y.iv()}),y.iv()},K.setCursor=function(I){"default"===I&&(I=this._defaultCursor||I);var o=this.getView().style;o.cursor=I,o.cursor="-webkit-"+I,o.cursor="-moz-"+I},K.getWidth=function(){return this._view.clientWidth},K.getHeight=function(){return this._view.clientHeight},K.setWidth=function(U){var $=this;$._view.style.width=U+qf,$.iv(),$.fp&&$.fp(Mj,f,U)},K.setHeight=function(V){var x=this;x._view.style.height=V+qf,x.iv(),x.fp&&x.fp(_p,f,V)},K.setFocus=function(s){var j=this,C=j._currentEditor;return s&&C&&(C.getView&&(C=C.getView()),C.contains(s.target))?!1:(xg(j._view),j.endEditing&&j.endEditing(),j.fireViewEvent("focus"),!0)},K.iv=function(M){this.invalidate(M)},K.invalidate=function(h){var t=this;t._68I||(t._68I=1,Un(t.validate,t,f,h),t.onInvalidated&&t.onInvalidated(),t.fireViewEvent("invalidate"))},K.validate=function(){var Q=this,o=Q._view;if(Q._68I&&(delete Q._68I,o.parentNode))if(0===o.offsetWidth&&0===o.offsetHeight&&Q._67I!==f)Q._67I===E&&(Q._67I=L.reinvalidateCount),Q._67I>0?Q._67I--:Q._67I=f,Q.iv();else{Q.fireViewEvent("beginValidate"),Q.validateImpl(),Q.onValidated&&Q.onValidated(),Q.fireViewEvent("validate");var I=Q._63O;I&&(o.lastChild!==I&&(bn(I),Zg(o,I)),kq(I,0,0,Q.getWidth(),Q.getHeight())),yo(Q),Nh(Q),Dl(Q)}},K.layout=function(v,O,K,B){1===arguments.length?kq(this,v):kq(this,v,O,K,B)},K.addViewListener=function(I,j,z){var D=this;D._67O||(D._67O=new Ef),D._67O.add(I,j,z)},K.removeViewListener=function(V,H){this._67O.remove(V,H)},K.fireViewEvent=function(S){var b=this;b._67O&&(Vn(S)&&(S={kind:S}),b._67O.fire(S)),L.viewListener&&L.viewListener(b,S)}},ms_tip:function(c){c.setToolTipEnabled=function(U){var r=this;U?dn||r._13o||(r.enableToolTip(),r.fp("toolTipEnabled",!1,!0)):r._13o&&(r.disableToolTip(),r.fp("toolTipEnabled",!0,!1))},c.isToolTipEnabled=function(){return!!this._13o},c.enableToolTip=function(){var J=this;if(!dn&&!J._13o){J._13o=function(q){var o=J.getToolTip(q);o!=f?(L.toolTipContinual&&L.isToolTipShowing()?op(q,o):(Dq(),yc={timeout:On(me,de),e:q,info:o}),Yb={e:q,view:J}):Dq()};var Y=J.getView();w(Y,mo,J._13o),w(Y,"mouseleave",L.hideToolTip)}},c.disableToolTip=function(){var m=this;if(m._13o){var F=m.getView();x(F,mo,m._13o),x(F,"mouseleave",L.hideToolTip),delete m._13o}},c.getToolTip=function(i){var c=this;if(c.getDataAt){var W=c.getDataAt(i);return W?W.getToolTip():f}return c.getValue?c.getValue():void 0}},_52o:function(M){M._zoom=1,M._29I=hq,M.zoomIn=function(n,q){this.setZoom(this._zoom*Yj,n,q)},M.zoomOut=function($,d){this.setZoom(this._zoom/Yj,$,d)},M.zoomReset=function(o,c){this.setZoom(1,o,c)},M.scrollZoomIn=function(d){this.setZoom(this._zoom*Jb,f,d)},M.scrollZoomOut=function(H){this.setZoom(this._zoom/Jb,f,H)},M.pinchZoomIn=function(j){this.setZoom(this._zoom*vl,f,j)},M.pinchZoomOut=function(E){this.setZoom(this._zoom/vl,f,E)},M.adjustZoom=function(v){return cs>v?cs:v>_r?_r:v},M.getZoom=function(){return this._zoom},M.setZoom=function(R,B,z){var L=this;if(B=Oj(B)){L._14o&&L._14o.stop(!0);var e=L._zoom;B.action=function(y){L._96O(e+(R-e)*y,z)},B._37o=function(){delete L._zooming,delete L._14o,L.onZoomEnded()},L._zooming=1,L._14o=xo(B)}else L._96O(R,z)},M._96O=function(m,g){var E=this;if(m=E.adjustZoom(m),m!==E._zoom){E.validate();var f=E._29I,M=E._zoom;0!==f.width&&0!==f.height&&(g=g?g:{x:f.x+f.width/2,y:f.y+f.height/2},E.tx((g.x-f.x)*M-g.x*m),E.ty((g.y-f.y)*M-g.y*m)),E._zoom=m,E.fp("zoom",M,m)}}},ms_edge:function(x){x._2I=function(B){var V=this;V._44I||(V._44I=new zp),V._42I||(V._42I=new zp),V._44I.add(B),V._42I.add(B),V._20I()},x._4I=function(C){var O=this;O._44I||(O._44I=new zp),O._43I||(O._43I=new zp),O._44I.add(C),O._43I.add(C),O._20I()},x._16I=function(M){var i=this;i._44I.remove(M),i._42I.remove(M),i._44I.isEmpty()&&delete i._44I,i._42I.isEmpty()&&delete i._42I,i._20I()},x._18I=function(s){var l=this;l._44I.remove(s),l._43I.remove(s),l._44I.isEmpty()&&delete l._44I,l._43I.isEmpty()&&delete l._43I,l._20I()},x._20I=function(){var N=this;if(delete N._45I,!N._44I||N._44I.isEmpty())return delete N._70O,void 0;var Q;N._44I.each(function(t){t.isLooped()&&(Q||(Q={}),Q[t._id]||(N._45I||(N._45I=new zp),N._45I.add(t),Q[t._id]=t))}),Q?(N._70O=new zp,N._44I.each(function(E){Q[E._id]?"A"===Q[E._id]||(Q[E._id]="A",N._70O.add(E)):N._70O.add(E)})):N._70O=N._44I},x.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},x.getSourceAgentEdges=function(){return this._46I},x.getTargetAgentEdges=function(){return this._47I},x._1I=function(I){var O=this;O._46I||(O._46I=new zp),O._48I||(O._48I=new zp),O._46I.add(I),O._48I.add(I),O._19I()},x._3I=function(X){var C=this;C._47I||(C._47I=new zp),C._48I||(C._48I=new zp),C._47I.add(X),C._48I.add(X),C._19I()},x._15I=function(S){var h=this;h._46I.remove(S),h._48I.remove(S),h._46I.isEmpty()&&delete h._46I,h._48I.isEmpty()&&delete h._48I,h._19I()},x._17I=function(R){var l=this;l._47I.remove(R),l._48I.remove(R),l._47I.isEmpty()&&delete l._47I,l._48I.isEmpty()&&delete l._48I,l._19I()},x._19I=function(){var N=this;delete N._49I;var J=N._48I;if(J&&!J.isEmpty()){var P={};J.each(function(J){P[J._id]?N._49I||(N._49I=new zp):P[J._id]=J}),N._49I?J.each(function(w){P[w._id]&&(N._49I.add(w),delete P[w._id])}):N._49I=J}},x.getLoopedEdges=function(){return this._45I},x.getEdges=function(){return this._70O},x.getAgentEdges=function(){return this._49I},x.getSourceEdges=function(){return this._42I},x.getTargetEdges=function(){return this._43I},x._8I=function(){this._70O&&this._70O.each(function(Z){Z._7I()})}}};Hi(L,{getVersion:function(){return"7.2.8"}},!0);var qg=function(S){return S.devicePixelRatio?S.devicePixelRatio:S.screen&&S.screen.logicalXDPI?S.screen.deviceXDPI/S.screen.logicalXDPI:1};Hi(L,{numberDigits:5,crossOrigin:"",baseZIndex:E,isTouchable:dn,mockTouch:!0,devicePixelRatio:qg(u),reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:D.disabledBackground,forceHierarchicalSerialization:!0,extractBatchTranslation:!1,extractShapeTranslation:!1,extractPolylineTranslation:!1,extractVerticesTranslation:!1,envmapProbeMinWaitTime:300,envmapProbeMaxWaitTime:25e3,EnvmapTextureSize:1024,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return gk},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,textExtraWidth:4,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(w){return w*w},labelColor:ck,labelSelectColor:Ze,labelFont:"12px arial, sans-serif",widgetIndent:dn?30:20,widgetRowHeight:dn?30:20,widgetHeaderHeight:dn?32:22,widgetTitleHeight:dn?34:24,scrollBarColor:Jh,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:dn?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Eo,intersectionLineLine:Tb,isEnter:Ll,isEsc:le,isDelete:xh,isSpace:Xc,isLeft:Ff,isUp:Tf,isRight:Te,isDown:rl,isTouchEvent:bj,getTarget:Nr,isString:Vn,isNumber:$c,isBoolean:dk,isArray:br,isSelectAll:Qq,isFunction:fi,isObject:Mr,getPropertyValue:Wp,setPropertyValue:Pq,addMethod:Hi,createGradient:function(v,i,r,S,x,K,y,l){var h=Je[i];return h(v,r,S,x,K,y,l)},appendToScreen:function(M){M=M.getView?M.getView():M,(Y.fullscreenElement||Y.mozFullScreenElement||Y.webkitFullscreenElement||Y.msFullscreenElement||Y.body).appendChild(M)},encodeString:function(t){return H.Math.encodeBase64(t,L.encodeStringKey)},decodeString:function(f){return H.Math.decodeBase64(f,L.encodeStringKey)},findView:function(x){var p=function(Y,B){var U=B._ht;U&&Y.push(U);var t=B.children,f=t.length;if(f)for(var z=0;f>z;z++)p(Y,t[z])},i=[];p(i,Y.body);var V=function($,l){for(var Z="2d"===l?Gc.GraphView:nj.Graph3dView,e=0,W=$.length;W>e;e++)if($[e]instanceof Z)return i[e];return null};return"all"===x?i:"2d"===x?V(i,"2d"):"3d"===x?V(i,"3d"):V(i,"3d")||V(i,"2d")},toggleFullscreen:function(W){var F=W.getView();if(Y.fullscreenElement||Y.mozFullScreenElement||Y.webkitFullscreenElement||Y.msFullscreenElement)Y.exitFullscreen?Y.exitFullscreen():Y.msExitFullscreen?Y.msExitFullscreen():Y.mozCancelFullScreen?Y.mozCancelFullScreen():Y.webkitExitFullscreen&&Y.webkitExitFullscreen();else{var z=!0;if(W.isSelfViewEvent){var e=W.getX(),p=W.getY(),f=W.getWidth(),l=W.getHeight(),X=F.style.background,s=F.style.backgroundColor;X||s||(F.style.backgroundColor="white"),F.requestFullscreen?F.requestFullscreen():F.msRequestFullscreen?F.msRequestFullscreen():F.mozRequestFullScreen?F.mozRequestFullScreen():F.webkitRequestFullscreen&&F.webkitRequestFullscreen();var P=setInterval(function(){if(F!==(Y.fullscreenElement||Y.mozFullScreenElement||Y.webkitFullscreenElement||Y.msFullscreenElement))clearInterval(P),W.setX(e),W.setY(p),W.setWidth(f),W.setHeight(l),W._fullscreen=!1,F.style.oldBackgroundColor=s,W.iv();else{var v=H.Default.getWindowInfo();(z||v.width!==W.getWidth()||v.height!==W.getHeight())&&(W.setX(v.left),W.setY(v.top),W.setWidth(v.width),W.setHeight(v.height),W._fullscreen=!0,W.iv(),z=!1)}},500)}else{var $=F.style.left,h=F.style.top,f=F.style.width,l=F.style.height,X=F.style.background,s=F.style.backgroundColor;X||s||(F.style.backgroundColor="white"),F.requestFullscreen?F.requestFullscreen():F.msRequestFullscreen?F.msRequestFullscreen():F.mozRequestFullScreen?F.mozRequestFullScreen():F.webkitRequestFullscreen&&F.webkitRequestFullscreen();var P=setInterval(function(){if(F!==(Y.fullscreenElement||Y.mozFullScreenElement||Y.webkitFullscreenElement||Y.msFullscreenElement))clearInterval(P),F.style.left=$,F.style.top=h,F.style.width=f,F.style.height=l,F.style.oldBackgroundColor=s,W.iv();else{var t=H.Default.getWindowInfo();(z||t.width!==W.getWidth()||t.height!==W.getHeight())&&(kq(W),z=!1)}},500)}}},appendTimeStamp:function(K){return K},setCompType:function(o,K){Vn(K)&&K.substr(0,12)==Nc&&(K=L.parse(K)),fi(K)||Mr(K)?ee[o]=K:rp(o)},getCompType:function(Z){var b=ee[Z];return b===E&&Cs.test(Z)&&rp(Z),b},getCompTypeMap:function(){return ee},drawCompType:function(m,_,A,k,w,L){m(_,A,k,w,L)},numberListener:function(){var e={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(q){var z=q.keyCode;e[z]||65===z&&L.isCtrlDown(q)||86===z&&L.isCtrlDown(q)||67===z&&L.isCtrlDown(q)||88===z&&L.isCtrlDown(q)||z>=35&&40>=z||(q.shiftKey||48>z||z>57)&&(96>z||z>105)&&q.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(d){var I=d.target.tagName;("DIV"===I||"CANVAS"===I)&&!(L.ignoreKeyCodes.indexOf(d.keyCode)>=0)&&("keydown"!==d.type||Ff(d)||Te(d)||Tf(d)||rl(d)||xh(d)||65===d.keyCode&&(d.metaKey||d.ctrlKey))&&d.cancelable===!0&&(d.preventDefault(),d.preventManipulation&&d.preventManipulation())},getWindowInfo:function(){var X=Y.documentElement,o=X&&(X.scrollLeft||X.scrollTop)?X:Y.body;return{target:o,left:o.scrollLeft,top:o.scrollTop,width:u.innerWidth||o.clientWidth,height:u.innerHeight||o.clientHeight}},isDragging:function(){return!!gk},isLeftButton:function(m){return bj(m)?!0:0===m.button},isMiddleButton:function(g){return bj(g)?!1:g&&(1===g.button||4&(g.buttons||0))},isRightButton:function(p){return bj(p)?!1:p&&(2===p.button||2&(p.buttons||0))},isInput:function(F){if(!F)return!1;var h=F.tagName;return"INPUT"===h||"TEXTAREA"===h||"SELECT"===h},getTouchCount:function(W){return bj(W)?W.touches.length:1},isDoubleClick:function(){function $(j){j.details=0,j.timeout=null,j.lastPoint=null}var W={};return Do=new ak,sc=Do.getTime(),function(i){if(Ai(i)>1)return!1;var q=i.button==f?"":i.button,H=i.type+q,O=H+"_isDoubleClick",N=W[H];if(N||(N=W[H]={details:0,timeout:null,lastPoint:null}),i[O]===E){i[O]=!0;var n=dg(i);N.timeout&&(Zh(N.timeout),N.timeout=null);var P=bj(i)?L.doubleTouchRange:L.doubleClickRange;N.lastPoint&&Mp(N.lastPoint,n)>P&&$(N),N.lastPoint=n,N.details++,N.timeout=On(function(){$(this)}.bind(N),L.doubleClickSpeed)}return 2===N.details}}(),isShiftDown:function(t){return t?t.shiftKey:Go["16"]},isCtrlDown:function(f){return f?Zf?f.metaKey:f.ctrlKey:Zf?Go["91"]:Go["17"]},getClientPoint:function(S){return bj(S)&&(S=rg(S)),{x:S.clientX,y:S.clientY}},isMouseEvent:function(x){return x instanceof MouseEvent||0===x.type.indexOf("mouse")},getTargetElement:function(_){var U,i=Oq(_);if(U=L.isMouseEvent(_)||!Y.elementFromPoint?_.target:Y.elementFromPoint(i.x,i.y),xf&&Y.elementFromPoint){for(var j=[],d=[];"none"===U.style.pointerEvents;)j.push(U),d.push(U.style.display||""),U.style.display="none",U=Y.elementFromPoint(i.x,i.y);j.forEach(function(c,r){c.style.display=d[r]})}return U},getPagePoint:function(P){return bj(P)&&(P=rg(P)),{x:P.pageX,y:P.pageY}},createObject:function(T,V){var $=new T;for(var X in V){var m=V[X];if(fi(m))$[X]=m;else if(0===X.indexOf("s:"))$.s(X.substr(2),V[X]);else if(0===X.indexOf("a:"))$.a(X.substr(2),V[X]);else{var r=fc(X),m=V[X];$[r]?($[r](m),"setToolTip"===r&&$.enableToolTip&&$.enableToolTip()):$[X]=m}}return $},setImage:function(w,j,l,d){var A=arguments.length;4===A?jp(w,d,j,l):2===A?Vn(j)?j.substr(0,12)==Nc?yj(w,L.parse(j)):jp(w,j):yj(w,j):1===A&&jp(w,w)},getImage:function(G,A,o){var d;if(G==f)return f;if(Mr(G)?d=G:(d=ih[G],G&&d===E&&(cl&&cl[G]||jp(G,G))),A&&d&&d.tagName){var v;v="override"===o?"colors_override":"override_rgb"===o?"colors_override_rgb":"override_a"===o?"colors_override_a":"colors",d[v]||(d[v]={__count__:0});var H=d[v][A];return H||(d[v].__count__>L.imageCacheThreshold&&(d[v]={__count__:0}),H=Dm(d,$r(A),d.width,d.height,o),d[v][A]=H,d[v].__count__++),H}return d},isImageComplete:function(o,y,s){var b=mr(o);if(!b)return!1;if(b.tagName)return b.complete;for(var A,o,x,l=b.comps,X=!0,_=0,N=l.length;N>_;_++)if(A=l[_],x=A.type,"image"===A.type){o=A.name,o&&o.func&&(o=kh(o,y));var O=fk(o,y,s);if(!O){X=!1;break}}else if(Cs.test(x)&&L.getCompType(x)===E){X=!1,rp(x);break}return X},getId:function(){var E=1;return function(){return++E}}(),callLater:function(S,x,a,_){var J=function(){S.apply(x,a)};return _?On(J,_):u.requestAnimationFrame(J)},cancelLater:function(R,U){U?Zh(R):u.cancelAnimationFrame(R)},clone:function(l){if(null==l||"object"!=typeof l)return l;if(l instanceof Date){var _=new Date;return _.setTime(l.getTime()),_}if(l instanceof Array){for(var _=[],o=0,N=l.length;N>o;o++)_[o]=ys(l[o]);return _}if(l instanceof zp){for(var _=new zp,o=0,N=l.length;N>o;o++)_.set(o,ys(l.get(o)));return _}if(l instanceof rd)return l;if(l instanceof Wo){var _=new Wo;return _.deserialize(l.serialize()),_}if(l instanceof b){var _={};for(var G in l)l.hasOwnProperty(G)&&(_[G]=ys(l[G]));return _}return l},callWhenLoaded:function(J,k){k=k||100;var L=el(J,k);Mb||(Mb={}),Mb[L]={tick:L,cb:J,delay:k}},beforeLoadURL:function(q,T){if(Mb){var p={};for(var T in Mb){var l=Mb[T];Zh(l.tick);var x=el(l.cb,l.delay);p[x]={tick:x,delay:l.delay,cb:l.cb}}Mb=p}return L.convertURL?L.convertURL(q,T):q},convertURL:function(l){return l},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return L.getImage("default_blank")},resizeImage:function(w,I,V,p){V||(V=I),p||(p=Vq());var Z=p.getContext("2d");return Zq(p,I,V,1),Z.drawImage(w,0,0,I,V),p},resizeImagePOT:function(v,D,K){if(!v||!v.tagName)return v;var k=v.width,A=v.height;if(!k||!A)return v;if(xc.isPOT(k)&&xc.isPOT(A)&&(!D||k===A))return v;var g,M;return D?M=g=xc.nearestPOT(Math.min(k,A)):(g=xc.nearestPOT(k),M=xc.nearestPOT(A)),L.resizeImage(v,g,M,K)},sortFunc:function(S,j){if(S===j)return 0;if(S==f&&j!=f)return 1;if(S!=f&&j==f)return-1;if(S==f&&j==f)return 0;var h,U=typeof S,Q=typeof j;return U===Vm&&Q===Vm?h=S.localeCompare(j):U===Bl&&Q===Bl&&(h=S-j),h===E&&(h=(""+S).localeCompare(""+j)),h>0?1:0>h?-1:0},getClassMap:function(){return Bs},getClass:function(T){if(Vn(T)){var R,E=Bs[T];if(!E){R=T.split("."),E=u;for(var f=0;f<R.length;f++)E=E[R[f]];Bs[T]=E}return E}return T},def:function(e,f,Q){var t,n,s,O=function(){};if(O.prototype=f.prototype,t=new O,Vn(e)){if(Bs[e])throw"'"+e+"' already defined";s=jk(e),t.getClassName=function(){return e}}else s=e;if(t.constructor=s,t.getClass=function(){return s},t.getSuperClass=function(){return f},Q)for(n in Q)ti[n]&&ti.hasOwnProperty(n)?ti[n](t,Q):dm(t,Q,n);s.prototype=t,s.superClass=f.prototype},startAnim:function(){var F=function(b){b.duration&&(b.startTime=ek()),b.timeId=Un(b.tick,f,f,b.interval)};return function(e){return e=ys(e),e.easing=e.easing||L.animEasing,e.duration||e.frames||(e.duration=L.animDuration),e.t=0,e.duration?e.interval=0:(e.frame=0,e.interval=e.interval||10),e.tick=function(){if(e.duration){var m=(ek()-e.startTime)/e.duration;if(m>1&&(m=1),e.t=m,e.action(e.easing(m),m),!e.isRunning())return;1===m?e.stop():e._isPaused||(e.timeId=Un(e.tick))}else{if(e.frame++,m=e.t=e.frame/e.frames,e.action(e.easing(m),m),!e.isRunning())return;e.frame<e.frames?e._isPaused||(e.timeId=Un(e.tick,f,f,e.interval)):e.stop()}},e.resume=function(){e._isPaused&&(delete e._isPaused,e.duration?e.t<1&&(e.startTime=ek()-e.duration*e.t,e.timeId=Un(e.tick)):e.frame<e.frames&&(e.timeId=Un(e.tick,f,f,e.interval)))},e.pause=function(){zo(e.timeId,!e.duration),e._isPaused=!0},e.isPaused=function(){return this._isPaused},e.stop=function(Q){e.isRunning()&&(zo(e.timeId,!e.duration),delete e.timeId,e.duration?e.t<1&&Q&&(e.t=1,e.action(e.easing(1),1)):e.frame<e.frames&&Q&&(e.frame=e.frames,e.action(e.easing(1),1)),e._37o&&e._37o(),e.finishFunc&&e.finishFunc())},e.isRunning=function(){return e.timeId!=f},e.delay?Un(F,f,[e],e.delay):F(e),e}}(),getTextSize:function(){var N={},i=Y?Vq().getContext("2d"):f;return function(M,F){i.font=M?M:Bh;var v=N[i.font];return v||(v=2*i.measureText("e").width+4,N[i.font]=v),{width:i.measureText(F).width+L.textExtraWidth,height:v}}}(),drawText:function(q,X,R,l,U,L,Z,m,i,I,E){if(X!=f){var y=vm(R,X),D={};D.y=I&&I!==aj?I===Fc?L+y.height/2:L+m-y.height/2:L+m/2,D.x=i&&i!==re?i===ln?U+Z-y.width/2:U+Z/2:U+y.width/2,Iq(q,X,D,R,l),E&&lj(q,X,R,l,D.x,D.y,y.width,E)}},getDistance:function(W,e){var v=W.length;return e?3===v?G(wk(W[0]-e[0])+wk(W[1]-e[1])+wk(W[2]-e[2])):2===v?G(wk(W[0]-e[0])+wk(W[1]-e[1])):W.z===E?G(wk(e.x-W.x)+wk(e.y-W.y)):G(wk(e.x-W.x)+wk(e.y-W.y)+wk(e.z-W.z)):3===v?G(wk(W[0])+wk(W[1])+wk(W[2])):2===v?G(wk(W[0])+wk(W[1])):void 0},brighter:function(g,D){return 0>D&&(D=-D),Si(g,D?D:40)},darker:function(i,$){return $>0&&($=-$),Si(i,$?$:-40)},unionPoint:function(e,o){if(!e)return f;if(2===arguments.length)return e&&o?{x:h(e.x,o.x),y:h(e.y,o.y),width:a(e.x-o.x),height:a(e.y-o.y)}:f;var t=e;if(t._as&&(t=t._as),t.length===E)return f;var b=t.length;if(0>=b)return f;for(var y=1,n=t[0],Z={x:n.x,y:n.y,width:0,height:0};b>y;y++){n=t[y];var c=h(Z.x,n.x),N=p(Z.x+Z.width,n.x),$=h(Z.y,n.y),J=p(Z.y+Z.height,n.y);Z.x=c,Z.y=$,Z.width=N-c,Z.height=J-$}return Z},unionRect:function(o,X){if(o&&!X)return ys(o);if(!o&&X)return ys(X);if(o&&X){var q={x:h(o.x,X.x),y:h(o.y,X.y)};return q.width=p(o.x+o.width,X.x+X.width)-q.x,q.height=p(o.y+o.height,X.y+X.height)-q.y,q}return f},containsPoint:function(r,E,w,M){if(M!=f&&1!==M){var g=r.x+r.width/2,F=r.y+r.height/2;r={x:g-r.width/2*M,y:F-r.height/2*M,width:r.width*M,height:r.height*M}}if(w){var U=r.width/2,v=r.height/2,h=B(-w),b=J(-w),x=E.x-r.x-U,p=E.y-r.y-v;return E={x:b*x-h*p,y:h*x+b*p},Sj({x:-U,y:-v,width:r.width,height:r.height},E)}return!(!r||E.x<r.x||E.y<r.y||E.x>r.x+r.width||E.y>r.y+r.height)},containsRect:function(U,q){if(!U||!q)return!1;var u=q.x,d=q.y,C=q.width,c=q.height,K=U.width,n=U.height;if(0>(K|n|C|c))return!1;var L=U.x,N=U.y;if(L>u||N>d)return!1;if(K+=L,C+=u,u>=C){if(K>=L||C>K)return!1}else if(K>=L&&C>K)return!1;if(n+=N,c+=d,d>=c){if(n>=N||c>n)return!1}else if(n>=N&&c>n)return!1;return!0},intersectsRect:function(a,_){if(!a||!_)return!1;var x=_.width,r=_.height,F=a.width,G=a.height;if(0>=F||0>=G||0>=x||0>=r)return!1;var l=_.x,X=_.y,M=a.x,C=a.y;return F+=M,G+=C,x+=l,r+=X,F>l&&G>X&&x>M&&r>C},intersection:function(z,e){if(!z||!e)return f;var X=e.x,d=e.y,R=z.x,S=z.y,Q=X,r=d,H=R,K=S;return Q+=e.width,r+=e.height,H+=z.width,K+=z.height,R>X&&(X=R),S>d&&(d=S),Q>H&&(Q=H),r>K&&(r=K),Q-=X,r-=d,0>=Q||0>=r?f:{x:X,y:d,width:Q,height:r}},grow:function(D,W,T){T===E&&(T=W),D.x-=W,D.y-=T,D.width=D.width+2*W,D.height=D.height+2*T},getScreenPoint:function(o,J,x,W,a,U,X){var j=x.getBoundingClientRect(),A=o*(U||1)-x.scrollLeft+(W||0),l=J*(X||1)-x.scrollTop+(a||0),s=Pm(x,!1);
if(s){var Z=new np(A,l,0);return Z.applyMatrix4(s),console.log(Z),{x:Z.x,y:Z.y}}return{x:A+j.left,y:l+j.top}},getLogicalPoint:function(F,T,R,_,Z,X){var O,p,S=T.getBoundingClientRect();F.target?(vf(F)?Zf?Go["91"]=!0:Go["17"]=!0:Zf?Go["91"]=!1:Go["17"]=!1,Go["16"]=An(F)?!0:!1,F=bj(F)?rg(F):F,O=F.clientX,p=F.clientY):(O=F.x,p=F.y);var J=Pm(T,!0);if(J){var l=new np(O,p,0);l.applyMatrix4(J);do{if(Math.abs(l.z)<=1e-6)break;var V=new np(O,p,1);if(V.applyMatrix4(matrix),Math.abs(V.z)<=1e-6){l=V;break}if(V.sub(l),Math.abs(V.z)<=1e-6)break;l.addScaledVector(V,-l.z/V.z)}while(!1);return{x:(l.x+T.scrollLeft-(R||0))/(Z||1),y:(l.y+T.scrollTop-(_||0))/(X||1)}}return{x:(O-S.left+T.scrollLeft-(R||0))/(Z||1),y:(p-S.top+T.scrollTop-(_||0))/(X||1)}},removeHTML:function(){var d;return function(P){return P&&P.getView&&(P=P.getView()),P&&P.parentNode?d===P?!0:(d=P,P.parentNode.removeChild(P),d=f,!0):!1}}(),getToolTipDiv:function(){if(!Ad){Ad=Rq(),an=Rq();var a=Ad.style;L.baseZIndex!=f&&(a.zIndex=cm(L.baseZIndex)+3+""),a.whiteSpace="nowrap",a.color=L.toolTipLabelColor,a.background=L.toolTipBackground,a.font=L.toolTipLabelFont,a.padding="5px",a.boxShadow="0px 0px 3px "+L.toolTipShadowColor}return Ad},isToolTipShowing:function(){return Ad&&Ad.parentNode?!0:an&&an.parentNode?!0:!1},updateToolTipContent:function(q,z){if(L.isToolTipShowing()&&(z||(z=Yb&&Yb.view),q===E&&z&&Yb.e&&(q=z.getToolTip(Yb.e)),q!=f)){var N;q.html?(q=q.html,N=an):N=Ad,N.innerHTML=q}},hideToolTip:function(){if(L.isToolTipShowing()){bn(Ad),bn(an),Ok();var S=Yb&&Yb.view;S&&S.onHideToolTip&&S.onHideToolTip(),Yb=f}},showToolTip:function(N,i,A){if(!N||i==f)return Dq(),void 0;L.getToolTipDiv();var M,P;if(i.html?(i=i.html,M=an,bn(Ad)):(M=Ad,bn(an)),P=M.style,M.innerHTML=i,M.parentNode||H.Default.appendToScreen(M),N.target){N=Oq(N);var h=Kd(),Q=N.x,p=N.y,X=dn?60:12;if(dn){var r=M.getBoundingClientRect();P.left=Q-r.width/2+qf,P.top=p-r.height-X<h.top?p+X+qf:p-r.height-X+qf}else{P.left=Q+X+qf,P.top=p+X+qf;var r=M.getBoundingClientRect();r.left+r.width>h.width&&(P.left=Q-X-r.width+qf),r.top+r.height>h.height&&(P.top=p-X-r.height+qf),r.left<0&&(P.left=Q+X+qf),r.top<0&&(P.top=p+X+qf)}}else P.left=N.x+qf,P.top=N.y+qf;Ok(),A===E?A=Yb&&Yb.view:Yb={e:N,view:A},A&&A.onShowToolTip&&A.onShowToolTip()},startDragging:function(J,r,P){P==E&&(P=!0),J!==gk&&(gk?P&&(bj(r)?gk.handleWindowTouchEnd(r):gk.handleWindowMouseUp(r)):bj(r)?(w(u,ic,Al),w(u,Wn,Il),w(u,"blur",Il)):(w(u,mo,Vc),w(u,gh,Bn),w(u,"blur",Bn)),gk=J)},getImageMap:function(){return ih},toBoundaries:function(h,P,E,b){var U=[];return Hc(h,P,E,b).forEach(function(E){var r=[];E.forEach(function(L){r.push(L.x,L.y)}),U.push(r)}),U},getCurrentKeyCodeMap:function(){return Go},drawCenterImage:function(n,E,b,e,z,S,C,A){!z&&S&&S.isSelfViewEvent&&(z=S);var k=Bb(E,z,S),v=qh(E,z,S);Pi(n,E,P(b-k/2),P(e-v/2),k,v,z,S,C,A)},drawStretchImage:function(Z,j,W,V,u,r,U,A,Y,b,S,N){!A&&Y&&Y.isSelfViewEvent&&(A=Y);var d,s=Bb(j,A,Y,r),n=qh(j,A,Y,U);"uniform"===W?(d=h(r/s,U/n),s*=d,n*=d,V+=P((r-s)/2),u+=P((U-n)/2),r=s,U=n):"centerUniform"===W&&((s>r||n>U)&&(d=h(r/s,U/n),s*=d,n*=d),V+=P((r-s)/2),u+=P((U-n)/2),r=s,U=n);var T=Z.interactiveInfo;if(T){var C;if(C="center"===W?{x:V+r/2-s/2,y:u+U/2-n/2,width:s,height:n}:{x:V,y:u,width:r,height:U},T.rect){var D=T.compInfos,v=D.length;v&&(D[v-1].rect.image=j)}else T.rect=C}if("center"===W){var B=S!==!1&&(s>r||n>U);B&&(Z.save(),Z.beginPath(),Z.rect(V,u,r,U),Z.clip()),Pi(Z,j,V+r/2-s/2,u+U/2-n/2,s,n,A,Y,b,N),B&&Z.restore()}else Pi(Z,j,V,u,r,U,A,Y,b,N)},toCanvas:function(M,s,l,m,X,d,P,e,y){M=mr(M,P),s=s||Bb(M,X),l=l||qh(M,X);var r=Vq(),w=Xn(r);return e?(Zq(r,s,l,e),w.scale(e,e)):Zq(r,s,l,1),Tc(w,M,m,0,0,s,l,X,d,P,y),M&&M.clampToEdge&&(r.clampToEdge=M.clampToEdge),w.restore(),r},toGrayColor:function(_){if(!_)return _;var A=si(_),s=P(.299*A[0]+.587*A[1]+.114*A[2]);return"rgba("+s+","+s+","+s+","+A[3]/255+")"},createGradientImage:function(I,h,E,j){for(var G=["L",0,0,I,0,1,0,0,1,0,0],y=0,P=Math.min(h.length,E.length);P>y;y++)G.push(E[y],h[y]);var k=H.Default.toCanvas({width:I,height:I,clampToEdge:!0,comps:[{type:"shape",rotation:j||0,points:[0,0,I,0,I,I,0,I],background:"#ffffff",gradientPack:G}]});return k},createElement:function(u,Q,q,m){var T=Y.createElement(u);return sn(T,Q||D.widgetBorder,2),T.style.font=q?q:Bh,m!=f&&(T.value=m),L.onElementCreated&&L.onElementCreated(T),T},containedInView:function(Q,g){var i=kn(g).getBoundingClientRect();return Sj({x:i.left,y:i.top,width:i.width,height:i.height},dg(Q))},isIsolating:function(){return Lj>0},setIsolating:function(S){S?Lj++:Lj--},getMSMap:function(){return ti},stringify:function(D,$,U){var F=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var V=Wo.prototype.toJSON;Wo.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},$=U?0:$==f?2:$;var t=JSON.stringify(D,function(q,n){return"function"==typeof n?"__ht__"+(n.__ht__||n.toString()):$c(n)?_i(n):n instanceof H.List?"__ht__list"+(n.__ht__list||L.stringify(n._as)):n},$);return Date.prototype.toJSON=F,Wo.prototype.toJSON=V,U&&(t=Nc+oo(t)),t},parse:function(F,s){return Vn(F)?F.substr(0,12)!=Nc||(F=wr(F.substr(12)),Vn(F))?(s=s||{},JSON.parse(F,function(G,z){if(Vn(z))if(s.ignoreFunction||"__ht__function"!=z.substr(0,14)){if(!s.ignoreDate&&"__ht__date"==z.substr(0,10))return new Date(cm(z.substr(10)));if("__ht__list"===z.substr(0,10))return new zp(L.parse(z.substr(10)));if(!s.ignoreDataModel&&"__ht__dataModel"===z.substr(0,15)){var u=new Wo;return u.deserialize(L.parse(z.substr(15))),u}}else{var A=z.indexOf("{")+1,r=z.lastIndexOf("}"),o=z.indexOf("(")+1,B=z.indexOf(")");if(A&&r&&o&&B)try{var f=new Function(z.substring(o,B),z.substring(A,r));return f.__ht__=z.substr(6),f}catch(k){throw console.info("=== SyntaxError ===\n",z),k}}return z})):F:F},loadJS:function(N,O){O&&N.push(O);var q=N.shift();if(br(q))N=q.contact(N),L.loadJS(N);else if(fi(q))q(),L.loadJS(N);else if(Vn(q)){var S=Y.createElement("script");S.onload=function(){L.loadJS(N)},S.setAttribute("src",q),Y.getElementsByTagName("head")[0].appendChild(S)}else N.length&&L.loadJS(N)},extendClass:function(_,z){var D=_.prototype;for(var q in z)ti[q]&&ti.hasOwnProperty(q)?ti[q](D,z):D[q]=z[q]},toRoundedCorner:function(){function K(T,m,q){T.x=m.x,T.y=m.e||q,T.z=m.y}var n=new np,y=new np,A=new np,U=new np;return function(z,s){var d,T=0;z.getPoints&&(T=z.getElevation(),z=z.getPoints()),d=z instanceof zp?z:new zp(z);var Y=d.size();if(0>=s)return{points:d};var t=new zp,R=new zp,x=d.get(0);K(n,x,T),t.add(x),R.add(1);for(var S=1;Y>S;S++)if(Y>S+1){var G=d.get(S),g=d.get(S+1);K(y,G,T),K(A,g,T),U.subVectors(n,y).setLength(Math.min(.99*U.length(),s)).add(y),G.e!==E||x.e!==E?t.add({x:U.x,y:U.z,e:U.y}):t.add({x:U.x,y:U.z}),t.add(G),U.subVectors(A,y).setLength(Math.min(.99*U.length(),s)).add(y),G.e!==E||g.e!==E?t.add(x={x:U.x,y:U.z,e:U.y}):t.add(x={x:U.x,y:U.z}),n.copy(U),R.addAll([2,3])}else t.add(d.get(S)),R.add(2);return{points:t,segments:R}}}(),toColorData:si,setCanvas:Zq,createDiv:Rq,createDisabledDiv:sk,createView:Cg,createCanvas:Vq,appendChild:Zg,initContext:Xn,checkLoadingImage:yo,translateAndScale:ji,layout:kq,getPosition:Nb,drawPoints:Ko,drawRoundRect:Jf,drawBorder:Df,setFocus:xg,getter:Ql,setter:fc,isEmptyObject:cc,cameraPriority:function(){var A={skybox:0,main:1e4,top:1e7,infinity:1/0};return b.seal(b.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return A.skybox},set:function(M){if(M>=A.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");A.skybox=Number(M)}},main:{configurable:!1,enumerable:!1,get:function(){return A.main},set:function(Q){if(Q<=A.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(Q>=A.top)throw new RangeError("Main camera must have lower priority than the top camera.");A.main=Number(Q)}},top:{configurable:!1,enumerable:!1,get:function(){return A.top},set:function(E){if(E<=A.main)throw new RangeError("Top camera must have higher priority than the main camera.");A.top=Number(E)}}}))}()},!0),Hi(g,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Zm=L.disabledOpacity,de=L.toolTipDelay,od=L.devicePixelRatio,Po=L.autoMakeVisible,Pp=L.autoHideScrollBar,pk=L.imageGradient,op=L.showToolTip,Dq=L.hideToolTip,Uf=L.dashPattern,Am=L.lineCap,Jm=L.lineJoin,Tk=L.labelColor,th=L.labelSelectColor,Bh=L.labelFont,hj=L.widgetIndent,ip=L.widgetRowHeight,mg=L.widgetHeaderHeight,Ic=L.widgetTitleHeight,gn=L.scrollBarColor,qm=L.scrollBarSize,jq=L.scrollBarTimeout,pn=L.scrollBarMinLength,Qn=L.scrollBarInteractiveSize,Yj=L.zoomIncrement,Jb=L.scrollZoomIncrement,vl=L.pinchZoomIncrement,_r=L.zoomMax,cs=L.zoomMin,dq=L.createObject,Lk=L.preventDefault,eo=L.setImage,mr=L.getImage,fk=L.isImageComplete,Vj=L.drawCenterImage,Tc=L.drawStretchImage,Vi=L.getId,Un=L.callLater,zo=L.cancelLater,Ln=L.sortFunc,ys=L.clone,jk=L.getClass,xo=L.startAnim,Zk=L.brighter,Pd=L.darker,rq=L.drawText,vm=L.getTextSize,zj=L.isLeftButton,Jl=L.isMiddleButton,er=L.isRightButton,Ai=L.getTouchCount,Md=L.isDoubleClick,An=L.isShiftDown,vf=L.isCtrlDown,dg=L.getClientPoint,Oq=L.getPagePoint,Mp=L.getDistance,Db=L.unionPoint,Ie=L.unionRect,Sj=L.containsPoint,tr=L.containsRect,Mg=L.intersectsRect,sj=L.intersection,Kd=L.getWindowInfo,Qd=L.grow,Gm=L.getLogicalPoint,tn=L.getScreenPoint,bg=L.startDragging,bn=L.removeHTML,$e=L.createElement,wo=L.segmentResolution,Yo=L.shapeResolution,bp=L.shapeSide,kl=L.def,Ce=function(D,b,g){kl(K+"."+D,b,g)},Dj=function(_,X){_.childNodes.forEach(function(H){X(H),Dj(H,X)})};Hi(L,{toolTipLabelColor:Tk,toolTipLabelFont:Bh,toolTipBackground:D.toolTipBackground,toolTipShadowColor:Jh,debugTipLabelFont:Bh,debugTipLabelColor:Tk,debugTipBackground:D.toolTipBackground,drawBreakableText:Or,setDevicePixelRatio:function(F){od=L.devicePixelRatio="number"==typeof F?F:qg(u),Dj(Y.body,function(E){var _=E._ht;_&&_._canvas&&(Zq(_._canvas,_.getWidth(),_.getHeight()),_.redraw?_.redraw():_.iv())})},getPosition3dGap:function(){return es()}},!0);var _m=1e-6,_q="undefined"!=typeof Uint16Array?Uint16Array:Array,Qb="undefined"!=typeof Float32Array?Float32Array:Array,ch=function(Z,K,O){var C=[Z[0]-K[0],Z[1]-K[1],Z[2]-K[2]];if(O){var n=Mp(C);n>0&&(C[0]/=n,C[1]/=n,C[2]/=n)}return C},eh=function(){var w="charCodeAt",L=2*(2*zh.length+1);for(var M in u)if(M===K+re[0]+(qf.length+2)){var S=u[M];if(!S)break;for(var c=S.length,j=0;c>j;j++)if(S[j][w](0)===L&&S[j+1]!=f&&S[j+1]===qf[0]&&S[j+2]!=f&&S[j+2][w](0)===L){for(var D=j+3;c>D;D++)if(S[D][w](0)===L){if(0==S[D+1])for(var Q,g=D+2;c>g;g++){if(S[g][w](0)===L){0==S[g-1]&&Q&&(yf=Q.substr(0,Q.length-1));break}Q==f?Q=S[g]:Q+=S[g]}break}break}break}return function(C){return[-C[0],-C[1],-C[2]]}}(),Cl=function(s,r){return 3===s.length?s[0]*r[0]+s[1]*r[1]+s[2]*r[2]:s[0]*r[0]+s[1]*r[1]},ue=function(){var o=new Array(16);return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},ql=ue(),Nd=function(u){var X=new Array(16);return X[0]=u[0],X[1]=u[1],X[2]=u[2],X[3]=u[3],X[4]=u[4],X[5]=u[5],X[6]=u[6],X[7]=u[7],X[8]=u[8],X[9]=u[9],X[10]=u[10],X[11]=u[11],X[12]=u[12],X[13]=u[13],X[14]=u[14],X[15]=u[15],X},Tj=function(s,P){return s[0]=P[0],s[1]=P[1],s[2]=P[2],s[3]=P[3],s[4]=P[4],s[5]=P[5],s[6]=P[6],s[7]=P[7],s[8]=P[8],s[9]=P[9],s[10]=P[10],s[11]=P[11],s[12]=P[12],s[13]=P[13],s[14]=P[14],s[15]=P[15],s},pg=function(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},Vh=function(e,f){var v=e[0],S=e[1],w=e[2];return e[0]=f[0]*v+f[4]*S+f[8]*w+f[12],e[1]=f[1]*v+f[5]*S+f[9]*w+f[13],e[2]=f[2]*v+f[6]*S+f[10]*w+f[14],e},zm=function(M,F){var O=M[0],b=M[1],C=M[2],k=M[3];return M[0]=F[0]*O+F[4]*b+F[8]*C+F[12]*k,M[1]=F[1]*O+F[5]*b+F[9]*C+F[13]*k,M[2]=F[2]*O+F[6]*b+F[10]*C+F[14]*k,M[3]=F[3]*O+F[7]*b+F[11]*C+F[15]*k,M},he=function(){var U,K,m,L,k=mp(Sf[1]+Sf[7]),r=mp(Sf[0]+Sf[3]-Sf[10]),B=mp(Sf[8]+2),q=function(){return K=m.charAt(U),U+=1,K},R=function(){var f="";if(K===B)for(;q();){if(K===B)return q(),f;f+=K}else q()},D=function(){for(;K&&" ">=K;)q()},S=function(){var c,O={};if(K===k){if(q(),D(),K===r)return q(),O;for(;K;){if(c=R(),D(),q(),O[c]=L(),D(),K===r)return q(),O;q(),D()}}};return L=function(){switch(D(),K){case k:return S();default:return R()}},function(A){if(c={},A){var V;if(m=A,U=0,K=" ",V=L(),D(),!K)return V}}}(),ll=function(q,R){if(R){var j=B(R),K=J(R),v=q[4],g=q[5],r=q[6],l=q[7],L=q[8],f=q[9],b=q[10],_=q[11];q[4]=v*K+L*j,q[5]=g*K+f*j,q[6]=r*K+b*j,q[7]=l*K+_*j,q[8]=L*K-v*j,q[9]=f*K-g*j,q[10]=b*K-r*j,q[11]=_*K-l*j}},Th=function(V,x){if(x){var X=B(x),T=J(x),u=V[0],F=V[1],Q=V[2],I=V[3],n=V[8],E=V[9],S=V[10],d=V[11];V[0]=u*T-n*X,V[1]=F*T-E*X,V[2]=Q*T-S*X,V[3]=I*T-d*X,V[8]=u*X+n*T,V[9]=F*X+E*T,V[10]=Q*X+S*T,V[11]=I*X+d*T}},qc=function(v,Z){if(Z){var n=B(Z),i=J(Z),O=v[0],H=v[1],f=v[2],d=v[3],N=v[4],V=v[5],M=v[6],a=v[7];v[0]=O*i+N*n,v[1]=H*i+V*n,v[2]=f*i+M*n,v[3]=d*i+a*n,v[4]=N*i-O*n,v[5]=V*i-H*n,v[6]=M*i-f*n,v[7]=a*i-d*n}},ec=function(g,b,p){return gs(f,p===!1?f:g.getFinalScale3d(),g.getFinalRotation3d(),g.getRotationMode(),g.p3(),f,b)},gs=function(V,s,M,A,B,E,a){return E||(E=ue()),B&&tf(E,B),qe(E,M,A),a&&Tq(E,E,a),s&&Hr(E,s),V&&Tq(E,E,V),E},ej=function(W,U,q){U=cm(U),q=cm(q);var H=this;H.g=W,H._84O=U,H._85O=q,H._70I=!0,H.F=0,H._83O=U+q,H.pen={x:0,y:0}},Wr="lineDashOffset",hh="setLineDash",$p=function(M){for(var F in M)1===F.length&&(Wr=M[F]);return F?1:0},ko=function(g,v,p){return jj(v)?g:g[hh]?(g[hh](v),p&&(g.lineDashOffset=p),g):new ej(g,v[0],v.length>1?v[1]:v[0])},Kh=function(I,$){!jj($)&&I[hh]&&(I[hh](up),I.lineDashOffset=0)};kl(ej,b,{_69I:6,moveTo:function(s,x){var c=this,G=c.pen;G.x=s,G.y=x,c.g.moveTo(s,x),c.start||(c.start={x:s,y:x})},lineTo:function(x,b){var f=this,g=f.pen,d=x-g.x,D=b-g.y,F=ts(D,d),G=J(F),m=B(F),n=f._23O(g.x,g.y,x,b),H=f._85O,X=f._84O,h=f._83O;if(f.F){if(f.F>n)return f._70I?f._72I(x,b):f.moveTo(x,b),f.F-=n,void 0;if(f._70I?f._72I(g.x+G*f.F,g.y+m*f.F):f.moveTo(g.x+G*f.F,g.y+m*f.F),n-=f.F,f.F=0,f._70I=!f._70I,!n)return}var W=j(n/h);if(W){for(var w=G*X,Q=m*X,S=G*H,L=m*H,P=0;W>P;P++)f._70I?(f._72I(g.x+w,g.y+Q),f.moveTo(g.x+S,g.y+L)):(f.moveTo(g.x+S,g.y+L),f._72I(g.x+w,g.y+Q));n-=h*W}f._70I?n>X?(f._72I(g.x+G*X,g.y+m*X),f.moveTo(x,b),f.F=H-(n-X),f._70I=!1):(f._72I(x,b),n===X?(f.F=0,f._70I=!f._70I):(f.F=X-n,f.moveTo(x,b))):n>H?(f.moveTo(g.x+G*H,g.y+m*H),f._72I(x,b),f.F=X-(n-H),f._70I=!0):(f.moveTo(x,b),n===H?(f.F=0,f._70I=!f._70I):f.F=H-n)},quadraticCurveTo:function(v,t,I,p){var n,D=this,M=D.pen,k=M.x,i=M.y,E=D._22O(k,i,v,t,I,p),r=0,d=0,X=D._85O,h=D._84O;if(D.F){if(D.F>E)return D._70I?D._71I(v,t,I,p):D.moveTo(I,p),D.F-=E,void 0;if(r=D.F/E,n=D._20O(k,i,v,t,I,p,r),D._70I?D._71I(n[2],n[3],n[4],n[5]):D.moveTo(n[4],n[5]),D.F=0,D._70I=!D._70I,!E)return}var Y=E-E*r,w=j(Y/D._83O),e=h/E,J=X/E;if(w)for(var T=0;w>T;T++)D._70I?(d=r+e,n=D._21O(k,i,v,t,I,p,r,d),D._71I(n[2],n[3],n[4],n[5]),r=d,d=r+J,n=D._21O(k,i,v,t,I,p,r,d),D.moveTo(n[4],n[5])):(d=r+J,n=D._21O(k,i,v,t,I,p,r,d),D.moveTo(n[4],n[5]),r=d,d=r+e,n=D._21O(k,i,v,t,I,p,r,d),D._71I(n[2],n[3],n[4],n[5])),r=d;Y=E-E*r,D._70I?Y>h?(d=r+e,n=D._21O(k,i,v,t,I,p,r,d),D._71I(n[2],n[3],n[4],n[5]),D.moveTo(I,p),D.F=X-(Y-h),D._70I=!1):(n=D._19O(k,i,v,t,I,p,r),D._71I(n[2],n[3],n[4],n[5]),E===h?(D.F=0,D._70I=!D._70I):(D.F=h-Y,D.moveTo(I,p))):Y>X?(d=r+J,n=D._21O(k,i,v,t,I,p,r,d),D.moveTo(n[4],n[5]),n=D._19O(k,i,v,t,I,p,d),D._71I(n[2],n[3],n[4],n[5]),D.F=h-(Y-X),D._70I=!0):(D.moveTo(I,p),Y===X?(D.F=0,D._70I=!D._70I):D.F=X-Y)},bezierCurveTo:function(){var R=arguments;this.pen={x:R[4],y:R[5]},this.g.bezierCurveTo(R[0],R[1],R[2],R[3],R[4],R[5])},arc:function(O,m,_,z,P,C){C||(z=-z,P=-P),gm(this,O,m,z,P-z,_,_,!1)},rect:function(q,B,D,A){var L=this;L.pen={x:q,y:B},L.moveTo(q,B),L.lineTo(q,B+A),L.lineTo(q+D,B+A),L.lineTo(q+D,B),L.lineTo(q,B)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(d,Q,U,K){var E=U-d,Z=K-Q;return G(E*E+Z*Z)},_22O:function(T,x,N,v,$,M,i){for(var l,q,d,L,h,C,m,P=0,z=T,J=x,j=i>0?i:this._69I,o=1;j>=o;o++)d=o/j,L=1-d,h=L*L,C=2*d*L,m=d*d,l=h*T+C*N+m*$,q=h*x+C*v+m*M,P+=this._23O(z,J,l,q),z=l,J=q;return P},_21O:function(y,N,K,q,d,H,n,T){var V=this;if(0===n)return V._20O(y,N,K,q,d,H,T);if(1===T)return V._19O(y,N,K,q,d,H,n);var j=V._20O(y,N,K,q,d,H,T);return j.push(n/T),V._19O.apply(V,j)},_20O:function($,X,T,g,f,Y,M){if(1!==M){var F=T+(f-T)*M,B=g+(Y-g)*M;T=$+(T-$)*M,g=X+(g-X)*M,f=T+(F-T)*M,Y=g+(B-g)*M}return[$,X,T,g,f,Y]},_19O:function(G,q,W,H,C,x,U){if(1!==U){var b=G+(W-G)*U,K=q+(H-q)*U;W+=(C-W)*U,H+=(x-H)*U,G=b+(W-b)*U,q=K+(H-K)*U}return[G,q,W,H,C,x]},_72I:function(k,f){var Z=this.pen;(k!==Z.x||f!==Z.y)&&(Z.x=k,Z.y=f,this.g.lineTo(k,f))},_71I:function(K,D,r,P){var j=this.pen;(K!==r||D!==P||r!==j.x||P!==j.y)&&(j.x=r,j.y=P,this.g.quadraticCurveTo(K,D,r,P))}}),ti.ms_quickVisible=function(a){a._4BQ=!1,a._4CQ=function(_){var h=_._4EQ;return h!==E?h:h=_._4EQ=this._4FQ(_)},a._4DQ=function(K){if(!K)return this.dm().each(function(b){b._4EQ=E}),void 0;K._4EQ=E;var Q=this;if(K instanceof If||Zd(K)||K instanceof Wb||K.ISubGraph)K.eachChild(function(R){Q.invalidateQuickVisible(R)});else if(K.getEdges){var X=K.getEdges();X&&X.each(function(R){Q.invalidateQuickVisible(R)})}},a.enableQuickVisibleMode=function(){this._4BQ||(this._4BQ=!0,this._4FQ=this.isVisible,this.isVisible=this._4CQ,this.invalidateQuickVisible=this._4DQ)},a.disableQuickVisibleMode=function(){this._4BQ&&(this._4BQ=!1,this.isVisible=this._4FQ,this.invalidateQuickVisible=vi)},a.isQuickVisibleMode=function(){return this._4BQ},a.invalidateQuickVisible=vi},ne=ml()+1,wh&&u.console&&ne&&!1&&(u.navigator&&u.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?u.console.log.apply(console,["Hightopo - Version："+H.Default.getVersion()+" - %cTrial：http://hightopo.com/request.html","color: #f00;"]):u.console.log("Hightopo - Version："+H.Default.getVersion()+" - Trial：http://hightopo.com/request.html"));var Wj=f,eg=f,Nh=L.checkLoadingCompType=function(K){Wj&&!K._72O_&&(eg||(eg={}),eg[K._72O_=Vi()]=K)},rp=function(t,R){if(R||(R=t),R&&(Wj||(Wj={}),!Wj[t])){var q=new yk;if(Wj[R]={request:q,url:R},R=L.beforeLoadURL(R,t),R.data){var c=L.parse(R.data);$h(t,c),L.handleCompTypeLoaded(t,c)}else{q.onload=function(){if(200===this.status||0===this.status){var S=L.parse(q.getResponseText());$h(t,S),L.handleCompTypeLoaded(t,S)}else $h(t,f)},q.onerror=function(){$h(t,f)};var m={};m.url=encodeURI(R),m.sync=!1,q.send(m)}}},$h=function(x,m){if(ee[x]=m,delete Wj[x],cc(Wj)&&(Wj=f,eg)){for(var W in eg){var Z=eg[W];Z.invalidateAll&&Z.invalidateAll(E,"compTypeLoaded",x),Z.redraw&&Z.redraw(),Z.iv(),delete Z._72O_}eg=f}if(m&&eg)for(var W in eg){var Z=eg[W];Z.invalidateAll&&Z.invalidateAll(E,"compTypeLoading",x),Z.redraw&&Z.redraw(),Z.iv()}},ep=D.chart,Xg="",yp=!0,Bo=L.compStack=[],Cn=/^style@/,zf=/^attr@/,Vo=/^field@/,Kn={x:.5,y:.5},Zp=function(){yp=!0},kr=function(){return yp},_l=function(d,x,z){if(!d)return!1;var P;return z&&z.isImageFitSize&&(P=z.isImageFitSize(x,d)),P==f&&(P=kh(d.fitSize,x,z)),P},Bb=function(M,h,$,G){if(!M)return 0;if(_l(M,h,$)&&G)return G;var R=kh(M.width,h,$);return null==R?20:R},qh=function(Y,Q,A,m){if(!Y)return 0;if(_l(Y,Q,A)&&m)return m;var B=kh(Y.height,Q,A);return null==B?20:B},kh=function(A,j,W){if(!A||!A.func)return A;var N,r=A.func,x=A.value;return N=fi(r)?W&&W.vectorDataBindingDisabled&&!A.isSafeFunc?x:r(j,W):j instanceof rd||(H.ui?j instanceof H.ui.View:0)?zf.test(r)?j.a(Xg+r.slice(5)):Cn.test(r)?j.s(Xg+r.slice(6)):Vo.test(r)?j[r.slice(6)]:j[r]?j[r](W):x:x,x!==E&&N==f?x:N},Pi=L.drawImage=function(){var s,U,I,t,w,X,K=3,V=6,O=function(q,C){q.getValue&&q.getValue.compType===C||(q.getValue=function(u){var Z=r(q,u);if(Z===E&&C.properties){var H=C.properties[u];H&&(Z=H.defaultValue)}return Z},q.getColor=function(D,_){return _===!0?v(D):v(q.getValue(D))},q.getValue.compType=C)},r=function(v,L,$){var Y,u=!1;if(v.prefix&&U instanceof rd){var t=U.a(Xg+L);t!==E&&(u=!0,Y=t)}return Y===E&&(Y=v[L]),Y&&Y.func&&(u=!0,Y=kh(Y,U,I)),$&&(Y=$(Y),u||(v[L]=Y)),Y},v=function(_,B){var j;return j=B?r(_,B):_,s&&s.compGray&&j?L.toGrayColor(j):w&&j?Fm(j,w,X):j},P=function(S){if(br(S)){for(var B=new zp,u=S.length,K=0;u>K;K+=2)B.add({x:S[K],y:S[K+1]});S=B}return S},Z=function(g){var J=r(g,"anchorX"),O=r(g,"anchorY");if(J!==E||O!==E)return{x:J===E?Kn.x:J,y:O===E?Kn.y:O};var s=r(g,"type"),y=r(g,"name");if("image"!==s||!y)return Kn;var S=mr(y);return S&&S.anchorX!==E&&S.anchorY!==E?{x:S.anchorX,y:S.anchorY}:Kn},A=function(f,E){var A=r(f,Bj),F=Z(f);if(br(A)){var G=A.length,m=r(f,"relative"),z=E.width,_=E.height;if(4===G)A={x:A[0],y:A[1],width:A[2],height:A[3]},m&&(A.x*=z,A.y*=_,A.width*=z,A.height*=_);else if(3===G){var k=A[0];A={width:A[1],height:A[2]},m&&(A.width*=z,A.height*=_),"object"==typeof k?k.length&&(k={x:k[0],y:k[1]}):k=Nb(k,E,A),A.x=k.x-A.width*F.x,A.y=k.y-A.height*F.y}A.x+=r(f,"offsetX")||0,A.y+=r(f,"offsetY")||0,!m&&E.fitSize&&(A=x(f,A,E))}return A},x=function(j,E,c){if(E){var a,Q,W,N={x:E.x,y:E.y,width:E.width,height:E.height},Y=Z(j),K=r(j,"layoutH"),V=r(j,"layoutV"),U=1,q=1,T=0,d=0,S=1,l=1;switch(K){case"left":break;case"right":N.x+=c.width-c.rw;break;case"center":N.x+=.5*(c.width-c.rw);break;case"scale":case"leftright":default:a=r(j,ve)||0,a&&(T=Math.abs(d=Math.sin(a)),S=Math.abs(l=Math.cos(a))),"leftright"!==K?(U+=S*(c.widthScale-1),q+=T*(c.widthScale-1)):(U+=N.width?S*(c.width-c.rw)/N.width:0,q+=N.height?T*(c.width-c.rw)/N.height:0,Q=-Math.min(-Y.x*l+Y.y*d,-Y.x*l-(1-Y.y)*d,(1-Y.x)*l+Y.y*d,(1-Y.x)*l-(1-Y.y)*d))}switch(V){case"top":break;case"bottom":N.y+=c.height-c.rh;break;case"center":N.y+=.5*(c.height-c.rh);break;case"scale":case"topbottom":default:a==f&&(a=r(j,ve),a&&(T=Math.abs(d=Math.sin(a)),S=Math.abs(l=Math.cos(a)))),"topbottom"!==V?(U+=T*(c.heightScale-1),q+=S*(c.heightScale-1)):(U+=N.width?T*(c.height-c.rh)/N.width:0,q+=N.height?S*(c.height-c.rh)/N.height:0,W=-Math.min(-Y.x*d-Y.y*l,-Y.x*d+(1-Y.y)*l,(1-Y.x)*d-Y.y*l,(1-Y.x)*d+(1-Y.y)*l))}return(1!==U||1!==q)&&("scale"!==K&&K?"leftright"===K&&(N.x+=N.width*(1-U)*Y.x+Q*(c.width-c.rw)):N.x+=N.x*(c.widthScale-1)+Y.x*N.width*(c.widthScale-U),"scale"!==V&&V?"topbottom"===V&&(N.y+=N.height*(1-q)*Y.y+W*(c.height-c.rh)):N.y+=N.y*(c.heightScale-1)+Y.y*N.height*(c.heightScale-q),N.width*=U,N.height*=q),N.width<0&&(N.width=0),N.height<0&&(N.height=0),N}},y=function(O){return br(O)?new zp(O):O},$=function(P,W,D,n,k,$,C){var R=s.interactiveInfo,X=P.transform;if(X)return s.save(),s.setTransform(X.a,X.b,X.c,X.d,X.tx,X.ty),R&&R.compInfos.push({comp:P,rect:W,matrix:X.clone(),prefix:Xg,refRect:R.refRect}),!0;k===E&&(k=1),$===E&&($=1);var I=r(P,"clipPercentage"),v=nk(D,W);if(v&&!n&&1===k&&1===$&&I==E)return R&&R.compInfos.push({comp:P,rect:W,matrix:R.matrix.clone(),prefix:Xg,refRect:R.refRect}),!1;C=C||Kn;var Y=W.x+W.width*C.x,U=W.y+W.height*C.y,Z=D.x+D.width*C.x,T=D.y+D.height*C.y,B=D.width?k*(W.width/D.width):1,w=D.height?$*(W.height/D.height):1;if(s.save(),R&&(R.matrix.appendTranslate(Y,U).appendRotate(n).appendScale(B,w).appendTranslate(-Z,-T),R.compInfos.push({comp:P,rect:W,matrix:R.matrix.clone(),prefix:Xg,refRect:R.refRect})),rn(s,Y,U),bo(s,n||0),wj(s,B,w),rn(s,-Z,-T),I!=E){var a=jg(D,r(P,"clipDirection"),I);s.beginPath(),s.rect(a.x,a.y,a.width,a.height),s.clip()}return!0},C=function(){s.restore()},M=function(B,b,V){var G=r(B,"path"),I=r(B,ve),q=r(B,"scaleX"),e=r(B,"scaleY"),K=Z(B),y=f,W=gc(null,G);if(V||(V=B.unionRect,V||(V=Db(W),B.path.func||(B.unionRect=V)),y=V),V){y||(y=B.unionRect,y||(y=Db(W),B.path.func||(B.unionRect=y)));var o=$(B,V,y,I,q,e,K),M=r(B,"borderPattern"),D=ko(s,M),p=v(B,"background"),u=v(B,"borderColor"),A=r(B,"borderWidth"),h=r(B,"gradient"),Q=v(B,"gradientColor"),J=r(B,"border3d"),E=v(B,"border3dColor"),T=r(B,"border3dAccuracy"),Y=s.lineJoin,g=s.lineCap;s.lineJoin=r(B,"borderJoin")||Jm,s.lineCap=r(B,"borderCap")||Am,p?(Le(s,p,h,Q,y),gc(s,G),s.fill(),D!==s&&gc(s,G)):gc(s,G);var X=r(B,"borderWidthAbsolute");if(X&&(s.save(),s.setTransform(1,0,0,1,0,0)),A&&u&&(s.lineWidth=A,s.strokeStyle=u,s.stroke(),J&&El(s,u,E,A,t,T)),Kh(s,M),r(B,"dash")){var i=r(B,"dashWidth")||A;if(i>0){M=r(B,"dashPattern")||Uf;var D=ko(s,M,r(B,"dashOffset")),U=v(B,"dashColor")||v(pp);D!==s&&gc(s,G),s.strokeStyle=U,s.lineWidth=i,s.stroke(),r(B,"dash3d")&&El(s,U,v(B,"dash3dColor"),i,t,r(B,"dash3dAccuracy")),Kh(s,M)}}X&&s.restore(),b===Bj&&Sp(s,p,r(B,"depth"),y),s.lineJoin=Y,s.lineCap=g,o&&C()}},T=function(V,l,q,Y){var T=r(V,we,P),H=r(V,ve),G=Z(V);if(T&&Y.fitSize){var D=new zp,R=Db(T),F=x(V,R,Y),K=R.x+G.x*R.width,g=R.y+G.y*R.height,Q=F.x+G.x*F.width,z=F.y+G.y*F.height,k=R.width?F.width/R.width:1,m=R.height?F.height/R.height:1;T.each(function(I){D.add({x:Q+(I.x-K)*k,y:z+(I.y-g)*m})}),T=D,V.unionRect=null}var S=r(V,"scaleX"),o=r(V,"scaleY"),B=l===pc,e=f;if(!q&&B&&(q=V.unionRect,q||(q=Db(T),V.points.func||(V.unionRect=q)),e=q),q){B?e||(e=V.unionRect,e||(e=Db(T),V.points.func||(V.unionRect=e))):e=q;var M,i,d,b,L=$(V,q,e,H,S,o,G),n=r(V,"borderPattern"),c=ko(s,n),N=v(V,"background"),h=mr(r(V,"repeatImage"),w,X),O=r(V,"gradientPack"),j=r(V,"borderGradientPack"),p=v(V,"borderColor"),u=r(V,"borderWidth"),A=mr(r(V,"borderRepeatImage"),w,X),W=r(V,"segments",y),_=r(V,"gradient"),a=v(V,"gradientColor"),J=r(V,"border3d"),mh=v(V,"border3dColor"),Fg=r(V,"border3dAccuracy"),Sr=r(V,"closePath"),Yf=r(V,"fillRule")||"nonzero",_f=s.lineJoin,$i=s.lineCap;if(s.lineJoin=r(V,"borderJoin")||Jm,s.lineCap=r(V,"borderCap")||Am,B)if(N||h||O){var bl=r(V,"fillClipPercentage");if(bl!=E){var jj=jg(e,r(V,"fillClipDirection"),bl);s.save(),s.beginPath(),s.rect(jj.x,jj.y,jj.width,jj.height),s.clip()}Ko(s,T,W,Sr),O?Lf(s,O,v,!1,q):h?mn(s,h,w,X,U,I):Le(s,N,_,a,e),s.fill(Yf),O&&s.restore(),bl!=E&&s.restore(),c!==s&&Ko(c,T,W,Sr)}else Ko(c,T,W,Sr);else if("roundRect"===l?M=r(V,"cornerRadius"):"polygon"===l?(M=r(V,"polygonSide"),i=r(V,"cornerRadius"),d=r(V,"regular")):"arc"===l&&(M=r(V,"arcFrom"),i=r(V,"arcTo"),d=r(V,"arcClose"),b=r(V,"arcOval")),N||h||O){var bl=r(V,"fillClipPercentage");if(bl!=E){var jj=jg(e,r(V,"fillClipDirection"),bl);s.save(),s.beginPath(),s.rect(jj.x,jj.y,jj.width,jj.height),s.clip()}Dg(s,l,e,M,i,d,b),O?Lf(s,O,v,!1,q):h?mn(s,h,w,X,U,I):Le(s,N,_,a,e),s.fill(Yf),O&&s.restore(),bl!=E&&s.restore(),s!==c&&Dg(c,l,e,M,i,d,b)}else Dg(c,l,e,M,i,d,b);var Dh=r(V,"borderWidthAbsolute");if(Dh&&(s.save(),s.setTransform(1,0,0,1,0,0)),u&&(p||A||j)&&(s.lineWidth=u,j?Lf(s,j,v,!0,q):A?Ck(s,A,w,X,U,I):s.strokeStyle=p,s.stroke(),j&&s.restore(),J&&El(s,p,mh,u,t,Fg)),Kh(s,n),r(V,"dash")){var Te=r(V,"dashWidth")||u;if(Te>0){n=r(V,"dashPattern")||Uf;var c=ko(s,n,r(V,"dashOffset")),$j=v(V,"dashColor")||v(pp);c!==s&&(B?Ko(c,T,W,Sr):Dg(c,l,e,M,i,d,b)),s.strokeStyle=$j,s.lineWidth=Te,s.stroke(),r(V,"dash3d")&&El(s,$j,v(V,"dash3dColor"),Te,t,r(V,"dash3dAccuracy")),Kh(s,n)}}Dh&&s.restore(),l===Bj&&Sp(s,N,r(V,"depth"),e),s.lineJoin=_f,s.lineCap=$i,L&&C()}},z=function(S,O){var j=w||r(S,lr),c=X||r(S,"blendMode"),e=r(S,"name"),d=mr(e,j,c);d&&d.cacheRule!=f&&(d=Yl(s,d,r(S,"stretch"),O.width,O.height,U,I,j)),d?Tc(s,d,r(S,"stretch"),O.x,O.y,O.width,O.height,U,I,j,null,c):yp=!1},Y=function(H,z){var c=r(H,"text");if(c!=f){c+="";var t,E=r(H,"gradientPack"),e=r(H,"gradient"),G=v(H,"gradientColor"),X=r(H,"font"),W=r(H,"vertical"),P=r(H,"verticalGap")||0,$=r(H,"align"),Z=r(H,"vAlign"),V=r(H,"decoration"),C=r(H,"letterGap")||0,R=r(H,"wrap"),h=r(H,"borderWidth"),x=r(H,"borderColor"),Q=vm(X,c);if(E?(t=Lf(s,E,v,!1,z),s.restore()):t=v(H,lr),!E&&e&&(t=L.createGradient(s,e,t||L.labelColor,G||D.imageGradient,z.x,z.y,z.width,z.height)),h&&br(x)&&(x=Lf(s,x,v,!1,z),s.restore()),W){null==P&&(P=1);var N,g,F,A=[],K=[];N=R?fl(c,z.height,X,C,W,P):[c],s.textBaseline=Fc,s.font=X,N.forEach(function(_){for(var I=_.length,n=0,X=(I-1)*P,f=0;I>f;f++){var Y=s.measureText(_[f]);A.push(Y),X+=Y.fontBoundingBoxDescent||Q.height,n=p(n,Y.width)}K.push({width:n,height:X})});var B=(N.length-1)*C;K.forEach(function(A){B+=A.width}),g=$&&$!==re?$===ln?z.x+z.width-B:z.x+(z.width-B)/2:z.x;var U=0;N.forEach(function(I,j){var n=K[j],d=I.length;F=Z&&Z!==aj?Z===Fc?z.y:z.y+z.height-n.height:z.y+(z.height-n.height)/2;for(var N=0;d>N;N++){var T=I[N],f=A[U],Y=f.fontBoundingBoxDescent||Q.height;vb(s,T,X,t,{x:g,y:F,width:n.width,height:Y},bb,Z,V,C,h,x),F+=Y+P,U++}g+=n.width+C})}else{var N=R?fl(c,z.width,X,C,W,P):c.split("\n"),u=N.length;if(u>1){var o=vm(X,c),k=o.height,y=u*k+P*(u-1),m=ys(z);return Z&&Z!==aj?Z===ab&&(m.y=z.y+z.height-y):m.y=z.y+(z.height-y)/2,m.height=y,Or(s,N,m,X,t,$||re,V,C,h,x),void 0}vb(s,c,X,t,z,$,Z,V,C,h,x)}}},g=function(y,J){Df(s,v(y,lr),J.x,J.y,J.width,J.height,r(y,"width"))},N=function(F,v){var q=r(F,nl),n=0;if(q&&(q.forEach(function(O){n+=O}),n>0)){for(var N=r(F,"colors")||ep,O=r(F,"startAngle")||0,u=r(F,"hollow"),P=r(F,oc),k=r(F,vh),Z=r(F,Cr),g=P?new zp:f,x=v.x,S=v.y,a=v.width,K=v.height,T=x+a/2,e=S+K/2,i=h(a,K)/2,t=0,z=0;z<q.length;z++){var X=q[z],D=_*X/n,H=O+D;if(s.fillStyle=N[t++],t===N.length&&(t=0),s.beginPath(),u){var I=T+J(O)*i/2,L=e+B(O)*i/2,V=T+J(H)*i,b=e+B(H)*i;s.moveTo(I,L),s.arc(T,e,i/2,O,H,!1),s.lineTo(V,b),s.arc(T,e,i,H,O,!0)}else s.moveTo(T,e),s.arc(T,e,i,H,O,!0);g&&(D=(O+H)/2,g.add({text:fi(P)?P(X,z,n,U):X,x:T+.75*J(D)*i,y:e+.75*B(D)*i})),s.closePath(),s.fill(),O=H}g&&g.each(function(P){rq(s,P.text,k,Z,P.x,P.y,0,0,bb)})}},S=function(S,T){var w=r(S,sf);if(w&&w.length>0){var Z=w.length,Q=r(S,oc),H=r(S,vh),n=r(S,Cr),K=Q?new zp:f,L=r(S,"minValue")||0,t=r(S,"maxValue");if(t==f&&(t=0,w.forEach(function(Z){r(Z,nl).forEach(function(v){t=p(t,v)})})),L===t)return;for(var q=T.height/(t-L),g=T.y+t*q,$=r(w[0],nl).length,O=T.width/(3*$+1),A=2*O/Z,d=0,z=0;Z>z;z++)for(var e=w[z],j=r(e,lr),m=r(e,"colors"),l=r(e,nl),J=0;$>J;J++){m?s.fillStyle=m[J]:j?s.fillStyle=j:(s.fillStyle=ep[d++],d===ep.length&&(d=0));var P=l[J],u=P*q,R=T.x+(1+3*J)*O+z*A;if(Nj(s,R,g-u,A,u),K){var h=fi(Q)?Q(P,J,e,U):P,D=vm(H,h).height;K.add({x:R,y:g-u-D,width:A,height:D,text:h})}}K&&K.each(function(r){rq(s,r.text,H,n,r.x,r.y,r.width,r.height,bb)})}},G=function(v,P){var O=r(v,sf);if(O&&O.length>0){var h=O.length,d=r(O[0],nl).length,o=P.width/(3*d+1),F=0,R=r(v,"maxValue"),T=r(v,oc),a=r(v,vh),q=r(v,Cr),n=T?new zp:f;if(R==f){R=0;for(var w=0;d>w;w++){for(var K=0,t=0;h>t;t++)K+=r(O[t],nl)[w];R=p(R,K)}}if(R>0){for(var w=0;d>w;w++)for(var Z=P.y+P.height,t=0;h>t;t++){var g=O[t],X=r(g,lr),_=r(g,nl)[w],N=_/R*P.height;X?s.fillStyle=X:(s.fillStyle=ep[F++],F===ep.length&&(F=0)),Z-=N;var k={x:P.x+(1+3*w)*o,y:Z,width:2*o,height:N};Nj(s,k.x,k.y,k.width,k.height),n&&(k.text=fi(T)?T(_,w,g,U):_,n.add(k))}n&&n.each(function(e){rq(s,e.text,a,q,e.x,e.y,e.width,e.height,bb)})}}},W=function(_,i){var N=r(_,sf);if(N&&N.length>0){for(var T=N.length,A=r(N[0],nl).length,B=i.width/(3*A+1),J=0,t=r(_,oc),P=r(_,vh),G=r(_,Cr),Y=t?new zp:f,M=0;A>M;M++){for(var D=0,I=0;T>I;I++)D+=r(N[I],nl)[M];if(D>0){var Q=i.y+i.height;for(I=0;T>I;I++){var V=N[I],c=r(V,lr),X=r(V,nl)[M],H=X/D*i.height;c?s.fillStyle=c:(s.fillStyle=ep[J++],J===ep.length&&(J=0)),Q-=H;var u={x:i.x+(1+3*M)*B,y:Q,width:2*B,height:H};Nj(s,u.x,u.y,u.width,u.height),Y&&(u.text=fi(t)?t(X,M,V,U):X,Y.add(u))}}}Y&&Y.each(function(t){rq(s,t.text,P,G,t.x,t.y,t.width,t.height,bb)})}},l=function(c,B){var q=r(c,sf);if(q&&q.length>0){var y=q.length,W=r(c,"minValue")||0,X=r(c,"maxValue");if(X==f&&(X=0,q.forEach(function(v){r(v,nl).forEach(function(j){X=p(X,j)})})),W===X)return;for(var o=B.height/(X-W),F=B.y+X*o,D=r(q[0],nl).length,L=B.width/(3*D+1),$=0,x=r(c,"lineWidth")||2,n=r(c,"line3d"),V=r(c,"linePoint"),Z=r(c,oc),g=r(c,vh),i=r(c,Cr),P=0;y>P;P++){var N=q[P],l=r(N,lr),R=r(N,nl);l?s.strokeStyle=l:(l=s.strokeStyle=ep[$++],$===ep.length&&($=0)),s.beginPath();for(var C=0;D>C;C++){var z=B.x+(2+3*C)*L,u=F-R[C]*o;0===C?s.moveTo(z,u):s.lineTo(z,u)}if(s.lineWidth=x,s.stroke(),n&&El(s,l,f,x,t),V||Z){var S,a=x/2+2;for(C=0;D>C;C++){var Q=R[C];if(z=B.x+(2+3*C)*L,u=F-Q*o,fi(V)?V(s,z,u,l,C,N,U):V&&(s.fillStyle=l,s.beginPath(),s.arc(z,u,a,0,_,!0),s.fill()),fi(Z)?S=Z(Q,C,N,U):Z&&(S=Q),S){var j=vm(g,S).height,v=s.shadowBlur;
if(v){var T=s.shadowOffsetX,m=s.shadowOffsetY,A=s.shadowColor;s.shadowOffsetX=0,s.shadowOffsetY=0,s.shadowBlur=0,s.shadowColor=f}rq(s,S,g,i,z,u-j-a+2,0,j,bb),v&&(s.shadowOffsetX=T,s.shadowOffsetY=m,s.shadowBlur=v,s.shadowColor=A)}}}}}},q=function(b){s=b[0],U=b[1],I=b[2],t=b[3],w=b[4],X=b[5]},n=function(){return[s,U,I,t,w,X]},F=function(w,z){var _;I&&I.getDrawableState?_=I.getDrawableState(U):I&&I.getState?_=I.getState(U):(_=U instanceof rd?U.s(sg):null,(_===E||null===_)&&(_=r(w,sg)));var A=r(z,sg);return A!==E&&null!==A&&A!==_?!1:r(z,Xh)},b={border:g,image:z,text:Y,pieChart:N,columnChart:S,stackedColumnChart:G,percentageColumnChart:W,lineChart:l};return function(d,c,Y,N,g,D,B,W,l,z){if(c&&g&&D){var x=n();s=d,U=B,I=W,!U&&I&&I.isSelfViewEvent&&(U=I),t=I?I._zoom?I._zoom:1:1,w=l,X=z;var o=g,_=D;if(ym()){var j,G,a,p,R,k;0===s[vk]?ym[0]&&(j=!0):j=!0,s.texureImage2D?ym[1]&&(G=!0):G=!0,s.texureImage3D?ym[2]&&(a=!0):a=!0,s.drawDNDState?ym[3]&&(R=!0):R=!0,H[We[1]+Co[0]+uo[1]]?ym[Co[0]]&&(k=!0):k=!0,Aq.widget[0]?ym[4]&&(p=!0):p=!0,j&&G&&a&&p&&R&&k&&(o=Y,_=N)}if(c.tagName)return Vn(yf)&&!u[yf]||s.drawImage(c,o,_,g,D),q(x),void 0;if(0==r(c,"visible"))return q(x),void 0;w||(w=kh(c.color,U,I)),z||(X=kh(c.blendMode,U,I)),Vn(yf)&&!u[yf]&&(g=o,D=_);var S=Bb(c,U,I,g),h=qh(c,U,I,D),Q={x:0,y:0,width:S,height:h,fitSize:_l(c,U,I)},i=r(c,"clip"),e=r(c,"opacity");if(Q.fitSize){var J=Q.rw=kh(c.width,U,I)||20;Q.widthScale=S/J;var m=Q.rh=kh(c.height,U,I)||20;Q.heightScale=h/m}if(s.save(),s.interactiveInfo){var ui=s.interactiveInfo.matrix,zj=ui.clone();ui.appendTranslate(o,_).appendScale(g/S,D/h),s.interactiveInfo.refRect=Q}rn(s,o,_),(S!==g||h!==D)&&s.scale(g/S,D/h),i&&(fi(i)?i(s,S,h,U,I,c):(s.beginPath(),s.rect(0,0,S,h),s.clip())),e!=f&&(s.globalAlpha*=e),r(c,"comps").forEach(function(e){if(e.prefix){var m=Xg,X=kh(e.prefix,U,I);X&&(Xg=Xg+X+".")}if(0==F(c,e))return e.prefix&&(Xg=m),void 0;if(Bo.splice(0,0,e),s.interactiveInfo)var h=s.interactiveInfo.matrix.clone();var d=r(e,"opacity"),u=r(e,"shadow"),q=r(e,"type"),g=r(e,"refRect")||Q,j=A(e,g);if(d!=f){var n=s.globalAlpha;s.globalAlpha*=d}if(u){var J=t*L.devicePixelRatio,o=s.shadowOffsetX,k=s.shadowOffsetY,W=s.shadowBlur,R=s.shadowColor,p=r(e,"shadowOffsetX"),i=r(e,"shadowOffsetY"),Y=r(e,"shadowBlur"),S=v(e,"shadowColor");s.shadowOffsetX=(p==f?K:p)*J,s.shadowOffsetY=(i==f?K:i)*J,s.shadowBlur=(Y==f?V:Y)*J,s.shadowColor=S||v(to)}if("save"===q)s.save();else if("endClip"===q||"restore"===q)s.restore();else if("clip"===q)s.save(),Ko(s,r(e,"points",P),r(e,"segments",y),!0),s.clip();else if(Je[q]){if(j=j||{x:0,y:0,width:g.width,height:g.height},T(e,q,j,g),e.prefix&&0===e.prefix.indexOf("ui.")&&I&&H.ui&&I instanceof H.ui.View){I._vectorCompInfo||(I._vectorCompInfo=[]);for(var G=!1,x=0;x<I._vectorCompInfo.length;x++){var N=I._vectorCompInfo[x];if(e.prefix===N.comp.prefix&&B===N.data){I._vectorCompInfo[x]={comp:e,type:q,rect:j,compRefRect:g,data:B,image:c,transform:s.getTransform()},G=!0;break}}G||I._vectorCompInfo.push({comp:e,type:q,rect:j,compRefRect:g,data:B,image:c,transform:s.getTransform()})}}else if(q===pc)T(e,q,j,g);else if("SVGPath"===q)M(e,q,j);else{j=j||{x:0,y:0,width:g.width,height:g.height};var l=r(e,ve),D=r(e,"scaleX"),z=r(e,"scaleY"),a=Z(e),_=$(e,j,j,l,D,z,a);if(fi(q))O(e,q),L.drawCompType(q,s,j,e,U,I);else if(L.getCompType(q)){var w=L.getCompType(q),Zl=w.func||w;O(e,w),L.drawCompType(Zl,s,j,e,U,I)}else b[q]?b[q](e,j):L.getCompType(q)===E&&Cs.test(q)&&(rp(q),yp=!1);_&&C()}u&&(s.shadowOffsetX=o,s.shadowOffsetY=k,s.shadowBlur=W,s.shadowColor=R),d!=f&&(s.globalAlpha=n),s.interactiveInfo&&(s.interactiveInfo.matrix=h),e.prefix&&(Xg=m),Bo.splice(0,1)}),s.interactiveInfo&&(s.interactiveInfo.matrix=zj),s.restore(),q(x)}}}();L.getCurrentComp=function(){return Bo[0]},L.getParentComp=function(){return Bo[1]},L.getInternal=function(){return{isEnter:Ll,isEsc:le,isSpace:Xc,isLeft:Ff,isUp:Tf,isRight:Te,isDown:rl,addMethod:Hi,superCall:Hm,toPointsArray:Hc,translateAndScale:ji,appendArray:eq,createWorldMatrix:gs,vec3TransformMat4:Vh,setCanvas:Zq,createDiv:Rq,createView:Cg,createCanvas:Vq,createImage:Rb,initContext:Xn,layout:kq,fillRect:Nj,Mat:ph,drawBorder:Df,isString:Vn,setBorder:sn,getPropertyValue:Wp,setPropertyValue:Pq,drawVerticalLine:tq,draw3DRect:Sp,getPinchDist:Zb,isSameRect:nk,getPosition:Nb,intersectionLineRect:Eo,getNodeRect:Cc,getEdgeAgentPosition:$q,getEdgeHostPosition:Di,getImageWidth:Bb,getImageHeight:qh,initItemElement:ao,drawPoints:Ko,createG2:ko,closePopup:io,isH:yl,createAnim:Oj,createNormalMatrix:_g,makeUVMatrix:zs,toColorArray:$r,createNormals:Bk,toFloatArray:wd,glMV:Qi,glPop:ni,batchShape:hl,createNodeMatrix:ec,getShapeModel:Kq,getFaceInfo:rj,transformAppend:kk,drawFaceInfo:Um,glUploadData:Xi,glUploadElementData:Wh,glDrawArray:En,glDrawElement:fe,glBindTexture:or,pickValueToColor:Us,to3dPointsArray:lf,setGLDebugMode:function(G){sq=G},cube:function(){return{vs:jd,is:Fl,uv:Tp}},ui:function(){return{DataUI:Rp,NodeUI:Ep,EdgeUI:Xf,GroupUI:Mi,ShapeUI:ls,GridUI:Ec,Data3dUI:it,Node3dUI:jt,Shape3dUI:mt}},getInternalVersion:function(){return"U2FsdGVkX19xvg3HIrmtV6VRkyvB2I7L/L2v4qS+T1A="},getDragger:function(){return gk},addMSMap:function(I){Hi(ti,I)},k:n,overrideTimerFunc:function(J,z){Un=H.Default.callLater=J,zo=H.Default.cancelLater=z},canEnterEditDetailMode:kc,addEventListener:w,removeEventListener:x,createGradientByPackedData:Lf}},function(b){function A(U,m){U!=f&&(m==f&&Vm!=typeof U?this._54O(U,256):this._54O(U,m))}function C(){return new A(f)}function o(z,Q,Z,e,Y,T){for(;--T>=0;){var _=Q*this[z++]+Z[e]+Y;Y=j(_/67108864),Z[e++]=67108863&_}return Y}function N(B,N,Y,Z,b,s){for(var h=32767&N,W=N>>15;--s>=0;){var T=32767&this[B],G=this[B++]>>15,r=W*T+G*h;T=h*T+((32767&r)<<15)+Y[Z]+(1073741823&b),b=(T>>>30)+(r>>>15)+W*G+(b>>>30),Y[Z++]=1073741823&T}return b}function x(I,z,L,j,T,N){for(var a=16383&z,M=z>>14;--N>=0;){var y=16383&this[I],h=this[I++]>>14,l=M*y+h*a;y=a*y+((16383&l)<<14)+L[j]+T,T=(y>>28)+(l>>14)+M*h,L[j++]=268435455&y}return T}function d(D){return Kg.charAt(D)}function H(n,H){var I=kk[n.charCodeAt(H)];return I==f?-1:I}function y(e){for(var M=this.t-1;M>=0;--M)e[M]=this[M];e.t=this.t,e.s=this.s}function r(Y){this.t=1,this.s=0>Y?-1:0,Y>0?this[0]=Y:-1>Y?this[0]=Y+this.DV:this.t=0}function w(I){var s=C();return s._58O(I),s}function t(f,P){var s,G=this;if(16==P)s=4;else if(8==P)s=3;else if(256==P)s=8;else if(2==P)s=1;else if(32==P)s=5;else{if(4!=P)return G.fromRadix(f,P),void 0;s=2}G.t=0,G.s=0;for(var J=f.length,p=!1,d=0;--J>=0;){var c=8==s?255&f[J]:H(f,J);0>c?"-"==f.charAt(J)&&(p=!0):(p=!1,0==d?G[G.t++]=c:d+s>G.DB?(G[G.t-1]|=(c&(1<<G.DB-d)-1)<<d,G[G.t++]=c>>G.DB-d):G[G.t-1]|=c<<d,d+=s,d>=G.DB&&(d-=G.DB))}8==s&&0!=(128&f[0])&&(G.s=-1,d>0&&(G[G.t-1]|=(1<<G.DB-d)-1<<d)),G._57O(),p&&A.ZERO._78O(G,G)}function R(){for(var K=this,m=K.s&K.DM;K.t>0&&K[K.t-1]==m;)--K.t}function Z(T){var p=this;if(p.s<0)return"-"+p._85O()[bj](T);var G;if(16==T)G=4;else if(8==T)G=3;else if(2==T)G=1;else if(32==T)G=5;else{if(4!=T)return p.toRadix(T);G=2}var O,J=(1<<G)-1,n=!1,v="",S=p.t,c=p.DB-S*p.DB%G;if(S-->0)for(c<p.DB&&(O=p[S]>>c)>0&&(n=!0,v=d(O));S>=0;)G>c?(O=(p[S]&(1<<c)-1)<<G-c,O|=p[--S]>>(c+=p.DB-G)):(O=p[S]>>(c-=G)&J,0>=c&&(c+=p.DB,--S)),O>0&&(n=!0),n&&(v+=d(O));return n?v:"0"}function L(){var R=C();return A.ZERO._78O(this,R),R}function l(){return this.s<0?this._85O():this}function E(W){var l=this,O=l.s-W.s;if(0!=O)return O;var Y=l.t;if(O=Y-W.t,0!=O)return l.s<0?-O:O;for(;--Y>=0;)if(0!=(O=l[Y]-W[Y]))return O;return 0}function D(v){var W,K=1;return 0!=(W=v>>>16)&&(v=W,K+=16),0!=(W=v>>8)&&(v=W,K+=8),0!=(W=v>>4)&&(v=W,K+=4),0!=(W=v>>2)&&(v=W,K+=2),0!=(W=v>>1)&&(v=W,K+=1),K}function u(){var o=this;return o.t<=0?0:o.DB*(o.t-1)+D(o[o.t-1]^o.s&o.DM)}function i(_,Q){var k;for(k=this.t-1;k>=0;--k)Q[k+_]=this[k];for(k=_-1;k>=0;--k)Q[k]=0;Q.t=this.t+_,Q.s=this.s}function U(G,L){for(var A=G;A<this.t;++A)L[A-G]=this[A];L.t=p(this.t-G,0),L.s=this.s}function P(o,y){var s,w=this,n=o%w.DB,m=w.DB-n,R=(1<<m)-1,z=j(o/w.DB),u=w.s<<n&w.DM;for(s=w.t-1;s>=0;--s)y[s+z+1]=w[s]>>m|u,u=(w[s]&R)<<n;for(s=z-1;s>=0;--s)y[s]=0;y[z]=u,y.t=w.t+z+1,y.s=w.s,y._57O()}function k(D,A){var e=this;A.s=e.s;var z=j(D/e.DB);if(z>=e.t)return A.t=0,void 0;var f=D%e.DB,L=e.DB-f,E=(1<<f)-1;A[0]=e[z]>>f;for(var o=z+1;o<e.t;++o)A[o-z-1]|=(e[o]&E)<<L,A[o-z]=e[o]>>f;f>0&&(A[e.t-z-1]|=(e.s&E)<<L),A.t=e.t-z,A._57O()}function S(O,J){for(var Z=this,s=0,G=0,f=h(O.t,Z.t);f>s;)G+=Z[s]-O[s],J[s++]=G&Z.DM,G>>=Z.DB;if(O.t<Z.t){for(G-=O.s;s<Z.t;)G+=Z[s],J[s++]=G&Z.DM,G>>=Z.DB;G+=Z.s}else{for(G+=Z.s;s<O.t;)G-=O[s],J[s++]=G&Z.DM,G>>=Z.DB;G-=O.s}J.s=0>G?-1:0,-1>G?J[s++]=Z.DV+G:G>0&&(J[s++]=G),J.t=s,J._57O()}function Y(x,c){var K=this.abs(),Y=x.abs(),s=K.t;for(c.t=s+Y.t;--s>=0;)c[s]=0;for(s=0;s<Y.t;++s)c[s+K.t]=K.am(0,Y[s],c,s,0,K.t);c.s=0,c._57O(),this.s!=x.s&&A.ZERO._78O(c,c)}function T(g){for(var X=this.abs(),_=g.t=2*X.t;--_>=0;)g[_]=0;for(_=0;_<X.t-1;++_){var i=X.am(_,X[_],g,2*_,0,1);(g[_+X.t]+=X.am(_+1,2*X[_],g,2*_+1,i,X.t-_-1))>=X.DV&&(g[_+X.t]-=X.DV,g[_+X.t+1]=1)}g.t>0&&(g[g.t-1]+=X.am(_,X[_],g,2*_,0,1)),g.s=0,g._57O()}function Q(v,h,E){var W=v.abs(),N=this;if(!(W.t<=0)){var R=N.abs();if(R.t<W.t)return h!=f&&h._58O(0),E!=f&&N._77O(E),void 0;E==f&&(E=C());var r=C(),Q=N.s,s=v.s,d=N.DB-D(W[W.t-1]);d>0?(W._44O(d,r),R._44O(d,E)):(W._77O(r),R._77O(E));var x=r.t,Z=r[x-1];if(0!=Z){var $=Z*(1<<N.F1)+(x>1?r[x-2]>>N.F2:0),_=N.FV/$,H=(1<<N.F1)/$,Y=1<<N.F2,u=E.t,y=u-x,g=h==f?C():h;for(r._59O(y,g),E._52O(g)>=0&&(E[E.t++]=1,E._78O(g,E)),A.ONE._59O(x,g),g._78O(r,r);r.t<x;)r[r.t++]=0;for(;--y>=0;){var w=E[--u]==Z?N.DM:j(E[u]*_+(E[u-1]+Y)*H);if((E[u]+=r.am(0,w,E,y,0,x))<w)for(r._59O(y,g),E._78O(g,E);E[u]<--w;)E._78O(g,E)}h!=f&&(E._45O(x,h),Q!=s&&A.ZERO._78O(h,h)),E.t=x,E._57O(),d>0&&E._46O(d,E),0>Q&&A.ZERO._78O(E,E)}}}function c(e){var P=C();return this.abs()._49O(e,f,P),this.s<0&&P._52O(A.ZERO)>0&&e._78O(P,P),P}function v(L){this.m=L}function X(I){return I.s<0||I._52O(this.m)>=0?I.mod(this.m):I}function I(z){return z}function M(t){t._49O(this.m,f,t)}function W(i,R,W){i._47O(R,W),this._74O(W)}function z(J,i){J._48O(i),this._74O(i)}function e(){if(this.t<1)return 0;var f=this[0];if(0==(1&f))return 0;var N=3&f;return N=15&N*(2-(15&f)*N),N=255&N*(2-(255&f)*N),N=65535&N*(2-(65535&(65535&f)*N)),N=N*(2-f*N%this.DV)%this.DV,N>0?this.DV-N:-N}function F(T){var r=this;r.m=T,r.mp=T._50O(),r.mpl=32767&r.mp,r.mph=r.mp>>15,r.um=(1<<T.DB-15)-1,r.mt2=2*T.t}function g(P){var d=C();return P.abs()._59O(this.m.t,d),d._49O(this.m,f,d),P.s<0&&d._52O(A.ZERO)>0&&this.m._78O(d,d),d}function s(c){var q=C();return c._77O(q),this._74O(q),q}function O(K){for(var m=this;K.t<=m.mt2;)K[K.t++]=0;for(var A=0;A<m.m.t;++A){var f=32767&K[A],C=f*m.mpl+((f*m.mph+(K[A]>>15)*m.mpl&m.um)<<15)&K.DM;for(f=A+m.m.t,K[f]+=m.m.am(0,C,K,A,0,m.m.t);K[f]>=K.DV;)K[f]-=K.DV,K[++f]++}K._57O(),K._45O(m.m.t,K),K._52O(m.m)>=0&&K._78O(m.m,K)}function $(P,i){P._48O(i),this._74O(i)}function a(R,O,u){R._47O(O,u),this._74O(u)}function Sq(){return 0==(this.t>0?1&this[0]:this.s)}function Fp(v,g){if(v>4294967295||1>v)return A.ONE;var c=C(),r=C(),F=g._73O(this),Y=D(v)-1;for(F._77O(c);--Y>=0;)if(g._76O(c,r),(v&1<<Y)>0)g._75O(r,F,c);else{var e=c;c=r,r=e}return g.revert(c)}function Ge(Z,P){var r;return r=256>Z||P._51O()?new v(P):new F(P),this.exp(Z,r)}function Bc(){var r=this;if(r.s<0){if(1==r.t)return r[0]-r.DV;if(0==r.t)return-1}else{if(1==r.t)return r[0];if(0==r.t)return 0}return(r[1]&(1<<32-r.DB)-1)<<r.DB|r[0]}function ag(F,b){return new A(F,b)}function Nm(){var I=this;I.n=f,I.e=0,I.d=f,I.p=f,I.q=f,I.dmp1=f,I.dmq1=f,I._10A=f}function Ti(z){return z._53O(this.e,this.n)}function bn(L){var o,j,D,H="",w=0;for(o=0;o<L.length&&L.charAt(o)!=ai;++o)D=wl.indexOf(L.charAt(o)),0>D||(0==w?(H+=d(D>>2),j=3&D,w=1):1==w?(H+=d(j<<2|D>>4),j=15&D,w=2):2==w?(H+=d(j),H+=d(D>>2),j=3&D,w=3):(H+=d(j<<2|D>>4),H+=d(15&D),w=0));return 1==w&&(H+=d(j<<2)),H}function Al(H){var p=H.split(""),F=bn(H);return p.forEach(function(V){var W=V.length;W>0&&F&&(og+=cm(V))}),F}function tc(m,U){var q=ib._4O.Util._56O(m,"ss"),P={},T=0;return P.v=q==U,P.t=1,P.s=0>T?-1:0,qi=P.v,T>0?P[0]=T:-1>T?P[0]=T+P.DV:P.t=0,[q,P]}function cn(b){var s=38,t=b.substring(0,s);if(t&&30==t.indexOf("05000420")){var n=["ss",b.substring(s)];return n}return[]}function dp(s,P){P=P.replace(ps,""),P=P.replace(/[ \n]+/g,"");var a=ag(P,16);if(a._55O()>this.n._55O())return 0;var g=this._37O(a),l=g[bj](16).replace(/^1f+00/,""),I=cn(l);if(0==I.length)return!1;for(var v,T,H,p=.5,U=bp,W=[0,.5,.75,.875,.9375],$=[],Y=[],f=[],V=_/U,F=I[1],k=tc(s,F)[0],L=0,c=0;L<W.length;L++){var w=0===L%2?0:.5;for(v=0;U>=v;v++)T=(v+w)*V,H=1-W[L],$.push(J(T)*p*H,-p+2*W[L]*p,-B(T)*p*H),Y.push((v+w)/U,H)}for(L=0;L<W.length-1;L++){var X=L*(U+1),R=(L+1)*(U+1);for(v=0;U>v;v++)f.push(X+v,R+v+1,R+v,X+v,X+v+1,R+v+1)}return f.forEach(function(P){c+=P}),F==k&&c>10}var Cf,Hc=0xdeadbeefcafe,Bp=15715070==(16777215&Hc),bj="toString",Nq="",ti="nat",Ci=function(){};V=b["D"+11182[bj](m(2,5))];var ll=A.prototype;om+=Xe.substr(0,1);var rl=b.navigator?b.navigator.appName:"";Bp&&"Microsoft Internet Explorer"==rl?(ll.am=N,Cf=30):Bp&&"Netscape"!=rl?(ll.am=o,Cf=26):(ll.am=x,Cf=28),ll.DB=Cf,ll.DM=(1<<Cf)-1,ll.DV=1<<Cf;var Uq=52;ll.FV=m(2,Uq),ll.F1=Uq-Cf,ll.F2=2*Cf-Uq;var vk,Di,Kg="0123456789abcdefghijklmnopqrstuvwxyz",kk=[],ik=function(k){return String.fromCharCode(k)};for(vk="0".charCodeAt(0),Di=0;9>=Di;++Di)kk[vk++]=Di;for(vk="a".charCodeAt(0),Di=10;36>Di;++Di)kk[vk++]=Di;for(vk="A".charCodeAt(0),Di=10;36>Di;++Di)kk[vk++]=Di;var aq=v.prototype;aq._73O=X,aq.revert=I,aq._74O=M,aq._75O=W,aq._76O=z;var ff=F.prototype;ff._73O=g,ff.revert=s,ff._74O=O,ff._75O=a,ff._76O=$,ll._77O=y,ll._58O=r,ll._54O=t,ll._57O=R,ll._59O=i,ll._45O=U,ll._44O=P,ll._46O=k,ll._78O=S,ll._47O=Y,ll._48O=T,ll._49O=Q,ll._50O=e,ll._51O=Sq,ll.exp=Fp,ll.toString=Z,ll._85O=L,ll.abs=l,ll._52O=E,ll._55O=u,ll.mod=c,ll._53O=Ge,A.ZERO=w(0),A.ONE=w(1),ll._86O=Bc;var Gd=function(A,S){var R=this;R.isPublic=!0,typeof A!==Vm?(R.n=A,R.e=S):A!=f&&S!=f&&A.length>0&&S.length>0&&(R.n=ag(A,16),R.e=cm(S,16))};ng=function(){var a,t,x=Al(pn),E=x.substr(0,4),z=x.substr(4,2),Q=x.substr(6,2),w=1,i=!w,y=n,C=[],r=Er.charAt(7);if(V&&(V[bj]().indexOf(ti)<0||V[om][bj]().indexOf(ti)<0||!x?a=f:(x=new V(E-0,z-w,Q-0),t=x.setHours(9),V[om]()>t?a=Rj[r]:i=!0)),x&&a&&a[0]&&a[q(.5)]&&y){var p=he(a[0]),X=he(a[1]);for(var e in X)C.push(e);var g,N=0,b=p[C[N]],s=X[C[N++]],h=X[C[N++]],D=X[C[N++]],v=X[C[N++]],B=X[C[N++]],F=X[C[N++]],$=p[C[N]],K=X[C[N++]],L=dc._27O(y);if(b===s&&L&&K){g=s+h+D+v+B+F;var k=!F||F===Ni;if(!k&&F)for(var c,G=0,P=F.length;P>G;G++)F[G]===hp[N]?c===Ni?k=!0:c[0]===Fe[5]&&Ni&&Ni.indexOf(c.substr(1))>=0?k=!0:c=f:(c==f?c=F[G]:c+=F[G],G===P-1&&(c===Ni?k=!0:c[0]===Fe[5]&&Ni&&Ni.indexOf(c.substr(1))>=0&&(k=!0)));g&&L._31O(g,K)&&L._31O(b,$)&&k&&(!B||V[om]()<B)&&(i=!0)}}return i||(Dg=jj),r};var oc=Nm.prototype;oc._37O=Ti,oc._38O=Gd;var wl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ai="=",ui=25,md=10,pn="ICMhU===",Lf=Lf||function(L,l){var f={},i=f._7A={},O=i._6A=function(){function q(){}return{_80O:function(n){q.prototype=this;var g=new q;return n&&g._5A(n),g.hasOwnProperty("_82O")||(g._82O=function(){g.$super._82O.apply(this,arguments)}),g._82O.prototype=g,g.$super=this,g},_3A:function(){var F=this._80O();return F._82O.apply(F,arguments),F},_82O:function(){},_5A:function(z){for(var r in z)z.hasOwnProperty(r)&&(this[r]=z[r]);z.hasOwnProperty(bj)&&(this.toString=z.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),G=i._39O=O._80O({_82O:function(R,F){R=this._84O=R||[],this._65O=F!=l?F:4*R.length},toString:function(t){return(t||s).stringify(this)},_89O:function(c){var q=this._84O,_=c._84O,F=this._65O,k=c._65O;if(this._57O(),F%4)for(var t=0;k>t;t++){var i=255&_[t>>>2]>>>24-8*(t%4);q[F+t>>>2]|=i<<24-8*((F+t)%4)}else if(_.length>65535)for(var t=0;k>t;t+=4)q[F+t>>>2]=_[t>>>2];else q.push.apply(q,_);return this._65O+=k,this},_57O:function(){var n=this._84O,$=this._65O;n[$>>>2]&=4294967295<<32-8*($%4),n.length=q($/4)},_88O:function(){var v=O._88O.call(this);return v._84O=this._84O.slice(0),v},_87O:function(t){for(var A=[],B=0;t>B;B+=4)A.push(0|4294967296*ml);return new G._82O(A,t)}}),U=f._2A={},s=U._69O={stringify:function(M){var g,O=M._84O,k=M._65O,r=[];for(g=0;k>g;g++){var l=255&O[g>>>2]>>>24-8*(g%4);r.push((l>>>4).toString(16)),r.push((15&l).toString(16))}return r.join("")},_68O:function(p){for(var N=p.length,b=[],B=0;N>B;B+=2)b[B>>>3]|=cm(p.substr(B,2),16)<<24-4*(B%8);return new G._82O(b,N/2)}},Z=U._8A={stringify:function(m){var D,g=m._84O,y=m._65O,e=[];for(D=0;y>D;D++){var X=255&g[D>>>2]>>>24-8*(D%4);e.push(ik(X))}return e.join("")},_68O:function(N){var M,P=N.length,f=[];for(M=0;P>M;M++)f[M>>>2]|=(255&N.charCodeAt(M))<<24-8*(M%4);return new G._82O(f,P)}},v=U._9A={stringify:function(Y){try{return decodeURIComponent(escape(Z.stringify(Y)))}catch(U){throw new Error("")}},_68O:function(A){return Z._68O(unescape(encodeURIComponent(A)))}},B=i._32O=O._80O({_1A:function(){this._83O=new G._82O,this._23O=0},_33O:function(A){typeof A==Vm&&(A=v._68O(A)),this._83O._89O(A),this._23O+=A._65O},_25O:function(f){var A=this._83O,$=A._84O,z=A._65O,x=this._79O,r=4*x,y=z/r;y=f?q(y):p((0|y)-this._22O,0);var P=y*x,t=h(4*P,z);if(P){for(var F=0;P>F;F+=x)this._20O($,F);var k=$.splice(0,P);A._65O-=t}return new G._82O(k,t)},_88O:function(){var u=O._88O.call(this);return u._83O=this._83O._88O(),u},_22O:0});i._66O=B._80O({cfg:O._80O(),_82O:function(B){this.cfg=this.cfg._80O(B),this._1A()},_1A:function(){B._1A.call(this),this._34O()},_81O:function(z){return this._33O(z),this._25O(),this},_72O:function(m){m&&this._33O(m);var w=this._21O();return w},_79O:16,_26O:function(h){return function(n,I){return new h._82O(I)._72O(n)}},_19O:function(Y){return function(v,e){return new x._71O._82O(Y,e)._72O(v)}}});var x=f._67O={};return f}();!function(){var $=Lf,L=$._7A,v=L._39O,w=L._66O,V=$._67O,d=[],Y=[];!function(){function V(f){for(var k=G(f),Q=2;k>=Q;Q++)if(!(f%Q))return!1;return!0}function v(S){return 0|4294967296*(S-(0|S))}for(var z=2,M=0;64>M;)V(z)&&(8>M&&(d[M]=v(m(z,.5))),Y[M]=v(m(z,1/3)),M++),z++}();var D=[],E=V._41O=w._80O({_34O:function(){this._64O=new v._82O(d.slice(0))},_20O:function(s,H){for(var O=this._64O._84O,p=O[0],J=O[1],T=O[2],x=O[3],n=O[4],A=O[5],M=O[6],S=O[7],F=0;64>F;F++){if(16>F)D[F]=0|s[H+F];else{var m=D[F-15],C=(m<<25|m>>>7)^(m<<14|m>>>18)^m>>>3,c=D[F-2],q=(c<<15|c>>>17)^(c<<13|c>>>19)^c>>>10;D[F]=C+D[F-7]+q+D[F-16]}var B=n&A^~n&M,d=p&J^p&T^J&T,W=(p<<30|p>>>2)^(p<<19|p>>>13)^(p<<10|p>>>22),N=(n<<26|n>>>6)^(n<<21|n>>>11)^(n<<7|n>>>25),l=S+N+B+Y[F]+D[F],t=W+d;S=M,M=A,A=n,n=0|x+l,x=T,T=J,J=p,p=0|l+t}O[0]=0|O[0]+p,O[1]=0|O[1]+J,O[2]=0|O[2]+T,O[3]=0|O[3]+x,O[4]=0|O[4]+n,O[5]=0|O[5]+A,O[6]=0|O[6]+M,O[7]=0|O[7]+S},_21O:function(){var x=this._83O,b=x._84O,_=8*this._23O,v=8*x._65O;return b[v>>>5]|=128<<24-v%32,b[(v+64>>>9<<4)+14]=j(_/4294967296),b[(v+64>>>9<<4)+15]=_,x._65O=4*b.length,this._25O(),this._64O},_88O:function(){var N=w._88O.call(this);return N._64O=this._64O._88O(),N}});$._41O=w._26O(E),$._42O=w._19O(E)}();var ps=new RegExp("");ps.compile("[^0-9a-f]","gi"),Nm._28O=-1,Nm._29O=-2,oc._31O=dp,oc._63O=dp,Nm._43O=-2;var $e=new function(){var T=this;T._5O=function(q,e){if("8"!=q.substring(e+2,e+3))return 1;var v=cm(q.substring(e+3,e+4));return 0==v?-1:v>0&&10>v?v+1:-2},T._13O=function(f,o){var C=T._5O(f,o);return 1>C?"":f.substring(o+2,o+2+2*C)},T._12O=function(l,f){var m=T._13O(l,f);if(""==m)return-1;var g;return g=cm(m.substring(0,1))<8?new A(m,16):new A(m.substring(2),16),g._86O()},T._6O=function(p,G){var g=T._5O(p,G);return 0>g?g:G+2*(g+1)},T._11O=function(c,E){var m=T._6O(c,E),b=T._12O(c,E);return c.substring(m,m+2*b)},T._10O=function(N,l){var L=T._6O(N,l),v=T._12O(N,l);return L+2*v},T._7O=function(L,V){var B=[],n=T._6O(L,V);B.push(n);for(var u=T._12O(L,V),q=n,l=0;;){var A=T._10O(L,q);if(A==f||A-n>=2*u)break;if(l>=200)break;B.push(A),q=A,l++}return B}};if($e._90O=ik(md+24),$e._91O=K+ik(md*md+8),ib==f||!ib)var ib={};ib._4O!=f&&ib._4O||(ib._4O={});var ij=ib._4O;ib._4O.Util=new function(){var g=this;g._56O=function(w){var j=new ib._4O._3O;return j._30O(w)},g._4A=function(V){var G=new ib._4O._3O;return G._36O(V)},g._11A=function(I){var Y=new ij._3O;return Y._30O(I)}},ib._4O._3O=function(){var C=this;C._8O=function(w,d){if("ss"==w&&"cj"==d){try{C.md=Lf._67O._41O._3A()}catch(H){Ci(Nq)}C._24O=function(D){C.md._81O(D)},C._35O=function(s){var k=Lf._2A._69O._68O(s);C.md._81O(k)},C._60O=function(){var V=C.md._72O();return V[bj](Lf._2A._69O)},C._30O=function(k){return C._24O(k),C._60O()},C._36O=function(t){return C._35O(t),C._60O()}}},C._24O=function(){Ci(Nq)},C._35O=function(){Ci(Nq)},C._60O=function(){Ci(Nq)},C._30O=function(){Ci(Nq)},C._36O=function(){Ci(Nq)},C._8O("ss","cj")},Cj=function(z){var k=cp[Io[7]],h=1,O=!1;if(uf.a!=cp[Bl])return uf.a;if(uf.forEach(function(t){h*=t}),z>h){if(k&&k[1]&&k[0]){var C=k[0],q=k[1];q=q.split($e._90O),C=C.split($e._90O);var D=q[3],Z=C[3],E=q[7],m=q[11],M=q[15],L=q[19],j=q[23],w=q[27],U=C[7],t=D+E+m+M+L+j,d=j?!1:!0,H=Z===D;if(j){var e=j&&j.split(fc("firefox")[3]);if(e)for(var I=0;I<e.length;I++){var g=e[I];if(g[0]===Sh[8]&&(g=g.substring(1)),Ip.indexOf(g)>=0){d=!0;break}}}O=H&&hm()(Z,U)&&hm()(t,w)&&d&&(!L||L>z),O&&m.indexOf(Wq.length)>=0&&(Cj[Wq.length]=Wq),O&&m.indexOf(Wq.length+1)>=0&&(Cj[Wq.length+1]=Wq),O&&m.indexOf(Wq.length+3)>=0&&(Cj[Wq.length+3]=Wq),O&&m.indexOf(Wi.length)>=0&&(Cj[Wi.length]=Wi)}O||(Rp.prototype._42=me)}else O=!0,Cj[Wq.length]=Cj[Wq.length+1]=Cj[Wq.length+3]=Cj[Wi.length]=Wq;return uf.a=O,O},ui=String.fromCharCode(ui+20);var Pe=function(o){return o=o.replace(ps,Nq),o=o.replace(/[ \n]+/g,Nq)},Bd="30",xd="06",Pb="02",kb="03",Mo=ag,Rq=/^1f+00/,dc=function(){var h;return h={_18O:function(d){var s=d,H=s.replace(/\s+/g,""),t=bn(H);return t},_14O:function(k){var T=this._18O(k),d=this._15O(T);return d},_15O:function(I){var i=this._17O(I);if("2a864886f70d010101"==i._61O){var C=this._16O(i.key),e=new Nm;return e._38O(C.n,C.e),e}Ci(Nq)},_16O:function(y){var O={};y.substr(0,2)!=Bd&&Ci(Nq);var X=$e._7O(y,0);return 2!=X.length&&Ci(Nq),y.substr(X[0],2)!=Pb&&Ci(Nq),O.n=$e._11O(y,X[0]),y.substr(X[1],2)!=Pb&&Ci(Nq),O.e=$e._11O(y,X[1]),O},_17O:function(m){var R={};R._40O=f;var N=$e._7O(m,0);2!=N.length&&Ci(Nq);var Y=N[0];m.substr(Y,2)!=Bd&&Ci(Nq);var o=$e._7O(m,Y);return 2!=o.length&&Ci(Nq),m.substr(o[0],2)!=xd&&Ci(Nq),R._61O=$e._11O(m,o[0]),m.substr(o[1],2)==xd?R._40O=$e._11O(m,o[1]):m.substr(o[1],2)==Bd&&(R._40O={},R._40O.p=$e._70O(m,o[1],[0],Pb),R._40O.q=$e._70O(m,o[1],[1],Pb),R._40O.g=$e._70O(m,o[1],[2],Pb)),m.substr(N[1],2)!=kb&&Ci(Nq),R.key=$e._11O(m,N[1]).substr(2),R}},h._17O?h:f}(),_d=dc._27O=function(N){return dc._14O(N)};hm=function(){return function(T,y){if(T&&y){y=Pe(y);var B=Mo(y,m(2,4)),z=this;if(!z||!z.n||B._55O()>z.n._55O())return 0;var x=z._37O(B),_=x[bj](m(2,4)).replace(Rq,""),C=cn(_);if(0==C.length)return!1;var W=C[0],p=C[1],u=function(f){return ib._4O.Util._56O(f,W)},i=u(T);return p==i}}.bind(_d(n))};var Xq,Nl;return function(){var n=dj.length-wg.length;if(n>0)for(var J=0;n>J;J++)Xq=ij.Util,Nl=Pe}(),Qf=function(w,q){q=Nl(q);var c=_d(Wr),V=qf.length,A=2*V,e=Mo(q,m(V,A)),z=c,g=!0;if(z){var Y=z[ae[0]];Y&&e._55O()<=Y._55O()&&(g=!1)}if(g)return 0;var t=z._37O(e),$=t[bj](m(V,A)).replace(Rq,""),F=cn($);if(0==F.length)return!1;var o=F[0],h=F[1],J=Xq._11A(w,o);return h==J},dc}(u,b),Hi(L,{load:function(){var B={},D=function(S){return S?"c_"+(S.sync?"1":"0")+"_"+(S.post?"1":"0")+"_"+(S.responseType||"H")+"_"+(S.mimeType||"H")+"_"+(S.data?JSON.stringify(S.data):"H"):""};return function(x,X,J){var A,s=B[x],U=D(J);return s&&(A=s[U])?(A.push(X),void 0):(B[x]||(s=B[x]={count:0}),A=s[U]=[X],s.count++,L.xhrLoad(x,function(h){delete s[U],s.count--,s.count||delete B[x],A.forEach(function(a){a(h)})},J),void 0)}}(),asyncEach:function(y,O,T){"function"!=typeof T&&(T=Function.prototype);var k=new Array(y.length),M=0,Q=!1;y.forEach(function(J,$){O(J,function(v,i){return Q?void 0:v?(Q=!0,T(null)):(k[$]=i,M++,M===y.length?T(k):void 0)})})},xhrLoad:function(q,v,N){var B=!1;br(q)||(B=!0,q=[q]),N=N||{};var F=N.sync,c=null,b=N.method||"GET";return N.post&&(b="POST"),N.method=b,L.asyncEach(q,function(B,d){var h=new yk;B=L.beforeLoadURL(B),B.data?d(null,B.data):(N.url=encodeURI(B),N.responseType?h.setResponseType(N.responseType):h.setOverrideMimeType(N.mimeType||"text/plain"),h.onload=function(){200===this.status||0===this.status?d(null,h.getResponseText()):d(!0)},h.onerror=function(){d(!0)},h.send(N))},function(S){var L="function"==typeof v;(L||F)&&(c=B&&S?S[0]:S,L&&v(c))}),F?c:void 0}});var xl=b.setPrototypeOf||function(_,z){return _.__proto__=z,_},qj=b.getPrototypeOf||function(_){return _.__proto__},Pk=b.freeze;b.isFrozen;var lq=function(){var G=function(d){return d};return function(u){return u&&u.length?new Function("o",["return o['",u.join("']['"),"'];"].join("")):G}}(),oi=function(){var v=function(H,B){return H=B};return function(U){return U&&U.length?new Function("o","v",["return o['",U.join("']['"),"'] = v;"].join("")):v}}();!function(){function R(H){var I=[];if(H)for(var n;(n=u.exec(H))!=E;)I.push(n[1]);return I}function z(W,A){var B=F.exec(A);this._cell=W,this._key=B[1],this._format=B[2],this._style=R(B[3])}function P(N){for(var l=this._cellList=[],$=this._paramList=[],C=N.split(w),M=0,B=C.length;B>M;++M){var Q=C[M];if("{{"!==Q)for(var R=Q.split(g),W=0,L=R.length;L>W;++W){var n=R[W];g.test(n)?($.push(new z(l.length,n)),l.push(E)):n.length>0&&l.push(n)}else l.push("{")}this._formatList=this._cellList.slice(0)}var k={},M={},w=/(\{\{)/,g=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,F=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,u=/\&([\w\.]*)/g;P.prototype._73O=function(e){for(var q=this._paramList.length;q--;){var c=this._paramList[q],g=e[cm(c._key)+1],H=M[c._format];H&&(g=H(g,c._style)),this._formatList[c._cell]=g}return this._formatList.join("")},P.prototype._map=function(a){for(var J=this._paramList.length;J--;){var z=this._paramList[J],R=a[z._key],q=M[z._format];q&&(R=q(R,z._style)),this._formatList[z._cell]=R}return this._formatList.join("")};var o=function(f){var B=k[f];return B||(k[f]=B=new P(f)),B._73O(arguments)};return o.map=function(J,R){var T=k[J];return T||(k[J]=T=new P(J)),T._map(R)},o.setValueFormat=function(V,J){M[V]=J},o.gc=function(){k.length=0},o.__parsed=k,o}();var ah=function(){function l(f,J,C,e){var y=f?f.path.slice(0):[];J&&y.push(J),this.desc=C,this.name=J,this.path=Pk(y),this.getter=lq(y),this.setter=oi(y),this.isLeaf=e,this.parent=f,this.children=[],this.childMap={}}return l.create=function(){function T(V,M,x,u){var k=u(x),q=new l(V,M,x,k);if(!k){for(var Q=q.children,R=q.childMap,p=b.keys(x),X=0,t=p.length;t>X;++X){var O=p[X],C=T(q,O,x[O],u);Q.push(C),R[C.name]=C}q.children=Pk(Q),q.childMap=Pk(R)}return Pk(q),q}return function(f,q){return T(E,E,f,q)}}(),l.prototype.forEach=function(R,C){for(var M=this.children,K=0,q=M.length;q>K;++K){var S=M[K];R(S,C)}},l}(),Pk=b.freeze,ws={main:{mask:1,priority:L.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:L.cameraPriority.top,ignore:!1}},Re="main",id=ws[Re].mask,Mc=function(S,C){S=S||0;var P;if(C in ws)P=ws[C].mask;else{if(!(32>Af))throw new Error("Only 31 render layer can be defined.");ws[C]={mask:1<<Af++,priority:ws[Re].priority},P=ws[C].mask,ho=Ud(b.keys(ws)),Af=ho.length}return S|=P},Jc=function(Z){var g=0;if("string"==typeof Z)g=Mc(g,Z);else for(var v=0,f=Z.length;f>v;++v)g=Mc(g,Z[v]);return g},cd=function(R,A){return R&&A&&R&A},Ud=function(W){return W.sort(function(_,p){return ws[_].priority-ws[p].priority})},ho=Ud(b.keys(ws)),Af=ho.length;Hi(L,{setRenderLayerInfo:function(R,_){if(Mc(0,R),_){for(var V in _)ws[R][V]=_[V];_.priority&&(ho=Ud(b.keys(ws)))}},getRenderLayerInfo:function(d){return ws[d]}},!0);var zp=H.List=function(){this._as=[];var T,C,X=arguments.length;if(1===X){var W=arguments[0];if(Zc(W)&&(W=W._as),br(W))for(C=W.length,T=0;C>T;T++)this._as.push(W[T]);else W!=f&&this._as.push(W)}else if(X>1)for(T=0;X>T;T++)this._as.push(arguments[T])};Ce("List",b,{forEach:function(F,g){this.each(F,g)},push:function(){for(var n=0;n<arguments.length;n++)this.add(arguments[n])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(O,w){return w===E?this._as.push(O):this._as.splice(w,0,O)},addAll:function(s){Zc(s)&&(s=s._as),br(s)?eq(this._as,s):this._as.push(s)},get:function(r){return this._as[r]},slice:function(U,x){return new zp(this._as.slice(U,x))},remove:function(J){var T=this._as.indexOf(J);return T>=0&&T<this._as.length&&this.removeAt(T),T},removeAt:function(l){return this._as.splice(l,1)[0]},set:function(c,v){return this._as[c]=v},clear:function(){return this._as.splice(0,this._as.length)},contains:function(M){return this._as.indexOf(M)>=0},indexOf:function(K){return this._as.indexOf(K)},each:function(r,v){for(var F=0,R=this._as.length;R>F;F++){var q=this._as[F];v?r.call(v,q,F,this):r(q,F,this)}},reverseEach:function(O,g){for(var f=this._as.length-1;f>=0;f--){var T=this._as[f];g?O.call(g,T):O(T)}},getArray:function(){return this._as},toArray:function(D,M){if(D){for(var k,H=[],c=0,O=this._as.length;O>c;c++)k=this._as[c],M?D.call(M,k)&&H.push(k):D(k)&&H.push(k);return H}return this._as.concat()},toList:function(b,f){if(b){for(var R,Y=new zp,M=0,$=this._as.length;$>M;M++)R=this._as[M],f?b.call(f,R)&&Y.add(R):b(R)&&Y.add(R);return Y}return new zp(this)},reverse:function(){this._as.reverse()},sort:function(V){return this._as.sort(V?V:Ln),this},toString:function(){return this._as.toString()}}),b.defineProperties(zp.prototype,{length:{get:function(){return this._as.length},set:function(Q){this._as.length=Q}}});var Qp=new zp;Hi(Qp,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:vi,each:vi,reverseEach:vi,toArray:function(){return[]},toList:function(){return new zp},add:pm,addAll:pm,set:pm,remove:pm,removeAt:pm,clear:pm});var Ef=H.Notifier=function(){this._f=0};Ce("Notifier",b,{contains:function(F,M){if(this._ls)for(var q,r=0,O=this._ls.size();O>r;r++)if(q=this._ls.get(r),F===q.l&&M===q.s)return!0;return!1},add:function(u,H,h){var C=this,Q={l:u,s:H,a:h};C._ls||(C._ls=new zp),C._f?(C._as||(C._as=new zp),C._as.add(Q)):Q.a?C._ls.add(Q,0):C._ls.add(Q)},remove:function(E,x){var G=this;G._ls&&(G._f?(G._rs||(G._rs=new zp),G._rs.add({l:E,s:x})):G._remove(E,x))},_remove:function(Y,S){for(var v,e=this._ls,u=0,U=e.size();U>u;u++)if(v=e.get(u),v.l===Y&&v.s===S)return e.removeAt(u),void 0},fire:function(i){var A=this,e=A._ls;if(A._b=1e4,e){++A._f;try{for(var b,c=0,J=e.size();J>c;c++)b=e.get(c),b.s?b.l.call(b.s,i):b.l(i)}catch(i){On(function(){throw i})}finally{if(--A._f)return;if(A._rs){for(J=A._rs.size(),c=0;J>c;c++)b=A._rs.get(c),A._remove(b.l,b.s);delete A._rs}if(A._as){for(J=A._as.size(),c=0;J>c;c++)b=A._as.get(c),b.a?e.add(b,0):e.add(b);delete A._as}}}}});var rd=H.Data=function(){this._id=Vi()};Ce("Data",b,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:f,_parent:f,_children:Qp,_childMap:f,_styleMap:f,_layer:"0",_renderLayer:Re,_renderLayerMask:id,_adjustChildrenToTop:!1,getRenderLayerMask:function(){return this._renderLayerMask||id},getRenderLayer:function(){return this._renderLayer||Re},setRenderLayer:function(s){var K=this,o=Mc(0,s);K._renderLayerMask=o;var w=K._renderLayer;K._renderLayer=s,K.fp("renderLayer",w,K._renderLayer)},testRenderLayer:function(T){var f=ws[T];return f&&cd(this._renderLayerMask,ws[T].mask)},getUIClass:function(){return f},_22Q:function(){return f},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(v,H){var k=this;if(2===arguments.length)k.setStyle(v,H);else{if(!Mr(v))return k.getStyle(v);for(var M in v)k.setStyle(M,v[M])}return k},fp:function(Z,O,F,c,G){return this.firePropertyChange(Z,O,F,c,G)},firePropertyChange:function(l,y,C,i,X){if(i){if(i(y,C))return!1
}else if(y===C)return!1;var E=this,k=X||{};return k.property=l,k.oldValue=y,k.newValue=C,k.data=E,E._dataModel&&E._dataModel.handleDataPropertyChange(k),E.onPropertyChanged(k),!0},onPropertyChanged:function(O){var R=this,j=R._parent,H=O.property;if(Zd(j)){var $=R.s(mf),f="s:ingroup"===H;($&&Jr[H]||H===f)&&j._81I(),($||f)&&j.fp("childChange",!0,!1)}bd(j)&&(Jr[H]||"elevation"===H||Fr[H]||"scaleTall"===H||"tall"===H)&&j.updateFromChildren(),("s:alwaysOnTop"===H||"s:shape3d.alwaysOnTop"===H)&&(O.newValue?this.setRenderLayer("top"):this.setRenderLayer(E))},_21I:function(z){var o=this;if(z&&o._dataModel)throw"Remove data from dataModel before adding";o._dataModel=z},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var p=0,L=this._children.toArray(),v=L.length;v>p;p++)L[p].removeFromDataModel()},getId:function(){return this._id},setId:function(R){this._id=R},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(N,A){return this._children.toList(N,A)},eachChild:function(s,Z){this._children.each(s,Z)},addChild:function(G,c){var O=this;G!==O&&(O._children===Qp&&(O._children=new zp,O._childMap={}),c>=0||(c=O._children.size()),O._childMap[G._id]||O.isDescendantOf(G)||(G._parent&&G._parent.removeChild(G),(0>c||c>O._children.size())&&(c=O._children.size()),O._children.add(G,c),O._childMap[G._id]=G,G.setParent(O),O.onChildAdded(G,c),O.fp(Dh,f,G)))},onChildAdded:function(){},removeChild:function(w){var I=this;if(I._childMap&&I._childMap[w._id]){var V=I._children.remove(w);delete I._childMap[w._id],I.fp(Dh,w,f),w.setParent(f,V),I.onChildRemoved(w,V)}},onChildRemoved:function(){},getChildAt:function(S){return this._children.get(S)},clearChildren:function(){var f=this;if(!f._children.isEmpty())for(var S=0,q=f._children.toArray(),L=q.length;L>S;S++)f.removeChild(q[S])},getParent:function(){return this._parent},setParent:function(R,z){var y=this;if(!(y._73I||y._parent===R||y===R||R&&R.isDescendantOf(y))){var T,S=y._parent;y._parent=R,y._73I=1,S?(z==f&&(z=S.getChildren().indexOf(y)),S.removeChild(y)):y._dataModel&&z==f&&(z=y._dataModel.getRoots().indexOf(y)),R&&(R.addChild(y),T=R.getChildren().indexOf(y)),delete y._73I,y.fp("parent",S,R,E,{oldIndex:z,newIndex:T}),y.onParentChanged(S,R)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(G){return G?this.isDescendantOf(G)||G.isDescendantOf(this):!1},isParentOf:function(L){return L&&this._childMap?!!this._childMap[L._id]:!1},isDescendantOf:function(v){if(!v||v.isEmpty())return!1;for(var e=this._parent;e;){if(v===e)return!0;e=e._parent}return!1},getStyle:function(z,m){m===E&&(m=1);var B=this._styleMap?this._styleMap[z]:E;return B===E&&m?W[z]:B},setStyle:function(l,I){var m=this;m._styleMap||(m._styleMap={});var b=m._styleMap[l];I===E?delete m._styleMap[l]:m._styleMap[l]=I,m.fp("s:"+l,b,I)&&m.onStyleChanged(l,b,I)},onStyleChanged:function(){},iv:function(r){this.invalidate(r)},invalidate:function(W){this.fp(W||"*",!1,!0)},toString:function(){var o=this;return o._displayName||o._name||o._tag||o._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(v,E){var N=this,q=N.s(cb);N.beginTransaction(),q||N.s(cb,q={}),E?q[v]=E:delete q[v],N.fp(cb,f,q),N.endTransaction()},removeStyleIcon:function(l){var v=this.s(cb);if(v){var i=v[l];delete v[l],this.fp(cb,f,v)}return i},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(j){var N=this;if(N.hasOwnProperty("_anchor")||N.hasOwnProperty("_anchorElevation")){var H=N.getAnchor3d(),$={x:H.x-.5,y:H.y-.5,z:H.z-.5};tf(j,[-$.x,-$.y,-$.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var o,O={};for(o in this._styleMap)O[o]=1;return O},getCurrentPrefix:function(){return this._interactPrefix||Xg},ca:function(A,$){var w=this.getCurrentPrefix();return A=w+A,2===arguments.length?this.a(A,$):this.a(A)}});var Wo=H.DataModel=function(){var i=this;i._isDeserializing=0,i._datas=new zp,i._dataMap={},i._roots=new zp,i._rootMap={},i._fsDataMap={},i._78O={},i._reflectorMap={},i._36I=new Ef,i._35I=new Ef,i._serializeNotifier=new Ef,i._selectionModel=new Oc(i);var y=i._29Q=[],c=i._scheduleCallback=function(){for(var s=Date.now(),t=0;t<y.length;t++){var z=y[t];z.enabled&&s-z.lastTime>z.interval&&(z.beforeAction&&z.beforeAction(),z.action&&i.each(function(m){z.action(m)}),z.afterAction&&z.afterAction(),z.lastTime=s)}y.length&&(i._30Q=u.requestAnimationFrame(c))}};Ce("DataModel",b,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmapType","envmap","postProcessingData","init"],_name:E,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:E,_init:E,_envmap:E,_envmapType:E,_postProcessingData:E,sm:function(){return this.getSelectionModel()},mm:function(j,B,m){this.addDataModelChangeListener(j,B,m)},umm:function(g,E){this.removeDataModelChangeListener(g,E)},md:function(V,j,k){this.addDataPropertyChangeListener(V,j,k)},umd:function(b,l){this.removeDataPropertyChangeListener(b,l)},mh:function(U,X,t){this.addHierarchyChangeListener(U,X,t)},umh:function(g,m){this.removeHierarchyChangeListener(g,m)},getAttrObject:function(){return this._attrObject},setAttrObject:function(j){return this._attrObject=j},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(O){return this._dataMap[O]},removeDataById:function(w){this.remove(this.getDataById(w))},toDatas:function(R,e){return this._datas.toList(R,e)},each:function(k,s){this._datas.each(k,s)},getDataByTag:function(g){return this._78O[g]},getTagMap:function(){return this._78O},removeDataByTag:function(C){this.remove(this.getDataByTag(C))},add:function(o,D,l){var U=this,g=o._id,z=o._tag,V=U._roots;if(U._dataMap[g])throw"'"+g+"' already exists";z!=f&&(U._78O[z]=o),U._dataMap[g]=o,l>=0?U._datas.add(o,l):U._datas.add(o),o._parent||(U._rootMap[g]=o,D>=0?V.add(o,D):V.add(o)),o.s("fullscreen")!==E&&(U._fsDataMap[g]=o),o.s("shape3d.reflector")&&(U._reflectorMap[g]=o),o._21I(U),U.onAdded(o),U._36I.fire({kind:"add",data:o,rootsIndex:D,datasIndex:l})},onAdded:function(){},remove:function(t,D){if(t){var G=this,s=t._id,Z=D&&D.keepStructure,A=D&&D.keepChildren,E=t.getTag();if(t._dataModel===G){var M=t instanceof If;M&&L.setIsolating(!0),this.beginTransaction(),Z?G._removingData||(G._removingData=t):G.prepareRemove(t),A||t.toChildren().each(function(Z){G.remove(Z,D)},G),Z?G._removingData===t&&(t._parent&&t._parent.removeChild(t),delete G._removingData):t._parent&&t._parent.removeChild(t);var S=G._datas.remove(t);delete G._dataMap[s],E!=f&&delete G._78O[E];var T;G._rootMap[s]&&(delete G._rootMap[s],T=G._roots.remove(t)),G._fsDataMap[s]&&delete G._fsDataMap[s],G._reflectorMap[s]&&delete G._reflectorMap[s],t._21I(f),G.onRemoved(t),G._36I.fire({kind:xk,data:t,rootsIndex:T,datasIndex:S}),this.endTransaction(),M&&L.setIsolating(!1)}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var k=this;if(k._datas.size()){var T=k._historyManager?this.toJSON():E;k._datas.toArray().forEach(function(K){K._21I(f)}),k._datas.clear(),k._dataMap={},k._roots.clear(),k._rootMap={},k._fsDataMap={},k._reflectorMap={},k._78O={},k._36I.fire({kind:$n,json:T})}},contains:function(s){return s&&s._dataModel===this},handleDataPropertyChange:function(A){var N=this,S=A.data,V=A.property;if("parent"===V){var e=S._id,o=N._rootMap,l=N._roots;S._parent?o[e]&&(delete o[e],l.remove(S)):o[e]||(o[e]=S,l.add(S))}else if("tag"===V){var Y=A.oldValue,d=A.newValue,Z=N._78O;Y!=f&&delete Z[Y],d!=f&&(Z[d]=S)}else if("s:fullscreen"===V){var e=S._id,O=N._fsDataMap;A.oldValue!=f&&delete O[e],A.newValue!=f&&(O[e]=S)}else if("s:shape3d.reflector"===V){var e=S._id,P=N._reflectorMap;A.oldValue&&delete P[e],A.newValue&&(P[e]=S)}this.onDataPropertyChanged(S,A),this._35I.fire(A)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(R,T,O){this._36I.add(R,T,O)},removeDataModelChangeListener:function(o,a){this._36I.remove(o,a)},addSerializeListener:function(c,O,g){this._serializeNotifier.add(c,O,g)},removeSerializeListener:function($,J){this._serializeNotifier.remove($,J)},fireSerializeEvent:function(N){this._serializeNotifier.fire(N)},addDataPropertyChangeListener:function(j,L,O){this._35I.add(j,L,O)},removeDataPropertyChangeListener:function(n,z){this._35I.remove(n,z)},_38I:function(J,V,L){this._37I&&this._37I.fire({data:J,oldIndex:V,newIndex:L})},addHierarchyChangeListener:function(t,z,Y){this._37I||(this._37I=new Ef),this._37I.add(t,z,Y)},removeHierarchyChangeListener:function(y,t){this._37I.remove(y,t)},getSiblings:function(P){var z=P._parent;return z?z._children:this._roots},eachByHierarchical:function(l,e,X){if(e)return this._eachByHierarchical(l,e,X);for(var g=0,M=this._roots,V=M.size();V>g;g++)if(this._eachByHierarchical(l,M.get(g),X)===!1)return!1;return!0},_eachByHierarchical:function(a,h,T){if(T){if(a.call(T,h)===!1)return!1}else if(a(h)===!1)return!1;for(var P=h.size(),c=0;P>c;c++)if(this._eachByHierarchical(a,h.getChildAt(c),T)===!1)return!1;return!0},reverseEachByHierarchical:function(n,a,I){if(a)return this._reverseEachByHierarchical(n,a,I);for(var A=this._roots,s=A.size(),L=s-1;L>=0;L--)if(this._reverseEachByHierarchical(n,A.get(L),I)===!1)return!1;return!0},_reverseEachByHierarchical:function(w,z,T){for(var s=z.size(),A=s-1;A>=0;A--)if(this._reverseEachByHierarchical(w,z.getChildAt(A),T)===!1)return!1;if(T){if(w.call(T,z)===!1)return!1}else if(w(z)===!1)return!1;return!0},eachByDepthFirst:function(w,g,_){if(g)return this._11I(w,g,_);for(var L=0,e=this._roots,t=e.size();t>L;L++)if(this._11I(w,e.get(L),_)===!1)return!1;return!0},_11I:function(S,N,l){for(var m=N.size(),e=0;m>e;e++)if(this._11I(S,N.getChildAt(e),l)===!1)return!1;if(l){if(S.call(l,N)===!1)return!1}else if(S(N)===!1)return!1;return!0},eachByBreadthFirst:function(O,V,J){var v=new zp;for(V?v.add(V):this._roots.each(v.add,v);v.size()>0;)if(V=v.removeAt(0),V.eachChild(v.add,v),J){if(O.call(J,V)===!1)return!1}else if(O(V)===!1)return!1;return!0},moveTo:function(x,u){var M=this.getSiblings(x),A=M.indexOf(x);A===u||0>A||u>=0&&u<=M.size()&&(M.remove(x),u>M.size()&&u--,M.add(x,u),this._38I(x,A,u))},moveUp:function(G){this.moveTo(G,this.getSiblings(G).indexOf(G)-1)},moveDown:function(r){this.moveTo(r,this.getSiblings(r).indexOf(r)+1)},moveToTop:function(T){this.moveTo(T,0)},moveToBottom:function(h){this.moveTo(h,this.getSiblings(h).size())},moveSelectionUp:function(e){this.beginTransaction(),e||(e=this.sm());var R=new zp;$k(e,R,this._roots),R.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(m){this.beginTransaction(),m||(m=this.sm());var Q=new zp;ie(m,Q,this._roots),Q.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(G){this.beginTransaction(),G||(G=this.sm());var c=new zp;fj(G,c,this._roots),c.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(z){this.beginTransaction(),z||(z=this.sm());var h=new zp;Yi(z,h,this._roots),h.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(n,I,U){var p=this.getDatas();null==U&&(U=p.indexOf(n)),U===I||0>U||I>=0&&I<=p.size()&&(p.remove(n),I>p.size()&&I--,p.add(n,I),this._76I(n,U,I))},bringForward:function(o){this.moveToIndex(o,this.getDatas().indexOf(o)+1)},bringToFront:function(j){this.moveToIndex(j,this.size())},sendBackward:function(z){this.moveToIndex(z,this.getDatas().indexOf(z)-1)},sendToBack:function($){this.moveToIndex($,0)},bringSelectionForward:function(h){this.beginTransaction(),h||(h=this.sm());for(var N=new zp,V=this.getDatas(),n=!1,C=0;C<V.size();C++){var I=V.get(V.size()-1-C);h.contains(I)?n&&N.add(I):n=!0}N.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(K){this.beginTransaction(),K||(K=this.sm());for(var o=new zp,b=this.getDatas(),m=0;m<b.size();m++){var t=b.get(m);K.contains(t)&&o.add(t)}o.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(f){this.beginTransaction(),f||(f=this.sm());for(var $=new zp,L=this.getDatas(),S=!1,E=0;E<L.size();E++){var H=L.get(E);f.contains(H)?S&&$.add(H):S=!0}$.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(s){this.beginTransaction(),s||(s=this.sm());for(var G=new zp,X=this.getDatas(),q=0;q<X.size();q++){var f=X.get(X.size()-1-q);s.contains(f)&&G.add(f)}G.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(E){var W=this;W.removeScheduleTask(E),E.enabled==f&&(E.enabled=!0),E.interval==f&&(E.interval=10),E.lastTime=Date.now(),W._29Q.push(E),W._30Q==f&&(W._30Q=u.requestAnimationFrame(W._scheduleCallback))},removeScheduleTask:function(y){var j=this,B=j._29Q,O=B.indexOf(y);O>=0&&B.splice(O,1),B.length||j._30Q==f||(u.cancelAnimationFrame(j._30Q),delete j._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(L){this._historyManager||new H.HistoryManager(this),null!=L&&this._historyManager.setMaxHistoryCount(L),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(z){this._historyManager&&this._historyManager.undo(z)},redo:function($){this._historyManager&&this._historyManager.redo($)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(v){this._historyManager&&this._historyManager.addHistory(v)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(R){R?this._isDeserializing++:this._isDeserializing--},updateLayoutAttach:function(x){this.each(function(T){T instanceof jh&&T.getImage()===x&&T.updateLayoutAttaches()})},isCubicEnvmap:function(){return!1},setCubicEnvmap:function(){},setEnvmap:function(I){var m=this._envmap;this._envmap=I,"object"==typeof m&&"object"==typeof I&&(m=null),this.fp("envmap",m,I)}});var Oc=H.SelectionModel=function(z){var $=this;$._68O=ul,$._map={},$._73O=new zp,$._74I=new Ef,$._21I(z)};Ce("SelectionModel",b,{ms_fire:1,ms_dm:1,ms:function(I,Y,q){this.addSelectionChangeListener(I,Y,q)},ums:function(c,l){this.removeSelectionChangeListener(c,l)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===To},co:function(X){return this._map[X._id]!=f},ss:function(m){this.setSelection(m)},as:function(h){this.appendSelection(h)},rs:function(d){this.removeSelection(d)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(V){var t=this;if(t._68O!==V&&(V===ae||V===To||V===ul)){t.cs();var K=t._68O;t._68O=V,t.fp("selectionMode",K,V)}},_21I:function(l){var j=this,W=j._dataModel;W!==l&&(W&&(j.cs(),W.umm(j.handleDataModelChange,j)),j._dataModel=l,l.mm(j.handleDataModelChange,j,!0),j.fp(Yk,W,l))},dispose:function(){var a=this;a.cs(),a._dataModel.umm(a.handleDataModelChange,a)},handleDataModelChange:function(s){var $=this;if(s.kind===xk){var w=s.data;$.co(w)&&($._73O.remove(w),delete $._map[w._id],$._75I(xk,new zp(w)))}else s.kind===$n&&$.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(I){var H=this;if(H._filterFunc!==I){H.cs();var s=H._filterFunc;H._filterFunc=I,H.fp("filterFunc",s,H._filterFunc)}},_75I:function(E,G,e,q){e&&(this._73O.each(function(A){q[A._id]?e.remove(A):e.add(A)}),G=e.toList()),this._74I.fire({kind:E,datas:new zp(G)})},addSelectionChangeListener:function(T,E,y){this._74I.add(T,E,y)},removeSelectionChangeListener:function(p,J){this._74I.remove(p,J)},_97O:function(K,C){for(var G,v=this,u=0,x=new zp(K);u<x.size();u++)G=x.get(u),(v._filterFunc&&!v._filterFunc(G)||C&&v.co(G)||!C&&!v.co(G)||!v._dataModel.contains(G))&&(x.removeAt(u),u--);return x},appendSelection:function(L){var Z=this;if(Z._68O!==ae){var C,m,U=Z._73O,H=Z._97O(L,!0);H.isEmpty()||(Z.sg()&&(C=new zp(U),m=Z._map,U.clear(),Z._map={},H=new zp(H.get(H.size()-1))),H.each(function(X){U.add(X),Z._map[X._id]=X}),Z._75I("append",H,C,m))}},removeSelection:function(I){var z=this,a=z._97O(I),R=0,_=a.size();if(0!==_){for(;_>R;R++){var c=a.get(R);z._73O.remove(c),delete z._map[c._id]}z._75I(xk,a)}},toSelection:function(o,F){return this._73O.toList(o,F)},getSelection:function(){return this._73O},each:function(v,I){this._73O.each(v,I)},setSelection:function(D){var m=this,B=m._73O;if(m._68O!==ae&&!(B.isEmpty()&&!D||1===B.size()&&m.ld()===D)){var p=new zp(B),d=m._map;B.clear(),m._map={};var l=m._97O(D,!0);m.sg()&&l.size()>1&&(l=new zp(l.get(l.size()-1))),l.each(function($){B.add($),m._map[$._id]=$}),m._75I("set",f,p,d)}},clearSelection:function(){var k=this,D=k._73O;if(D.size()>0){var B=D.toList();D.clear(),k._map={},k._75I($n,B)}},selectAll:function(){var v=this;if(v._68O!==ae){var Z,E,R=v._dataModel.toDatas();if(v._filterFunc)for(Z=0;Z<R.size();Z++)E=R.get(Z),v._filterFunc(E)||(R.removeAt(Z),Z--);var O=v._73O,Y=new zp(O),e=v._map;O.clear(),v._map={},v.sg()&&R.size()>1&&(R=new zp(R.get(R.size()-1)));var T=R.size();for(Z=0;T>Z;Z++)E=R.get(Z),O.add(E),v._map[E._id]=E;v._75I("all",f,Y,e)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(O){return this._map[O._id]!=f},getLastData:function(){var k=this._73O;return k.size()>0?k.get(k.size()-1):f},getFirstData:function(){var S=this._73O;return S.size()>0?S.get(0):f},isSelectable:function(H){var I=this;return H&&I._68O!==ae?I._filterFunc?I._filterFunc(H):!0:!1},getTopSelection:function(){var m=this,S=new zp;return m._73O.each(function(b){for(var M=b.getParent();M;){if(m.contains(M)){b=f;break}M=M.parent}b&&S.add(b)}),S}});var Cc=function(){return Ui(0),function(G,d){var M;if(vc(d)){var $=G.getDataUI(d);$&&$._88I&&(M=$._88I.rect)}return M?M:d.getRect()}}();Hi(L,{edgeGroupAgentFunc:f,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:D.rectSelectBorder,graphViewRectSelectBackground:Gl,graphViewEditPointSize:dn?17:7,graphViewEditPointBorderColor:D.editPointBorder,graphViewEditPointBackground:D.editPointBackground,setEdgeType:function(J,f,B){Ak[J]=f,sd[J]=B},getEdgeType:function(R){return Ak[R]},getEdgeTypeMap:function(){return Ak},getNodeRect:Cc},!0);var Vd={"layout.h":E,"layout.v":E,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":E,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:E,ingroup:!0,"body.color":E,"2d.gray":!1,fullscreen:E,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:E,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"vector.layoutable":!1,"clip.direction":"top","clip.percentage":E,"select.color":to,"select.width":1,"select.padding":2,"select.type":Bj,"shadow.interactable":!0,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":to,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":E,"border.width":2,"border.padding":2,"border.type":Bj,label:E,"label.font":E,"label.color":Tk,"label.background":E,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":E,"label.max":E,"label.opacity":E,"label.scale":1,"label.align":E,"label.selectable":!0,"label.decoration":E,label2:E,"label2.font":E,"label2.color":Tk,"label2.background":E,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":E,"label2.max":E,"label2.opacity":E,"label2.scale":1,"label2.align":E,"label2.selectable":!0,"label2.decoration":E,note:E,"note.expanded":!0,"note.font":E,"note.color":th,"note.background":to,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":E,"note.toggleable":!0,"note.border.width":1,"note.border.color":E,"note.opacity":E,"note.scale":1,"note.align":E,note2:E,"note2.expanded":!0,"note2.font":E,"note2.color":th,"note2.background":to,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":E,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":E,"note2.opacity":E,"note2.scale":1,"note2.align":E,"group.type":E,"group.image":E,"group.image.stretch":"fill","group.repeat.image":E,"group.border.repeat.image":E,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":E,"group.title.color":th,"group.title.background":D.groupTitleBackground,"group.title.align":re,"group.title.orientation":Fc,"group.background":D.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":E,"group.border.color":Dk,"group.border.radius":E,"group.border.cap":Am,"group.border.join":Jm,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":f,"group.gradient.color":"#FFF",shape:E,"shape.background":Dk,"shape.repeat.image":E,"shape.border.repeat.image":E,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Dk,"shape.border.3d":!1,"shape.border.3d.color":E,"shape.border.3d.accuracy":E,"shape.border.cap":Am,"shape.border.join":Jm,"shape.border.pattern":E,"shape.gradient":f,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Uf,"shape.dash.offset":0,"shape.dash.color":pp,"shape.dash.width":E,"shape.dash.3d":!1,"shape.dash.3d.color":E,"shape.dash.3d.accuracy":E,"shape.polygon.side":6,"shape.arc.from":O,"shape.arc.to":_,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":E,"shape.gradient.pack":E,"shape.border.gradient.pack":E,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":E,"shape.foreground":E,"shape.foreground.gradient":f,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":E,"shape.regular":!0,"autolayout.gap":E,"autolayout.hgap":E,"autolayout.vgap":E,"edge.type":E,"edge.points":E,"edge.segments":E,"edge.color":Dk,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":E,"edge.3d.accuracy":E,"edge.cap":Am,"edge.join":Jm,"edge.source.position":17,"edge.source.anchor.x":E,"edge.source.anchor.y":E,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":E,"edge.target.anchor.y":E,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":E,"edge.dash":!1,"edge.dash.pattern":Uf,"edge.dash.offset":0,"edge.dash.color":pp,"edge.dash.width":E,"edge.dash.3d":!1,"edge.dash.3d.color":E,"edge.dash.3d.accuracy":E,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":E,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":E,"grid.column.percents":E,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":D.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":D.gridCellBorderColor,"grid.block":E,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":D.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Tk,"text.gradient.pack":E,"text.font":Bh,"text.shadow":!1,"text.shadow.color":to,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,"text.gradient":E,"text.gradient.color":"#FFF","text.decoration":E,"text.vertical":!1,"text.vertical.gap":1,"text.wrap":!1,"text.letter.gap":null,"text.border.color":to,"text.border.width":0,keepPosition:!0};Vd[sg]=E,Hi(W,Vd,!0),Hi(Wo,{_76I:function(j,u,l){this._39I&&this._39I.fire({data:j,oldIndex:u,newIndex:l})},addIndexChangeListener:function(C,y,Y){var L=this;L._39I||(L._39I=new Ef),L._39I.add(C,y,Y)},removeIndexChangeListener:function(W,X){this._39I.remove(W,X)},prepareRemove:function(N){Op(N)&&(N.setSource(f),N.setTarget(f)),N._70O&&N._70O.toList().each(this.remove,this),N._69O&&N._69O.toList().each(function(q){q.setHost(f)}),N._host&&N.setHost(f)},onAdded:function(M){this.isAutoAdjustIndex()&&this.adjustIndex(M)},onDataPropertyChanged:function(R,_){Yg[_.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(R)},isAdjustable:function(f){return mq(f)||Op(f)},isAdjustedToBottom:function(L){return Zd(L)?L.isExpanded()&&Oe(L):!1},adjustIndex:function(E){var b=this;this.isHierarchicalRendering()||(b.isAdjustedToBottom(E)?(b.sendToBottom(E),E.eachChild(b.adjustIndex,b)):b.sendToTop(E))},sendToTop:function(v){var e=this;if(e.contains(v)&&e.isAdjustable(v)){var Y=e._datas;if(v!==Y.get(e.size()-1)){var k=Y.indexOf(v);Y.removeAt(k),Y.add(v),e._76I(v,k,e.size()-1)}if(Op(v)){var D=v._40I;D&&!e.isAdjustedToBottom(D)&&e.sendToTop(D),D=v._41I,D&&!e.isAdjustedToBottom(D)&&e.sendToTop(D)}v._69O&&v._69O.each(function(j){j.isRelatedTo(v)||mq(v)&&j.isLoopedHostOn(v)||e.sendToTop(j)}),v.ISubGraph||(!Zd(v)||v.isExpanded())&&v._adjustChildrenToTop&&v.eachChild(function(T){Op(T)||e.sendToTop(T)})}},sendToBottom:function(Z,x){var e=this;if(Z!==x&&e.contains(Z)&&e.isAdjustable(Z)&&(!x||e.contains(x))){var o=e._datas,F=o.remove(Z),X=x?e._datas.indexOf(x):0;if(o.add(Z,X),F!==X){e._76I(Z,F,X);var S=Z._parent;!S||S.ISubGraph||Op(S)||e.sendToBottom(Z._parent,Z)}}}}),Hi(ti,{ms_edit:function(b){b._46O=function(Y){var S=this,g=S.gv.dm(),z=S._index,v=S._89I,W=S._node,N=S._shape,x=S._edge,K=S._77I;W&&v?(this.fi({kind:"endEditRect",event:Y,data:W,direction:v}),g.endTransaction()):N&&z>=0?(S.fi({kind:"endEditPoint",event:Y,data:N,index:z}),g.endTransaction()):x&&z>=0?(S.fi({kind:"endEditPoint",event:Y,data:x,index:z}),g.endTransaction()):K&&(S.fi({kind:"endEditRotation",event:Y,data:K}),g.endTransaction())},b._78I=function($){var H=this;H.autoScroll($);var _=H.gv.lp($),n=H._index,A=H._89I,T=H._node,m=H._shape,R=H._edge,e=H._77I;if(T&&A)H._80O(_),H.fi({kind:"betweenEditRect",event:$,data:T,direction:A});else if(m&&n>=0)_.e=m.getPoints().get(n).e,m.setPoint(n,_),H.fi({kind:"betweenEditPoint",event:$,data:m,index:n});else if(R&&n>=0){var M=R.s(Ji);_.e=M.get(n).e,M.set(n,_),R.fp(Ji,f,M),H.fi({kind:"betweenEditPoint",event:$,data:R,index:n})}else if(e){var p=e.p(),C=e.getScale(),v=qq+ts(_.y-p.y,_.x-p.x);C.y<0&&(v+=O),a(v)<.04&&(v=0),e.setRotation(v),H.fi({kind:"betweenEditRotation",event:$,data:e})}},b._80O=function(K){var c=this,Y=c._node,y=c._rect,s=y.x,O=y.y,b=y.width,t=y.height,R=c._89I,H=c._anchor,x=c._matrix,K=x.tfi(K);"northwest"===R?y=Db(K,{x:s+b,y:O+t}):R===Wq?y=Db({x:s,y:K.y},{x:s+b,y:O+t}):"northeast"===R?y=Db({x:s,y:K.y},{x:K.x,y:O+t}):R===Xe?y=Db({x:K.x,y:O},{x:s+b,y:O+t}):R===Kg?y=Db({x:s,y:O},{x:K.x,y:O+t}):"southwest"===R?y=Db({x:K.x,y:O},{x:s+b,y:K.y}):"south"===R?y=Db({x:s,y:O},{x:s+b,y:K.y}):"southeast"===R&&(y=Db({x:s,y:O},K)),Y.setPosition(x.tf(y.x+y.width*H.x,y.y+y.height*H.y)),Y.setWidth(y.width),Y.setHeight(y.height)},b._80I=function(c,L,C,d){var X=this,r=X.gv._zoom,Z=(X.gv.getEditPointSize()+2)/r;return Sj({x:L-Z/2,y:C-Z/2,width:Z,height:Z},c)?(X._89I!==d&&(X._89I=d),!0):!1},b._79I=function(x,o,Y){var d=this,Z=d.gv,h=o?Z.getDataUI(o):f,W=h?h._55O:f;if(W){var g,A,M,X,G=Z._zoom,r=(Z.getEditPointSize()+2)/G,H=Z.lp(x);if(mq(o)){if(W._56O&&mq(o)&&(A=W._98o,Sj({x:A.x-r/2,y:A.y-r/2,width:r,height:r},H)))return d._77I=o,Y&&d.fi({kind:"beginEditRotation",event:x,data:o}),d.setCursor("crosshair"),!0;if(W._43O&&o instanceof vg)for(M=o.getPoints(),g=M.size()-1;g>=0;g--)if(A=M.get(g),Sj({x:A.x-r/2,y:A.y-r/2,width:r,height:r},H))return d._index=g,d._shape=o,Y&&d.fi({kind:"beginEditPoint",event:x,data:o,index:g}),d.setCursor("crosshair"),!0;if(W._42O)for(var P=o.getEditControlPoints(),u=["northwest",-1,-1,Xe,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Kg,1,0,"northeast",1,-1,Wq,0,-1],g=0,X=P.length;X>g;g++){var w=u[3*g],N=P[g];if(d._80I(H,N.x,N.y,w)){d._node=o;var U=o.getWidth(),K=o.getHeight(),q=o.getAnchor();d._rect={x:-U*q.x,y:-K*q.y,width:U,height:K},d._anchor=q,d._matrix=o.getMatrix();var T=o.getRotation(),c=J(T),D=B(T),R=u[3*g+1]*Wd(o.getScale().x),p=u[3*g+2]*Wd(o.getScale().y),$=Math.atan2(-D*R-c*p,c*R-D*p),e=(Math.round($/(Math.PI/4))+8)%8,I=[Ek,"nesw-resize",Er,"nwse-resize",Ek,"nesw-resize",Er,"nwse-resize"][e];return d.setCursor(I),Y&&d.fi({kind:"beginEditRect",event:x,data:o,direction:d._89I}),!0}}}if(W._43O&&Op(o)&&o.s(uo)===we&&(M=o.s(Ji)))for(g=M.size()-1;g>=0;g--)if(A=M.get(g),Sj({x:A.x-r/2,y:A.y-r/2,width:r,height:r},H))return d._index=g,d._edge=o,Y&&d.fi({kind:"beginEditPoint",event:x,data:o,index:g}),d.setCursor("crosshair"),!0}return!1}},ms_gv:function(G){G._currentSubGraph=f,G._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},G.upSubGraph=function(){this.setCurrentSubGraph(js(this._currentSubGraph))},G.isVisible=function(B){var c=this;if(js(B)!==c._currentSubGraph)return!1;if(Op(B)){var A=B._40I,H=B._41I;if(!A||!H)return!1;if(!(B.s("edge.independent")||c.isVisible(A)&&c.isVisible(H)))return!1;if(B.isEdgeGroupHidden())return!1}else for(var y=B._parent;y&&!y.ISubGraph;){if(Zd(y)&&(!y.isExpanded()||!c.isVisible(y)))return!1;y=y._parent}if(B._parent instanceof If&&!c.isVisible(B._parent))return!1;if(B._refGraph instanceof Wb&&!c.isVisible(B._refGraph))return!1;if(c instanceof Es){if(!B.s("3d.visible"))return!1}else{var i=c.getLayersInfo();if(i){var x=i[B._layer];if(x&&x.visible===!1)return!1}if(!B.s("2d.visible"))return!1}return c._visibleFunc?c._visibleFunc(B):!0},G.handleSelectionChange=function(K){var d=this;K.datas.each(function(J){d.invalidateData(J);var k=J._parent;Zd(k)&&mq(J)&&J.s(mf)&&(d.invalidateData(k),k._49I&&k._49I.each(function(v){d.invalidateData(v)}))}),d.onSelectionChanged(K)},G.onSelectionChanged=function(d){var T=this,m=T.sm();if(1===m.size()&&("set"===d.kind||"append"===d.kind)){var X=m.ld();T.isAutoMakeVisible()&&T.makeVisible(X),T.adjustIndex&&T._dataModel.isAutoAdjustIndex()&&T.adjustIndex(X)}},G.makeVisible=function(r){if(r){var T=this,c=T.getDataUI?T.getDataUI(r):T.getData3dUI(r);if(c){var L=r,h=js(r);for(h!==T._currentSubGraph&&T.setCurrentSubGraph(h);(L=L._parent)&&L!==h;)Zd(L)&&L.setExpanded(!0);T._23I=r,T.iv()}}},G.getLabel=function(s){var X=s.getStyle(oc);return X===E?s.getName():X},G.getLabelBackground=function(f){return f.getStyle("label.background")},G.getLabelColor=function(p){return p.getStyle("label.color")},G.getLabel2=function(u){return u.getStyle("label2")},G.getLabel2Background=function(s){return s.getStyle("label2.background")},G.getLabel2Color=function(Z){return Z.getStyle("label2.color")},G.getNote=function(r){return r.getStyle(Ap)},G.getNoteBackground=function(g){return g.getStyle("note.background")},G.getNote2=function(A){return A.getStyle(uj)},G.getNote2Background=function(X){return X.getStyle("note2.background")},G.handleClick=function(n,z,K){var B=this;z?(B.fi({kind:"clickData",event:n,data:z,part:K}),B.onDataClicked(z,n)):(B.fi({kind:"clickBackground",event:n}),B.onBackgroundClicked(n))
},G.handleDoubleClick=function(g,A,$){var L=this;zj(g)&&(A?(L.fi({kind:"doubleClickData",event:g,data:A,part:$}),L.onDataDoubleClicked(A,g,$),L.checkDoubleClickOnNote(g,A,$)||L.checkDoubleClickOnRotation&&L.checkDoubleClickOnRotation(g,A,$)||(Op(A)?L.onEdgeDoubleClicked(A,g,$):A.ISubGraph?L.onSubGraphDoubleClicked(A,g,$):Zd(A)?L.onGroupDoubleClicked(A,g,$):A.IDoorWindow?L.onDoorWindowDoubleClicked(A,g,$):A.ICSGBox&&L.onCSGBoxDoubleClicked(A,g,$))):(L.fi({kind:"doubleClickBackground",event:g}),L.onBackgroundDoubleClicked(g)))},G.onSubGraphDoubleClicked=function(J){this.setCurrentSubGraph(J)},G.onEdgeDoubleClicked=function(n,T){this.isEditable(n)||(n.ISubGraph&&!vf(T)?this.setCurrentSubGraph(n):n.s("edge.toggleable")&&n.toggle())},G._39Q=function(S){return this.isInteractive(S)?this.preventDefaultWhenInteractive(S):!1},G.preventDefaultWhenInteractive=function(c){return c.s("preventDefaultWhenInteractive")},G.onGroupDoubleClicked=function(c){c.s("group.toggleable")&&c.toggle()},G.onDoorWindowDoubleClicked=function(r){r.s("dw.toggleable")&&r.toggle(!0)},G.onCSGBoxDoubleClicked=function($,b){var g=this;if(g instanceof Es){var _=g.intersectObject(b,$);_&&$.s(_.part+".toggleable")&&$.toggleFace(_.part,!0)}},G.onBackgroundClicked=function(){},G.onBackgroundDoubleClicked=function(){this.upSubGraph()},G.onDataClicked=function(){},G.onDataDoubleClicked=function(){},G.onAutoLayoutEnded=function(){},G.onMoveEnded=function(){},G.onPanEnded=function(){},G.onPinchEnded=function(){},G.onRectSelectEnded=function(){},G.onZoomEnded=function(){},G.serialize=function(d){return this.dm().serialize(d)},G.toJSON=function(){return this.dm().toJSON()},G.deserialize=function(V,K){var h=this;K=K instanceof rd?{rootParent:K}:dk(K)?{setId:K}:fi(K)?{finishFunc:K}:K||{},K.view=h;var y=h.dm();return K.reset&&(y.setAttrObject({}),y.setLayers(E),y.setName(E),y.setAutoAdjustIndex(!0),y.setHierarchicalRendering(!1),y.setBackground(E),y.setInit(E),y.setPostProcessingData(E),y.setEnvmap(E),y.setEnvmapType(E),h.disableToolTip(),h instanceof H.graph.GraphView?(h.setZoomable(L.graphViewZoomable),h.setPannable(L.graphViewPannable),h.setRectSelectable(L.graphViewRectSelectable)):h instanceof H.graph3d.Graph3dView&&(h.shadowMap.resetProperties(),h.setDashDisabled(L.graph3dViewDashDisabled),h.setUvClipEnabled(L.graph3dViewUvClipEnabled),h.getHighlightHelper().resetProperties(),h.resetHeadlightProperties(),h.resetFogProperties(),h.setBatchInfoMap({}),h.setBatchColorDisabled(L.graph3dViewBatchColorDisabled),h.setBatchInstancedDisabled(L.graph3dViewBatchInstancedDisabled),h.setBatchBlendDisabled(L.graph3dViewBatchBlendDisabled),h.setBatchBrightnessDisabled(L.graph3dViewBatchBrightnessDisabled),h.setFlowBlendMode(L.graph3dViewFlowBlendMode),h.setMoveStep(L.graph3dViewMoveStep),h.setRotateStep(L.graph3dViewRotateStep),h.setSortable(L.graph3dViewSortable),h.setSortFunc(E),h.setSkybox(E),nc(h))),K.__innerHandler__=function(N){if(dk(y.a("toolTipEnable"))&&(y.a("toolTipEnable")?h.enableToolTip():h.disableToolTip()),h instanceof H.graph.GraphView&&(dk(y.a("zoomable"))&&h.setZoomable&&h.setZoomable(y.a("zoomable")),dk(y.a("pannable"))&&h.setPannable&&h.setPannable(y.a("pannable")),dk(y.a("rectSelectable"))&&h.setRectSelectable&&h.setRectSelectable(y.a("rectSelectable")),y.a("fitContent")===!0&&h.fitContent&&h.fitContent(!0,0)),h instanceof H.graph3d.Graph3dView){var O=N.scene;O&&O.shadow!=f&&h.shadowMap.setShadow(O.shadow,O.shadowParams);var J=y.a("sceneContext");J?(J.eye&&h.setEye(J.eye),J.center&&h.setCenter(J.center),$c(J.far)&&h.setFar(J.far),$c(J.near)&&h.setNear(J.near)):($c(y.a("sceneNear"))&&h.setNear(y.a("sceneNear")),$c(y.a("sceneFar"))&&h.setFar(y.a("sceneFar")),O&&(O.eye&&h.setEye(O.eye),O.center&&h.setCenter(O.center))),dk(y.a("sceneShadowEnabled"))&&(y.a("sceneShadowEnabled")?h.enableShadow():h.disableShadow()),$c(y.a("sceneShadowDegreeX"))&&h.setShadowDegreeX(y.a("sceneShadowDegreeX")),$c(y.a("sceneShadowDegreeZ"))&&h.setShadowDegreeZ(y.a("sceneShadowDegreeZ")),$c(y.a("sceneShadowIntensity"))&&h.setShadowIntensity(y.a("sceneShadowIntensity")),y.a("sceneShadowQuality")!=f&&h.setShadowQuality(y.a("sceneShadowQuality")),y.a("sceneShadowType")&&h.setShadowType(y.a("sceneShadowType")),$c(y.a("sceneShadowRadius"))&&h.setShadowRadius(y.a("sceneShadowRadius")),$c(y.a("sceneShadowBias"))&&h.setShadowBias(y.a("sceneShadowBias")),dk(y.a("sceneDashEnable"))&&h.setDashDisabled(!y.a("sceneDashEnable")),dk(y.a("sceneUvClipEnabled"))&&h.setUvClipEnabled(y.a("sceneUvClipEnabled")),Vn(y.a("sceneHighlightMode"))&&h.setHighlightMode(y.a("sceneHighlightMode")),$c(y.a("sceneHighlightWidth"))&&h.setHighlightWidth(y.a("sceneHighlightWidth")),y.a("sceneHighlightColor")&&h.setHighlightColor(y.a("sceneHighlightColor")),y.a("sceneHighlightType")&&h.setHighlightType(y.a("sceneHighlightType")),y.a("sceneHighlightGlow")&&h.setHighlightGlow(y.a("sceneHighlightGlow")),y.a("sceneHighlightStrength")&&h.setHighlightStrength(y.a("sceneHighlightStrength")),dk(y.a("sceneHeadlightEnable"))&&h.setHeadlightDisabled(!y.a("sceneHeadlightEnable")),y.a("sceneHeadlightDirection")!=f&&h.setHeadlightDirection(y.a("sceneHeadlightDirection")),$c(y.a("sceneHeadlightRange"))&&h.setHeadlightRange(y.a("sceneHeadlightRange")),y.a("sceneHeadlightColor")&&h.setHeadlightColor(y.a("sceneHeadlightColor")),$c(y.a("sceneHeadlightIntensity"))&&h.setHeadlightIntensity(y.a("sceneHeadlightIntensity")),$c(y.a("sceneHeadlightAmbientIntensity"))&&h.setHeadlightAmbientIntensity(y.a("sceneHeadlightAmbientIntensity")),$c(y.a("sceneHeadlightGroup"))&&h.setHeadlightGroup(y.a("sceneHeadlightGroup")),dk(y.a("sceneFogEnable"))&&h.setFogDisabled(!y.a("sceneFogEnable")),y.a("sceneFogMode")&&h.setFogMode(y.a("sceneFogMode")),$c(y.a("sceneFogDensity"))&&h.setFogDensity(y.a("sceneFogDensity")),y.a("sceneFogColor")&&h.setFogColor(y.a("sceneFogColor")),$c(y.a("sceneFogNear"))&&h.setFogNear(y.a("sceneFogNear")),$c(y.a("sceneFogFar"))&&h.setFogFar(y.a("sceneFogFar")),dk(y.a("sceneBatchBrightnessDisabled"))&&h.setBatchBrightnessDisabled(y.a("sceneBatchBrightnessDisabled")),y.a("sceneFlowBlendMode")!==E&&h.setFlowBlendMode(y.a("sceneFlowBlendMode")),dk(y.a("sceneBatchBlendDisabled"))&&h.setBatchBlendDisabled(y.a("sceneBatchBlendDisabled")),dk(y.a("sceneBatchColorDisabled"))&&h.setBatchColorDisabled(y.a("sceneBatchColorDisabled")),dk(y.a("sceneBatchInstancedDisabled"))&&h.setBatchInstancedDisabled(y.a("sceneBatchInstancedDisabled")),y.a("sceneBatchInfoMap")&&h.setBatchInfoMap(y.a("sceneBatchInfoMap")),$c(y.a("sceneMoveStep"))&&h.setMoveStep(y.a("sceneMoveStep")),$c(y.a("sceneRotateStep"))&&h.setRotateStep(y.a("sceneRotateStep")),dk(y.a("sceneSortable"))&&h.setSortable(y.a("sceneSortable")),fi(y.a("sceneSortFunc"))&&h.setSortFunc(y.a("sceneSortFunc"));var x=y.a("sceneSkyboxType")||"sphere";if(x!=f){var G={},X=!1;if("sphere"===x){G.shape3d=x;var F=y.a("sceneSkyboxImage");F&&(G["shape3d.image"]=F,X=!0)}else"cube"===x?(G.shape3d=E,["front","back","left","right","top","bottom"].forEach(function(K){var r=K+".image",n=K.charAt(0).toUpperCase()+K.slice(1),I=y.a("sceneSkybox"+n+"Image");I&&(G[r]=I,X=!0)})):"color"===x&&(X=!0);if(X){var W=new jh,S=y.a("sceneSkyboxDiameter");if($c(S)?W.s3(S,S,S):W.s3(20,20,20),G["body.color"]=y.a("sceneSkyboxBodyColor"),G.envmap=y.a("sceneSkyboxEnvmap"),G["envmap.probe"]=y.a("sceneSkyboxEnvmapProbe"),G.roughness=y.a("sceneSkyboxRoughness"),G["shape3d.light"]=G["all.light"]=y.a("sceneSkyboxLight"),G["light.mask"]=y.a("sceneSkyboxLightMask"),G["headlight.ambientIntensity"]=y.a("sceneSkyboxHeadLightAmbientIntensity"),G["texture.wrap"]="clampToEdge",G["3d.clipbox.mask"]=Ee,G["effect.flow.mask"]=Ee,"color"===x){G.shape3d="sphere";var U=2,P=1024,F=W.s("shape3d.image"),q=F&&H.Default.getImage(F);q&&"CANVAS"===q.tagName||(q=Y.createElement("canvas"),F=H.Math.generateUUID(),H.Default.setImage(F,q)),F&&h.getTextureMap()&&h.deleteTexture(F),H.Default.setCanvas(q,U,P,1);var o=q.getContext("2d");o.clearRect(0,0,U,P),o.beginPath(),o.rect(0,0,U,P),Lf(o,y.a("sceneSkyboxColor"),function(x){return x},!1,{x:0,y:0,width:U,height:P}),o.fill(),o.restore(),G["shape3d.image"]=F}W.s(G),["X","Y","Z"].forEach(function(G){var O=y.a("sceneSkyboxRotation"+G);$c(O)&&W["setRotation"+G](O)}),h.setSkybox(W)}}}},y.deserialize(V,K.rootParent,K)},G.isDebugTipShowing=function(){return!!this._debugDiv},G.showDebugTip=function(){var O=this,t=O._debugDiv;if(!t){t=O._debugDiv=Y.createElement("div"),t.style.position="absolute",t.style.overflow="hidden",t.style.font=L.debugTipLabelFont,t.style.padding="6px",t.style.backgroundColor=L.debugTipBackground,t.style.color=L.debugTipLabelColor;var a=O.getView();O._79O?a.insertBefore(t,O._79O):a.appendChild(t);var r=function(){O.redraw();var e=O._canvas,s="FPS: "+O._fpsInfo.fps+"<br/>"+"Datas: "+O.dm().getDatas().length+(e?"<br/>Size: "+e.width+" * "+e.height:""),P=O.dm()._historyManager;P&&(s+="<br/>Undoes: "+P.getHistories().length+" index: "+P.getHistoryIndex());var X=O.getDebugTip();X&&(s+="<hr>"+X),t.innerHTML=s,O._isDebugging&&requestAnimationFrame(r)};requestAnimationFrame(r),O._isDebugging=!0}},G.hideDebugTip=function(){var U=this,Z=U._debugDiv;Z&&(delete U._debugDiv,U.getView().removeChild(Z),U._isDebugging=!1)},G.updateDOMAppendMatrix=function(){var w=this.getView();w&&(w.updateAppendMatrix=!0)},G.countFrame=function(){if(this._isDebugging){var E=Date.now(),J=this._fpsInfo;E-J.time>1e3?(J.fps=Math.round(1e5*(J.frames+1)/(E-J.time))/100,J.time=E,J.frames=0):J.frames++}}},ms_icons:function(z){z.getRotation=function(Z){return Z==f?0:Z},z._15O=function(){var x=this,M=x.s(cb);if(M){var s=x,N=x.data||x._data,m=N.getRotation&&N.getRotation(),k=x._38o={icons:M,rects:{}};for(var G in M){var L=M[G],o=kh(L.shape3d,N,s);if(!(kh(L.visible,N,s)===!1||kh(L.for3d,N,s)&&!x.I3d||o&&!x.I3d)){var i=o?[o]:kh(L.names,N,s),X=i?i.length:0,b=kh(L.position,N,s)||3,Q=kh(L.offsetX,N,s)||0,c=kh(L.offsetY,N,s)||0,v=kh(L.direction,N,s)||Kg,h=kh(L.gap,N,s),j=h!=f?h:1,B=kh(L.rotation,N,s),n=kh(L.keepOrien,N,s),u=kh(L.rotationFixed,N,s)?B:x.getRotation(B,n,b),A=f,H=k.rects[G]=new Array(X);$c(m)&&($c(u)?u+=m:u=m),H.rotation=u;for(var l=0;X>l;l++){var p,z,V,Y,a=i[l];if(o)V=0,Y=0;else{var g=mr(a);V=kh(L.width,N,s),Y=kh(L.height,N,s),V==f&&(V=Bb(g,N)),Y==f&&(Y=qh(g,N))}if(A?v===Kg?Q+=V/2:v===Xe?Q-=V/2:v===Wq?c-=Y/2:c+=Y/2:A={width:V,height:Y},x.I3d){var C=-V/2,D=-Y/2;z={width:V,height:Y,mat:x._16O(kh(L.autorotate,N,s),b,A,kh(L.face,N,s)||Bc,kh(L.t3,N,s),kh(L.r3,N,s),kh(L.rotationMode,N,s),Q,c),vs:new Qb([C,-D,0,C,-D-Y,0,C+V,-D-Y,0,C+V,-D,0])}}else p=x.getPosition(b,Q,c,A,kh(L.positionFixed,N,s)),z={x:p.x-V/2,y:p.y-Y/2,width:V,height:Y},x._68o(z,u);H[l]=z,v===Kg?Q+=V/2+j:v===Xe?Q-=V/2+j:v===Wq?c-=Y/2+j:c+=Y/2+j}}}}}}});var Mk={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},rf={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},Bi={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Yg={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Jr={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Em={"edge.type":1,"edge.group":1},Fr={rotation:1,rotationX:1,rotationZ:1,rotation3d:1},nd={rotation:1,position:1,width:1,height:1,anchor:1,scale:1,host:1},Gg={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},Pb={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},nm={shape:1,thickness:1,position:1,anchor:1,scale:1},js=function(P){if(!P)return f;if(Op(P)){var k=P._40I,Z=P._41I;if(!k||!Z)return f;var w=js(k),m=js(Z);return w===m?w:f}for(var s=P._parent;Op(s)&&!s.ISubGraph;)s=s._parent;return s?s.ISubGraph?s:js(s):f},xs=function(D,H,I,c){var K=H.getStyle(I)*c;K&&Qd(D,K),K=H.getStyle(I+".left")*c,K&&(D.x-=K,D.width+=K),K=H.getStyle(I+".right")*c,K&&(D.width+=K),K=H.getStyle(I+".top")*c,K&&(D.y-=K,D.height+=K),K=H.getStyle(I+".bottom")*c,K&&(D.height+=K),D.width<0&&(D.width=-D.width,D.x-=D.width),D.height<0&&(D.height=-D.height,D.y-=D.height)},Oe=function(i){for(var J,c=0,g=i.size();g>c;c++)if(J=i.getChildAt(c),mq(J)&&Oe(J))return!0;return i.hasAgentEdges()},Yp=function(Q){if(!Q)return f;for(var i=Q._parent;Zd(i);){if(!Zd(i._parent))return i.isExpanded()?Q:i;i.isExpanded()||(Q=i),i=i._parent}return Q},Uc=function(D,t){if(!D||!t)return f;var h,c,F,R=js(D),e=js(t);if(R!==e){for(;e&&R!==e;)e=js(e);if(R===e)return D;h=new zp,h.add(D,0);for(var Z=D._parent;mq(Z)&&!t.isDescendantOf(Z);)h.add(Z,0),Z=Z._parent;for(F=h.size(),c=0;F>c;c++){var Y=h.get(c);if(Zd(Y)&&!Y.isExpanded())return Y;if(Y.ISubGraph)return Y}return D}return D},cr=function(N){if(N.isLooped())return N._source;var z=Yp(N._source),M=Yp(N._target);return z===M?N._source:Uc(z,M)},In=function(v){if(v.isLooped())return v._target;var s=Yp(v._source),f=Yp(v._target);return s===f?v._target:Uc(f,s)},Di=function(y,q,e){"target"!==e&&(e="source");var X="target"===e?q.getTargetAgent():q.getSourceAgent(),k="edge."+e+".";if(Op(X)){var N=y.getDataUI(X);N._79o();var H=q.s(k+"index");if(H>=0){var G=xe(N);return G[Math.max(0,Math.min(H,G.length-1))]}var Q=q.s(k+"percent")||0;Q=Math.max(0,Math.min(Q,1));var a=ks(N);return Sq(a,100*Q)}return $q(y,X,q.s(k+"position"),q.s(k+"offset.x"),q.s(k+"offset.y"),q.s(k+"anchor.x"),q.s(k+"anchor.y"))},$q=function(k,G,v,C,Q,d,K){if(!G)return f;var D,q=G.getRotation?G.getRotation():0;if(d!==E||K!==E){d=d===E?.5:d,K=K===E?.5:K;var z=G.getScale();if(q&&!vc(G,k)||z.x<0||z.y<0){var t=G.getPosition(),N=G.getWidth(),b=G.getHeight(),F=G.getAnchor(),n=new ph(q,t.x,t.y,z.x,z.y);v=n.tf((d-F.x)*N,(K-F.y)*b)}else D=Cc(k,G),v={x:D.x+d*D.width,y:D.y+K*D.height}}else v=Nb(v,Cc(k,G));if(q){var O=J(q),T=B(q),y=C*O-Q*T;Q=C*T+Q*O,C=y}return v.x+=C,v.y+=Q,v},Of=function(i,y){if(!i||!y)return f;var K,I,g,M,J,C;if(i===y){if(M=i.getLoopedEdges(),!M)return f;M=new zp(M)}else{if(J=i.getAgentEdges(),C=y.getAgentEdges(),!J||!C)return f;for(I=J.size(),K=0;I>K;K++)g=J.get(K),C.contains(g)&&(M||(M=new zp),M.add(g))}if(M)for(K=0;K<M.size();K++)g=M.get(K),g.getStyle(uo)===we&&(g._22I(f),M.removeAt(K),K--);return M},rm=function(g,R){var p=Of(g,R);if(p&&!p.isEmpty()){if(1===p.size())return p.get(0)._22I(f),void 0;var S=new zp,Z=new zp;p.each(function(u){var k=u.s("edge.group");S.contains(k)||S.add(k)}),S.sort(),S.each(function(C){Z.add(new H.EdgeGroup(p.toList(function(G){return C===G.s("edge.group")}),Z))}),Z.each(function(G){G.each(function(_){_._22I(G)})})}},dc=function(p,M,g){var Z=p._canvas;p._zoom;var l=Gm(M,Z),b=Gm(g,Z);return{x:l.x-b.x,y:l.y-b.y}},mi=function(s,o){if(o){var x=o.rect,r=o.color,U=o.rotation,j=o.labelWidth,A=o.background,B=o.opacity,c=o.scale,$=c!=f&&1!==c;if(B!=f){var d=s.globalAlpha;s.globalAlpha*=B}if(U||$){s.save();var Z=x.x+x.width/2,y=x.y+x.height/2;rn(s,Z,y),U&&bo(s,U),$&&s.scale(c,c),rn(s,-Z,-y)}if(A&&Nj(s,x.x,x.y,x.width,x.height,A),j){var n=x.width,R=s.createLinearGradient(x.x,x.y,x.x+n,x.y);R.addColorStop(0,r),R.addColorStop(.9,r),R.addColorStop(1,Wm),r=R,x.width=j}Or(s,o.ss,x,o.font,r,o.align,o.decoration),j&&(x.width=n),(U||$)&&s.restore(),B!=f&&(s.globalAlpha=d)}},fo=function(v,b){if(b){var P=b.rect,d=P.x,L=P.y,g=P.width,x=P.height,H=b.background,$=b.backgroundImage,y=b.borderWidth,q=b.borderColor,Y=b.labelWidth,i=b.opacity,U=b.scale,s=U!=f&&1!==U;if(i!=f){var J=v.globalAlpha;v.globalAlpha*=i}if(s){v.save();var V=P.x+P.width/2,K=P.y+P.height/2;rn(v,V,K),v.scale(U,U),rn(v,-V,-K)}if(b.expanded){var A=h(8,g/4),M=L+x-8;if(v.fillStyle=H,v.beginPath(),v.moveTo(d,L),v.lineTo(d,M),v.lineTo(d+g/2,M),v.lineTo(d+g/2,L+x),v.lineTo(d+g/2+A,M),v.lineTo(d+g,M),v.lineTo(d+g,L),v.closePath(),v.fill(),y&&(v.lineWidth=y,v.lineJoin="round",v.lineCap="round",q?(v.strokeStyle=q,v.stroke()):(v.strokeStyle=Pd(H),v.beginPath(),v.moveTo(d+g,L),v.lineTo(d+g,M),v.lineTo(d+g/2+A,M),v.lineTo(d+g/2,L+x),v.stroke(),v.strokeStyle=Zk(H),v.beginPath(),v.moveTo(d+g,L),v.lineTo(d,L),v.lineTo(d,M),v.lineTo(d+g/2,M),v.lineTo(d+g/2,L+x),v.stroke())),$)Tc(v,mr($),kp,P.x,P.y,P.width,P.height-8,b.data,b.view);else{if(P.height-=8,H=b.color,Y){var l=g,E=v.createLinearGradient(d,L,d+l,L);E.addColorStop(0,H),E.addColorStop(.9,H),E.addColorStop(1,Wm),H=E,P.width=Y}Or(v,b.ss,P,b.font,H,b.align),Y&&(P.width=l),P.height+=8}}else if(b.icon)Pi(v,mr(b.icon),d,L,g,x,b.data,b.view);else{var R=g/2;y&&(v.lineWidth=y,v.lineJoin="round",v.lineCap="round",v.strokeStyle=q?q:Pd(H),v.beginPath(),v.arc(d+R,L+R,R,qq,1.6*O,!0),v.moveTo(d+R,L+x),v.lineTo(d+g-R/5,L+R),v.stroke(),v.strokeStyle=q?q:Zk(H),v.beginPath(),v.arc(d+R,L+R,R,1.6*O,qq,!0),v.moveTo(d+R,L+x),v.lineTo(d+R/5,L+R),v.stroke()),v.fillStyle=H,v.beginPath(),v.arc(d+R,L+R,R,0,_,!0),v.moveTo(d+R,L+x),v.lineTo(d+g-R/5,L+R),v.lineTo(d+R/5,L+R),v.closePath(),v.fill(),v.fillStyle=b.color,v.beginPath(),v.arc(d+R,L+R,R/3,0,_,!0),v.fill()}s&&v.restore(),i!=f&&(v.globalAlpha=J)}},ac=function(f,X){return X>2*f?f:X/2},ij=function(y,G,L,X){if(!y||!G)return 0;var K=ts(G.y-y.y,G.x-y.x);return L||(K=G.x<y.x?K+O:K),K+X},hb=function(n,f,Q,A,W,u,v){v&&(n.x>f.x||n.x===f.x&&n.y>f.y)&&(Q=sh[Q],W=-W);var s=Nb(Q,{x:0,y:0,width:Mp(n,f),height:0},u);return s.x+=A,s.y+=W,s=new ph(ts(f.y-n.y,f.x-n.x)).tf(s),s.x+=n.x,s.y+=n.y,s},Kl=function(A,O,t,Y,$){if(A._19Q=!0,!t.getEdgeGroup())return Y?t.s("edge.gap"):0;if(Op(t.getSourceAgent())||Op(t.getTargetAgent()))return 0;var P,T=0,I=0,L=0;if(t.getEdgeGroup().getSiblings().each(function(N){N.each(function(r){if(O.isVisible(r)&&r.s(uo)==$){var q=r.s("edge.gap");P?(I+=L/2+q/2,L=q):(P=r,L=q),r===t&&(T=I)}})}),Y)return I-T+L;var G=T-I/2;return P&&t._40I!==P._40I&&(A._19Q=!1),G},kc=function(V){var n=V._getValidSelection();if(1===n.length){var i=n[0],o=i instanceof H.Edge;if(i instanceof H.Shape||o){if(o){var C=i.s("edge.type");if(C&&"points"!==C)return}var c=V.gv;if((!c.isPointEditable||c.isPointEditable(i))&&c.isEditable(i))return i}}},Oo=function(){var K=function(P){var S=[];return P.forEach(function(F){S.push({x:F.x,y:F.y}),S.push({x:F.x+F.width,y:F.y+F.height}),S.push({x:F.x+F.width,y:F.y}),S.push({x:F.x,y:F.y+F.height})}),S};return function(U,z,n){if("oval"===U){var w=0,T=n.height/n.width,X=T*T,f=n.x+n.width/2,o=n.y+n.height/2,q=K(z);q.forEach(function(q){var N=q.x-f,U=q.y-o,c=N*N+U*U/X;c>w&&(w=c)}),w=G(w);var j=T*w;return{x:f-w,y:o-j,width:2*w,height:2*j}}if("circle"===U){var t=0,f=n.x+n.width/2,o=n.y+n.height/2,q=K(z);return q.forEach(function(z){var i=z.x-f,F=z.y-o,Y=i*i+F*F;Y>t&&(t=Y)}),t=G(t),{x:f-t,y:o-t,width:2*t,height:2*t}}return"roundRect"===U?(Qd(n,h(n.width,n.height)/16),n):n}}(),Gc=H.graph={},Sc=function(x,l,U){kl(K+".graph."+x,l,U)};H.layout={};var nb={},Yl=function(I,Y,O,c,p,C,v,x){var u=v._zoom;if(u!==v._cacheZoom&&(v._cacheZoom=u,v._cacheImage={}),u*=od,c=Math.ceil(c),p=Math.ceil(p),c*u>2048||p*u>2048)return Y;var M=[Y.uuid,c,p,O].join("_");if(Y.cacheRule){var g;g=fi(Y.cacheRule)?Y.cacheRule(C,v):kh(Y.cacheRule,C,v),M+="_"+g}var q,r=1;p>=c&&r>c*u?(q=p/c,c=r/u,p=c*q):c>=p&&r>p*u&&(q=c/p,p=r/u,c=p*q),c=Math.ceil(c),p=Math.ceil(p);var R=v._cacheImage[M];if(!R){if(Zp(),R=H.Default.toCanvas(Y,c,p,O,C,v,x,u),!kr())return Y;v._cacheImage[M]=R}return R};Hi(L,{setImageCacheRule:function(a,M){var s;M||"object"!=typeof a?(s={},s[a]=M):s=a;for(var Q in s){var t=s[Q];Vn(Q)?(kl=mr(Q),kl?kl.cacheRule=t:nb[Q]=t):Q.cacheRule=t}}});var Zn={comps:[{type:pc,points:[85,50,70,115,100,71,86,107,88,49,56,101,86,87,80,101,106,70,110,108,107,97,117,70,84,73,86,77,49,117,52,65,78,74,80,118,102,47,83,54,104,115,73,61],borderWidth:1,borderColor:f}]};if(Zn[Mj]=Zn[_p]=160,u.Image){var Kp=new u.Image;Kp.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",eo("default_blank",Kp)}eo("node_image",Rb(30,30,[{type:Bj,rect:[4,5,22,16],gradient:pk,gradientColor:Id,background:Dk},{type:Bj,rect:[2,3,26,20],borderWidth:1,borderColor:Dk},{type:Bj,rect:[11,23,8,4],background:Dk},{type:Bj,rect:[6,27,18,2],background:Dk}])),eo("node_icon",Rb(16,16,[{type:Bj,rect:[2,2,12,10],gradient:pk,gradientColor:Id,background:Dk},{type:_f,rect:[2,2,12,10],width:1,color:Dk},{type:Bj,rect:[6,12,4,2],background:Dk},{type:Bj,rect:[4,14,8,1],background:Dk}])),eo("block_icon",Rb(16,16,[{type:_f,rect:[1,1,14,14],width:1,color:Dk}])),eo("group_image",Rb(66,39,[{type:Bj,rect:[44.3,18,18.1,12.8],gradient:pk,gradientColor:Id,background:Dk},{type:Bj,rect:[3.3,17.8,18.1,12.8],gradient:pk,gradientColor:Id,background:Dk},{type:Bj,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Dk,gradient:pk,gradientColor:Id,background:Dk},{type:Bj,rect:[26.2,29.4,12.8,4.2],background:Dk},{type:Bj,rect:[21.3,33.5,22.5,2.3],background:Dk},{type:Bj,rect:[5.3,32.7,14.1,2.1],background:Dk},{type:Bj,rect:[9,30.4,6.7,2.4],background:Dk},{type:Bj,rect:[50,30.7,6.7,2.4],background:Dk},{type:Bj,rect:[46.3,33,14.1,2.1],background:Dk}])),eo("group_icon",Rb(16,16,[{type:Bj,rect:[4,12,4,2],background:Dk},{type:Bj,rect:[2,13,8,1],background:Dk},{type:Bj,rect:[12,12,2,1],background:Dk},{type:Bj,rect:[11,13,4,1],background:Dk},{type:Bj,rect:[10,7,6,5],gradient:pk,gradientColor:Id,background:Dk},{type:Bj,rect:[1,2,10,10],gradient:pk,gradientColor:Id,background:Dk},{type:_f,rect:[1,2,10,10],width:1,color:Dk}])),eo("refGraph_icon",Rb(16,16,[{type:"shape",borderWidth:1,borderColor:Dk,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Dk,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),eo("edge_icon",Rb(16,16,[{type:Bj,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:pk,gradientColor:Id,background:Dk},{type:Bj,rect:[10.8,1,4,4],background:Dk},{type:Bj,rect:[1,11,4,4],background:Dk}])),eo("subGraph_image",Rb(72,45,[{type:pc,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:pk,gradientColor:Id,background:Dk},{type:Bj,rect:[29.6,30.7,3.6,1.8],background:Dk},{type:Bj,rect:[28.4,32.3,6,1.2],background:Dk},{type:Bj,rect:[37.3,32,10.8,1.8],background:Dk},{type:Bj,rect:[39.1,29.9,7.2,2.3],background:Dk},{type:Bj,rect:[26.6,23.7,9.6,7.2],gradient:pk,gradientColor:Id,background:Dk},{type:Bj,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Dk,gradient:pk,gradientColor:Id,background:Dk}])),eo("subGraph_icon",Rb(17,17,[{type:pc,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:pk,gradientColor:Id,background:Dk}])),eo("shape_icon",Rb(16,16,[{type:pc,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Dk}])),eo("polyline_icon",Rb(16,16,[{type:pc,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Dk},jb(7.5,.4),jb(7.5,6.3),jb(13.6,6.3),jb(13.6,14),jb(.7,13.9),jb(.7,.3)])),eo("grid_icon",Rb(16,16,[{type:Bj,rect:[1,1,4,4],background:Dk,gradient:pk,gradientColor:Id},{type:Bj,rect:[6,1,4,4],background:Dk,gradient:pk,gradientColor:Id},{type:Bj,rect:[11,1,4,4],background:Dk,gradient:pk,gradientColor:Id},{type:Bj,rect:[11,6,4,4],background:Dk,gradient:pk,gradientColor:Id},{type:Bj,rect:[6,6,4,4],background:Dk,gradient:pk,gradientColor:Id},{type:Bj,rect:[1,6,4,4],background:Dk,gradient:pk,gradientColor:Id},{type:Bj,rect:[11,11,4,4],background:Dk,gradient:pk,gradientColor:Id},{type:Bj,rect:[6,11,4,4],background:Dk,gradient:pk,gradientColor:Id},{type:Bj,rect:[1,11,4,4],background:Dk,gradient:pk,gradientColor:Id}])),eo("light_icon",Rb(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Dk},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Dk,gradient:pk,gradientColor:Id,background:{func:function(w){var U=w?w.s(Vb):f;return br(U)?"rgb("+cm(255*U[0])+","+cm(255*U[1])+","+cm(255*U[2])+")":U||Dk}}}])),eo("text_icon",Rb(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Dk}])),eo("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),eo("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),eo("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),eo("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var xm=function(D,E,b,Y,t,v){var L,n,q,x,W,l,f,N,o,p,h,$=[];if(Math.abs(Y)>2*Math.PI&&(Y=2*Math.PI),W=Math.ceil(Math.abs(Y)/(Math.PI/4)),L=Y/W,n=-L,q=-b,W>0){l=D+Math.cos(b)*t,f=E+Math.sin(-b)*v,$.push({x:l,y:f});for(var O=0;W>O;O++)q+=n,x=q-n/2,N=D+Math.cos(q)*t,o=E+Math.sin(q)*v,p=D+Math.cos(x)*(t/Math.cos(n/2)),h=E+Math.sin(x)*(v/Math.cos(n/2)),$.push({x:p,y:h}),$.push({x:N,y:o})}return $},jn=function(r){if(r){var I=r._data;if(I instanceof H.Shape)return{points:I.getPoints(),segments:I.getSegments()};var f;if(I instanceof H.Edge&&(f=r._78o)){var $,X,m=f.type,B=f.points,S=f.segments,v=f.edgeTypeInfo;if(!m||B){var N=f.sourcePoint,p=N.x,l=N.y,b=f.targetPoint,E=b.x,h=b.y;if(m)S?($=new zp({x:p,y:l}),$.addAll(B),$.add({x:E,y:h}),X=new zp(S._as)):($=new zp({x:p,y:l}),B.each(function(q){$.add(q)}),$.add({x:E,y:h}));else if(f.looped){$=new zp(xm(p,l,0,2*Math.PI,f.radius,f.radius)),X=new zp([1]);for(var W=0;W<($.size()-1)/2;W++)X.add(3)}else $=new zp,f.center?($.add({x:f.c1.x,y:f.c1.y}),$.add({x:p,y:l}),$.add({x:E,y:h}),$.add({x:f.c2.x,y:f.c2.y})):($.add({x:p,y:l}),$.add({x:E,y:h}))}else v&&($=new zp(v.points._as),v.segments&&(X=new zp(v.segments._as)));return{points:$,segments:X}}}},ks=function(x,C,j){if(null==C){var R=jn(x);if(!R)return;C=R.points,j=R.segments}if(C){if(Array.isArray(C)&&(C=new zp(C)),"number"==typeof C.get(0)){for(var i=new H.List,r=0;r<C.size();r+=2)i.add({x:C.get(r),y:C.get(r+1)});C=i}if(!j){j=[1];for(var E=C.length-1;E>0;E--)j.push(2)}Array.isArray(j)&&(j=new zp(j));for(var B=Hc(C._as,j._as,50),X=B.length,f=[],r=0;X>r;r++){var O=B[r];O.length>1&&f.push(O)}return f}},bk=function(m){for(var j=0,X=m.length-1,s=0;X>s;s++){var G=m[s],I=m[s+1],M=I.x-G.x,n=I.y-G.y;j+=Math.sqrt(M*M+n*n)}return j},Pf=function(i,B){for(var y=0,J=B.length,Y=0;J>Y;Y++){var E=B[Y];if(y+=E,y>i)return Y}return Math.min(Y,J-1)},Fd=function(u,A){for(var s=0,j=0,C=0,J=u.length-1,q=0;J>q;q++){var O=u[q],Z=u[q+1],z=Z.x-O.x,k=Z.y-O.y;if(C=Math.sqrt(z*z+k*k),s+=C,s>A){s-=C,j=q;break}}var x=u[j],R=u[j+1],$=Math.atan2(R.y-x.y,R.x-x.x),b=A-s,k=Math.sin($)*b,z=Math.cos($)*b;return{x:x.x+z,y:x.y+k}},Sq=function(K,s){if(K){var n;if(0===s)n=K[0][0];else if(100===s)K=K[K.length-1],n=K[K.length-1];else{for(var e=0,t=[],N=K.length,_=0;N>_;_++){var H=K[_],l=bk(H);e+=l,t.push(l)}for(var z=e*s/100,F=Pf(z,t),I=0,h=0;F>h;h++)I+=t[h];z-=I,n=Fd(K[F],z)}return n}},xe=function(N){var Z,$;if(N instanceof Rp){var Q=jn(N);Z=Q.points,$=Q.segments}else Z=arguments[0],$=arguments[1];var B,E,q,Y,U=[],M=-1;for(E=0,q=$?$.length:Z.length;q>E;E++){if(B=$?$.get(E):1,3===B)Y=2;else if(4===B)Y=3;else{if(5===B)continue;Y=1}M+=Y,U.push(Z.get(M))}return U},wm=function(e,f,r,h){function F(U){if(U>=0&&1>=U){B=f(U);var x=(e.x-B.x)*(e.x-B.x)+(e.y-B.y)*(e.y-B.y);return Y>x?(Y=x,m=U,!0):!1}}r=r||100,h=h||1e-5;for(var Y=1/0,m=0,B=new pb,N=0;r>N;++N)F(N/r);for(var a=1/(2*r);a>h;)F(m-a)||F(m+a)||(a/=2);return m};Hi(L,{_edgeProtectMethod:{getStraightLinePoints:ks,calculateLineLength:bk,calcSegmentIndexByDistance:Pf,calculatePointAlongLine:Fd,getPercentPosition:Sq,getRealPointsFromDataUI:xe}});var $d=function(W,L){for(var B=W.vertices,$=0;$<B.length;$++){var A=B[$],I=A.y;A.y=A.z,A.z=-I,L&&(A.y+=L)}},wi=function(g){for(var P,d,r,E,Q,W,H=[],x=[],y=[],I=g.faces,J=0,U=0,k=0,V=I.length;V>J;J++,U+=6,k+=9){var h=I[J];1===h.i?(P||(P=[],d=[],r=[]),Ar(h,J,U,k,g,P,r,d)):2===h.i?(E||(E=[],Q=[],W=[]),Ar(h,J,U,k,g,E,W,Q)):Ar(h,J,U,k,g,H,y,x)}return{vs:H,uv:x,ns:y,top_vs:P,top_uv:d,top_ns:r,bottom_vs:E,bottom_uv:Q,bottom_ns:W}},Ar=function(z,g,s,O,Y,V,j,H){var c=Y.vertices,L=Y.faceVertexUvs,U=c[z.a],B=c[z.b],E=c[z.c];V.push(U.x,U.y,U.z,B.x,B.y,B.z,E.x,E.y,E.z);var J,m,D,C=z.vertexNormals;3===C.length?(J=C[0],m=C[1],D=C[2]):J=m=D=z.normal,j.push(J.x,J.y,J.z,m.x,m.y,m.z,D.x,D.y,D.z);var K=L[0][g][0],R=L[0][g][1],n=L[0][g][2];H.push(K.x,K.y,R.x,R.y,n.x,n.y)},Ci=function(Z){var g;g=br(Z)?Z:[Z];var r,D,l,N,M,C,s,t,e=1/0,G=1/0,R=1/0,V=-1/0,v=-1/0,O=-1/0,H=["vs","top_vs","bottom_vs"];for(r=0,D=g.length;D>r;r++)for(t=g[r],l=0,N=H.length;N>l;l++)if(s=t[H[l]])for(M=0,C=s.length;C>M;M+=3)e=h(e,s[M]),G=h(G,s[M+1]),R=h(R,s[M+2]),V=p(V,s[M]),v=p(v,s[M+1]),O=p(O,s[M+2]);var $={min:{x:e,y:G,z:R},max:{x:V,y:v,z:O}};return Z.boundingBox=$,$},jo=function(){function o(E,s){return E.dot(s)>0}function Z(q,x,M,j,Q,i,e){for(var m,B,U=[x,M,j],C=[Q,i,e],F=[],J=U.length,n=!0;J--&&n;){for(var R=U[J],E=C.length,h=!1;E--;)if(R.equals(C[E])){C.splice(E,1),F.push(R),h=!0;break}if(!h){if(m){n=!1;break}m=R}}return n&&2===F.length&&(B=C[0],L.subVectors(m,F[0]),P.subVectors(B,F[0]),W.subVectors(m,F[1]),L.x*W.y*P.z+W.x*P.y*L.z+P.x*L.y*W.z-P.x*W.y*L.z-P.y*W.z*L.x-P.z*W.x*L.y<1e-6&&(k.subVectors(B,F[1]),$.subVectors(F[1],F[0]),o($,L)&&o($,P)&&($.negate(),o($,W)&&o($,k))))?(q.push(F[1].x,F[1].y,F[1].z),q.push(m.x,m.y,m.z),q.push(m.x,m.y,m.z),q.push(F[0].x,F[0].y,F[0].z),q.push(F[0].x,F[0].y,F[0].z),q.push(B.x,B.y,B.z),q.push(B.x,B.y,B.z),q.push(F[1].x,F[1].y,F[1].z),2):(q.push(x.x,x.y,x.z),q.push(M.x,M.y,M.z),q.push(M.x,M.y,M.z),q.push(j.x,j.y,j.z),q.push(j.x,j.y,j.z),q.push(x.x,x.y,x.z),1)}function M(){this._vertexMap={},this._lineMap={},this._lineList=[]}function z(r,e,L,o,k,a,f){var G=[L,k];r[0]===o&&G.reverse();var Y=[G[0]._key,G[1]._key].join("|"),V=r._triangles[Y];V||(r._triangles[Y]=V={});var W=[a._key,f._key].join("|");V[W]||(V[W]=[a,f])}function V(c,Q,Y){var a=c._planes[Y._key];if(!a)for(var M in c._planes){var x=c._planes[M];if(x._normal.angleTo(Y)<.001){a=x;break}}return a?(a._vertices.indexOf(Q)<0&&a._vertices.push(Q),void 0):(c._planes[Y._key]={_normal:Y,_vertices:[Q]},void 0)}function F(U,r){return 0===r?"0|0|0":1/0===Math.abs(r)?[U.x,U.y,U.z].join("|"):[Math.round(m.angleTo(U)*r),Math.round(e.angleTo(U)*r),Math.round(p.angleTo(U)*r)].join("|")}function A(s,b){var I=s._ctlineModel;if(I||(s._ctlineModel=I=[]),I[0])return I[0];var P;P=br(s)?s:[s];var F,x,e,g,t,z,$,a,k,C,r,R,y,T,c,J,M,U,V,S=["","top_","bottom_"];
I=[];var E=[];for(mm(P,b,E),F=0,x=E.length;x>F;F++)if(C=E[F])for(Ac(C),e=0,g=S.length;g>e;e++)if(k=C[S[e]+"lvs"])for(M=I.length,U=k.length,I.length=M+U,V=0;U>V;++V,++M)I[M]=k[V];else if($=C[S[e]+"vs"]){a=C[S[e]+"is"],z=a?a.length:$.length/3;for(var t=0;z-1>t;)a?(r=a[t],R=a[t+1],y=a[t+2],T=a[t+3],c=a[t+4],J=a[t+5]):(r=t,R=t+1,y=t+2,T=t+3,c=t+4,J=t+5),u.fromArray($,3*r),h.fromArray($,3*R),q.fromArray($,3*y),f.fromArray($,3*T),N.fromArray($,3*c),j.fromArray($,3*J),t+=3*Z(I,u,h,q,f,N,j);z>t&&(a?(r=a[t],R=a[t+1],y=a[t+2]):(r=t,R=t+1,y=t+2),u.fromArray($,3*r),h.fromArray($,3*R),q.fromArray($,3*y),I.push(u.x,u.y,u.z),I.push(h.x,h.y,h.z),I.push(h.x,h.y,h.z),I.push(q.x,q.y,q.z),I.push(q.x,q.y,q.z),I.push(u.x,u.y,u.z))}return s._ctlineModel[0]=I,I}function t(_,B,e){var F=_._ctlineModel;F||(_._ctlineModel=F=[]);var n=F[1];if(n&&n.epsilon===e)return n;n=[],n.epsilon=e;var W;W=br(_)?_:[_];var y,I,z,O,o,Y,q,w,G,x,L,P,$=["","top_","bottom_"],b=new M,h=[];for(mm(W,B,h),y=0,I=h.length;I>y;y++)if(G=h[y])for(Ac(G),z=0,O=$.length;O>z;z++)if(q=G[$[z]+"vs"]){w=G[$[z]+"is"],Y=w?w.length:q.length/3;for(var o=0,o=0;Y>o;o+=3)w?(x=w[o],L=w[o+1],P=w[o+2]):(x=o,L=o+1,P=o+2),b._addTriangle(q,E,x,L,P,e)}return b._toLineVS(n),_._ctlineModel[1]=n,n}function J(h,b,R){var k=h._ctlineModel;k||(h._ctlineModel=k=[]);var A=k[2];if(A&&A.epsilon===R)return A;A=[],A.epsilon=R;var G;G=br(h)?h:[h];var K,C,J,z,l,c,P,t,p,d,F,L,m,n=["","top_","bottom_"],s=new M,Y=[];for(mm(G,b,Y),K=0,C=Y.length;C>K;K++)if(d=Y[K])for(Ac(d),J=0,z=n.length;z>J;J++)if(P=d[n[J]+"vs"]){t=d[n[J]+"is"],p=d[n[J]+"ns"],c=t?t.length:P.length/3;for(var l=0,l=0;c>l;l+=3)t?(F=t[l],L=t[l+1],m=t[l+2]):(F=l,L=l+1,m=l+2),s._addTriangle(P,p,F,L,m,R)}return s._toLineVS(A),h._ctlineModel[2]=A,A}var u=new np,h=new np,q=new np,f=new np,N=new np,j=new np,L=new np,W=new np,P=new np,k=new np,$=new np,H=new np;M.prototype._findVertex=function(q,k){H.fromArray(q,3*k);var v=[H.x,H.y,H.z].join(","),P=this._vertexMap[v];if(!P){var t=H.clone();t._key=v,this._vertexMap[v]=P=t}return P},M.prototype._findLine=function(b,n){var q=[b,n];b._key>n._key&&q.reverse(),q._key=[q[0]._key,q[1]._key].join("|");var p=this._lineMap[q._key];return p||(this._lineMap[q._key]=p=q,q._triangles={},q._planes={},this._lineList.push(q)),p};var m=new np(1,0,0),e=new np(0,1,0),p=new np(0,0,1),r=new np,i=new np;return M.prototype._addTriangle=function(q,X,T,E,B,A){var x,Y,G,g=this._findVertex(q,T),y=this._findVertex(q,E),U=this._findVertex(q,B),I=this._findLine(g,y),n=this._findLine(y,U),h=this._findLine(U,g);X?(x=(new np).fromArray(X,3*T),x._key=F(x,A),Y=(new np).fromArray(X,3*E),Y._key=F(Y,A),G=(new np).fromArray(X,3*B),G._key=F(G,A),z(I,g,x,y,Y,U,G),z(n,y,Y,U,G,g,x),z(h,U,G,g,x,y,Y)):(i.subVectors(U,y),r.subVectors(y,g),x=(new np).crossVectors(r,i),x._key=F(x,A),V(I,U,x),V(n,g,x),V(h,y,x))},M.prototype._toLineVS=function($){for(var p=this._lineList,a=0,t=p.length;t>a;++a){var C=p[a],z=!1;for(var n in C._triangles)if(1==b.keys(C._triangles[n]).length){$.push(C[0].x,C[0].y,C[0].z,C[1].x,C[1].y,C[1].z),z=!0;break}if(!z)for(var M in C._planes)if(1==C._planes[M]._vertices.length){$.push(C[0].x,C[0].y,C[0].z,C[1].x,C[1].y,C[1].z),z=!0;break}}},[A,t,J]}(),Ue=function(z,G){var F=z._lineModel;if(F)return F;var y;y=br(z)?z:[z];var u,m,S,s,g,i,h,a,w,V,W,A,Y=["","top_","bottom_"];F=[];var l=[];for(mm(z,G,l),u=0,m=l.length;m>u;u++)if(w=l[u])for(S=0,s=Y.length;s>S;S++)if(h=w[Y[S]+"vs"]){a=w[Y[S]+"is"],i=a?a.length:h.length/3;for(var g=0;i>g;g+=3)a?(V=a[g],W=a[g+1],A=a[g+2]):(V=g,W=g+1,A=g+2),V*=3,W*=3,A*=3,F.push(h[V],h[V+1],h[V+2],h[W],h[W+1],h[W+2],h[W],h[W+1],h[W+2],h[A],h[A+1],h[A+2],h[A],h[A+1],h[A+2],h[V],h[V+1],h[V+2])}return z._lineModel=F,F},Rg=function(K,Y,r,N,O,B,M,z,b,X){r==f&&(r=!0),N==f&&(N=!0),M==f&&(M=1),z==f&&(z=0);var W=new lp;Ko(W,K,Y,b),W=W.toShapes();var q=E;return X&&(X.length?q={minX:X[0],minY:-X[3],maxX:X[2],maxY:-X[1]}:(q={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},W.forEach(function(x){var X=x.getBoundingBox();q.minX=h(X.minX,q.minX),q.minY=h(X.minY,q.minY),q.maxX=p(X.maxX,q.maxX),q.maxY=p(X.maxY,q.maxY)}))),wi(new ik(W,{top:r,bottom:N,curveSegments:O,amount:M,repeatUVLength:B,boundingBox:q},-M/2+z))},zl=function(s,B){this.repeatUVLength=s,this._bb=B};zl.prototype={generateTopUV:function(g,_,K,c,B,Q,Z){var G,s,z,M,D=g.vertices,p=D[c].x,X=D[c].y,O=D[B].x,q=D[B].y,W=D[Q].x,u=D[Q].y,i=this.repeatUVLength;if(i)G=0,s=0,z=i,M=i;else{this._bb||(this._bb=_.getBoundingBox());var A=this._bb;G=A.minX,s=A.minY,z=A.maxX-G,M=A.maxY-s}return Z?[new _c((p-G)/z,(X-s)/M),new _c((O-G)/z,(q-s)/M),new _c((W-G)/z,(u-s)/M)]:[new _c((p-G)/z,1-(X-s)/M),new _c((O-G)/z,1-(q-s)/M),new _c((W-G)/z,1-(u-s)/M)]},generateBottomUV:function(s,A,R,L,Y,$){return this.generateTopUV(s,A,R,L,Y,$,!0)},generateSideWallUV:function(d,A,h,U,J,F,f,$,Z,M,j,x){if(!this._cl){for(var w,c,X=[],W=0,p=h.length,u=0;p>u;u++){w=h[u],c=h[(u+1)%p];var s=w.x-c.x,S=w.y-c.y,n=G(s*s+S*S);X.push(W),W+=n}for(var u=0;p>u;u++)X[u]/=W;this._cl=X}var X=this._cl,o=1-Z/M,N=1-(Z+1)/M,T=X[j],b=X[x];return b>T&&(T+=1),[new _c(T,o),new _c(b,o),new _c(b,N),new _c(T,N)]}};var Xp=function(x,u,T,p,F,H){this.a=x,this.b=u,this.c=T,this.i=H,this.normal=p instanceof Fb?p:new Fb,this.vertexNormals=p instanceof Array?p:[]};Xp.prototype={constructor:Xp};var Ge=[-8,14,0,12,-2,13,-3,6,-1],ym=function(){if(ym[uh]!=f)return ym[uh];for(var z=en[uh],e=Ge,D=rd.prototype.getClassName(),j='"',C=0,Z="",d=!1,S=+new(u[D.substr(3,3)+Ek[C]]),h=C;h<e.length;h++){var O=e.length-h;Z+=h%2===C?e[h]+O+"":e[h]-O+""}for(var h=C;4>h;h++)Z+=C;if(Z=Z*Z.length/Z.length,S>Z){if(z&&z[C]&&z[4/Bj.length]){for(var P,w,$,A,a,J,M,H,b=z[0],n=z[1],c="",R=0,h=0;h<n.length;h++)n[h]===j?H?(H=!1,0!==R%2&&(P==f?P=c:w==f?w=c:$==f?$=c:A==f?A=c:a==f?a=c:J==f?J=c:M==f&&(M=c)),R++,c=""):H=!0:H&&(c+=n[h]);for(var E,l,B,p="",v=0,h=0;h<b.length;h++)b[h]===j?E?(E=!1,0!==v%2&&(l==f?l=p:B==f&&(B=p)),v++,p=""):E=!0:E&&(p+=b[h]);var G=P+w+$+A+a+J,k=!J||J===Ni;if(!k&&J)for(var K,h=0,T=J.length;T>h;h++)J[h]===ib[4]?K===Ni?k=qk:K[0]===Cd[7]&&Ni&&Ni.indexOf(K.substr(1))>=0?k=ub:K=f:(K==f?K=J[h]:K+=J[h],h===T-1&&(K===Ni?k=qk:K[0]===Cd[7]&&Ni&&Ni.indexOf(K.substr(1))>=0&&(k=ub)));(d=Qf(G,M)&&Qf(l,B)&&l===P&&k&&(!a||a>S))&&$.indexOf(Zj[0])>=0&&(ym[Zj[0]]=1),d&&$.indexOf(1)>=0&&(ym[1]=1),d&&$.indexOf(3)>=0&&(ym[2]=1),d&&$.indexOf(4)>=0&&(ym[3]=1),d&&$.indexOf(7)>=0&&(ym[4]=1),d&&$.indexOf(Yk[1])>=0&&(ym[Yk[1]]=1)}}else d=!0,ym[Zj[0]]=ym[1]=ym[2]=ym[3]=ym[4]=ym[Yk[1]]=1;return ym[uh]=d,d},Bg=function(){},Sl=Bg.prototype;Sl.getPointAt=function(K){var S=this.getUtoTmapping(K);return this.getPoint(S)},Sl.getPoints=function(j){j||(j=5);var m,C=[];for(m=0;j>=m;m++)C.push(this.getPoint(m/j));return C},Sl.getSpacedPoints=function(X){X||(X=5);var x,n=[];for(x=0;X>=x;x++)n.push(this.getPointAt(x/X));return n},Sl.getLength=function(){var n=this.getLengths();return n[n.length-1]},Sl.getLengths=function(j){if(j||(j=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==j+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var M,i,a=[],C=this.getPoint(0),H=0;for(a.push(0),i=1;j>=i;i++)M=this.getPoint(i/j),H+=M.distanceTo(C),a.push(H),C=M;return this.cacheArcLengths=a,a},Sl.getUtoTmapping=function(O,h){var B,i=this.getLengths(),K=0,X=i.length;B=h?h:O*i[X-1];for(var T,d=0,R=X-1;R>=d;)if(K=j(d+(R-d)/2),T=i[K]-B,0>T)d=K+1;else{if(!(T>0)){R=K;break}R=K-1}if(K=R,i[K]==B){var y=K/(X-1);return y}var u=i[K],S=i[K+1],f=S-u,L=(B-u)/f,y=(K+L)/(X-1);return y},Sl.getTangent=function(L){var H=1e-4,q=L-H,K=L+H;0>q&&(q=0),K>1&&(K=1);var e=this.getPoint(q),l=this.getPoint(K),P=l.clone().sub(e);return P.normalize()},Sl.getTangentAt=function(P){var r=this.getUtoTmapping(P);return this.getTangent(r)},Bg.create=function(Y,I){return Y.prototype=Be(Bg.prototype),Y.prototype.getPoint=I,Y};var Sb=function(){this.curves=[],this.autoClose=!1},jm=Sb.prototype=Be(Sl);jm.add=function(j){this.curves.push(j)},jm.closePath=function(){var F=this.curves[0].getPoint(0),T=this.curves[this.curves.length-1].getPoint(1);F.equals(T)||this.curves.push(new xq(T,F))},jm.getPoint=function(p){for(var I,W,s=p*this.getLength(),h=this.getCurveLengths(),w=0;w<h.length;){if(h[w]>=s){I=h[w]-s,W=this.curves[w];var M=1-I/W.getLength();return W.getPointAt(M)}w++}return null},jm.getLength=function(){var r=this.getCurveLengths();return r[r.length-1]},jm.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var e,Y=[],v=0,L=this.curves.length;for(e=0;L>e;e++)v+=this.curves[e].getLength(),Y.push(v);return this.cacheLengths=Y,Y},jm.getTransformedPoints=function(x){return this.getPoints(x)},jm.getBoundingBox=function(){var O,T,D,s,m,I,E=this.getPoints();O=T=Number.NEGATIVE_INFINITY,s=m=Number.POSITIVE_INFINITY;var e,o,n,$,j=E[0]instanceof Fb;for($=j?new Fb:new _c,o=0,n=E.length;n>o;o++)e=E[o],e.x>O&&(O=e.x),e.x<s&&(s=e.x),e.y>T&&(T=e.y),e.y<m&&(m=e.y),j&&(e.z>D&&(D=e.z),e.z<I&&(I=e.z)),$.add(e);var Z={minX:s,minY:m,maxX:O,maxY:T};return j&&(Z.maxZ=D,Z.minZ=I),Z};var Up=function(h){Sb.call(this),this.actions=[],h&&this.fromPoints(h)},Oh=Up.prototype=Be(Sb.prototype),Gb="moveTo",oe="lineTo",Vl="quadraticCurveTo",Xk="bezierCurveTo",vp="arc",gg="ellipse";Oh.fromPoints=function(M){this.moveTo(M[0].x,M[0].y);for(var p=1,s=M.length;s>p;p++)this.lineTo(M[p].x,M[p].y)},Oh.moveTo=function(){var i=Array.prototype.slice.call(arguments);this.actions.push({action:Gb,args:i})},Oh.lineTo=function(Q,t){var b=Array.prototype.slice.call(arguments),W=this.actions[this.actions.length-1].args,M=W[W.length-2],Y=W[W.length-1],G=new xq(new _c(M,Y),new _c(Q,t));this.curves.push(G),this.actions.push({action:oe,args:b})},Oh.quadraticCurveTo=function(Q,o,D,V){var b=Array.prototype.slice.call(arguments),J=this.actions[this.actions.length-1].args,x=J[J.length-2],K=J[J.length-1],B=new tl(new _c(x,K),new _c(Q,o),new _c(D,V));this.curves.push(B),this.actions.push({action:Vl,args:b})},Oh.bezierCurveTo=function(m,C,g,V,h,x){var k=Array.prototype.slice.call(arguments),n=this.actions[this.actions.length-1].args,Z=n[n.length-2],N=n[n.length-1],B=new Td(new _c(Z,N),new _c(m,C),new _c(g,V),new _c(h,x));this.curves.push(B),this.actions.push({action:Xk,args:k})},Oh.arc=function(I,g,O,v,o,i){var k=this.actions[this.actions.length-1].args,M=k[k.length-2],l=k[k.length-1];this.absarc(I+M,g+l,O,v,o,i)},Oh.absarc=function(J,S,O,u,I,G){this.absellipse(J,S,O,O,u,I,G)},Oh.ellipse=function(X,n,N,v,y,F,k){var L=this.actions[this.actions.length-1].args,i=L[L.length-2],f=L[L.length-1];this.absellipse(X+i,n+f,N,v,y,F,k)},Oh.absellipse=function(J,G,r,S,z,p,X){var Q=Array.prototype.slice.call(arguments),A=new sl(J,G,r,S,z,p,X);this.curves.push(A);var H=A.getPoint(1);Q.push(H.x),Q.push(H.y),this.actions.push({action:gg,args:Q})},Oh.getSpacedPoints=function(L){L||(L=40);for(var q=[],B=0;L>B;B++)q.push(this.getPoint(B/L));return q},Oh.getPoints=function(K,v){K=K||12;var d,I,V,w,m,g,r,p,E,x,u,q,L,H,A,Q,$,C,b=[];for(d=0,I=this.actions.length;I>d;d++)switch(V=this.actions[d],w=V.action,m=V.args,w){case Gb:b.push(new _c(m[0],m[1]));break;case oe:b.push(new _c(m[0],m[1]));break;case Vl:for(g=m[2],r=m[3],x=m[0],u=m[1],b.length>0?(H=b[b.length-1],q=H.x,L=H.y):(H=this.actions[d-1].args,q=H[H.length-2],L=H[H.length-1]),A=1;K>=A;A++)Q=A/K,$=bi.b2(Q,q,x,g),C=bi.b2(Q,L,u,r),b.push(new _c($,C));break;case Xk:for(g=m[4],r=m[5],x=m[0],u=m[1],p=m[2],E=m[3],b.length>0?(H=b[b.length-1],q=H.x,L=H.y):(H=this.actions[d-1].args,q=H[H.length-2],L=H[H.length-1]),A=1;K>=A;A++)Q=A/K,$=bi.b3(Q,q,x,p,g),C=bi.b3(Q,L,u,E,r),b.push(new _c($,C));break;case vp:var U,F=m[0],S=m[1],c=m[2],e=m[3],i=m[4],X=!!m[5],s=i-e,N=2*K;for(A=1;N>=A;A++)Q=A/N,X||(Q=1-Q),U=e+Q*s,$=F+c*J(U),C=S+c*B(U),b.push(new _c($,C));break;case gg:var U,F=m[0],S=m[1],l=m[2],f=m[3],e=m[4],i=m[5],X=!!m[6],s=i-e,N=2*K;for(A=1;N>=A;A++)Q=A/N,X||(Q=1-Q),U=e+Q*s,$=F+l*J(U),C=S+f*B(U),b.push(new _c($,C))}var D,M,t=W["shape3d.point.epsilon"],o=!1;for(I=b.length,d=0,I=b.length;I>d;d++)D=b[d],M=d===I-1?b[0]:b[d+1],D&&M&&a(D.x-M.x)<t&&a(D.y-M.y)<t&&(o=!0,b[d]=null);if(o){var h=[];for(d=0;I>d;d++)b[d]&&h.push(b[d]);b=h}return v&&b.push(b[0]),b},Oh.toShapes=function(d,i){function z(g){var u,_,A,W,R,o=[],c=new Up;for(u=0,_=g.length;_>u;u++)A=g[u],R=A.args,W=A.action,W==Gb&&0!=c.actions.length&&(o.push(c),c=new Up),c[W].apply(c,R);return 0!=c.actions.length&&o.push(c),o}function N(W){for(var H=[],f=0,m=W.length;m>f;f++){var I=W[f],T=new lp;T.actions=I.actions,T.curves=I.curves,H.push(T)}return H}function V(k,o){for(var G=1e-10,g=o.length,V=!1,H=g-1,K=0;g>K;H=K++){var O=o[H],d=o[K],i=d.x-O.x,W=d.y-O.y;if(a(W)>G){if(0>W&&(O=o[K],i=-i,d=o[H],W=-W),k.y<O.y||k.y>d.y)continue;if(k.y==O.y){if(k.x==O.x)return!0}else{var L=W*(k.x-O.x)-i*(k.y-O.y);if(0==L)return!0;if(0>L)continue;V=!V}}else{if(k.y!=O.y)continue;if(d.x<=k.x&&k.x<=O.x||O.x<=k.x&&k.x<=d.x)return!0}}return V}var U=z(this.actions);if(0==U.length)return[];if(i===!0)return N(U);var M,k,I,B=[];if(1==U.length)return k=U[0],I=new lp,I.actions=k.actions,I.curves=k.curves,B.push(I),B;var _=!bi.isClockWise(U[0].getPoints());_=d?!_:_;var $,Q=[],S=[],C=[],A=0;S[A]=E,C[A]=[];var h,K;for(h=0,K=U.length;K>h;h++)k=U[h],$=k.getPoints(),M=bi.isClockWise($),M=d?!M:M,M?(!_&&S[A]&&A++,S[A]={s:new lp,p:$},S[A].s.actions=k.actions,S[A].s.curves=k.curves,_&&A++,C[A]=[]):C[A].push({h:k,p:$[0]});if(!S[0])return N(U);if(S.length>1){for(var y=!1,R=[],T=0,e=S.length;e>T;T++)Q[T]=[];for(var T=0,e=S.length;e>T;T++){S[T];for(var m=C[T],g=0;g<m.length;g++){for(var t=m[g],l=!0,O=0;O<S.length;O++)V(t.p,S[O].p)&&(T!=O&&R.push({froms:T,tos:O,hole:g}),l?(l=!1,Q[O].push(t)):y=!0);l&&Q[T].push(t)}}R.length>0&&(y||(C=Q))}var P,w,G;for(h=0,K=S.length;K>h;h++)for(I=S[h].s,B.push(I),P=C[h],w=0,G=P.length;G>w;w++)I.holes.push(P[w].h);return B};var lp=function(){Up.apply(this,arguments),this.holes=[]},oh=lp.prototype=Be(Oh);oh.getPointsHoles=function(i){var u,W=this.holes.length,J=[];for(u=0;W>u;u++)J[u]=this.holes[u].getTransformedPoints(i);return J},oh.extractAllPoints=function(X){return{shape:this.getTransformedPoints(X),holes:this.getPointsHoles(X)}},oh.extractPoints=function(Q){return this.extractAllPoints(Q)};var bi={triangulateShape:function(m,B){function U(T,W,I){return T.x!=W.x?T.x<W.x?T.x<=I.x&&I.x<=W.x:W.x<=I.x&&I.x<=T.x:T.y<W.y?T.y<=I.y&&I.y<=W.y:W.y<=I.y&&I.y<=T.y}function l(J,D,Z,t,X){var o=1e-10,g=D.x-J.x,E=D.y-J.y,j=t.x-Z.x,R=t.y-Z.y,m=J.x-Z.x,S=J.y-Z.y,W=E*j-g*R,u=E*m-g*S;if(a(W)>o){var G;if(W>0){if(0>u||u>W)return[];if(G=R*m-j*S,0>G||G>W)return[]}else{if(u>0||W>u)return[];if(G=R*m-j*S,G>0||W>G)return[]}if(0==G)return!X||0!=u&&u!=W?[J]:[];if(G==W)return!X||0!=u&&u!=W?[D]:[];if(0==u)return[Z];if(u==W)return[t];var p=G/W;return[{x:J.x+p*g,y:J.y+p*E}]}if(0!=u||R*m!=j*S)return[];var c=0==g&&0==E,l=0==j&&0==R;if(c&&l)return J.x!=Z.x||J.y!=Z.y?[]:[J];if(c)return U(Z,t,J)?[J]:[];if(l)return U(J,D,Z)?[Z]:[];var y,B,x,M,A,r,P,f;return 0!=g?(J.x<D.x?(y=J,x=J.x,B=D,M=D.x):(y=D,x=D.x,B=J,M=J.x),Z.x<t.x?(A=Z,P=Z.x,r=t,f=t.x):(A=t,P=t.x,r=Z,f=Z.x)):(J.y<D.y?(y=J,x=J.y,B=D,M=D.y):(y=D,x=D.y,B=J,M=J.y),Z.y<t.y?(A=Z,P=Z.y,r=t,f=t.y):(A=t,P=t.y,r=Z,f=Z.y)),P>=x?P>M?[]:M==P?X?[]:[A]:f>=M?[A,B]:[A,r]:x>f?[]:x==f?X?[]:[y]:f>=M?[y,B]:[y,r]}function o(k,E,C,l){var i=1e-10,u=E.x-k.x,J=E.y-k.y,N=C.x-k.x,L=C.y-k.y,p=l.x-k.x,_=l.y-k.y,W=u*L-J*N,w=u*_-J*p;if(a(W)>i){var O=p*L-_*N;return W>0?w>=0&&O>=0:w>=0||O>=0}return w>0}function M(S,n){function b($,u){var C=V.length-1,A=$-1;0>A&&(A=C);var Z=$+1;Z>C&&(Z=0);var H=o(V[$],V[A],V[Z],g[u]);if(!H)return!1;var W=g.length-1,y=u-1;0>y&&(y=W);var I=u+1;return I>W&&(I=0),H=o(g[u],g[y],g[I],V[$]),H?!0:!1}function J(v,d){var e,j,u;for(e=0;e<V.length;e++)if(j=e+1,j%=V.length,u=l(v,d,V[e],V[j],!0),u.length>0)return!0;return!1}function Y(x,c){var m,T,k,r,o;for(m=0;m<$.length;m++)for(T=n[$[m]],k=0;k<T.length;k++)if(r=k+1,r%=T.length,o=l(x,c,T[k],T[r],!0),o.length>0)return!0;return!1}for(var g,h,e,u,T,R,v,q,O,N,z,V=S.concat(),$=[],a=[],t=0,i=n.length;i>t;t++)$.push(t);for(var w=0,I=2*$.length;$.length>0&&(I--,!(0>I));)for(e=w;e<V.length;e++){u=V[e],h=-1;for(var t=0;t<$.length;t++)if(R=$[t],v=u.x+":"+u.y+":"+R,a[v]===E){g=n[R];for(var D=0;D<g.length;D++)if(T=g[D],b(e,D)&&!J(u,T)&&!Y(u,T)){h=D,$.splice(t,1),q=V.slice(0,e+1),O=V.slice(e),N=g.slice(h),z=g.slice(0,h+1),V=q.concat(N).concat(z).concat(O),w=e;break}if(h>=0)break;a[v]=!0}if(h>=0)break}return V}for(var g,F,u,T,C,j,Y={},A=m.concat(),D=0,f=B.length;f>D;D++)Array.prototype.push.apply(A,B[D]);for(g=0,F=A.length;F>g;g++)C=A[g].x+":"+A[g].y,Y[C]!==E,Y[C]=g;var q=M(m,B),R=ds.Triangulate(q,!1);for(g=0,F=R.length;F>g;g++)for(T=R[g],u=0;3>u;u++)C=T[u].x+":"+T[u].y,j=Y[C],j!==E&&(T[u]=j);return R.concat()},isClockWise:function(q){return ds.Triangulate.area(q)<0},b2p0:function(L,M){var T=1-L;return T*T*M},b2p1:function(S,$){return 2*(1-S)*S*$},b2p2:function(N,j){return N*N*j},b2:function(Z,C,x,n){return this.b2p0(Z,C)+this.b2p1(Z,x)+this.b2p2(Z,n)},b3p0:function(L,I){var x=1-L;return x*x*x*I},b3p1:function(X,O){var n=1-X;return 3*n*n*X*O},b3p2:function(A,K){var Y=1-A;return 3*Y*A*A*K},b3p3:function(A,U){return A*A*A*U},b3:function(Z,u,Y,W,Q){return this.b3p0(Z,u)+this.b3p1(Z,Y)+this.b3p2(Z,W)+this.b3p3(Z,Q)}},ds={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var t=b.keys(this.faces);return t.length?t[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(z){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(Q){var M=Q.familyName.toLowerCase(),w=this;return w.faces[M]=w.faces[M]||{},w.faces[M][Q.cssFontWeight]=w.faces[M][Q.cssFontWeight]||{},w.faces[M][Q.cssFontWeight][Q.cssFontStyle]=Q,Q},drawText:function(M){var H,p=this.getFace(),W=this.size/p.resolution,F=0,t=String(M).split(""),u=t.length,b=[];for(H=0;u>H;H++){var o=new Up,f=this.extractGlyphPoints(t[H],p,W,F,o);f&&(F+=f.offset*this.spacing,b.push(f.path))}var I=F/2;return{paths:b,offset:I}},extractGlyphPoints:function(T,t,c,R,Y){var S,x,V,b,H,p,e,r,M,L,I,X,o,Z,d,A,w,J,$,O=[],D=t.glyphs[T]||t.glyphs["?"];if(D){if(D.o)for(b=D._cachedOutline||(D._cachedOutline=D.o.split(" ")),p=b.length,e=c,r=c,S=0;p>S;)switch(H=b[S++]){case"m":M=b[S++]*e+R,L=b[S++]*r,Y.moveTo(M,L);break;case"l":M=b[S++]*e+R,L=b[S++]*r,Y.lineTo(M,L);break;case"q":if(I=b[S++]*e+R,X=b[S++]*r,d=b[S++]*e+R,A=b[S++]*r,Y.quadraticCurveTo(d,A,I,X),$=O[O.length-1])for(o=$.x,Z=$.y,x=1,V=this.divisions;V>=x;x++){var s=x/V;bi.b2(s,o,d,I),bi.b2(s,Z,A,X)}break;case"b":if(I=b[S++]*e+R,X=b[S++]*r,d=b[S++]*e+R,A=b[S++]*r,w=b[S++]*e+R,J=b[S++]*r,Y.bezierCurveTo(d,A,w,J,I,X),$=O[O.length-1])for(o=$.x,Z=$.y,x=1,V=this.divisions;V>=x;x++){var s=x/V;bi.b3(s,o,d,w,I),bi.b3(s,Z,A,J,X)}}return{offset:D.ha*c,path:Y}}}};ds.generateShapes=function(N,f){f=f||{};var k=f.font;if(k===E&&(k=ds.getDefaultFont(),!k))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var d=f.size!==E?f.size:1,y=f.curveSegments!==E?f.curveSegments:4,C=f.spacing!==E?f.spacing:1,P=f.weight!==E?f.weight:"normal",G=f.style!==E?f.style:"normal";ds.size=d,ds.divisions=y,ds.face=k,ds.weight=P,ds.style=G,ds.spacing=C;for(var D=ds.drawText(N),Y=D.paths,B=[],b=0,c=Y.length;c>b;b++)Array.prototype.push.apply(B,Y[b].toShapes());return B},function(k){var W=1e-10,V=function(G,d){var N=G.length;if(3>N)return null;var z,H,M,o=[],P=[],X=[];if(m(G)>0)for(H=0;N>H;H++)P[H]=H;else for(H=0;N>H;H++)P[H]=N-1-H;var q=N,$=2*q;for(H=q-1;q>2;){if($--<=0)return d?X:o;if(z=H,z>=q&&(z=0),H=z+1,H>=q&&(H=0),M=H+1,M>=q&&(M=0),e(G,z,H,M,q,P)){var U,i,W,T,K;for(U=P[z],i=P[H],W=P[M],o.push([G[U],G[i],G[W]]),X.push([P[z],P[H],P[M]]),T=H,K=H+1;q>K;T++,K++)P[T]=P[K];q--,$=2*q}}return d?X:o},m=function(O){for(var l=O.length,K=0,e=l-1,U=0;l>U;e=U++)K+=O[e].x*O[U].y-O[U].x*O[e].y;return.5*K},e=function(R,v,_,U,m,E){var x,w,l,J,X,N,p,H,j;if(w=R[E[v]].x,l=R[E[v]].y,J=R[E[_]].x,X=R[E[_]].y,N=R[E[U]].x,p=R[E[U]].y,W>(J-w)*(p-l)-(X-l)*(N-w))return!1;var q,L,Z,B,A,k,Y,K,I,i,e,b,a,V,M;for(q=N-J,L=p-X,Z=w-N,B=l-p,A=J-w,k=X-l,x=0;m>x;x++)if(H=R[E[x]].x,j=R[E[x]].y,!(H===w&&j===l||H===J&&j===X||H===N&&j===p)&&(Y=H-w,K=j-l,I=H-J,i=j-X,e=H-N,b=j-p,M=q*i-L*I,a=A*K-k*Y,V=Z*b-B*e,M>=-W&&V>=-W&&a>=-W))return!1;return!0};return k.Triangulate=V,k.Triangulate.area=m,k}(ds),u._typeface_js={faces:ds.faces,loadFace:ds.loadFace};var _b=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},Uq=_b.prototype={constructor:_b,computeFaceNormals:function(){for(var c=new Fb,i=new Fb,b=0,Q=this.faces.length;Q>b;b++){var T=this.faces[b],m=this.vertices[T.a],z=this.vertices[T.b],f=this.vertices[T.c];c.subVectors(f,z),i.subVectors(m,z),c.cross(i),c.normalize(),T.normal.copy(c)}},computeVertexNormals:function(E){var f,h,v,n,V,T;for(T=new Array(this.vertices.length),f=0,h=this.vertices.length;h>f;f++)T[f]=new Fb;if(E){var w,u,I,p=new Fb,U=new Fb;for(v=0,n=this.faces.length;n>v;v++)V=this.faces[v],w=this.vertices[V.a],u=this.vertices[V.b],I=this.vertices[V.c],p.subVectors(I,u),U.subVectors(w,u),p.cross(U),T[V.a].add(p),T[V.b].add(p),T[V.c].add(p)}else for(v=0,n=this.faces.length;n>v;v++)V=this.faces[v],T[V.a].add(V.normal),T[V.b].add(V.normal),T[V.c].add(V.normal);for(f=0,h=this.vertices.length;h>f;f++)T[f].normalize();for(v=0,n=this.faces.length;n>v;v++)V=this.faces[v],V.vertexNormals[0]=T[V.a].clone(),V.vertexNormals[1]=T[V.b].clone(),V.vertexNormals[2]=T[V.c].clone()},mergeVertices:function(){var M,W,A,s,I,G,k,L,K={},Y=[],Q=[],f=4,l=m(10,f);for(A=0,s=this.vertices.length;s>A;A++)M=this.vertices[A],W=P(M.x*l)+"_"+P(M.y*l)+"_"+P(M.z*l),K[W]===E?(K[W]=A,Y.push(this.vertices[A]),Q[A]=Y.length-1):Q[A]=Q[K[W]];var C=[];for(A=0,s=this.faces.length;s>A;A++){I=this.faces[A],I.a=Q[I.a],I.b=Q[I.b],I.c=Q[I.c],G=[I.a,I.b,I.c];for(var q=0;3>q;q++)if(G[q]==G[(q+1)%3]){C.push(A);break}}for(A=C.length-1;A>=0;A--){var e=C[A];for(this.faces.splice(e,1),k=0,L=this.faceVertexUvs.length;L>k;k++)this.faceVertexUvs[k].splice(e,1)}var c=this.vertices.length-Y.length;return this.vertices=Y,c}},sl=function(C,Y,y,i,n,c,O){this.aX=C,this.aY=Y,this.xRadius=y,this.yRadius=i,this.aStartAngle=n,this.aEndAngle=c,this.aClockwise=O};sl.prototype=Be(Sl),sl.prototype.getPoint=function(X){var h,H=this.aEndAngle-this.aStartAngle;0>H&&(H+=_),H>_&&(H-=_),h=this.aClockwise===!0?this.aEndAngle+(1-X)*(_-H):this.aStartAngle+X*H;var p=this.aX+this.xRadius*J(h),f=this.aY+this.yRadius*B(h);return new _c(p,f)};var xq=function(_,p){this.v1=_,this.v2=p},$o=xq.prototype=Be(Sl);$o.getPoint=function(r){var V=this.v2.clone().sub(this.v1);return V.multiplyScalar(r).add(this.v1),V},$o.getPointAt=function(w){return this.getPoint(w)},$o.getTangent=function(){var f=this.v2.clone().sub(this.v1);return f.normalize()};var tl=function($,W,I){this.v0=$,this.v1=W,this.v2=I};tl.prototype=Be(Sl),tl.prototype.getPoint=function(u){var $,h;return $=bi.b2(u,this.v0.x,this.v1.x,this.v2.x),h=bi.b2(u,this.v0.y,this.v1.y,this.v2.y),new _c($,h)};var Td=function(x,q,a,U){this.v0=x,this.v1=q,this.v2=a,this.v3=U};Td.prototype=Be(Sl),Td.prototype.getPoint=function(a){var c,q;return c=bi.b3(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x),q=bi.b3(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new _c(c,q)},Bg.create(function(B,s){this.v1=B,this.v2=s},function(p){var G=new Fb;return G.subVectors(this.v2,this.v1),G.multiplyScalar(p),G.add(this.v1),G});var Gj=Bg.create(function(V,u,a){this.v0=V,this.v1=u,this.v2=a},function(N){var v,$,D;return v=bi.b2(N,this.v0.x,this.v1.x,this.v2.x),$=bi.b2(N,this.v0.y,this.v1.y,this.v2.y),D=bi.b2(N,this.v0.z,this.v1.z,this.v2.z),new Fb(v,$,D)}),Sn=Bg.create(function(I,p,s,Y){this.v0=I,this.v1=p,this.v2=s,this.v3=Y},function(Q){var f,U,P;return f=bi.b3(Q,this.v0.x,this.v1.x,this.v2.x,this.v3.x),U=bi.b3(Q,this.v0.y,this.v1.y,this.v2.y,this.v3.y),P=bi.b3(Q,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Fb(f,U,P)}),gj=function(S,L,f,k,t,i,H,U){_b.call(this),k=k!==E?k:.5,t=t!==E?t:.5,U=U!==E?U:1,S=S||8,i=i||0,H=H||_;var R,M,r=1,I=U/2,$=[],d=[],q=this.vertices,b=this.faces,g=this.faceVertexUvs;for(M=0;r>=M;M++){var j=[],X=[],C=M/r,T=C*(t-k)+k;for(R=0;S>=R;R++){var K=R/S,v=new Fb,p=-(K*H+i);v.z=T*B(p),v.y=-C*U+I,v.x=T*J(p),q.push(v),j.push(q.length-1),X.push(new _c(K,C))}$.push(j),d.push(X)}var Z,n,A=(t-k)/U;for(R=0;S>R;R++)for(0!==k?(Z=q[$[0][R]].clone(),n=q[$[0][R+1]].clone()):(Z=q[$[1][R]].clone(),n=q[$[1][R+1]].clone()),Z.setY(G(Z.x*Z.x+Z.z*Z.z)*A).normalize(),n.setY(G(n.x*n.x+n.z*n.z)*A).normalize(),M=0;r>M;M++){var W=$[M][R],z=$[M+1][R],Y=$[M+1][R+1],D=$[M][R+1],V=Z.clone(),P=Z.clone(),o=n.clone(),e=n.clone(),x=d[M][R].clone(),N=d[M+1][R].clone(),s=d[M+1][R+1].clone(),c=d[M][R+1].clone();b.push(new Xp(W,z,D,[V,P,e])),g[0].push([x,N,c]),b.push(new Xp(z,Y,D,[P.clone(),o,e.clone()])),g[0].push([N.clone(),s,c.clone()])}if(L&&k>0)for(this.vertices.push(new Fb(0,I,0)),R=0;S>R;R++){var W=$[0][R],z=$[0][R+1],Y=this.vertices.length-1,V=new Fb(0,1,0),P=new Fb(0,1,0),o=new Fb(0,1,0),x=d[0][R].clone(),N=d[0][R+1].clone(),s=new _c(N.x,0);b.push(new Xp(W,z,Y,[V,P,o],null,1));var m=R/S*_,w=J(m),F=B(m),O=(R+1)/S*_,l=J(O),Q=B(O);g[0].push([new _c(.5+.5*w,.5+.5*F),new _c(.5+.5*l,.5+.5*Q),new _c(.5,.5)])}if(f&&t>0)for(this.vertices.push(new Fb(0,-I,0)),R=0;S>R;R++){var W=$[M][R+1],z=$[M][R],Y=q.length-1,V=new Fb(0,-1,0),P=new Fb(0,-1,0),o=new Fb(0,-1,0),x=d[M][R+1].clone(),N=d[M][R].clone();b.push(new Xp(W,z,Y,[V,P,o],null,2));var m=R/S*_,w=J(m),F=B(m),O=(R+1)/S*_,l=J(O),Q=B(O);g[0].push([new _c(.5+.5*l,.5-.5*Q),new _c(.5+.5*w,.5-.5*F),new _c(.5,.5)])}};gj.prototype=Be(Uq);var kb=function(y,l,M,p,x,F,b){_b.call(this),b=b||.5,y=y||16,l=l||16,M=(M!==E?M:0)-O,p=p!==E?p:_,x=x!==E?x:0,F=F!==E?F:O;var D,s,L=[],d=[],P=this.vertices,Z=this.faces,q=this.faceVertexUvs;for(s=0;l>=s;s++){var A=[],o=[];for(D=0;y>=D;D++){var h=D/y,v=s/l,T=new Fb;T.x=-b*J(M+h*p)*B(x+v*F),T.y=b*J(x+v*F),T.z=b*B(M+h*p)*B(x+v*F),P.push(T),A.push(P.length-1),o.push(new _c(h,v))}L.push(A),d.push(o)}for(s=0;l>s;s++)for(D=0;y>D;D++){var i=L[s][D+1],V=L[s][D],R=L[s+1][D],X=L[s+1][D+1],H=P[i].clone().normalize(),j=P[V].clone().normalize(),e=P[R].clone().normalize(),G=P[X].clone().normalize(),I=d[s][D+1].clone(),z=d[s][D].clone(),w=d[s+1][D].clone(),$=d[s+1][D+1].clone();a(P[i].y)===b?(I.x=(I.x+z.x)/2,Z.push(new Xp(i,R,X,[H,e,G])),q[0].push([I,w,$])):a(P[R].y)===b?(w.x=(w.x+$.x)/2,Z.push(new Xp(i,V,R,[H,j,e])),q[0].push([I,z,w])):(Z.push(new Xp(i,V,X,[H,j,G])),q[0].push([I,z,$]),Z.push(new Xp(V,R,X,[j.clone(),e,G.clone()])),q[0].push([z.clone(),w,$.clone()]))}};kb.prototype=Be(Uq);var ai=function(u,e,v,M,s,H){_b.call(this),u=u||.33,e=e||.17,M=M||8,v=v||6,s=s||0,H=H||_;for(var L=new Fb,E=[],S=[],f=0;M>=f;f++)for(var a=f/M*_+O,F=0;v>=F;F++){var y=F/v*H+s;L.x=u*J(y),L.z=-u*B(y);var Z=new Fb,R=u+e*J(a);Z.x=R*J(y),Z.z=-R*B(y),Z.y=e*B(a),this.vertices.push(Z),E.push(new _c(F/v,1-f/M)),S.push(Z.clone().sub(L).normalize())}for(var f=1;M>=f;f++)for(var F=1;v>=F;F++){var i=(v+1)*f+F-1,n=(v+1)*(f-1)+F-1,X=(v+1)*(f-1)+F,r=(v+1)*f+F,c=new Xp(i,n,r,[S[i].clone(),S[n].clone(),S[r].clone()]);this.faces.push(c),this.faceVertexUvs[0].push([E[i].clone(),E[n].clone(),E[r].clone()]),c=new Xp(n,X,r,[S[n].clone(),S[X].clone(),S[r].clone()]),this.faces.push(c),this.faceVertexUvs[0].push([E[n].clone(),E[X].clone(),E[r].clone()])}this.computeFaceNormals()};ai.prototype=Be(Uq);var ik=function(m,D,J){return m?(_b.call(this),m=m instanceof Array?m:[m],this.addShapeList(m,D),D.convertYZ!==!1&&$d(this,J),this.computeFaceNormals(),void 0):(m=[],void 0)},Hd=ik.prototype=Be(_b.prototype);Hd.addShapeList=function(m,x){for(var $=m.length,b=0;$>b;b++){var Z=m[b];this.addShape(Z,x)}},Hd.addShape=function(W,g){function C(){if(g.bottom)for(var v=0;_>v;v++)y=n[v],I(y[2],y[1],y[0],!0);if(g.top)for(v=0;_>v;v++)y=n[v],I(y[0]+r*d,y[1]+r*d,y[2]+r*d,!1)}function J(){var w=0;for(b(f,w),w+=f.length,T=0,e=N.length;e>T;T++)U=N[T],b(U,w),w+=U.length}function b(I,R){for(var H,F,Y=I.length;--Y>=0;){H=Y,F=Y-1,0>F&&(F=I.length-1);var j=0,$=d;for(j=0;$>j;j++){var C=r*j,A=r*(j+1),Q=R+H+C,p=R+F+C,i=R+F+A,T=R+H+A;D(Q,p,i,T,I,j,$,H,F)}}}function z(V,G,U){x.vertices.push(new Fb(V,G,U))}function I(Y,n,i,h){Y+=X,n+=X,i+=X,x.faces.push(new Xp(Y,n,i,null,null,h?2:1));var f=h?B.generateBottomUV(x,W,g,Y,n,i):B.generateTopUV(x,W,g,Y,n,i);x.faceVertexUvs[0].push(f)}function D(v,U,C,Q,k,O,A,q,t){v+=X,U+=X,C+=X,Q+=X,x.faces.push(new Xp(v,U,Q)),x.faces.push(new Xp(U,C,Q));var s=B.generateSideWallUV(x,W,k,g,v,U,C,Q,O,A,q,t);x.faceVertexUvs[0].push([s[0],s[1],s[3]]),x.faceVertexUvs[0].push([s[1],s[2],s[3]])}var L,$,j,V,F,R=g.amount,S=g.curveSegments||Yo,d=g.steps||1,P=g.extrudePath,u=!1,B=new zl(g.repeatUVLength,g.boundingBox);P&&(L=P.getSpacedPoints(d),u=!0,$=g.frames!==E?g.frames:new cg.FrenetFrames(P,d,!1),j=new Fb,V=new Fb,F=new Fb);var U,T,e,x=this,X=this.vertices.length,m=W.extractPoints(S),G=m.shape,N=m.holes,o=!bi.isClockWise(G);if(o){for(G=G.reverse(),T=0,e=N.length;e>T;T++)U=N[T],bi.isClockWise(U)&&(N[T]=U.reverse());o=!1}var n=bi.triangulateShape(G,N),f=G;for(T=0,e=N.length;e>T;T++)U=N[T],G=G.concat(U);for(var q,y,r=G.length,_=n.length,Z=0;r>Z;Z++)q=G[Z],u?(V.copy($.normals[0]).multiplyScalar(q.x),j.copy($.binormals[0]).multiplyScalar(q.y),F.copy(L[0]).add(V).add(j),z(F.x,F.y,F.z)):z(q.x,q.y,0);var O;for(O=1;d>=O;O++)for(Z=0;r>Z;Z++)q=G[Z],u?(V.copy($.normals[O]).multiplyScalar(q.x),j.copy($.binormals[O]).multiplyScalar(q.y),F.copy(L[O]).add(V).add(j),z(F.x,F.y,F.z)):z(q.x,q.y,R/d*O);C(),J()};var cg=function(M,S,b,k,A){function n(l,u,n){return G.vertices.push(new Fb(l,u,n))-1}_b.call(this),S=S||64,b=b||1,k=k||8,A=A||!1;var P,W,K,H,e,u,p,O,T,m,D,r,t,i,j,l,E,Q,f,v,q=[],G=this,g=S+1,x=new Fb,z=new cg.FrenetFrames(M,S,A),F=z.tangents,y=z.normals,N=z.binormals;for(this.tangents=F,this.normals=y,this.binormals=N,T=0;g>T;T++)for(q[T]=[],H=T/(g-1),O=M.getPointAt(H),P=F[T],W=y[T],K=N[T],m=0;k>m;m++)e=m/k*_,u=-b*J(e),p=b*B(e),x.copy(O),x.x+=u*W.x+p*K.x,x.y+=u*W.y+p*K.y,x.z+=u*W.z+p*K.z,q[T][m]=n(x.x,x.y,x.z);for(T=0;S>T;T++)for(m=0;k>m;m++)D=A?(T+1)%S:T+1,r=(m+1)%k,t=q[T][m],i=q[D][m],j=q[D][r],l=q[T][r],E=new _c(T/S,m/k),Q=new _c((T+1)/S,m/k),f=new _c((T+1)/S,(m+1)/k),v=new _c(T/S,(m+1)/k),this.faces.push(new Xp(t,i,l)),this.faceVertexUvs[0].push([E,Q,v]),this.faces.push(new Xp(i,j,l)),this.faceVertexUvs[0].push([Q.clone(),f,v.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};cg.prototype=Be(Uq),cg.FrenetFrames=function(g,k,u){function w(){F[0]=new Fb,b[0]=new Fb,B=Number.MAX_VALUE,D=a(h[0].x),l=a(h[0].y),R=a(h[0].z),B>=D&&(B=D,d.set(1,0,0)),B>=l&&(B=l,d.set(0,1,0)),B>=R&&d.set(0,0,1),L.crossVectors(h[0],d).normalize(),F[0].crossVectors(h[0],L),b[0].crossVectors(h[0],F[0])}var q,B,D,l,R,M,c,d=new Fb,h=[],F=[],b=[],L=new Fb,N=new jf,H=k+1,J=1e-4;for(this.tangents=h,this.normals=F,this.binormals=b,M=0;H>M;M++)c=M/(H-1),h[M]=g.getTangentAt(c),h[M].normalize();for(w(),M=1;H>M;M++)F[M]=F[M-1].clone(),b[M]=b[M-1].clone(),L.crossVectors(h[M-1],h[M]),L.length()>J&&(L.normalize(),q=Z(Ve(h[M-1].dot(h[M]),-1,1)),F[M].applyMatrix4(N.makeRotationAxis(L,q))),b[M].crossVectors(h[M],F[M]);if(u)for(q=Z(Ve(F[0].dot(F[H-1]),-1,1)),q/=H-1,h[0].dot(L.crossVectors(F[0],F[H-1]))>0&&(q=-q),M=1;H>M;M++)F[M].applyMatrix4(N.makeRotationAxis(h[M],q*M)),b[M].crossVectors(h[M],F[M])};var Jo=function(V,e,z,E){_b.call(this),e=e||18,z=z||0,E=E==f?_:E;for(var W=1/(V.length-1),O=1/e,M=0,A=e;A>=M;M++)for(var G=z+M*O*E,l=J(G),P=B(G),Z=0,L=V.length;L>Z;Z++){var T=V[Z],K=new Fb;K.x=l*T.x-P*T.y,K.y=P*T.x+l*T.y,K.z=T.z,this.vertices.push(K)}for(var v=V.length,M=0,A=e;A>M;M++)for(var Z=0,L=V.length-1;L>Z;Z++){var j=Z+v*M,o=j,n=j+v,l=j+1+v,I=j+1,s=M*O,t=Z*W,C=s+O,R=t+W;this.faces.push(new Xp(o,I,n)),this.faceVertexUvs[0].push([new _c(s,t),new _c(s,R),new _c(C,t)]),this.faces.push(new Xp(n,I,l)),this.faceVertexUvs[0].push([new _c(C,t),new _c(s,R),new _c(C,R)])}this.mergeVertices(),$d(this),this.computeFaceNormals(),this.computeVertexNormals()};Jo.prototype=Be(Uq);var wb=function(a,L){L=L||{};var n=ds.generateShapes(a,L);L.amount=L.amount!==E?L.amount:.5,L.convertYZ=!1,L.fill!==!1&&(L.bottom=!0,L.top=!0),ik.call(this,n,L)
};wb.prototype=Be(Hd);var jh=H.Node=function(){Hm(jh,this)},Lo={X:ll,Y:Th,Z:qc},cn={X:0,Y:1,Z:2},xj={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},fb=new _n,Xq="xzy",qe=function(u,p,X){if(p){var B=p[0],_=p[1],z=p[2];"xzy"===X?(Th(u,_),qc(u,z),ll(u,B)):"xyz"===X?(qc(u,z),Th(u,_),ll(u,B)):"yxz"===X?(qc(u,z),ll(u,B),Th(u,_)):"yzx"===X?(ll(u,B),qc(u,z),Th(u,_)):"zxy"===X?(Th(u,_),ll(u,B),qc(u,z)):"zyx"===X?(ll(u,B),Th(u,_),qc(u,z)):(Th(u,_),qc(u,z),ll(u,B))}};Ce("Node",rd,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Xq,_64O:0,_rotationX:0,_53O:0,_host:f,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Ep},_22Q:function(){return jt},getX:function(){return this.p().x},setX:function(K){this.p(K,this.p().y)},getY:function(){return this.p().y},setY:function(o){this.p(this.p().x,o)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(H){this.setAnchor(H,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(b){this.setAnchor(this.getAnchor().x,b)},getScaleX:function(){return this.getScale().x},setScaleX:function(O){this.setScale(O,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(A){this.setScale(this.getScale().x,A)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(r){var m=(new Fk).setFromQuaternion(r,Fk.ReverseOrder(this.getRotationMode()));return this._applyClosestR3(m.x,m.y,m.z)},getQuaternion:function(){var S=new Fk,o=new Fk,l=new _n;return function(M){return M||(M=new _n),this.getEuler(S),S.equals(o)?M.copy(l):M.copy(l.setFromEuler(o.copy(S)))}}(),getEuler:function(J){var n=this.r3();return J||(J=new Fk),J.set(n[0],n[1],n[2],Fk.ReverseOrder(this.getRotationMode()))},setEuler:function(P){return P=P.clone().reorder(Fk.ReverseOrder(this.getRotationMode())),this.r3(P.x,P.y,P.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(W,Q){Vh(W,gs(f,f,this.r3(),this.getRotationMode())),this.translate3d(W[0]*Q,W[1]*Q,W[2]*Q)},translateFront:function(k){this.translate3dBy([0,0,1],k)},translateBack:function(i){this.translate3dBy([0,0,-1],i)},translateLeft:function(t){this.translate3dBy([-1,0,0],t)},translateRight:function(F){this.translate3dBy([1,0,0],F)},translateTop:function(c){this.translate3dBy([0,1,0],c)},translateBottom:function(y){this.translate3dBy([0,-1,0],y)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(f,L,m){1===arguments.length&&(L=f[1],m=f[2],f=f[0]),this.p(f,m),this.setElevation(L)},translate3d:function(x,P,F){1===arguments.length&&(P=x[1],F=x[2],x=x[0]),this.translate(x,F),this.setElevation(this._54O+P)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(M,S,n){1===arguments.length&&(S=M[1],n=M[2],M=M[0]),this.setSize(M,n),this.setTall(S)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(c,L,T){var D=this;if(!D._updatingRotation3d){D._updatingRotation3d=1,1===arguments.length&&(L=c[1],T=c[2],c=c[0]);var t=[D._rotationX,-D._64O,D._53O];D._rotationX=c,D._64O=-L,D._53O=T,D.fp("rotation3d",t,[c,L,T]),delete D._updatingRotation3d}},_applyClosestR3:function(){function n(u){return u%=_,0>u&&(u+=_),u>O?_-u:u}function m(j,X){return n(j[0]-X[0])+n(j[1]-X[1])+n(j[2]-X[2])}return function(X,Z,v){var y,b,t,g=this.r3(),H=this.getRotationMode();"xzy"===H||"yzx"===H?(y=X>0?X-O:X+O,b=Z>0?Z-O:Z+O,t=v>0?O-v:-O-v):"xyz"===H||"zyx"===H?(y=X>0?X-O:X+O,t=v>0?v-O:v+O,b=Z>0?O-Z:-O-Z):("yxz"===H||"zxy"===H)&&(t=v>0?v-O:v+O,b=Z>0?Z-O:Z+O,y=X>0?O-X:-O-X),m([y,b,t],g)<m([X,Z,v],g)?this.r3(y,b,t):this.r3(X,Z,v)}}(),setRotationY:function(Z){this.setRotation(-Z)},getRotationY:function(){return-this._64O},lookAtDirection:function(b,r){r=r||Bc;var W=this,q=Mp(b);r===Bc?(W.r3([-e(b[1]/q),-ts(b[2],b[0])+qq,0]),W.setRotationMode("xzy")):r===ln?(W.r3(0,-ts(b[2],b[0]),e(b[1]/q)),W.setRotationMode("zyx")):r===re?(W.r3(0,-ts(b[2],b[0])+O,-e(b[1]/q)),W.setRotationMode("zyx")):r===Fc?(W.r3([-e(b[1]/q)+qq,-ts(b[2],b[0])+qq,0]),W.setRotationMode("xzy")):r===ab&&(W.r3([-e(b[1]/q)-qq,-ts(b[2],b[0])+qq,0]),W.setRotationMode("xzy")),r===qo&&(W.r3([-e(b[1]/q)+O,-ts(b[2],b[0])+qq,O]),W.setRotationMode("zxy"))},lookAt:function(l,v){return this.lookAtDirection(ch(l,this.p3()),v)},lookAtX:function(){var n=new np,_=new np,F=new np,B=new jf,l=new jf,E=new Fk;return function(s,Y){var p=ec(this);if(B.fromArray(p),F.copy(this.p3()),n.copy(s).sub(F),!(n.lengthSq()<1e-6)){n.normalize(),Y=Y||Bc,"string"==typeof Y?Y===Bc?_.set(0,0,1):Y===qo?_.set(0,0,-1):Y===re?_.set(-1,0,0):Y===ln?_.set(1,0,0):Y===Fc?_.set(0,1,0):Y===ab&&_.set(0,-1,0):_.copy(Y).normalize(),_.applyMatrix4(B).sub(F).normalize();var b=Math.acos(n.dot(_));if(b){var r=n.clone().cross(_);r.lengthSq()<1e-6&&(Y===Fc||Y===ab||0===Y[0]&&0===Y[1]?r.set(0,0,1).applyMatrix4(B).sub(F):r.set(0,1,0).applyMatrix4(B).sub(F)),r.normalize(),E.set(this.r3(),this.getRotationMode(),!0),B.makeRotationFromEuler(E),l.makeRotationAxis(r,-b),E.setFromRotationMatrix(l.multiply(B)),this._applyClosestR3(E.x,E.y,E.z)}}}}(),getHost:function(){return this._host},setHost:function(E){var i=this;if(i!==E&&i._host!==E){var J=i._host;J&&(J._removeAttach(i),J.updateLayoutAttaches()),i._host=E,i._host&&(i._host._addAttach(i),i._host.updateLayoutAttaches()),i.fp("host",J,E),i.onHostChanged(J,E)}},getAttaches:function(){return this._69O},_addAttach:function(u){var z=this;z._69O||(z._69O=new zp),z._69O.add(u),z.fp("attaches",f,u)},_removeAttach:function(B){var D=this;D._69O.remove(B),D._69O.isEmpty()&&delete D._69O,D.fp("attaches",B,f)},getImage:function(){if(this._pendingCheckImageJSON){var C=L.getImage(this._image);C&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Wb&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(C){var e=this,I=e._image,p=e.getWidth(),M=e.getHeight();if(e._image=C,e.fp("image",I,C)){if(null!=C&&(Mr(C)||Vn(C)&&/\.json$/i.test(C))&&(this._pendingCheckImageJSON=!0),Lj)return;e.fp(Mj,p,e.getWidth()),e.fp(_p,M,e.getHeight())}},getElevation:function(){return this._54O},setElevation:function(P){var z=this;if(!z._50O){z._50O=1;var A=z._54O;z._54O=P,z.fp(Wi,A,P),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(W){var I=this;if(!I._49O){I._49O=1;var T=I._64O;I._64O=W,I.fp(ve,T,W),delete I._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(d){var e=this;if(!e._51O){e._51O=1;var l=e._rotationX;e._rotationX=d,e.fp("rotationX",l,d),delete e._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(c){var J=this;if(!J._52O){J._52O=1;var X=J._53O;J._53O=c,J.fp("rotationZ",X,c),delete J._52O}},getPosition:function(){return this._position},setPosition:function(l,O){var q=this;if(!q._50I){q._50I=1;var D;if(D=2===arguments.length?{x:l,y:O}:l,D.x!==q._position.x||D.y!==q._position.y){var h=q._position;q._position=D,q.fp(Cp,h,D)}delete q._50I}},translate:function(U,S){var b=this._position;this.p(b.x+U,b.y+S)},hasInheritedSize:function(){var B=this,S=B.getStyle("shape3d");if(S){var j=Cb(S);if(j&&j.rawS3)return!0;if(("billboard"===S||"plane"===S)&&mr(B.getStyle("shape3d.image")))return!0}return B.hasOwnProperty("_image")&&mr(B._image)?!0:!1},getWidth:function(){var x=this;if(x._width>=0)return x._width;var p=x.getStyle("shape3d");if(p){var S=Cb(p);if(S&&S.rawS3)return S.rawS3[0];if("billboard"===p||"plane"===p){var b=mr(x.getStyle("shape3d.image"));return b?Bb(b,x):20}}var b=mr(x._image);return b?Bb(b,x):20},setWidth:function(x){var h=this,d=h._width;h._width=x,h.fp(Mj,d,x)},getHeight:function(){var b=this;if(b._height>=0)return b._height;var N=b.getStyle("shape3d");if(N){var l=Cb(N);if(l&&l.rawS3)return l.rawS3[2];if("plane"===N){var r=mr(b.getStyle("shape3d.image"));return r?qh(r,b):20}if("billboard"===N)return 2}var r=mr(b._image);return r?qh(r,b):20},setHeight:function(v){var G=this,o=G._height;G._height=v,G.fp(_p,o,v)},getTall:function(){var N=this;if(N._tall>=0)return N._tall;var Z=N.getStyle("shape3d");if(Z){var _=Cb(Z);if(_&&_.rawS3)return _.rawS3[1];if("billboard"===Z){var r=mr(N.getStyle("shape3d.image"));return r?qh(r,N):20}if("plane"===Z)return 2}return 20},setTall:function(K){var Z=this,r=Z._tall;Z._tall=K,Z.fp("tall",r,K)},setSize:function(d,w){var f=this;2===arguments.length?(f.setWidth(d),f.setHeight(w)):(f.setWidth(d.width),f.setHeight(d.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(w,Y,Q,x,C){var y=this,A=y.getAnchor(),G=y.getScale();arguments.length<=2&&(C=Y,Y=w.y,Q=w.width,x=w.height,w=w.x);var h=C&&G.x<0?1-A.x:A.x,V=C&&G.y<0?1-A.y:A.y;y.p(w+Q*h,Y+x*V),C&&(Q/=Math.abs(G.x),x/=Math.abs(G.y)),y.setWidth(Q),y.setHeight(x)},getMatrix:function(){var Y=this,m=Y._64O,u=Y._position,U=Y.getScale();return new ph(m,u.x,u.y,U.x,U.y)},getMatrix4:function(){var _=new np,d=new _n,o=new np;return function(X){return this.getQuaternion(d),_.copy(this.p3()),o.copy(this.getFinalScale3d()),X||(X=new jf),X.compose(_,d,o)}}(),getAnchorRect:function(){var E=this,u=E.getWidth(),X=E.getHeight(),O=E.getAnchor();return{x:-u*O.x,y:-X*O.y,width:u,height:X}},toLocal:function(H){return this.getMatrix().tfi(H)},toGlobal:function(I){return this.getMatrix().tf(I)},getAttachPosition:function(){var D=new ph;return function(Q,S,W,j){W=W||0,j=j||0;var U=this,$=U.getAnchor(),Z=U._64O,v=U._position,r=U.getScale();return D.setFromTransform(Z,v.x,v.y).tf({x:W+r.x*U.getWidth()*(Q-$.x),y:j+r.y*U.getHeight()*(S-$.y)})}}(),isInRect:function(Y){Y=this.toLocal(Y);var v=this.getWidth(),u=this.getHeight();return Y.x+=v*this.getAnchorX(),Y.y+=u*this.getAnchorY(),!(Y.x<0||Y.y<0||Y.x>v||Y.y>u)},getRect:function(){var x=this,v=x.getWidth(),C=x.getHeight(),V=x.getAnchor(),_={x:-v*V.x,y:-C*V.y,width:v,height:C},z=x.getMatrix();return _=Db([z.tf(_.x,_.y),z.tf(_.x+_.width,_.y),z.tf(_.x+_.width,_.y+_.height),z.tf(_.x,_.y+_.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var N=this,i=N.getAnchor(),k=N._anchorElevation;return{x:i.x,y:k,z:i.y}},setAnchorElevation:function(U){var F=this,E=F._anchorElevation;return E!==U?(F._anchorElevation=U,F.fp("anchorElevation",E,U),!0):!1},setAnchor3d:function(j,C,R,Y){var A,U=this;"number"==typeof j?A={x:j,y:C,z:R}:(A=j.length?{x:j[0],y:j[1],z:j[2]}:j,Y=C),U.beginTransaction();var K=U.getAnchor3d(),t=U.setAnchor(A.x,A.z);if(U.setAnchorElevation(A.y)&&(t=!0),t&&Y&&!Lj){U.getAnchor3d();var Z=ec(U),x=Vh([A.x-K.x,A.y-K.y,A.z-K.z],Z);U.p3(x)}return U.endTransaction(),t},getAnchor:function(){var q=this;if(q.hasOwnProperty("_anchor"))return q._anchor;var P=mr(q._image);return P&&P.anchorX!==E?{x:P.anchorX,y:P.anchorY}:q._anchor},setAnchor:function(w,u,Z){var o,a=this;"number"==typeof w?o={x:w,y:u}:(o=w.length?{x:w[0],y:w[1]}:w,Z=u);var i=a.getAnchor();if(i.x!==o.x||i.y!==o.y){if(a.beginTransaction(),a._anchor=o,a.fp("anchor",i,o),Z&&!Lj){var I=a.getPosition(),Y=a.getSize(),C=a.getRotation(),O=a.getScale(),z=-Y.width*(i.x-o.x)*O.x,p=-Y.height*(i.y-o.y)*O.y,r=B(C),j=J(C);a.setPosition(I.x+j*z-r*p,I.y+r*z+j*p)}return a.endTransaction(),!0}return!1},getLocalQuaternion:function(H){var V=this,K=V.getHost();if(!K)return V.getQuaternion(H);var l=K.getQuaternion(),n=V.getQuaternion();return H||(H=new _n),H.copy(l).inverse().multiply(n)},setLocalQuaternion:function(O){var b=this,H=b.getHost();if(!H)return b.setQuaternion(O);var f=H.getQuaternion();b.setQuaternion(f.clone().multiply(O))},getLocalEuler:function(){var l=new _n;return function(M){var z=this,V=z.getHost();return V?(z.getLocalQuaternion(l),M||(M=new Fk),M.setFromQuaternion(l,Fk.ReverseOrder(this.getRotationMode()))):z.getEuler(M)}}(),setLocalEuler:function(){var W=new _n;return function(K){var J=this,$=J.getHost();return $?(W.setFromEuler(K),J.setLocalQuaternion(W)):J.setEuler(K)}}(),getLocalPosition3d:function(V){var P=this;V||(V=new np),V.copy(P.p3());var U=P.getHost();if(!U)return V;var N=U.getMatrix4();return V.applyMatrix4(N.getInverse(N))},setLocalPosition3d:function(o){var x=this,t=x.getHost();if(!t)return o.x!==E?x.p3(o.x,o.y,o.z):x.p3(o),void 0;var T=t.getMatrix4(),c=new np(o);c.applyMatrix4(T),x.p3(c.x,c.y,c.z)},getScale:function(){return this._scale},setScale:function(F,g){var $,_=this;$=2===arguments.length?{x:F,y:g}:F;var P=_.getScale();(P.x!==$.x||P.y!==$.y)&&(_._scale=$,_.fp("scale",P,$))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var P=this,O=P._scaleTall,f=P.getScale();return[f.x,O,f.y]},getFinalScale3d:function(){var K=this,v=K.s3(),B=K._dynamicScale3d,r=K.getScale3d();return v&&(r[0]*=v[0],r[1]*=v[1],r[2]*=v[2]),B&&(r[0]*=B[0],r[1]*=B[1],r[2]*=B[2]),r},getFinalRotation3d:function(){var V=this;return V._dynamicRotation||V.r3()},setScaleTall:function(h){var J=this,m=J._scaleTall;m!==h&&(J._scaleTall=h,J.fp("scaleTall",m,h))},setScale3d:function(C,b,Q){var w,y=this;w="number"==typeof C?{x:C,y:b,z:Q}:C.length?{x:C[0],y:C[1],z:C[2]}:C,y.setScaleTall(w.y),y.setScale(w.x,w.z)},getCorners:function(d,r){d==f&&(d=0),r==f&&(r=d);var P=this,E=P.getAnchor(),H=P.getWidth(),V=P.getHeight(),S=-H*E.x-d,R=-V*E.y-r,t=H+2*d,Q=V+2*r,l=P.getMatrix();return[l.tf(S,R),l.tf(S,R+Q),l.tf(S+t,R+Q),l.tf(S+t,R)]},getEditControlPoints:function(n,M,h){M==f&&(M=0),h==f&&(h=M);var w=this,O=w.getAnchor(),o=w.getWidth(),z=w.getHeight(),q=-o*O.x-M,C=-z*O.y-h,W=o+2*M,R=z+2*h;if(n)return[{x:q,y:C},{x:q,y:0},{x:q,y:C+R},{x:0,y:C+R},{x:q+W,y:C+R},{x:q+W,y:0},{x:q+W,y:C},{x:0,y:C}];var d=w.getMatrix();return[d.tf(q,C),d.tf(q,0),d.tf(q,C+R),d.tf(0,C+R),d.tf(q+W,C+R),d.tf(q+W,0),d.tf(q+W,C),d.tf(0,C)]},rotateAt:function(z,c,D){var R=this,x=R._position,H=R._64O,r=new ph(H,x.x,x.y).tf(z,c),y=G(z*z+c*c),M=ts(x.y-r.y,x.x-r.x)+D;R.setRotation(H+D),R.p(r.x+y*J(M),r.y+y*B(M))},rotateAroundAxis:function(Q,i){this.setQuaternion(this.getQuaternion().multiply(fb.setFromAxisAngle(Q,i)))},rotateAroundWorldAxis:function(d,G){this.setQuaternion(this.getQuaternion().premultiply(fb.setFromAxisAngle(d,G)))},rotateX:function(g){return this.rotateAroundAxis(np.AxisX,g)},rotateY:function(y){return this.rotateAroundAxis(np.AxisY,y)},rotateZ:function(G){return this.rotateAroundAxis(np.AxisZ,G)},onParentChanged:function(){jh.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var l={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(N){l[N]=!0}),function(h){var o=this;jh.superClass.onPropertyChanged.call(o,h);var B=h.property;if(l[B]&&!o._layoutUpdating&&o.updateLayoutParameters(null,B),o._69O&&o._69O.each(function(J){J.handleHostPropertyChange(h)}),o._49I&&o._49I.each(function(O){O.fp("agentChange",!0,!1)}),nd[B]&&this.updateLayoutAttaches(),"a:layout"===B.substring(0,8)){this.updateLayoutAttaches();var A=o._host;A&&A.updateLayoutAttaches()}("s:shape3d.autorotate"===B||"s:autorotate"===B||"s:shape3d.fixSizeOnScreen"===B||"s:fixSizeOnScreen"===B||"s:hide.overlapping.group"===B)&&(o._47Q=o.s("autorotate")||o.s("shape3d.autorotate")||o.s("fixSizeOnScreen")||o.s("shape3d.fixSizeOnScreen")||o.s("hide.overlapping.group"))}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(G){this.updateAttach(G)},onStyleChanged:function(E){jh.superClass.onStyleChanged.apply(this,arguments),Pb[E]&&this.updateAttach()},updateLayoutAttaches:function(){if(!Lj&&this.s("vector.layoutable")){var P,e,E=this;return P=mr(E.getImage()),P&&P.layoutAttach&&(e=P.layoutAttach,e&&e(E))?!0:void 0}},updateAttach:function(d){var z=this;return Lj?(z.updateLayoutParameters(),void 0):(z._51I||(z._51I=1,z._71O(d),delete z._51I),void 0)},_71O:function(P){var l,G,Q,o,q,_,h=this,n=h._host,c=P?P.property:f,x=P?P.oldValue:f,C=P?P.newValue:f;if(n instanceof jh&&(!P||nd[c])){var v;if(v=mr(n.getImage()),v&&v.layoutAttach)return}if(n instanceof H.Grid){if(c===Wi)h.setElevation(h._54O+C-x);else if(!P||Gg[c]){if(l=h.s("attach.row.index"),G=h.s("attach.column.index"),Q=n.getCellRect(l,G),!Q)return;o=h.s("attach.row.span"),q=h.s("attach.column.span"),(1!==o||1!==q)&&(Q=Ie(Q,n.getCellRect(l+o-1,G+q-1))),xs(Q,h,"attach.padding",1),h.setRect(Q)}}else if(n instanceof vg&&(_=h.s("attach.index"))>=0&&(!P||nm[c])){var J=h.s("attach.thickness"),E=n.getScale(),S=Math.max(E.x,E.y);J>0&&h.setHeight(n.getThickness()*J*S);var y=h.s("attach.offset"),t=n.getPoints(),T=t.size();if(T>_){var L=n.getPointsMatrix2d(),d=t.get(_),s=T===_+1?t.get(0):t.get(_+1);d=L.apply(d),s=L.apply(s);var $=[s.x-d.x,s.y-d.y],R=Mp($);if(R){h.s("attach.offset.relative")&&(y*=R),h.s("attach.offset.opposite")&&(y=R-y);var B={x:d.x+$[0]/R*y,y:d.y+$[1]/R*y},O=h.s("attach.gap");O&&(h.s("attach.gap.relative")&&(O*=n.getThickness()*S),B=Ng(f,B,s,O)),h.p(B),h.setRotation(ts($[1],$[0]))}}}else P&&(c===Cp?h.translate(C.x-x.x,C.y-x.y):c===Wi?h.setElevation(h._54O+C-x):Fr[c]?"rotation3d"===c?h.syncRotation3d(n,C,x):h._11Q(n,c,C-x):("anchor"===c||"width"===c||"height"===c||"scale"===c)&&h.layout(n))},_11Q:function(){var c=new H.Math.Euler,O=H.Math.Euler.ReverseOrder,N=new H.Math.Vector2,w=new H.Math.Vector2;return function(n,Y,i){var F=this,o=n.p3(),k=n.r3(),s=F.p3(),R=F.r3();if(Y===ve&&(Y="rotationY",i=-i),(Y===ve||"rotationY"===Y)&&0===R[0]&&0===R[2]&&0===k[0]&&0===k[2]&&0===s[1]&&0===o[1])return F.setRotation(-R[1]-i),N.set(s[0],s[2]).rotateAround(w.set(o[0],o[2]),-i),F.p(N.x,N.y),void 0;var U=xj[n.getRotationMode()],m=U[0],g=U[1],C=U[2],L=Lo[m],b=Lo[g],y=Lo[C],Q=ue();Y===ve+m?(y(Q,k[cn[C]]),b(Q,k[cn[g]]),L(Q,i),b(Q,-k[cn[g]]),y(Q,-k[cn[C]])):Y===ve+g?(y(Q,k[cn[C]]),b(Q,i),y(Q,-k[cn[C]])):Y===ve+C&&y(Q,i);var q=ch(s,o);Vh(q,Q),F.p3(o[0]+q[0],o[1]+q[1],o[2]+q[2]);var G=F.getRotationMode();qe(Q,F.r3(),G),c.setFromRotationMatrix(Q,O(G)),F.r3([c.x,c.y,c.z])}}(),syncRotation3d:function(){var o=new _n,m=new Fk,f=new np;return function(F,R,c){var Y=this;if(c[0]!==R[0]||c[1]!==R[1]||c[2]!==R[2]){var h=Fk.ReverseOrder(F.getRotationMode());fb.setFromEuler(m.set(c[0],c[1],c[2],h)),o.setFromEuler(m.set(R[0],R[1],R[2],h)),o.multiply(fb.inverse());var z=F.p3(),O=Y.p3();f.set(O[0]-z[0],O[1]-z[1],O[2]-z[2]).applyQuaternion(o),Y.p3(z[0]+f.x,z[1]+f.y,z[2]+f.z),Y.setQuaternion(Y.getQuaternion(fb).premultiply(o))}}}(),isHostOn:function(g){var I=this;if(I._host&&g&&g._69O)for(var Q={},q=I._host;q&&q!==I&&!Q[q._id];){if(q===g)return!0;Q[q._id]=q,q=q._host}return!1},isLoopedHostOn:function(M){return this.isHostOn(M)&&M.isHostOn(this)},getScaledSize:function(){var U=this.getSize(),y=this.getScale();return U.width*=Math.abs(y.x),U.height*=Math.abs(y.y),U},layout:function(T){if(T=T||this.getHost()){var Z=this,u=Z.s("layout.h")||"center",s=Z.s("layout.v")||"center";if("center"!==u||"center"!==s){var $=new H.Math.Vector2,r=T.getPosition(),d=T.getAnchor(),R=T.getScaledSize();Z.getPosition();var z,_,P,n,S,D=1,x=1;switch(Z._layoutUpdating=!0,u){case"left":$.setX(Z._layoutHValue-d.x*R.width);break;case"right":$.setX((1-d.x)*R.width-Z._layoutHValue);break;case"leftright":z=R.width-Z._layoutHValue[2],P=Z.getRotation()-T.getRotation(),n=Math.abs(Math.sin(P)),S=Math.abs(Math.cos(P)),D+=S*z/Z._layoutHValue[3],x+=n*z/Z._layoutHValue[4],$.setX(Z._layoutHValue[1]+(Z._layoutHValue[5]-d.x)*R.width);break;case"center":$.setX((.5-d.x)*R.width-Z._layoutHValue);break;case"scale":P=Z.getRotation()-T.getRotation(),n=Math.abs(Math.sin(P)),S=Math.abs(Math.cos(P)),$.setX((.5-d.x)*R.width-Z._layoutHValue[1]*R.width/Z._layoutHValue[0]),_=R.width/Z._layoutHValue[2]-1,D+=S*_,x+=n*_}switch(s){case"top":$.setY(Z._layoutVValue-d.y*R.height);break;case"bottom":$.setY((1-d.y)*R.height-Z._layoutVValue);break;case"topbottom":P||(P=Z.getRotation()-T.getRotation(),n=Math.abs(Math.sin(P)),S=Math.abs(Math.cos(P))),z=R.height-Z._layoutVValue[2],D+=n*z/Z._layoutVValue[3],x+=S*z/Z._layoutVValue[4],$.setY(Z._layoutVValue[1]+(Z._layoutVValue[5]-d.y)*R.height);break;case"center":$.setY((.5-d.y)*R.height-Z._layoutVValue);break;case"scale":P||(P=Z.getRotation()-T.getRotation(),n=Math.abs(Math.sin(P)),S=Math.abs(Math.cos(P))),$.setY((.5-d.y)*R.height-Z._layoutVValue[1]*R.height/Z._layoutVValue[0]),_=R.height/Z._layoutVValue[2]-1,D+=n*_,x+=S*_}if("leftright"===u||"scale"===u||"topbottom"===s||"scale"===s){var k=this.getScale(),a=Math.abs(k.x),W=Math.abs(k.y);"leftright"===u||"scale"===u?Z.setSize(Z._layoutHValue[3]*D/a,Z._layoutHValue[4]*x/W):Z.setSize(Z._layoutVValue[3]*D/a,Z._layoutVValue[4]*x/W)}$.rotateAround(null,T.getRotation()),this.setPosition($.x+r.x,$.y+r.y),Z._layoutUpdating=E}}},updateLayoutParameters:function(d,y){if(d=d||this.getHost()){var A=this,s=A.s("layout.h"),F=A.s("layout.v");if(s||F){var j,c,h,k,r,b,B=new H.Math.Vector2,n=d.getPosition(),J=d.getAnchor(),W=d.getScaledSize(),C=A.getPosition(),D=A.getScaledSize();switch(B.set(C.x-n.x,C.y-n.y),B.rotateAround(null,-d.getRotation()),s){case"left":A._layoutHValue=B.x+J.x*W.width;break;case"right":A._layoutHValue=-B.x+(1-J.x)*W.width;break;case"center":A._layoutHValue=-B.x+(.5-J.x)*W.width;break;case"leftright":case"scale":"scale"===s?j=-B.x+(.5-J.x)*W.width:(c=A.getAnchor(),h=A.getRotation()-d.getRotation(),k=Math.cos(h),r=Math.sin(h),b=-Math.min(-c.x*k+c.y*r,-c.x*k-(1-c.y)*r,(1-c.x)*k+c.y*r,(1-c.x)*k-(1-c.y)*r),j=B.x-(b-J.x)*W.width),"position"===y&&"object"==typeof A._layoutHValue?(A._layoutHValue[0]=W.width,A._layoutHValue[1]=j):A._layoutHValue=[W.width,j,W.width,D.width,D.height,b]}switch(F){case"top":A._layoutVValue=B.y+J.y*W.height;break;case"bottom":A._layoutVValue=-B.y+(1-J.y)*W.height;break;case"center":A._layoutVValue=-B.y+(.5-J.y)*W.height;break;case"topbottom":case"scale":"scale"===F?j=-B.y+(.5-J.y)*W.height:(h||(c=A.getAnchor(),h=A.getRotation()-d.getRotation(),k=Math.cos(h),r=Math.sin(h)),b=-Math.min(-c.x*r-c.y*k,-c.x*r+(1-c.y)*k,(1-c.x)*r-c.y*k,(1-c.x)*r+(1-c.y)*k),j=B.y-(b-J.y)*W.height),"position"===y&&"object"==typeof A._layoutVValue?(A._layoutVValue[0]=W.height,A._layoutVValue[1]=j):A._layoutVValue=[W.height,j,W.height,D.width,D.height,b]}}}},getSerializableProperties:function(){var M=jh.superClass.getSerializableProperties.call(this);return Hi(M,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),M}});var Rl=H.Edge=function(i,u){var B=this;Hm(Rl,B),B.setSource(i),B.setTarget(u)};Ce("Edge",rd,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return Xf},_22Q:function(){return lt},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(P){if(P===this)return!1;if(mq(P))return!0;for(var e,W,Q,m,O,L=[this],x=-1,p=0;p>x;)if(x++,e=L[x],W=e._44I)for(W=W.getArray(),m=0,O=W.length;O>m;m++)if(Q=W[m],Op(Q)&&!(L.indexOf(Q)>=0)){if(Q===P)return!1;L.push(Q),p++}return!0},setSource:function(d){var l=this;if(l._source!==d&&l.canSetSourceTarget(d)){var e=l._source;l._source=d,e&&e._16I(l),d&&d._2I(l),l._7I(),l.fp("source",e,d)}},setTarget:function(u){var R=this;if(R._target!==u&&R.canSetSourceTarget(u)){var E=R._target;R._target=u,E&&E._18I(R),u&&u._4I(R),R._7I(),R.fp("target",E,u)}},isLooped:function(){var $=this;return $._source===$._target&&mq($._source)&&mq($._target)},onPropertyChanged:function(M){var t=this;t._49I&&t._49I.each(function(K){K.fp("agentChange",!0,!1)}),("s:alwaysOnTop"===M.property||"s:shape3d.alwaysOnTop"===M.property)&&(M.newValue?this.setRenderLayer("top"):this.setRenderLayer(E))},_7I:function(){var I,o=this,u=cr(o);o._40I!==u&&(I=this._40I,I&&I._15I(o),o._40I=u,u&&u._1I(o),o.fp("sourceAgent",I,u),rm(I,o._41I),rm(u,o._41I));var C=In(o);o._41I!==C&&(I=o._41I,I&&I._17I(o),o._41I=C,C&&C._3I(o),o.fp("targetAgent",I,C),rm(I,o._40I),rm(C,o._40I))},_22I:function(w){this._52I=w,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var v=this;return v._52I&&v._52I.get(0)!==v&&!v.getStyle(Ne)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var j=this,Z=j._52I;return Z&&!j.getStyle(Ne)&&Z.size()>1&&j===Z.get(0)},toggle:function(){this.beginTransaction();var m=this._52I,F=!this.s(Ne);m&&m.size()>1&&(m.each(function(_){_.s(Ne,F)}),m.getSiblings().each(function(e){e!==m&&e.each(function(r){r.fp("edgeGroup",f,e)})})),this.endTransaction()},setStyle:function(k,Q){(k===Ji||"edge.segments"===k)&&(Q=vo(Q)),Rl.superClass.setStyle.call(this,k,Q)},onStyleChanged:function(l){Rl.superClass.onStyleChanged.apply(this,arguments),Em[l]&&rm(this._41I,this._40I)},getSerializableProperties:function(){var n=Rl.superClass.getSerializableProperties.call(this);return Hi(n,{source:1,target:1}),n}});var Vg=H.Group=function(){Hm(Vg,this)};Ce("Group",jh,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return Mi},onChildAdded:function(){Vg.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){Vg.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var b=this;if(!b._54I&&!Lj){var L=b.getChildrenRect();L&&(b._53I=1,b.p(Nb(b.s("group.position"),L,b.getSize())),delete b._53I)}},getChildrenRect:function(){var c,K=this;return K.eachChild(function(C){mq(C)&&(c=Ie(c,K.getChildRect(C)))}),c},getChildRect:function(M){var $;return mq(M)&&M.s(mf)&&(Zd(M)&&M.isExpanded()&&M.eachChild(function(F){$=Ie($,M.getChildRect(F))}),!$&&M.getRect&&($=M.getRect())),$},setPosition:function(s,H){var Z=this;if(!Z._54I){var B;B=2===arguments.length?{x:s,y:H}:s,Lj||Z._53I||(Z._54I=1,Lp(Z._children,B.x-Z._position.x,B.y-Z._position.y),delete Z._54I),Vg.superClass.setPosition.call(this,B)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(h){var i=this;if(i._57O!==h){var l=i._57O;i._57O=h,i.fp("expanded",l,i._57O),i._fireInvalidateDeep(),i._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(J){Zd(J)?J._fireInvalidateDeep():J.iv()})},_8I:function(){Vg.superClass._8I.call(this),this.eachChild(function(b){mq(b)&&b._8I()})},onStyleChanged:function(m){Vg.superClass.onStyleChanged.apply(this,arguments),"group.position"===m&&this._81I()},getSerializableProperties:function(){var y=Vg.superClass.getSerializableProperties.call(this);return y.expanded=1,y}});var fm=H.Camera=function(){Hm(fm,this),this.s({"shadow.cast":!1,"shadow.receive":!1,shape3d:"billboard"}),this._viewMatrix=new xc.Matrix4,this._projectMatrix=new xc.Matrix4,this.setScale3d(1,1,-1),this.setCullingMask("main,top"),this._projectMatrixDirty=!0};fm.CubeDirectionParam=[1,0,0,0,-1,0,-1,0,0,0,-1,0,0,1,0,0,0,1,0,-1,0,0,0,-1,0,0,1,0,-1,0,0,0,-1,0,-1,0],Ce("Camera",jh,{_22Q:function(){return Camera3dUI},attachRenderTarget:function(F){this._projectMatrixDirty=!0,this.renderTarget=F},detachRenderTarget:function(){this._projectMatrixDirty=!0,this.renderTarget=null},setCullingMask:function(K){var g=K.split(",");this._cullingMask=Jc(g)},isLayerVisible:function(t){var S=ws[t];return S&&cd(this._cullingMask,S.mask)},isOrtho:function(){return"ortho"===this.s("camera.type")&&!this.isCube()},isCube:function(){return this.renderTarget&&this.renderTarget.isCube()},isPerspective:function(){return!this.isOrtho()},setViewMatrix:function(){var n=new H.Math.Matrix4,X=new H.Math.Euler;return function(D){var t=this;D.isMatrix4?t._viewMatrix.copy(D):t._viewMatrix.fromArray(D),n.getInverse(t._viewMatrix),t.p3(n.getPosition().toArray()),X.set(0,0,0,t.getRotationMode(),!0).setFromRotationMatrix(n),t.r3([X.x,X.y,X.z])}}(),getViewMatrix:function(k){var g=this,l=gs(null,null,g.r3(),g.getRotationMode(),g.p3()),$=g._viewMatrix;return $.fromArray(l).getInverse($),$.toArray(k)},setProjectMatrix:function(d){var W=this;d.isMatrix4?W._projectMatrix.copy(d):W._projectMatrix.fromArray(d),d=W._projectMatrix.getElements(),W.isOrtho()?W.s({"camera.near":(d[14]+1)/d[10],"camera.far":(d[14]-1)/d[10],"camera.ortho.width":2/d[0]}):W.s({"camera.near":d[14]/(d[10]-1),"camera.far":d[14]/(d[10]+1),"camera.fovy":2*Math.atan(1/d[5]),"camera.aspect":d[5]/d[0]}),W._projectMatrixDirty=!1},onPropertyChanged:function(V){var _=this;fm.superClass.onPropertyChanged.call(_,V);var e=V.property;("s:camera.near"===e||"s:camera.far"===e||"s:camera.fovy"===e||"s:camera.aspect"===e||"s:camera.ortho.width"===e)&&(_._projectMatrixDirty=!0)},getProjectMatrix:function(){var j=this;if(j._projectMatrixDirty){var S=j.gv,s=j.isCube(),N=s?1:j.s("camera.aspect")||(S?S.getAspect():null)||L.graph3dViewAspect,O=j.s("camera.near")||(S?S.getNear():null)||L.graph3dViewNear,y=j.s("camera.far")||(S?S.getFar():null)||L.graph3dViewFar,$=ue();if(j.isOrtho()){var G=j.s("camera.ortho.width")||(S?S.getOrthoWidth():null)||L.graph3dViewOrthoWidth,q=G/2,W=q/N;_j($,-q,q,-W,W,O,y)}else{var a=s?Math.PI/2:j.s("camera.fovy")||(S?S.getFovy():null)||L.graph3dViewFovy;Ag($,a,N,O,y)}j._projectMatrix.fromArray($),j._projectMatrixDirty=!1}return j._projectMatrix.toArray()},lookAt:function(H,E){var e=this.p3();return H.x?this.lookAtDirection([H.x-e[0],H.y-e[1],H.z-e[2]],E):this.lookAtDirection([H[0]-e[0],H[1]-e[1],H[2]-e[2]],E)},lookAtDirection:function(){var T=new H.Math.Matrix4,A=new H.Math.Euler,x=new H.Math.Vector3,L=new H.Math.Vector3;return function(d,X){T.lookAtDirection(x.copy(d).multiplyScalar(-1),X?L.copy(X):L.set(0,1,0)),A.set(0,0,0,this.getRotationMode(),!0).setFromRotationMatrix(T),this.r3([A.x,A.y,A.z])}}(),updateAndRender:function(k){return k.syncRenderState(),k.updateScene(),this.render(k)},render:function(M){var e=this,d=M.getGL();if(!d)return!1;var t,l,u=e.renderTarget;if(u)t=u.width,l=u.height;else{var z=M.getDevicePixelRatio();t=M.getWidth()*z,l=M.getHeight()*z}e.gv=M,M._camera=e;var E=M._frameState.renderState.glState,g=E.color.clear.slice(0);Ej(d,e.s("camera.background"));var O=M.getEye;if(M.getEye=function(){return e.p3()},e.isCube())for(var L=fm.CubeDirectionParam,K=0;6>K;K++)u&&u.bind(d,K),e.lookAtDirection([L[6*K+0],L[6*K+1],L[6*K+2]],[L[6*K+3],L[6*K+4],L[6*K+5]]),e.s("camera.clear")!==!1&&d.clear(d.COLOR_BUFFER_BIT),M.setViewport(d,0,0,t,l),e.s("camera.onlySky")?M.renderSky():M.renderScene({renderAxis:e.s("camera.renderAxis"),renderGrid:e.s("camera.renderGrid"),renderEdit:e.s("camera.renderEdit"),renderReflector:!1}),u&&u.unbind(d);else u&&u.bind(d),e.s("camera.clear")!==!1&&d.clear(d.COLOR_BUFFER_BIT),M.overlappingBox.clear(),M.setViewport(d,0,0,t,l),e.s("camera.onlySky")?M.renderSky():M.renderScene({renderAxis:e.s("camera.renderAxis"),renderGrid:e.s("camera.renderGrid"),renderEdit:e.s("camera.renderEdit")}),u&&u.unbind(d);return M.getEye=O,Ej(d,g),M._camera=null,e.gv=null,!0}});var If=H.Block=function(){Hm(If,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};Ce("Block",jh,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return tg},_22Q:function(){return kt},onChildAdded:function(){If.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){If.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function j(Y,y,t){J.fromArray(ec(y));var m=y.getAnchor3d();Y.push((new np).set(0-m.x,0-m.y,0-m.z).applyMatrix4(J).applyMatrix4(t)),Y.push((new np).set(0-m.x,0-m.y,1-m.z).applyMatrix4(J).applyMatrix4(t)),Y.push((new np).set(0-m.x,1-m.y,0-m.z).applyMatrix4(J).applyMatrix4(t)),Y.push((new np).set(0-m.x,1-m.y,1-m.z).applyMatrix4(J).applyMatrix4(t)),Y.push((new np).set(1-m.x,0-m.y,0-m.z).applyMatrix4(J).applyMatrix4(t)),Y.push((new np).set(1-m.x,0-m.y,1-m.z).applyMatrix4(J).applyMatrix4(t)),Y.push((new np).set(1-m.x,1-m.y,0-m.z).applyMatrix4(J).applyMatrix4(t)),Y.push((new np).set(1-m.x,1-m.y,1-m.z).applyMatrix4(J).applyMatrix4(t))
}function k(w,Z){var V=(new jf).makeRotationFromEuler(this.getEuler()).setPosition((new np).fromArray(this.p3()));V.getInverse(V),w.forEach(function(v){mq(v)&&j(Z,v,V)})}var J=new jf;return function(d,g){if(d instanceof jh&&(d=[d]),!d||0===d.length)return f;var g=[];k.call(this,d,g);var I=[1/0,1/0,1/0],M=[-1/0,-1/0,-1/0];return g.forEach(function(Z){I[0]=Math.min(Z.x,I[0]),I[1]=Math.min(Z.y,I[1]),I[2]=Math.min(Z.z,I[2]),M[0]=Math.max(Z.x,M[0]),M[1]=Math.max(Z.y,M[1]),M[2]=Math.max(Z.z,M[2])}),{min:I,max:M}}}(),updateFromChildren:function(){var l=this;if(!Lj&&!l._updatingToChildren&&l._syncSize&&0!==l.size()&&!l._freezeSyncFromChildren){var R=this._getBoundingBox(l.toChildren(mq));if(R){l._updatingFromChildren=1;var T=(new np).fromArray(this.getScale3d()),h=(new np).fromArray(R.min),$=(new np).fromArray(R.max),F=L.blockMinSize,Y=new np,d=$.clone().sub(h);0===d.x&&Y.setX(.5),0===d.y&&Y.setY(.5),0===d.z&&Y.setZ(.5);var U=this._width==f||-1===this._width,X=new np(this.getAnchor3d()),A=T.clone().multiply((new np).fromArray(this.s3())),C=d.clone();0===C.x&&C.setX(F),0===C.y&&C.setY(F),0===C.z&&C.setZ(F);var S=X.clone().multiply(A),H=S.clone().multiplyScalar(-1).sub(h).divide(C).add(S.divide(C)).add(Y),r=this.s("keepPosition");if(U||this._anchorChanged||this._scaleChanged||!r){!U&&r&&(X=H);var m=X.clone().multiply(d).add(h).applyEuler(this.getEuler()).add((new np).fromArray(this.p3()));this.p3([m.x,m.y,m.z])}else this.setAnchor3d(H.x,H.y,H.z);var w=new np(1,1,1).divide(T).multiply(d);this.s3(Math.abs(w.x),Math.abs(w.y),Math.abs(w.z)),delete l._updatingFromChildren}}},setPosition:function(u,s){var S=this;if(!S._updatingToChildren){var W;W=2===arguments.length?{x:u,y:s}:u,Lj||S._updatingFromChildren||(S._updatingToChildren=1,Lp(S._children,W.x-S._position.x,W.y-S._position.y),delete S._updatingToChildren),If.superClass.setPosition.call(this,W)}},setSize3d:function(){this.beginTransaction(),If.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(N){var R=this;if(!R._updatingToChildren){this.beginTransaction(),N=p(N,L.blockMinSize);var a=R.getTall();if(N!==a&&If.superClass.setTall.call(R,N),!Lj&&!R._updatingFromChildren){R._updatingToChildren=1;var u=N/a;R._adjustChildTallOrScale(u,"size"),delete R._updatingToChildren,R.updateFromChildren()}this.endTransaction()}},setWidth:function(T){return this.setSize(T,this.getHeight())},setHeight:function(Q){return this.setSize(this.getWidth(),Q)},setSize:function(y,R){var M=L.blockMinSize;y=p(y,M),R=p(R,M);var A=this;if(!A._updatingToChildren){2!==arguments.length&&(R=y.height,y=y.width),this.beginTransaction();var O=A.getWidth(),Q=A.getHeight();if(y!==O&&If.superClass.setWidth.call(A,y),R!==Q&&If.superClass.setHeight.call(A,R),!Lj&&!A._updatingFromChildren){A._updatingToChildren=1;var P=y/O,S=R/Q;A._adjustChildScaleOrSize(P,S,"size"),delete A._updatingToChildren,A.updateFromChildren()}this.endTransaction()}},_adjustChildScaleOrSize:function(o,F,V){var P=this;if(P._syncSize){var Z=P.getPosition(),h=P.getRotation();P.eachChild(function(O){if(mq(O)){var X=O.getPosition(),E=O.getRotation(),C=O.getWidth(),G=O.getHeight(),S=O.getScale(),N=S.x*C,Y=S.y*G;if(0!==N&&0!==Y){0>o*F&&O.setRotation(-1*E);var l=new ph(E,X.x,X.y,N,Y);l.translate(-Z.x,-Z.y),l.rotate(-h),E=ts(l.b*Math.sign(N),l.a*Math.sign(N)),l.scale(o,F);var k,p,q,$=J(E);if(Math.abs($)<.001?(k=B(E),p=l.b/k,q=-l.c/k):(p=l.a/$,q=l.d/$),"scale"===V)O.setScale(p/C,q/G);else if("size"===V){var P=p/S.x,I=q/S.y;O.setScale(Wd(p)*Math.abs(S.x),Wd(q)*Math.abs(S.y)),O instanceof H.Shape?(O.setWidthForce(Math.max(Math.abs(P),1e-5)),O.setHeightForce(Math.max(Math.abs(I),1e-5))):O.setSize(Math.max(.01,Math.abs(P)),Math.max(.01,Math.abs(I)))}l.rotate(h),l.translate(Z.x,Z.y),O.setPosition(l.tx,l.ty)}}})}},_calcChangeFactor:function(M,b,S,c){var Q,G,W,v;return Q=a(M),G=a(S),W=Q>G?Q/G:G/Q,Q=a(b),G=a(c),v=Q>G?Q/G:G/Q,p(W,v)},setElevation:function(s){var x=this;if(!x._updatingToChildren){var m=x.getElevation(),c=s-m;0!==c&&(Lj||x._updatingFromChildren||(x._updatingToChildren=1,Lp(x._children,0,c,0),delete x._updatingToChildren),If.superClass.setElevation.apply(x,arguments))}},setScaleTall:function(q){var V=this;if(!V._updatingToChildren){var U=V.getScaleTall();if(a(q)<.01&&(q=.01*(Wd(q)||Wd(U))),If.superClass.setScaleTall.call(V,q),!Lj&&!V._updatingFromChildren){V._updatingToChildren=1;var D=q/U;V._adjustChildTallOrScale(D,"scale"),delete V._updatingToChildren,V._scaleChanged=1,this.updateFromChildren(),delete V._scaleChanged}}},_adjustChildTallOrScale:function(x,O){var f=this;if(f._syncSize){var C=f.getElevation();f.eachChild(function(Q){if(mq(Q)){if("size"===O){var v=Q.getTall();0>x&&Q.setScaleTall(-1*Q.getScaleTall()),Q.setTall(Math.max(.01,Math.abs(v*x)))}else{var X=Q.getScaleTall();Q.setScaleTall(X*x)}Q.setElevation(C+(Q.getElevation()-C)*x)}})}},setAnchor3d:function(){if(!this._updatingToChildren){this.beginTransaction();var L=If.superClass.setAnchor3d.apply(this,arguments);return L&&!Lj&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),L}},setAnchor:function(){var A=this;if(!A._updatingToChildren){var v=A.getAnchor(),I=If.superClass.setAnchor.apply(A,arguments);if(Lj||A._updatingFromChildren||!A._syncSize)return I;A._updatingToChildren=1;var r=A.getAnchor(),V=A.getSize(),c=V.width*(v.x-r.x),n=V.height*(v.y-r.y),y=(new jf).compose(new np,this.getQuaternion(),new np(this.getScale3d())),E=new np(c,0,n).applyMatrix4(y);return A.eachChild(function(a){if(mq(a)){var B=new np(a.p3());a.p3(B.add(E).toArray())}}),delete A._updatingToChildren,I}},setAnchorElevation:function(){var O=this;if(!O._updatingToChildren){var e=O.getAnchorElevation(),y=If.superClass.setAnchorElevation.apply(O,arguments);if(Lj||O._updatingFromChildren||!O._syncSize)return y;O._updatingToChildren=1;var X=O.getAnchorElevation(),E=O.getTall()*(e-X),l=(new jf).compose(new np,this.getQuaternion(),new np(this.getScale3d())),F=new np(0,E,0).applyMatrix4(l);return O.eachChild(function(D){if(mq(D)){var E=new np(D.p3());D.p3(E.add(F).toArray())}}),delete O._updatingToChildren,y}},setRotation:function(X){this._updateChildrenRotation3d("rotation",X)},setRotationX:function(g){this._updateChildrenRotation3d("rotationX",g)},setRotationZ:function(O){this._updateChildrenRotation3d("rotationZ",O)},setRotation3d:function(){var i=this;if(!i._updatingToChildren){var W=i.r3();If.superClass.setRotation3d.apply(i,arguments);var C=i.r3();Lj||i._updatingFromChildren||(i._updatingToChildren=1,i.eachChild(function(X){mq(X)&&X.syncRotation3d(i,C,W)}),delete i._updatingToChildren)}},_updateChildrenRotation3d:function(o,C){var l=this;if(!l._updatingToChildren){var _=l[Ql(o)]();If.superClass[fc(o)].call(l,C),Lj||l._updatingFromChildren||this._updateRotationToChildren(o,C-_)}},_updateRotationToChildren:function(w,b){var V=this;V._updatingToChildren=1,V.eachChild(function(Z){mq(Z)&&Z._11Q(V,w,b)}),delete V._updatingToChildren},setScale:function(O,I){var Q=this;if(!Q._updatingToChildren){null==I&&(I=O.y,O=O.x);var u=Q.getScale();if(a(O)<.01&&(O=.01*(Wd(O)||Wd(u.x))),a(I)<.01&&(I=.01*(Wd(I)||Wd(u.y))),If.superClass.setScale.call(Q,O,I),!Lj&&!Q._updatingFromChildren){Q._updatingToChildren=1;var c=O/u.x,V=I/u.y;Q._adjustChildScaleOrSize(c,V,"scale"),delete Q._updatingToChildren,Q._scaleChanged=1,Q.updateFromChildren(),delete Q._scaleChanged}}},onPropertyChanged:function(u){If.superClass.onPropertyChanged.call(this,u),"s:3d.visible"===u.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(t){(t.s("batch")||t.s("wf.geometry")||t.s("wf.visible"))&&t.iv(),t instanceof If&&t._invalidateChildrenBatch()})},getSerializableProperties:function(){var h=If.superClass.getSerializableProperties.call(this);return h.clickThroughEnabled=1,h.syncSize=1,h}});var nq=H.Grid=function(){Hm(H.Grid,this)};Ce("Grid",jh,{IRotatable:!1,_icon:"grid_icon",_image:f,getUIClass:function(){return Ec},setRotation:function(){},getCellRect:function(x,A){var Q=this,R=Q.s("grid.row.count"),u=Q.s("grid.column.count");if(0>=R||0>=u||0>x||x>=R||0>A||A>=u)return f;var e,O,W,l=Q.getRect(),h=Q.s("grid.row.percents"),F=Q.s("grid.column.percents");if(xs(l,Q,"grid.border",-1),h&&h._as&&(h=h._as),F&&F._as&&(F=F._as),h&&h.length===R){for(W=0,e=0;x>e;e++)W+=l.height*h[e];l.y+=W,l.height=l.height*h[x]}else l.height=l.height/R,l.y+=l.height*x;if(F&&F.length===u){for(O=0,e=0;A>e;e++)O+=l.width*F[e];l.x+=O,l.width=l.width*F[A]}else l.width=l.width/u,l.x+=l.width*A;return Qd(l,-Q.s("grid.gap")),l}});var ns=H.Text=function(){Hm(ns,this),this.setSize(100,50),this.s("text","TEXT")};Ce("Text",jh,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return $l},setWidth:function(G){G||(G=.001),ns.superClass.setWidth.call(this,G)},setHeight:function(y){y||(y=.001),ns.superClass.setHeight.call(this,y)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),eo("__text__",{width:{value:100,isSafeFunc:!0,func:function(q){return q?q._width:100}},height:{value:50,isSafeFunc:!0,func:function(V){return V?V._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradient:{func:"style@text.gradient"},gradientColor:{func:"style@text.gradient.color"},gradientPack:{func:"style@text.gradient.pack"},decoration:{func:"style@text.decoration"},vertical:{func:"style@text.vertical"},verticalGap:{func:"style@text.vertical.gap"},wrap:{func:"style@text.wrap"},letterGap:{func:"style@text.letter.gap"},borderWidth:{func:"style@text.border.width"},borderColor:{func:"style@text.border.color"}}]});var vg=H.Shape=function(){Hm(vg,this),this._59O=new zp};vg.__de__=Zn,Ce("Shape",jh,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return ls},_22Q:function(){return mt},getLength:function(M){return Gn(Hc(this._59O,this._58O,M,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var r=this._58O;return r?new zp(r._as.slice(0)):r},setSegments:function(I){var f=this._58O;I=I?br(I)?new zp(I.slice(0)):new zp(I._as.slice(0)):null,(f&&I&&f._as.join(",")!==I._as.join(",")||f!==I)&&(this._58O=I,this.fp("segments",f,I))},getPoints:function(){return this._59O},toPoints:function(){var F=this._59O;return new zp(F._as.slice(0))},getPointsMatrix2d:function(){var Q=this,L=new xc.Matrix2d,j=Q.getPosition(),W=Q.getScale(),v=Q.getRotation();return L.translate(-j.x,-j.y).scale(W.x,W.y).rotate(v).translate(j.x,j.y),L},getPointsMatrix3d:function(){return function(){var v=this,F=new xc.Matrix4,P=F.getElements(),I=v.p3();tf(P,I),qe(P,v.getFinalRotation3d(),v.getRotationMode());var c=v.getScale3d(),C=v._dynamicScale3d;return C&&(c[0]*=C[0],c[1]*=C[1],c[2]*=C[2]),Hr(P,c),tf(P,eh(I)),F}}(),setPoints:function(B,l){var S=this,A=S._59O;B=B?br(B)?new zp(B.slice(0)):new zp(B._as.slice(0)):new zp;var k,J,i,G,h,y;l&&(k=S.getPosition(),y=new ph(S.getRotation(),0,0,S.getScale().x,S.getScale().y)),(A&&B&&A._as.join(",")!==B._as.join(",")||A!==B)&&(S._59O=B,S.fs(),S.fp("points",A,B)),l&&(J=S.getPosition(),i=J.x-k.x,G=J.y-k.y,h=y.tf(i,G),S.setPosition(J.x-i+h.x,J.y-G+h.y))},setPoints3d:function(q,z){var c=new np(this.p3()),J=this.getPointsMatrix3d();if(J.setPosition(new np),Ab.superClass.setPoints.call(this,q),z){var R=new np(this.p3()),F=R.clone().sub(c).applyMatrix4(J);c.add(F),this.p3(c.x,c.y,c.z)}},addPoint:function(q,a,k){var j=this.toPoints();j.add(q,a),this.setPoints(j,k)},setPoint:function(a,K,W){var Q=this.toPoints();Q.set(a,K),this.setPoints(Q,W)},removePointAt:function(C){var T=this.toPoints();T.removeAt(C),this.setPoints(T)},setWidthForce:function(c){var d=this;if(!d._55I&&!Lj&&d.getWidth()){d._55I=1;var L=d._position.x,P=c/d.getWidth(),y=d.toPoints(),H=new zp;1!==P&&(y.each(function(N){H.add({x:(N.x-L)*P+L,y:N.y,e:N.e})}),d.setPoints(H),Rj(d,[P,0,0,1,L*(1-P),0]),d.fs()),delete d._55I}vg.superClass.setWidth.call(d,c)},setWidth:function(t){return this.setWidthForce(_m>t?_m:t)},setHeightForce:function(g){var n=this;if(!n._55I&&!Lj&&n.getHeight()){n._55I=1;var I=n._position.y,h=g/n.getHeight(),q=n.toPoints(),V=new zp;1!==h&&(q.each(function(u){V.add({x:u.x,y:(u.y-I)*h+I,e:u.e})}),n.setPoints(V),Rj(n,[1,0,0,h,0,I*(1-h)]),n.fs()),delete n._55I}vg.superClass.setHeight.call(n,g)},setHeight:function(b){return this.setHeightForce(_m>b?_m:b)},setAnchorElevation:function(l){var A=this;A._55I=!0;var b=A._updatingAnchor3d,n=!Lj&&!b;if(n){var L,h=l,I=A.getAnchorElevation(),E=A.getTall();L=E*(I-h),0!==L&&A.shiftPointsElevation(L)}var f=vg.superClass.setAnchorElevation.apply(A,arguments);return b||delete A._55I,f},getShapeElevation:function(){var J=this,Y=J._54O;return Y-(J.getTall()||0)*(J._anchorElevation-.5)},setAnchor3d:function(Q,z,G,D){var Y,A=this;if("number"==typeof Q?Y={x:Q,y:z,z:G}:(Y=Q.length?{x:Q[0],y:Q[1],z:Q[2]}:Q,D=z),A._55I=!0,A._updatingAnchor3d=!0,A.beginTransaction(),!Lj){var f=A.getAnchor3d(),U=A.getSize(),I=A.getTall(),p=U.width*(f.x-Y.x),c=U.height*(f.z-Y.z),w=I*(f.y-Y.y);D||A.shiftPoints(p,c,w);var e=A.p3()}var a=vg.superClass.setAnchor3d.apply(A,arguments);if(!Lj&&D){var x=A.p3();A.shiftPoints(x[0]-e[0]+p,x[2]-e[2]+c,x[1]-e[1]+w)}return A.endTransaction(),delete A._updatingAnchor3d,delete A._55I,a},setAnchor:function(J,e,A){var n=this;n._55I=!0;var $=n._updatingAnchor3d,L=!Lj&&!$;if(L){var k,p,D;"number"==typeof J?D={x:J,y:e}:(D=J.length?{x:J[0],y:J[1]}:J,A=e);var I=n.getAnchor(),g=n.getSize();k=g.width*(I.x-D.x),p=g.height*(I.y-D.y),A||n.shiftPoints(k,p);var Y=n.getPosition()}var _=vg.superClass.setAnchor.apply(n,arguments);if(L){var v=n.getPosition();A&&n.shiftPoints(v.x-Y.x+k,v.y-Y.y+p)}return $||delete n._55I,_},shiftPoints:function(L,B,S){if(L||B||S){var m=this,O=m.getElevation()||0,V=m.toPoints(),_=new zp;V.each(function(x){var P=x.e;S&&(P=(P==f?O:P)+S),_.add({x:x.x+L,y:x.y+B,e:P})}),m.setPoints(_),m.fs()}},shiftPointsElevation:function(l){return this.shiftPoints(0,0,l)},setPosition:function(L,g){var P,l=this;if(!l._28Q){if(l._28Q=1,!l._55I&&!Lj){P=2===arguments.length?{x:L,y:g}:L;var w=P.x-l._position.x,Z=P.y-l._position.y;if(0===w&&0===Z)return delete l._28Q,void 0;l._55I=1,l.shiftPoints(w,Z),Rj(l,[1,0,0,1,w,Z]),delete l._55I}vg.superClass.setPosition.apply(l,arguments),delete l._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var n=this;if(2!==n._59O.size())return!1;var o=n._58O;return o?2===o.size()&&1===o.get(0)&&2===o.get(1)?!0:!1:!0},fireShapeChange:function(){var n=this;if(!n._55I&&!Lj){var Q=Db(n._59O);Q&&(n._55I=1,n.setRect(Q),delete n._55I)}n.fp(pc,!1,!0)},getSerializableProperties:function(){var B=vg.superClass.getSerializableProperties.call(this);return B.segments=1,B.points=1,B.thickness=1,B.closePath=1,B}});var bh=H.Points=function(){Hm(bh,this)};Ce("Points",jh,{_59O:[],_colors:[],_sizes:[],_uvoffsets:[],_22Q:function(){return nt},getPoints:function(){return this._59O},setPoints:function(j){var X=this._59O;j=j?j.slice(0):[];var m=j[0];if($c(m)){var O=j;j=[];for(var Q=0,d=O.length;d>Q;Q+=3)j.push({x:O[Q],e:O[Q+1],y:O[Q+2]})}this._59O=j,this._pointsDirty=!0,this.fp("points",X,this._59O)},setPoint:function(_,p){var L=this._59O.slice(0);L[_]=p,this.setPoints(L)},addPoint:function(h){this.setPoint(this._59O.length,h)},getColors:function(){return this._colors},setColors:function(m){var $=this._colors;m=m?m.slice(0):[],this._colors=m,this._colorsDirty=!0,this.fp("colors",$,m)},setPointColor:function(b,Z){var E=this._colors.slice(0);E[b]=Z,this.setColors(E)},getSizes:function(){return this._sizes},setSizes:function(m){var c=this._sizes;m=m?m.slice(0):[],this._sizes=m,this._sizesDirty=!0,this.fp("sizes",c,this._sizes)},setPointSize:function($,Z){var k=this._sizes.slice(0);k[$]=Z,this.setSizes(k)},getUvoffsets:function(){return this._uvoffsets},setUvoffsets:function(V){var q=this._uvoffsets;V=V?V.slice(0):[],this._uvoffsets=V,this._offsetsDirty=!0,this.fp("uvoffsets",q,this._uvoffsets)},setPointUvoffset:function(I,G,P){var N;"object"==typeof G?(N=G[0],P=G[1]):N=G;var L=this._uvoffsets.slice(0);L[2*I+0]=N,L[2*I+1]=P,this.setUvoffsets(L)},getPointInfo:function(A){var Q=this.getPoints();if(!Q||Q[A]==f)return f;var j=Q[A],L=[j.x,j.e,j.y],x=this.mat||ec(this),s=[L[0],L[1],L[2]];Vh(s,x);var D=this.getColors(),u=D[A]||this.s("points.color"),q=this.getSizes(),r=q[A];return{size:r==f?this.s("points.size"):r,color:u,local:L,world:s}},getSerializableProperties:function(){var R=bh.superClass.getSerializableProperties.call(this);return R.points=1,R.colors=1,R.sizes=1,R.uvoffsets=1,R},onPropertyChanged:function(E){bh.superClass.onPropertyChanged.call(this,E);var H=E.property;"s:points.color"===H?this._colorsDirty=!0:"s:points.size"===H?this._sizesDirty=!0:"s:points.model"===H&&(this._modelDirty=!0)},getWidth:function(){var J=this;if(J._width>=0)return J._width;var c=J.getStyle("points.model");if(c){var S=Cb(c);if(S&&S.rawS3)return S.rawS3[0]}return 1},getHeight:function(){var X=this;if(X._height>=0)return X._height;var o=X.getStyle("points.model");if(o){var d=Cb(o);if(d&&d.rawS3)return d.rawS3[2]}return 1},getTall:function(){var J=this;if(J._tall>=0)return J._tall;var U=J.getStyle("points.model");if(U){var Q=Cb(U);if(Q&&Q.rawS3)return Q.rawS3[1]}return 1}});var Ab=H.Polyline=function(){Hm(Ab,this),this.s({"shape.background":null,"shape.border.width":2})};Ce("Polyline",vg,{_icon:"polyline_icon",_22Q:function(){return qt},getUIClass:function(){return tm},setClosePath:function(){},setTall:function(Y){var V=this;if(V.beginTransaction(),!V._55I&&!V._24Q&&!Lj&&V.getTall()){V._24Q=1;var C=V._54O,D=Y/V.getTall();if(1!==D){var d=V.toPoints(),Q=new zp;d.each(function(n){Q.add({x:n.x,y:n.y,e:n.e==f?n.e:(n.e-C)*D+C})}),V.setPoints(Q),V.fs()}delete V._24Q}Ab.superClass.setTall.call(V,Y),V.endTransaction()},setElevation:function(y){var $=this;if($.beginTransaction(),!$._55I&&!$._24Q&&!Lj){$._24Q=1;var j=y-$._54O;0!==j&&$.shiftPointsElevation(j),delete $._24Q}Ab.superClass.setElevation.apply($,arguments),$.endTransaction()},fireShapeChange:function(){var B=this,$=B._59O;if(!B._55I&&!B._24Q&&!Lj){var F=$.size();if(F){var D=1,W=$.get(0),S=B._54O;W.e==f&&(W.e=S);for(var t=W.e,d=0;F>D;D++){W=$.get(D),W.e==f&&(W.e=S);var l=h(t,W.e),X=p(t+d,W.e);t=l,d=X-l}B._24Q=1,B.setTall(d),B.setElevation(t+d*B._anchorElevation),delete B._24Q}}Ab.superClass.fireShapeChange.apply(B,arguments)}});var zn=H.SubGraph=function(){Hm(zn,this)};Ce("SubGraph",jh,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){zn.superClass._8I.call(this),this.eachChild(function(c){mq(c)&&c._8I()})}}),L.loadingRefGraph=0;var Wb=H.RefGraph=function(){Hm(Wb,this)};Ce("RefGraph",If,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(r){var T=this._ref;this._ref=r,this.fp("ref",T,r),this.updateRef()},_21I:function(){Wb.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var F=this;if(L.loadingRefGraph++,F.clearChildrenFromDataModel(),L.loadingRefGraph--,F._ref&&F._dataModel){F._xhrLoadHandler&&(F._xhrLoadHandler.cancel=!0);var h=Lj,w=F._xhrLoadHandler=function(Z){if(Z&&F._dataModel){L.loadingRefGraph++;var D=F._pendingUpdateInfo={needToRestore:h};h&&(D.p3=F.p3(),D.s3=F.s3(),D.r3=F.r3(),D.anchor3d=F.getAnchor3d(),D.scale3d=F.getScale3d()),F.r3(0,0,0),F.setScale3d(1,1,1),F.setAnchor3d(.5,.5,.5),F.p3(0,0,0);var n=L.parse(Z),g=F._dataModel.deserialize(n,F,{justDatas:!0});g.each(function(n){n._refGraph=F}),F.checkPendingUpdateInfo(),L.loadingRefGraph--,L.handleRefGraphLoaded(F,g,n)}};w.xhrLoadCalled=!1,L.load(F._ref,function(V){w.cancel||(w.xhrLoadCalled?w(V):Un(function(){w(V)}))}),w.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var p=this,X=p._pendingUpdateInfo;if(!X)return p.onPendingUpdated&&(L.loadingRefGraph++,p.onPendingUpdated(),L.loadingRefGraph--),void 0;var r=!0;this.eachChild(function(y){(y._pendingCheckImageJSON||y._pendingUpdateInfo)&&(r=!1)}),r&&(L.loadingRefGraph++,p._pendingUpdateInfo=null,p.updateFromChildren(),X.needToRestore&&(p.setAnchor3d(X.anchor3d),p.setScale3d(X.scale3d),p.r3(X.r3),p.p3(X.p3)),this.getParent()instanceof Wb&&this.getParent().checkPendingUpdateInfo(),p.onPendingUpdated&&p.onPendingUpdated(),L.loadingRefGraph--)},getSerializableProperties:function(){var I=Wb.superClass.getSerializableProperties.call(this);return I.ref=1,I}}),H.EdgeGroup=function(T,J){this._70O=T,this._siblings=J;for(var R,s,b=0,G=T.size(),t=W[Ne];G>b;b++)if(R=T.get(b).getStyle(Ne,!1),R!=f){t=R;break}t==f&&(t=!0);var u=L.edgeGroupAgentFunc;for(u&&(s=u(T),s&&s!==T.get(0)&&(T.remove(s),T.add(s,0))),b=0;G>b;b++)T.get(b).s(Ne,t)},Ce("EdgeGroup",b,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(u){return this._70O.get(u)},indexOf:function(n){return this._70O.indexOf(n)},each:function(k,r){this._70O.each(k,r)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(D,l){this._siblings.each(function(i){i._70O.each(D,l)})}});var rr=function(U,F,N){var w=zg[U]={type:U,action:F};if(N)for(var x in N)w[x]=N[x]};Hi(L,{setConnectAction:rr,getConnectAction:function(v,l){if(!l){if(!v)return null;l=v.getCurrentConnectActionType()}return zg[l]},doConnectAction:function(x,r,Q,S){S=S||x.getCurrentConnectActionType();var Y=zg[S];if(!Y)return!1;var m=Y.action;return m?(r instanceof al.Group?x.sm().getSelection().each(function(o){m.call(null,x,o,Q)}):m.call(null,x,r,Q),!0):!1},doDeleteConnectionAction:function(Z,Q,s){s=s||Z.getCurrentConnectActionType();var c=zg[s];if(!c||!c.delete)return!1;var g=c.delete.action;return g?(Q instanceof al.Group?Z.sm().getSelection().each(function(_){g.call(null,Z,_)}):g.call(null,Z,Q),!0):!1}});var Aj=H.JSONSerializer=function(K,A){this.dm=this._dataModel=K,this._hierarchical=L.forceHierarchicalSerialization?!0:A==f?K.isHierarchicalRendering():A};Ce("JSONSerializer",b,{ms_ac:["hierarchical"],serialize:function(Y){return L.stringify(this.toJSON(),Y)},toJSON:function(){var X,Y=this,R=Y.dm,m=R.getRoots(),j=Y.json={v:L.getVersion(),p:{},a:{},d:[]},M=R.getSerializableAttrs();(X=R.getInit())&&(j.init=X),(X=R.getName())&&(j.p.name=X),(X=R.getBackground())&&(j.p.background=X),(X=R.getLayers())&&(j.p.layers=X),(X=R.getEnvmap())&&(j.p.envmap=X),(X=R.getEnvmapType())&&(j.p.envmapType=X),j.p.autoAdjustIndex=R.isAutoAdjustIndex(),j.p.hierarchicalRendering=R.isHierarchicalRendering();for(var r in M){var e=R.a(r);e!==E&&Y[Io](r,e,j.a)}return cc(j.a)&&delete j.a,Y._hierarchical?m.each(Y.serializeData,this):R.each(function(Q){Y.serializeData(Q)}),R.fireSerializeEvent({type:"serialize",json:j}),R.getPostProcessingData()&&(j.p.postProcessingData=R.getPostProcessingData()),j},isSerializable:function(){return!0},getProperties:function(b){return b.getSerializableProperties()},getStyles:function(E){return E.getSerializableStyles()},getAttrs:function(u){return u.getSerializableAttrs()},serializeData:function(K){var R=this;if(R.isSerializable(K)&&!K._refGraph){var a,C,M,L,X,$,l=jk(K.getClassName())||K.getClass(),r=new l,T={c:K.getClassName(),i:K.getId(),p:{},s:{},a:{}};R.json.d.push(T),a=R.getProperties(K);for(C in a)if(/^_/.test(C)){if(M=K[C],!("_width"!==C&&"_height"!==C||M!=f&&-1!==M)){if(X==E){var Y;$=(K.s("layout.h")||K.s("layout.v"))&&K.getHost()||K instanceof H.Node&&(Y=K.getParent())&&Y instanceof H.Block||K.s("fullscreen"),X=K.hasInheritedSize()}$&&X&&(M=K[C]="_width"===C?K.getWidth():K.getHeight())}M!==r[C]&&R[Io](C.substr(1),M,T.p)}else L=Ql(C),K[L]&&(M=K[L](),M!==r[L]()&&R[Io](C,M,T.p));a=R.getStyles(K);for(C in a)M=K.s(C),M!==r.s(C)&&R[Io](C,M,T.s);a=R.getAttrs(K);for(C in a)M=K.a(C),M!==r.a(C)&&R[Io](C,M,T.a);cc(T.p)&&delete T.p,cc(T.s)&&delete T.s,cc(T.a)&&delete T.a}R._hierarchical&&K.getChildren().each(R.serializeData,R)},serializeValue:function(y,D,Y){Zc(D)?D={__a:D._as}:D instanceof rd?D={__i:D.getId()}:D instanceof Wo&&(D={__dm:D.serialize(0)}),Y[y]=D},deserialize:function(z,U,i){var r=this;return Vn(z)&&/.json$/.test(z)?(L.xhrLoad(z,function(u){r.deserializeImpl(u,U,i)}),void 0):r.deserializeImpl(z,U,i)},deserializeImpl:function(X,D,d){var m=this,R=m.dm;R.setDeserializing(!0),d=dk(d)?{setId:d}:fi(d)?{finishFunc:d}:d||{},X=m.json=Vn(X)?L.parse(X):X,!d.justDatas&&X.a&&X.a.onPreDeserialize&&!d.disableOnPreDeserialize&&X.a.onPreDeserialize(X,R,d.view),R.beginTransaction(),Lj++,m._82I={};var v=new zp,O=new zp,g=0,J=X.d.length;if(d.justDatas||(!d.disableInit&&fi(X.init)&&X.init(R),R.setInit(X.init)),!d.justDatas){for(var k in X.a)R.a(k,m[oj](X.a[k]));for(var U in X.p)R[fc(U)](X.p[U])}for(;J>g;g++){var w=X.d[g],N=jk(w.c),r=new N,A=w.i;d.setId&&A!=f&&(r._id=A),m._82I[A]=r,v.add(r),O.add(w)}for(g=0;J>g;g++)m.deserializeData(v.get(g),O.get(g));return v.each(function(j){D&&!j.getParent()&&j.setParent(D),R.add(j)}),d.__innerHandler__&&d.__innerHandler__(X,R,d.view,v),R.fireSerializeEvent({type:"deserialize",json:X}),Lj--,R.endTransaction(),!d.justDatas&&X.a&&X.a.onPostDeserialize&&!d.disableOnPostDeserialize&&X.a.onPostDeserialize(X,R,d.view,v),d.finishFunc&&d.finishFunc(X,R,d.view,v),R.setDeserializing(!1),v},deserializeData:function(k,U){for(var g in U.p)k[fc(g)](this[oj](U.p[g]));for(g in U.s)k.s(g,this[oj](U.s[g]));for(g in U.a)k.a(g,this[oj](U.a[g]))},deserializeValue:function(j){if(Mr(j)){var Z=j.__i;if(Z!=f)return this._82I[Z];if(Z=j.__dm,Z!=f){var W=new H.DataModel;return W.deserialize(Z),W}if(Z=j.__a,br(Z))return new zp(Z)}return j}}),Hi(Wo,{serialize:function(f,B){return new Aj(this,B).serialize(f)},toJSON:function(p){return new Aj(this,p).toJSON()},deserialize:function(W,I,o){return new Aj(this).deserialize(W,I,o)}});var rb=H.OverlappingBox=function(X){this.gv=X,this.boxes={}};Ce("OverlappingBox",b,{clear:function(){var l,F,H=this.boxes;for(l in H)F=H[l],F.length=0},isOverlapping:function(z,J){var K,o,F=this,B=F.boxes,V=B[z];V?(K=V.rects,o=V.length):V=B[z]={rects:K=[],length:o=0};var n,a,J;for(n=0;o>n;n++)if(a=K[n],a.x<J.x+J.w&&a.x+a.w>J.x&&a.y<J.y+J.h&&a.h+a.y>J.y)return!0;return K.length<=o?(K.push(J),V.length++):K[V.length++]=J,!1}}),Hi(L,{fetch:function(Q,h){var K="GET",y=!1,R=null,z="";h&&(K=h.method||"GET",y=h.sync,z=h.url,R=h.data||null),Q.open(K,z,!y),h.responseType?Q.responseType=h.responseType:h.overrideMimeType&&Q.overrideMimeType&&Q.overrideMimeType(h.overrideMimeType),Q.send(R)},convertImageSrc:function(G,s){s&&"function"==typeof s||(s=function(){}),s(G)}});var yk=H.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Ce("Request",b,{_responseType:null,_overrideMimeType:"text/plain",send:function(H){var l=this._xhr,A=this.onload,M=this.onerror;this.getResponseType()?H.responseType=this.getResponseType():this.getOverrideMimeType()&&(H.overrideMimeType=this.getOverrideMimeType()),l.onload=A,l.onerror=M,L.fetch(l,H)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(i){this._responseType=i},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(n){this._overrideMimeType=n},getResponseText:function(){var A=this._xhr;return A.response||A.responseText}}),Gc.GraphView=function(p){var E=this;E._24I={},E._34I=new zp,E.enableDirtyRect(),E._25I={},E._56I={},E._view=Cg(1,E),E._canvas=Vq(E._view),E.dm(p?p:new Wo),this._coreInteractor=new fp(this),E.setEditable(!1),E.setScrollBarVisible(L.graphViewScrollBarVisible),E._initView()},Sc("GraphView",b,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Bf,We,Co,Sh,"resettable","editInteractor",Cd,"zoomable","pannable","rectSelectable","autoScrollZone",hp,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:L.graphViewZoomable,_resettable:L.graphViewResettable,_pannable:L.graphViewPannable,_rectSelectable:L.graphViewRectSelectable,_autoScrollZone:L.graphViewAutoScrollZone,_rectSelectBackground:L.graphViewRectSelectBackground,_rectSelectBorderColor:L.graphViewRectSelectBorderColor,_editPointSize:L.graphViewEditPointSize,_editPointBorderColor:L.graphViewEditPointBorderColor,_editPointBackground:L.graphViewEditPointBackground,_scrollBarColor:gn,_scrollBarSize:qm,_autoHideScrollBar:Pp,_autoMakeVisible:Po,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(P){this._dataModel.setLayers(P)},setEditable:function(A){var e=this,X=e.__interactorMap__;if(!X){var j=Gc.XEditInteractor;X=e.__interactorMap__={scrollBar:new Vk(e),select:new wp(e),edit:j?new j(e):new ed(e),text:new hc(e),move:new yn(e),"default":new Rh(e),touch:new bf(e,{editable:!1})}}A?(e._uieditable=!0,e.setInteractors([X.scrollBar,X.select,X.edit,X.text,X.move,X.default,X.touch])):(e._uieditable=!1,e.setInteractors([X.scrollBar,X.select,X.move,X.default,X.touch]))},getCanvas:function(){return this._canvas},_33I:function(C){var h=C.getUIClass();return h?new h(this,C):f},getDataUI:function(_){var w=this,U=w._25I[_._id];return U===E&&(U=w._33I(_),w._25I[_._id]=U),U},getNodeRect:function(e){return L.getNodeRect(this,e)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(Z){var B=this.getDataUI(Z);return B?(B._79o(),B._78o):null},getEdgeSourcePosition:function(V){var N=this,y=N.getDataUI(V),G=y.s,A=y._data._40I;return $q(N,A,G("edge.source.position"),G("edge.source.offset.x"),G("edge.source.offset.y"),G("edge.source.anchor.x"),G("edge.source.anchor.y"))},getEdgeTargetPosition:function(K){var M=this,B=M.getDataUI(K),S=B.s,O=B._data._41I;return $q(M,O,S("edge.target.position"),S("edge.target.offset.x"),S("edge.target.offset.y"),S("edge.target.anchor.x"),S("edge.target.anchor.y"))},invalidateAll:function(P){var D=this;if(P){for(var u in D._25I){var b=D._25I[u];b&&b.dispose()}D._25I={},D._56I={},D._24I={},D._34I.clear(),D.redraw()}else D.dm().each(function(E){D.invalidateData(E)})},invalidateSelection:function(){var a=this;a.sm().each(function(t){a.invalidateData(t)})},invalidateData:function(T){var f=this;f._24I[T._id]=T,f._21Q(T),f.iv()},_21Q:function(w){var W=this,b=W._24I;if(Op(w)&&sd[w.s(uo)]){var t=w.getSourceAgent();t&&t.getAgentEdges().each(function(j){b[j._id]=j}),t=w.getTargetAgent(),t&&t.getAgentEdges().each(function(M){b[M._id]=M}),W.iv()}},redraw:function(A){var Y=this;Y._32I||(A?Y._34I.add(A):(Y._32I=1,Y._34I.clear()),Y.iv())},each:function(I,$){var g,Z,L,N=0,c=this.getLayers(),u=this._dataModel,U=u._datas._as,x=U.length;if(c){var y,s={};u.isHierarchicalRendering()&&u.eachByHierarchical(function(r){L=r._layer,y=s[L],y||(y=s[L]=[]),y.push(r)});for(var B=c.length;B>N;N++)if(L=c[N],Mr(L)&&(L=L.name),u.isHierarchicalRendering()){y=s[L];var M,g,r;if(y&&(M=y.length)>0)for(var X=0;M>X;X++)if(g=y[X],r=$?I.call($,g):I(g),r===!1)return}else for(var X=0;x>X;X++)if(g=U[X],g._layer===L&&(Z=$?I.call($,g):I(g),Z===!1))return}else if(u.isHierarchicalRendering())this._dataModel.eachByHierarchical(I,null,$);else for(;x>N;N++)if(g=U[N],Z=$?I.call($,g):I(g),Z===!1)return},reverseEach:function(S,N){var K,E,o,A,R=this._dataModel,k=R._layers,j=R._datas._as,Q=j.length;if(k){var U,h={};for(R.isHierarchicalRendering()&&R.reverseEachByHierarchical(function(k){A=k._layer,U=h[A],U||(U=h[A]=[]),U.push(k)}),K=k.length-1;K>=0;K--)if(A=k[K],Mr(A)&&(A=A.name),R.isHierarchicalRendering()){U=h[A];var H,E,s;if(U&&(H=U.length)>0)for(var P=0;H>P;P++)if(E=U[P],s=N?S.call(N,E):S(E),s===!1)return}else for(var P=Q-1;P>=0;P--)if(E=j[P],E._layer===A&&(o=N?S.call(N,E):S(E),o===!1))return}else if(R.isHierarchicalRendering())R.reverseEachByHierarchical(S,null,N);
else for(K=Q-1;K>=0;K--)if(E=j[K],o=N?S.call(N,E):S(E),o===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var x=this,t=x._84I;if(!t){var i=this.dm().a("width"),u=this.dm().a("height");i>0&&u>0?x._84I={x:0,y:0,width:i,height:u}:(x.each(function(m){x.isVisible(m)&&(t=Ie(t,x.getDataUIBounds(m)))}),x._84I=t?t:hq)}return x._84I},getScrollRect:function(){return Ie(this.getContentRect(),this._29I)},makeCenter:function(F,C,f){var s=this;if(!s.getWidth()||!s.getHeight())return f||Un(s.makeCenter,s,[F,C,!0],500),void 0;s.makeVisible(F),s.validate();var S=s.getDataUIBounds(F);if(S){var y=s.getWidth(),G=s.getHeight(),v=S.x+S.width/2,w=S.y+S.height/2,N=-v*s._zoom+y/2,Z=-w*s._zoom+G/2;s.setTranslate(N,Z,C)}},fitData:function(t,V,X,I,N){var M=this;if(!M.getWidth()||!M.getHeight())return N||Un(M.fitData,M,[t,V,X,I,!0],500),void 0;var W=function(){M.makeVisible(t),M.validate();var s=M.getDataUIBounds(t);s&&(s=ys(s),Qd(s,X==f?20:X),M.fitRect(s,V,I))};V?L.callWhenLoaded(W):W()},fitContent:function(q,H,J,y){var w=this;if(!w.getWidth()||!w.getHeight())return y||Un(w.fitContent,w,[q,H,J,!0],500),void 0;var c=function(){w.validate();var d=ys(w.getContentRect());Qd(d,H==f?20:H),w.fitRect(d,q,J)};q?L.callWhenLoaded(c):c()},fitRect:function(W,r,v){var O=this,U=O.getWidth(),c=O.getHeight(),S=W.x+W.width/2,x=W.y+W.height/2,C=h(U/W.width,c/W.height),y=O._zoom,p=-S*y+U/2,t=-x*y+c/2;0===C||isNaN(C)||(v&&(C=h(1,C)),r?(O._65I&&(delete O._65I.finishFunc,O._65I.stop(!0)),O._14o&&O._14o.stop(!0),O.setTranslate(p,t,{finishFunc:function(){O.setZoom(C,r)}})):(O.setTranslate(p,t),O.setZoom(C)))},fitSelection:function(g,o,i){var J=this,Q=J.sm(),Z=null;Q.size()&&(Q.each(function(O){Z=Ie(J.getDataUIBounds(O),Z)}),g&&Qd(Z,g),J.fitRect(Z,o,i))},toCanvas:function(c,g,u){g=g||this._zoom,this.validateImpl();var o=this,f=o.getContentRect();u&&Qd(f,u),f.width||(f.width=10),f.height||(f.height=10);var M=Vq(),$=f.x*g,O=f.y*g,E=Math.ceil(f.width*g),S=Math.ceil(f.height*g);Zq(M,E,S,1);var s=Xn(M);c=c||this._dataModel.getBackground(),c&&Nj(s,0,0,E,S,c),rn(s,-$,-O),s.scale(g,g);var t=this._zoom;return this._zoom=g,o._42(s),this._zoom=t,s.restore(),M},toDataURL:function(x,U,Z,K){return this.toCanvas(x,Z,K).toDataURL(U||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(a,h){var O=this,U=O.dm().getBackground();if(U){var i=O.dm().a("width"),g=O.dm().a("height");i>0&&g>0&&Nj(a,0,0,i,g,U)}var o=O.__htmlOrderList,D=[],R=O._forcedLayoutHTML;if(O._93db(a,h),O.each(function(w){var U=O.getDataUI(w);if(U){var J=O._56I[w._id],v=U._htmlView;if(J){var o=U._79o();if(v=U._htmlView,H.HtmlNode&&w instanceof H.HtmlNode)U._42(a);else{var B=O.getViewRect(),y=v&&v.layoutHTML;!h||Mg(h,o)?(y&&(v.layoutHTML(),U.__outerLayout&&delete U.__outerLayout),U._42(a)):Mg(B,o)||!y||U.__outerLayout&&!R||(v.layoutHTML(),U.__outerLayout=!0)}}v&&(D.push(v),v.getView&&(v=v.getView()),v.style.display=J?"block":ae)}}),o&&D.length>0){var Z=!1;if(o.length!==D.length)Z=!0;else for(var v=0;v<D.length;v++)if(D[v]!==o[v]){Z=!0;break}Z&&(D.forEach(function(E){E.autoAdjustIndex!==!1&&O.appendHTML(E,!0)}),this.__htmlOrderList=D)}else this.__htmlOrderList=D;O._92db(a,h)},disableDirtyRect:function(){this._shouldRedrawAll=X},enableDirtyRect:function(){var o=this;o._shouldRedrawAll=function(){return o._32I}},validateImpl:function(){this.tryUpdateRootData();var k,P,h,K,X,m=this,Q=m.tx(),F=m.ty(),Y=m._zoom,x=m._canvas,y=this.getWidth(),t=this.getHeight(),J=m._29I,r={x:-Q/Y,y:-F/Y,width:y/Y,height:t/Y},G={},T=m._34I,i=m._24I,n=m._shouldRedrawAll(),D=m._23I;m._24I={},(y!==x.clientWidth||t!==x.clientHeight)&&(Zq(x,y,t),n=1,m._forcedLayoutHTML=1),n||nk(r,J)||(n=1,m._forcedLayoutHTML=1),m._29I=r,m.each(function(r){P=r._id;var J=G[P]=m.isVisible(r);J!==m._56I[P]&&(i[P]=r,h=m.getDataUI(i[P]),h&&h._84o(J),m._84o(r,J))},m);for(P in i)h=m.getDataUI(i[P]),h&&(!n&&m._56I[P]&&(X=h._79o(),X&&T.add(X)),h.invalidate()),m._83I=1;if(m._56I=G,!n)for(P in i)G[P]&&(h=m.getDataUI(i[P]),h&&(X=h._79o(),X&&T.add(X)));if(n?K=r:(T.each(function(d){Mg(r,d)&&(K=Ie(K,d))}),K&&(Qd(K,p(1,1/Y)),K.x=j(K.x*Y)/Y,K.y=j(K.y*Y)/Y,K.width=q(K.width*Y)/Y,K.height=q(K.height*Y)/Y,K=sj(r,K))),m._74O=K,K&&0!==K.width&&0!==K.height){k=Xn(x);var Z=K.x,u=K.y,L=K.width,E=K.height;Z=Math.floor((Z*Y+Q)*od),u=Math.floor((u*Y+F)*od),L=Math.ceil(L*Y*od)+1,E=Math.ceil(E*Y*od)+1,n||(K.x=(Z/od-Q)/Y,K.y=(u/od-F)/Y,K.width=L/od/Y,K.height=E/od/Y),k.beginPath(),k.rect(Z,u,L,E),k.clip(),k.clearRect(Z,u,L,E),ji(k,Q,F,Y),m._42(k,K),k.restore(),delete m._74O}if(T.clear(),delete m._32I,delete m._forcedLayoutHTML,D&&y>0&&t>0){var h=m.getDataUI(D);if(h){var X=h._79o(),c=m._29I,w=c.x,O=c.y,l=c.width,e=c.height,Y=m._zoom;X&&!Mg(X,c)&&(X.x+X.width<w&&m.tx(-X.x*Y),X.x>w+l&&m.tx(-(X.x+X.width-l)*Y),X.y+X.height<O&&m.ty(-X.y*Y),X.y>O+e&&m.ty(-(X.y+X.height-e)*Y))}delete m._23I}m._83I&&(delete m._83I,delete m._84I),m._98O(),m.countFrame(),cc(m._24I)||Un(m.iv,m)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var $,b=this.getFullscreenDatas();for(var V in b)$=b[V],this.scaleRootData($);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(u){var D=u.s("fullscreen");if("uniform"===D||"fill"===D){u.getRotation()&&u.setRotation(0);var M=u.s("fullscreen.gap")||0,k=this.getWidth(),w=this.getHeight();if(k&&w){var F,$,J,O=k-2*M,n=w-2*M,A=u.getAnchor(),l=u.getScaledSize(),E=l.width,m=l.height,U=u.s("fullscreen.lock");if(U)return"uniform"===D?O/n>E/m?(F=n/m,E=m*O/n):(F=O/E,m=E*n/O):"v"===U?(F=n/m,E=O/F,u.getWidth()!==E&&u.setWidth(E)):(F=O/E,m=n/F,u.getHeight()!==m&&u.setHeight(m)),this.setZoom(F),$=M-(u.getX()-A.x*E)*F,J=M-(u.getY()-A.y*m)*F,$!==this.tx()&&this.tx($),J!==this.ty()&&this.ty(J),void 0;$=this.tx(),J=this.ty(),F=this._zoom;var V={x:(-$+M)/F,y:(-J+M)/F,width:O/F,height:n/F};if("uniform"===D){var f=E/m,x=Math.min(V.width,V.height*f),r=x/f;V.x+=.5*(V.width-x),V.y+=.5*(V.height-r),V.width=x,V.height=r}O=V.width/u.getScaleX(),n=V.height/u.getScaleY(),(u.getWidth()!=O||u.getHeight()!==n)&&u.setSize(O,n);var K=V.x+A.x*V.width,P=V.y+A.y*V.height,v=u.getPosition();(K!==v.x||P!==v.y)&&u.setPosition(K,P)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(L){var R=this;L!==R.isScrollBarVisible()&&(L?(Zg(R._view,R._79O=Rq()),Zg(R._79O,R._27I=Rq()),Zg(R._79O,R._28I=Rq())):(bn(R._79O),delete R._79O,delete R._27I,delete R._28I),R.fp("scrollBarVisible",!L,L))},getDebugTip:function(){return""},showScrollBar:function(){var I=this;I._79O&&(I._85I||(On(function(){I._86I()},jq),I.iv()),I._85I=new Date)},_86I:function(){var G=this;if(G._85I){var t=new Date,D=t.getTime();D-G._85I.getTime()>=jq?(delete G._85I,G.iv()):On(function(){G._86I()},jq)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var L=this,G=this._27I,Z=this._28I;if(L._79O){if(L._autoHideScrollBar&&!L._85I)return G.style.visibility=jc,Z.style.visibility=jc,void 0;var R=L.getScrollBarColor(),t=L._zoom,$=L.getScrollBarSize(),U=L.getViewRect(),f=L.getScrollRect(),a=U.height*t,o=f.height*t,d=U.width*t-$-2,j=a*((U.y-f.y)*t/o),u=a*(a/o),c=G.style;o-.5>a?(pn>u&&(j=j+u/2-pn/2,0>j&&(j=0),j+pn>a&&(j=a-pn),u=pn),kq(G,d,j,$,u),c.visibility=Xh,c.background=R,c.borderRadius=$/2+qf):c.visibility=jc;var l=U.width*t,k=f.width*t,j=U.height*t-$-2,d=l*((U.x-f.x)*t/k),q=l*(l/k),c=Z.style;k-.5>l?(pn>q&&(d=d+q/2-pn/2,0>d&&(d=0),d+pn>l&&(d=l-pn),q=pn),kq(Z,d,j,q,$),c.visibility=Xh,c.background=R,c.borderRadius=$/2+qf):c.visibility=jc}},setDataModel:function(N){var n=this,S=n._dataModel,k=n._selectionModel;S!==N&&(S&&(S.ump(n.handleDataModelPropertyChange,n),S.umm(n.handleDataModelChange,n),S.umd(n.handleDataPropertyChange,n),S.removeIndexChangeListener(n._75O,n),S.removeHierarchyChangeListener(n.handleHierarchyChange,n),k||S.sm().ums(n.handleSelectionChange,n)),n._dataModel=N,N.mp(n.handleDataModelPropertyChange,n),N.mm(n.handleDataModelChange,n),N.md(n.handleDataPropertyChange,n),N.addIndexChangeListener(n._75O,n),N.addHierarchyChangeListener(n.handleHierarchyChange,n),k?k._21I(N):N.sm().ms(n.handleSelectionChange,n),n.invalidateAll(!0),n.fp(Yk,S,N),n.updateBackground())},getLayersInfo:function(){if(this._layersInfo===E){var j=this.getLayers();j?(this._layersInfo={},j.forEach(function(t){var T=Mr(t)?t.name:t;this._layersInfo[T]=t},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(n,y,Q){var Z,I,T,m,g=this;n instanceof H.Data?(m=g.getDataUI(n),T=ks(m)):(T=ks(null,arguments[0],arguments[1]),y=arguments[2],Q=arguments[3]),2===y.length&&(y=new pb(y[0],y[1]));var w=wm(y,function($){return Sq(T,100*$)},100,.001),e=Sq(T,100*w);if(!Q){var _=m?xe(m):xe(arguments[0],arguments[1]),D=new pb(e.x,e.y),o=49/(g._zoom*g._zoom);for(Z=0,I=_.length;I>Z;Z++)if(D.distanceToSquared(_[Z])<o)return{index:Z,point:_[Z],distance:Math.sqrt((_[Z].x-y.x)*(_[Z].x-y.x)+(_[Z].y-y.y)*(_[Z].y-y.y))}}return{percent:w,point:e,distance:Math.sqrt((e.x-y.x)*(e.x-y.x)+(e.y-y.y)*(e.y-y.y))}},getPercentPositionOfPath:function($,q){var r;if($ instanceof H.Data){var b=this.getDataUI($);r=ks(b)}else r=ks(null,arguments[0],arguments[1]),q=arguments[2];return Sq(r,q)},getNeareastPositionOfPath:function(){return this.calculateEdgePosition.apply(this,arguments)},getPointsOfPath:function(){function $(h,E,i,y,m,S){var $=new pb(E.get(i)),G=S.apply($);h.push({local:$,world:G,type:m,index:i,realIndex:y})}return function(U){var Q,b;if(U instanceof H.Data){var i=this.getDataUI(U),j=jn(i);Q=j.points,b=j.segments}else Q=arguments[0],b=arguments[1];var G,C,k,J=U instanceof H.Shape?U.getPointsMatrix2d():new xc.Matrix2d,L=[],W=-1,n=-1;for(C=0,k=b?b.length:Q.length;k>C;C++)G=b?b.get(C):1,5!==G&&(n++,3===G?($(L,Q,W+1,n,"C",J),$(L,Q,W+2,n,"M",J),W+=2):4===G?($(L,Q,W+1,n-1,"R",J),$(L,Q,W+2,n,"L",J),$(L,Q,W+3,n,"M",J),W+=3):($(L,Q,W+1,n,"M",J),W+=1));return L}}(),calculateAttachPoint:function(){var y=new pb,n=new pb,u=new pb;return function(x,c){var h=this.getAttachPoints(x);if(!h||!h.length)return null;u.set(c.x,c.y);for(var M,H,z,U,X,p=1/0,Q=0,j=h.length;j>Q;Q++)z=h[Q],n.x=z.x,n.y=z.y,y.x=z.offsetX||0,y.y=z.offsetY||0,U=$q(this,x,0,y.x,y.y,n.x,n.y),H=u.distanceToSquared(U),p>H&&(M=Q,p=H,X=U);p=Math.sqrt(p);var b=this.getAttachStyle(x);if("close"===b){var L=x.s("attach.close.threshold")/this._zoom;if(p>L)return null}return{index:M,distance:p,info:h[M],point:X}}}(),getAttachPoints:function(T){var W=T.s("attach.points");if(W)return W;var A=mr(T._image);return A?kh(A.attachPoints,T,this)||null:void 0},getAttachStyle:function(V){var c=V.s("attach.style");if(c)return c;var $=mr(V._image);return $?kh($.attachStyle,V,this)||"close":void 0},updateLayers:function(){this._layersInfo=E,this.invalidateSelection(),this.redraw()},updateBackground:function(){var o=this.dm().a("width"),O=this.dm().a("height");this._canvas.style.background=o>0&&O>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(M){if("background"===M.property){var a=this._canvas.style.background,i=M.newValue||"";this.updateBackground(),this.fp("canvasBackground",a,i),this.redraw()}else"a:width"===M.property||"a:height"===M.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===M.property?this.updateLayers():"hierarchicalRendering"===M.property&&this.redraw()},handleDataPropertyChange:function(v){this.dm().isHierarchicalRendering()&&"parent"===v.property&&v.data.hasChildren()&&this.redraw(),this.invalidateData(v.data)},onPropertyChanged:function(M){var k=this,f=M.property;if(k.redraw(),"zoom"===f){var i=k.sm().getSelection();i.size()&&i.each(function(Q){Q.invalidate()})}else"dataModel"===f&&(k._83I=1);Bi[f]?k.showScrollBar():f===Cd&&k.onCurrentSubGraphChanged(M)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(z){var C=this,K=z.kind,g=z.data;if(C._83I=1,"add"===K)C.invalidateData(g),Op(g)&&g.getEdgeGroup()&&g.getEdgeGroup().eachSiblingEdge(C.invalidateData,C),g.getHost&&g.getHost()&&g.getHost().updateLayoutAttaches();else if(K===xk){C._21Q(g);var d=g._id,y=C._25I[d];if(y){if(C._56I[d]){var Z=y._79o();Z&&C.redraw(Z)}y.dispose(),delete C._25I[d],delete C._24I[d],delete C._56I[d]}g===C._currentSubGraph&&C.setCurrentSubGraph(f)}else K===$n&&(C.invalidateAll(!0),C.setCurrentSubGraph(f))},_75O:function(M){this.invalidateData(M.data)},handleHierarchyChange:function(L){this.dm().isHierarchicalRendering()&&L.data.hasChildren()&&this.redraw(),this.invalidateData(L.data)},adjustIndex:function(n){var h=this;if(h.isVisible(n)){h.dm().beginTransaction();for(var T=n;T._parent&&h.isVisible(T._parent);)T=T._parent;T&&T!==n&&h._dataModel.adjustIndex(T),h._dataModel.adjustIndex(n),h.dm().endTransaction()}},getImage:function(T){return T.getImage?T.getImage():E},getSelectWidth:function(j){var Z=mr(this.getImage(j));return Z&&kh(Z.disableSelectedBorder,j,this)?0:j.s("select.width")},getSelectColor:function(q){return q.s("select.color")},isSelectable:function(T,Z){if(this.isSelected(T))return!0;if(!Z&&T.getParent()instanceof If&&this.isSelectable(T.getParent(),!0)&&T.getParent().isSyncSize())return!1;var o=this.getLayersInfo();if(o){var A=o[T._layer];if(A&&A.selectable===!1)return!1}return T.s("2d.selectable")&&this.sm().isSelectable(T)},isMovable:function(C){var z=this;if(Op(C)&&C.getStyle(uo)!==we)return!1;var B=this.getLayersInfo();if(B){var x=B[C._layer];if(x&&x.movable===!1)return!1}return C.s("2d.movable")?z._movableFunc?z._movableFunc(C):!0:!1},isEditable:function(Y){var S=this;if(H._uiSerializing)return S._uieditable;if(!S._editInteractor||!S.isSelected(Y))return!1;if(Zd(Y)){var N=S.getDataUI(Y);if(!N||N._88I)return!1}if(Op(Y)&&Y.getStyle(uo)!==we)return!1;var O=this.getLayersInfo();if(O){var i=O[Y._layer];if(i&&i.editable===!1)return!1}return Y.s("2d.editable")?S._editableFunc?S._editableFunc(Y):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(q){return mq(q)&&0!==q.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(q):!0},isRectEditable:function(I){return this._rectEditableFunc?this._rectEditableFunc(I):!0},isAnchorEditable:function(f){return this._anchorEditableFunc?this._anchorEditableFunc(f):!0},isRotationEditable:function(z){return z.setRotation&&z.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(z):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(H){var B=H.getAnchor(),y=H.getScale(),Q=this._zoom,X=Cf(H.getRotation(),0,-H.getHeight()*y.y*B.y-(y.y<0?-1:1)*(dn?32:16)/Q),r=H.p();return X.x+=r.x,X.y+=r.y,X},getLogicalPoint:function(F){var n=this;return Gm(F,n._canvas,n.tx(),n.ty(),n._zoom,n._zoom)},getScreenPoint:function(D,l){var t,b=this;return"object"==typeof D?D.x!==E?(t=D.x,l=D.y):(t=D[0],l=D[1]):t=D,tn(t,l,b._canvas,b.tx(),b.ty(),b._zoom,b._zoom)},getSelectedDataAt:function(v){var I=this;return this.getDataAt(v,function(O){return I.isSelected(O)})},getDataInfoAt:function(F,z,B){var C,o=this.lp(F),u=this.getDataAt(o,z,B);if(u){var I=this.getDataUI(u);C={data:u,ui:I,point:o};var Q=I._38o;if(Q){var X=Q.icons;for(var G in X){var V=X[G],p=Q.rects[G];if(p)for(var w=kh(V.names,u,this),y=w?w.length:0,D=p.rotation,m=y-1;m>=0;m--){var K=w[m],l=p[m];if(Sj(l,o,D))return C.part="icons",C.name=G,C.icon=K,C.rect=l,C.index=m,C.rotation=D,C}}}if(this.isNoteVisible(u)){if(I.note2Info&&Sj(I.note2Info.clickRect,o,f,I.note2Info.scale))return C.part="note2",C;if(I.noteInfo&&Sj(I.noteInfo.clickRect,o,f,I.noteInfo.scale))return C.part="note",C}if(this.isLabelVisible(u)){if(I.label2Info&&Sj(I.label2Info.rect,o,I.label2Info.rotation,I.label2Info.scale))return C.part="label2",C;if(I.labelInfo&&Sj(I.labelInfo.rect,o,I.labelInfo.rotation,I.labelInfo.scale))return C.part="label",C}if(u.isInRect&&u.isInRect(o))return C.part="body",C}return C},getDataAt:function(q,P,I){q.target&&(q=this.lp(q));var N,n=this._zoom;return this.reverseEach(function(D){return(P?P(D):this.isSelectable(D))&&this.rectIntersects(D,Yh(q.x,q.y,I,n))?(N=D,!1):void 0},this),N},getIconInfoAt:function(C,F){var J=this;if(C.target&&(C=J.lp(C)),F||(F=J.getDataAt(C)),F){var q=J.getDataUI(F);if(q&&q._38o){var l,m=q._38o,u=new zp;for(l in m.icons)u.add(l);for(var o=u.size()-1;o>=0;o--){l=u.get(o);for(var Y=m.rects[l],i=Y.rotation,I=Y.length-1;I>=0;I--){var $=Y[I],p=$.width,j=$.height,A={x:C.x-$.x-p/2,y:C.y-$.y-j/2};i!=f&&(A=Cf(-i,A.x,A.y));var $={x:-p/2,y:-j/2,width:p,height:j};if(Sj($,A))return{key:l,index:I,name:m.icons[l].names[I],rect:Y[I],point:C,rotation:i,relativeRect:$,relativePoint:A,data:F}}}}}return f},getDatasInRect:function(V,Q,Y){Y===E&&(Y=1);var v=this,$=new zp;return v.reverseEach(function(M){Y&&!v.isSelectable(M)||(Q?v.rectIntersects(M,V):v.rectContains(M,V))&&$.add(M)}),$},moveSelection:function(q,X){var h=this;h.dm().beginTransaction(),Lp(h.sm().toSelection(h.isMovable,h),q,X),h.dm().endTransaction()},moveDatas:function(J,L,c){var R=this;R.dm().beginTransaction(),J instanceof zp||(J=new zp(J)),Lp(J,L,c),R.dm().endTransaction()},getDataUIBounds:function(F){var k=this.getDataUI(F);return k?k._79o():f},drawData:function(N,n,w){var p=this.getDataUI(n);if(p){var _=p._79o();(!w||Mg(w,_))&&(p._42(N),n instanceof H.Block&&n.eachChild(function(i){this.isVisible(i)&&this.drawData(N,i,w)},this))}},getBoundsForGroup:function(w){return w.s(mf)?this.getDataUIBounds(w):f},isPixelPerfect:function(j){return j.s("pixelPerfect")},rectIntersects:function(C,X){this.validate();var M=f;if(this._56I[C._id]){var N=this._25I[C._id];if(N){var B=N._79o();if(tr(X,B))M=!0;else if((X=sj(X,B))&&(N.rectIntersects&&(M=N.rectIntersects(X)),M==f)){if(!this.isPixelPerfect(C))return!0;var I=X.x,F=X.y,K=X.width,n=X.height,b=this._zoom,A=L.hitMaxArea,G=K*n*b*b;if(G>A){var o=Math.sqrt(A/G);b*=o}K*=b,n*=b,2>K&&(K=2),2>n&&(n=2),I*=b,F*=b;var c=Mn(K,n);rn(c,-I,-F),c.scale(b,b),this._drawForChecking=!0,this.drawData(c,C,X),this._drawForChecking=!1;try{for(var y=0,r=c.getImageData(0,0,K,n).data;y<r.length;y+=4)if(0!==r[y+3]){M=!0;break}c.restore()}catch(x){gr=f,M=!1}}}}return M?!0:!1},rectContains:function(H,S){if(this._56I[H._id]){var L=this._25I[H._id];if(L)return tr(S,L._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(V){if(!L.isInput(V.target)){var N=this,q=N._focusData,F=q&&N._25I[q._id],y=0,z=N._dataModel._datas;if(!(q&&q._enabled&&q._editable&&F&&F.onKeyDown&&F.onKeyDown(V)===!0))if(9===V.keyCode&&(q&&(y=z.indexOf(q),An(V)?-1===--y&&(y=0):++y===z.size()&&(y=0)),N._focusData=q=z.get(y),N.sm().setSelection(q)),Qq(V)?N.selectAll():Xc(V)&&N.isResettable()&&N.reset(),N.sm().isEmpty()){if(N._editing)return;var u=N.tx(),S=N.ty(),c=!1,d=An()?100:10;Ff(V)&&(u-=d,c=!0),Tf(V)&&(S-=d,c=!0),Te(V)&&(u+=d,c=!0),rl(V)&&(S+=d,c=!0),c&&N.setTranslate(u,S)}else{xh(V)&&N.handleDelete(V);var X=An()?10:1;Ff(V)&&(N.moveSelection(-X,0),N.fi({kind:"moveLeft"})),Tf(V)&&(N.moveSelection(0,-X),N.fi({kind:"moveUp"})),Te(V)&&(N.moveSelection(X,0),N.fi({kind:"moveRight"})),rl(V)&&(N.moveSelection(0,X),N.fi({kind:"moveDown"}))}}},handleScroll:function(h,t){if(Lk(h),this.isZoomable()){if(!this.getEditInteractor()){var y=this.getDataAt(h);if(y){var k=mr(this.getImage(y));if(k&&kh(k.scrollable,y,this))return}}var W=this.getFullscreenDatas();for(var w in W)if(W[w].s("fullscreen.lock"))return;var f=this.lp(h);t>0?this.scrollZoomIn(f):0>t&&this.scrollZoomOut(f)}},handlePinch:function(T,n,t){this.isZoomable()&&(Math.abs(n-t)<L.pinchZoomThreshold||(n>t?this.pinchZoomIn(T):this.pinchZoomOut(T)))},checkDoubleClickOnNote:function(h,Z){var l=this,I=l.lp(h),w=l.getDataUI(Z),c=w.note2Info;return c&&Z.s("note2.toggleable")&&Sj(c.clickRect,I)?(Z.s(pe,!Z.s(pe)),l.fi({kind:"toggleNote2",event:h,data:Z}),!0):(c=w.noteInfo,c&&Z.s("note.toggleable")&&Sj(c.clickRect,I)?(Z.s(lb,!Z.s(lb)),l.fi({kind:"toggleNote",event:h,data:Z}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(a,$){var r=this,Q=r.getAutoScrollZone(),G=Q/r.getZoom(),d=Q/4,U=r._29I,j=r.lp(a),E={x:r.tx(),y:r.ty()};return j&&Q>0&&U&&(j.x-U.x<G?r.translate(d,0):U.x+U.width-j.x<G&&r.translate(-d,0),j.y-U.y<G?r.translate(0,d):U.y+U.height-j.y<G&&r.translate(0,-d)),E.x=r.tx()-E.x,E.y=r.ty()-E.y,$&&($.x+=E.x,$.y+=E.y),E},getMoveMode:function(r,L){var p=L.s("2d.move.mode");return p?p:Go["88"]?"x":Go["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(K,P,a){var Z=this;return"currentSubGraph"===P?{__i:K.getId()}:a.serializeProperty(K,P,Z)},deserializeProperty:function(k,g,P){var U=this;if("currentSubGraph"===g){var r=U.dm(),a=r.__idMap;return a[k.__i]}return P.deserializeProperty(k,g,U)},setDefaultCursor:function(D,n){this._defaultCursor=D,n!==!1&&this.setCursor(D)},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(z){return z===f||L.getConnectAction(null,z)?(this._currentActionType=z,this.redraw(),!0):!1},getEditStyle:function(p){var b=this.getEditInteractor();return b?b.getStyle(p):E},setEditStyle:function(q,M,s){var N=this.getEditInteractor();return N?(N.setStyle(q,M,s),!0):!1},isConnectActionVisible:function(u){var k=L.getConnectAction(this);if(!k)return!1;var l=k.visible;return fi(l)&&(l=l(this,u)),l},isInteractive:function(W){if(this._drawForChecking)return!1;var K=mr(this.getImage(W));return K&&kh(K.interactive,W,this)?!0:W.s("interactive")},getRenderingStyleIconName:function(){return Bm},appendHTML:function($,x){var z=this.getView();if(!(x||$&&$.parentNode!==z))return!1;var s=$.getView&&$.getView(),d=$.beforeCanvas;if(!x&&s&&s.parentNode===z)return!1;($.getView||$.isSelfViewEvent)&&($=$.getView());var w=this.getEditInteractor();return d?z.insertBefore($,this.getCanvas()):w&&w._canvas?z.insertBefore($,w._canvas):this.isScrollBarVisible()?z.insertBefore($,this.getView().lastChild):Zg(z,$),!0},_layoutHTMLImpl:function(U,p,l){if(arguments.length>1){var W,f=this,w=f._zoom;if(p.getView&&(W=p,p=p.getView()),p.style.position="absolute",l){var u=U.getRect();kq(W||p,f.tx()+u.x*w,f.ty()+u.y*w,u.width*w,u.height*w)}else{var z=new Uo,u=U.getAnchorRect(),K=U.getPosition(),C=U.getScale(),d=p.style;kq(W||p,u),z.appendTranslate(f.tx(),f.ty()),z.appendScale(w,w),z.append(new Uo(U.getRotation(),K.x,K.y,C.x,C.y)),no(d,"transform","matrix("+z.a.toFixed(5)+", "+z.b.toFixed(5)+", "+z.c.toFixed(5)+",\n    "+z.d.toFixed(5)+", "+z.tx.toFixed(5)+", "+z.ty.toFixed(5)+")"),no(d,"transformOrigin",(-u.x).toFixed(5)+"px "+(-u.y).toFixed(5)+"px"),p.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(h){return h instanceof ns?{name:"text",accessType:"s",font:h.s("text.font"),isMultiline:!0}:void 0},getState:function(T){var f="state",r=T.s(f);if(r)return r;var G=mr(T._image);return G?kh(G[f],T,this)||null:void 0},getShape:function(e){return e.getStyle(pc)}}),b.defineProperties(Gc.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(A){this._layoutHTML=A}}});var Rp=function(d,H){var J=this;J.gv=d,J.s=function(J){return H.getStyle(J)},J._data=H,J._87I=new zp},Bm=f;kl(Rp,b,{_6I:f,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var R=this,S=R.gv.isSelected(R._data);return!S||R.isShadowed()?0:R.gv.getSelectWidth(R._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(j){var O=this._data,U=this.gv.getBodyColor(O);return U?U:j?O.getStyle(j):f},_2Q:function(k){return this.s(k)},_1Q:function(a,$,R,y){var Z=this.s,M=Z("2d.gray"),Q=Z($+".dash.color");if(M&&(Q=L.toGrayColor(Q)),a.strokeStyle=Q,a.lineWidth=R,a.stroke(),Z($+".dash.3d")){var q=Z($+".dash.3d.color");El(a,Q,M?L.toGrayColor(q):q,R,this.gv._zoom,Z($+".dash.3d.accuracy"))}Kh(a,y)},invalidate:function(){this._6I=f},_79o:function(){var r=this;if(!r._6I){var H=r._data,L=r.gv;r.labelInfo=r.label2Info=r.noteInfo=r.note2Info=r._38o=f,r._87I.clear(),r.interactiveInfo=L.isInteractive(H)?{}:f,r._3O(),r._55O=L.isEditable(H)?{_42O:L.isRectEditable(H),_43O:L.isPointEditable(H),_56O:L.isRotationEditable(H)}:f,r._6I=r._81o()}return r._6I},_3O:function(){},getPosition:function(){return hq},_68o:function(C,p){C&&this._87I.add(dp(C,p))},_81o:function(){var P=this,q=P.s;P._24O(oc,"getLabel"),P._24O(jr,"getLabel2"),P._26O(Ap,"getNote"),P._26O(uj,"getNote2"),P._15O(),P._55O&&P._48O();var z;if(P._87I.each(function(M){z=Ie(z,M)}),z&&q("shadow.interactable")){var V=P.isShadowed(),y=q("shadow2"),_=ys(z);y?(_.x+=q("shadow2.offset.x"),_.y+=q("shadow2.offset.y"),Qd(_,q("shadow2.blur"))):V&&(_.x+=q("shadow.offset.x"),_.y+=q("shadow.offset.y"),Qd(_,q("shadow.blur"))),z=Ie(z,_)}return P._87I.clear(),z},_42:function(u){var e=this,k=e._data,N=e.gv,p=e.s,r=p("opacity"),h=this.isShadowed(),y=p("shadow2");if(h||y){var $=u.shadowOffsetX,c=u.shadowOffsetY,_=u.shadowBlur,m=u.shadowColor,q=N.getZoom()*L.devicePixelRatio,o=h?"shadow":"shadow2";u.shadowOffsetX=p(o+".offset.x")*q,u.shadowOffsetY=p(o+".offset.y")*q,u.shadowBlur=p(o+".blur")*q,u.shadowColor=h?e.getSelectColor():p(o+".color")}if(r!=f){var s=u.globalAlpha;u.globalAlpha=r}e._80o(u),N.isLabelVisible(k)&&((!N._drawForChecking||p("label.selectable"))&&mi(u,e.labelInfo),(!N._drawForChecking||p("label2.selectable"))&&mi(u,e.label2Info)),N.isNoteVisible(k)&&(fo(u,e.noteInfo),fo(u,e.note2Info)),e._99O(u),r!=f&&(u.globalAlpha=s),(h||y)&&(u.shadowOffsetX=$,u.shadowOffsetY=c,u.shadowBlur=_,u.shadowColor=m)},_80o:function(){},_47O:function(){},_24O:function(z,G){var R=this,N=R._data,w=R.gv,d=R.s,$=w[G](N);if($!=f){var Z=d(z+".scale"),W=d(z+".max"),c=d(z+".position"),o=R[z+"Info"]={label:$,scale:Z,color:w[G+"Color"](N),font:d(z+".font"),opacity:d(z+".opacity"),align:d(z+".align"),decoration:d(z+".decoration"),rotation:R.getRotation(d(z+".rotation"),!1,c),background:w[G+"Background"](N)},_=je(o,$);W>0&&W<_.width&&(o.labelWidth=_.width,_.width=W),1!==Z&&(_.width*=Z,_.height*=Z);var E=R.getPosition(c,d(z+".offset.x"),d(z+".offset.y"),_,d(z+".position.fixed"));if(_.x=E.x-_.width/2,_.y=E.y-_.height/2,R._68o(o.rect=_,o.rotation),1!==Z){var F=_.width/Z,H=_.height/Z;o.rect={x:E.x-F/2,y:E.y-H/2,width:F,height:H}}}},_26O:function(w,H){var $=this,E=$.gv,M=$._data,m=$.s,S=E[H](M);if(S!=f){var r,v,V=m(w+".scale"),Y=$[w+"Info"]={note:S,scale:V,data:M,view:E,expanded:m(w+".expanded"),font:m(w+".font"),color:m(w+".color"),opacity:m(w+".opacity"),align:m(w+".align"),icon:m(w+".icon"),backgroundImage:m(w+".backgroundImage"),borderWidth:m(w+".border.width"),borderColor:m(w+".border.color"),background:E[H+"Background"](M)},T=$.getPosition(m(w+".position"),m(w+".offset.x"),m(w+".offset.y")),W=T.x,F=T.y;if(Y.expanded){var g,e=m(w+".max"),l=m(w+".backgroundImage");l?(l=mr(l),g={width:Bb(l,M),height:qh(l,M)}):g=je(Y,S),g.width+=6,g.height+=2,e>0&&e<g.width&&(Y.labelWidth=g.width,g.width=e),r=g.width,v=g.height+8,Y.clickRect={x:W-r*V/2,y:F-v*V,width:r*V,height:v*V*g.height/v}}else{var p=m(w+".icon");p?(p=mr(p),r=Bb(p,M),v=qh(p,M)):(r=12,v=18),Y.clickRect={x:W-r*V/2,y:F-v*V,width:r*V,height:v*V}}Y.rect={x:W-r/2,y:F-v*V/2-v/2,width:r,height:v};var y=q(Y.borderWidth/2)*V;$._68o({x:W-r*V/2-y,y:F-v*V-y,width:r*V+2*y,height:v*V+2*y})}},_48O:function(){},_99O:function(U){var H=this,i=H._38o;if(i){var R=H.gv,z=H._data,E=i.icons,p=H.interactiveInfo;p&&(p._38o={});for(var B in E){var l=E[B],c=i.rects[B];if(c){p&&(p._38o[B]=[]);var d=kh(l.opacity,z,R),k=kh(l.names,z,R),x=k?k.length:0,g=c.rotation;if(d!=f){var O=U.globalAlpha;U.globalAlpha*=d}for(var M=0;x>M;M++){var j=k[M],w=mr(j),C=c[M];if(g){var P=C.x+C.width/2,N=C.y+C.height/2;U.save(),rn(U,P,N),bo(U,g),rn(U,-P,-N)}p&&p._38o[B].push(U.interactiveInfo={compInfos:[],matrix:g?new Uo(g,P,N).appendTranslate(-P,-N):new Uo});var t=Bm;Bm=B,Tc(U,w,kh(l.stretch,z,R),C.x,C.y,C.width,C.height,H._data,H.gv),Bm=t,U.interactiveInfo=f,g&&U.restore()}d!=f&&(U.globalAlpha=O)}}}}});var Ep=function(z,e){Hm(Ep,this,[z,e])};kl(Ep,Rp,{_checkEmptyRect:!0,_40O:function(x,E){var y=this,B=y.s,o=x.rect;(x.borderColor=y.gv.getBorderColor(y._data))&&(x.borderType=B("border.type"),x.borderWidth=B("border.width"),x.borderPadding=B("border.padding"),E=p(E,x.borderPadding+x.borderWidth/2));var M=y._data.getScale(),i=p(1,p(a(M.x),a(M.y)));if(x.selectWidth=y.getSelectWidth()){var k=y.gv._zoom;x.selectType=B("select.type"),x._97o=y.getSelectColor(),x.selectPadding=B("select.padding"),E=p(E,(x.selectPadding+x.selectWidth/2/k)/i)}E>0&&(E*=i,o=ys(o),Qd(o,E)),y._68o(o)},_39O:function(U,X){var V,S=this,l=X.rect;if(X.borderWidth>0&&(V=X.borderPadding,U.strokeStyle=X.borderColor,U.lineWidth=X.borderWidth,Dg(U,X.borderType,{x:l.x-V,y:l.y-V,width:l.width+2*V,height:l.height+2*V}),U.stroke()),X.selectWidth>0){var I=S.gv._zoom;if(V=X.selectPadding,U.strokeStyle=X._97o,U.lineWidth=X.selectWidth/I,X.rotation!=f){U.save(),U.translate(X.position.x,X.position.y),U.rotate(X.rotation);var m=S._data,J=m.getWidth(),K=m.getHeight(),o=X.scale,B=X.anchor;l={x:o.x*-J*B.x,y:o.y*-K*B.y,width:o.x*J,height:o.y*K}}Dg(U,X.selectType,{x:l.x-V,y:l.y-V,width:l.width+2*V,height:l.height+2*V}),X.rotation!=f&&U.restore(),U.stroke()}},dispose:function(){var T=this,m=T._htmlView;Ep.superClass.dispose.call(T),m&&(m.onHTMLRemoved&&m.onHTMLRemoved(),bn(m))},_3O:function(){var v,j=this,y=j.s,Z=j._data,X=j.gv,C=X.getShape(Z),b=j.getBodyColor(),I=y("shape.border.color"),K=j._83o=C?{shape:C,_53o:j.getBodyColor("shape.background"),_27Q:mr(y("shape.repeat.image"),b),shapeGradientPack:y("shape.gradient.pack"),shapeBorderGradientPack:y("shape.border.gradient.pack"),_54o:y("shape.border.width"),_55o:I,shapeBorderRepeatImage:mr(y("shape.border.repeat.image"),I),_56o:y("shape.border.3d"),_57o:y("shape.border.3d.color"),_58o:y("shape.border.3d.accuracy"),shapeGradient:y("shape.gradient"),_59o:y("shape.gradient.color"),_60o:y("shape.border.pattern"),_61o:y("shape.border.cap"),_62o:y("shape.border.join"),shapeForeground:y("shape.foreground"),bodyColor:b,gray:y("2d.gray")}:{img:mr(X.getImage(Z),b),bodyColor:b,gray:y("2d.gray"),stretch:y("image.stretch")},V=K.img;V&&V.renderHTML?(j._htmlInfo&&j._htmlInfo.img!==V&&(j._htmlInfo=f),j._htmlInfo||(j._htmlInfo={img:V,cache:{}}),v=V.renderHTML(Z,X,j._htmlInfo.cache)):j._htmlInfo=f,j._htmlView&&j._htmlView!==v&&(j._htmlView.onHTMLRemoved&&j._htmlView.onHTMLRemoved(),bn(j._htmlView.getView?j._htmlView.getView():j._htmlView)),(j._htmlView=v)&&X.appendHTML(v)&&(v.onHTMLAddedSync&&v.onHTMLAddedSync(),v.onHTMLAdded&&Un(v.onHTMLAdded)),K.rect=Z.getRect(),K.position=Z.p(),K.scale=Z.getScale(),K.anchor=Z.getAnchor(),K.rotation=Z.getRotation(),C===Bj&&(K._63o=y("shape.depth"));var t=0;if(C)t=en(f,K._54o/2,K._62o),j.s("shape.dash")&&(t=p(t,(j.s("shape.dash.width")||K._54o)/2));else if(V&&V.boundExtend)if(t=kh(V.boundExtend,Z,X),V.boundExtendAbsolute){var r=Z.getScale();t/=X._zoom*p(1,p(a(r.x),a(r.y)))}else if(!kh(V.fitSize,Z,X)){var A=kh(V.width,Z,X),B=kh(V.height,Z,X);t*=p(Z.getWidth()/A,Z.getHeight()/B)}j._40O(K,t);var Y=y("clip.percentage");if(Y!=E&&(K.clipRect=jg(Z.getAnchorRect(),y("clip.direction"),Y)),C){var D=y("shape.fill.clip.percentage");D!=E&&(K.shapeClipRect=jg(Z.getAnchorRect(),y("shape.fill.clip.direction"),D));var R=y("shape.foreground.clip.percentage");R!=E&&(K.shapeForegroundClipRect=jg(Z.getAnchorRect(),y("shape.foreground.clip.direction"),R))
}},getPosition:function(s,E,V,k){var t=Nb(s,this._83o.rect,k);return t.x+=E,t.y+=V,t},_80o:function(d){var m=this,p=m.s,R=m.gv,c=m._data,l=m._83o,b=l.rect,K=l.position,x=l.rotation,s=l.anchor,r=l.scale,U=l.shape,j=l.clipRect;if(!m._checkEmptyRect||b.width>0&&b.height>0){var M=c.getSize();if(M.x=-M.width*s.x,M.y=-M.height*s.y,vj&&!ol&&rn(d,M.width,M.height),d.save(),rn(d,K.x,K.y),bo(d,x),wj(d,r.x,r.y),j&&(d.beginPath(),d.rect(j.x,j.y,j.width,j.height),d.clip()),R._drawForChecking&&l.img&&kh(l.img.pixelPerfect,c,R)===!1)Nj(d,M.x,M.y,M.width,M.height,"#888888");else if(m.freeDraw)m.freeDraw(d,M,l);else if(U){var z,E,V,a,J=l._60o,v=ko(d,J),t=l._27Q,Z=l._54o,$=l.shapeGradientPack,X=l.gray,h=d.lineJoin,S=d.lineCap,D=function(y){return X?L.toGrayColor(y):y};"roundRect"===U?z=p("shape.corner.radius"):"polygon"===U?(z=p("shape.polygon.side"),E=p("shape.corner.radius"),V=p("shape.regular")):"arc"===U&&(z=p("shape.arc.from"),E=p("shape.arc.to"),V=p("shape.arc.close"),a=p("shape.arc.oval")),d.lineJoin=l._62o,d.lineCap=l._61o;var y=D(l._53o);if(y||t||$){var A=l.shapeClipRect;A&&(d.save(),d.beginPath(),d.rect(A.x,A.y,A.width,A.height),d.clip()),Dg(d,U,M,z,E,V,a),$?Lf(d,$,function(P){return Fm(P,l.bodyColor)},!1,M):t?mn(d,t,D(l.bodyColor),null,c,R):Le(d,y,l.shapeGradient,D(l._59o),M),d.fill(),$&&d.restore(),A&&d.restore(),d!==v&&Dg(v,U,M,z,E,V,a)}else Dg(v,U,M,z,E,V,a);var I=l.shapeForeground;if(I){d.save();var Q=l.shapeForegroundClipRect;Q&&(d.beginPath(),d.rect(Q.x,Q.y,Q.width,Q.height),d.clip()),Dg(d,U,M,z,E,V,a),Le(d,I,p("shape.foreground.gradient"),D(p("shape.foreground.gradient.color")),M),d.fill(),d.restore()}if(Z>0){var F=p("shape.border.width.absolute");F&&(d.save(),d.setTransform(1,0,0,1,0,0)),d.lineWidth=Z;var Y=D(l._55o),C=l.shapeBorderGradientPack;C?Lf(d,C,D,!0,M):l.shapeBorderRepeatImage?Ck(d,l.shapeBorderRepeatImage,Y,null,c,R):d.strokeStyle=Y,d.stroke(),C&&d.restore(),F&&d.restore(),l._56o&&El(d,Y,D(l._57o),Z,R._zoom,l._58o)}if(Kh(d,J),p("shape.dash")){var G=p("shape.dash.width")||Z;if(G>0){J=p("shape.dash.pattern");var v=ko(d,J,m._2Q("shape.dash.offset"));v!==d&&Dg(v,U,M,z,E,V,a),m._1Q(d,"shape",G,J)}}Sp(d,y,l._63o,M),d.lineJoin=h,d.lineCap=S}else{var w=m.interactiveInfo;w&&(d.interactiveInfo=w.bodyInfo={compInfos:[],matrix:new Uo(x,K.x,K.y,r.x,r.y)}),l.gray&&(d.compGray=!0);var O=l.img;O&&O.cacheRule!=f&&(O=Yl(d,O,l.stretch,M.width,M.height,c,R,l.bodyColor)),Tc(d,O,l.stretch,M.x,M.y,M.width,M.height,c,R,l.bodyColor),d.compGray=!1,d.interactiveInfo=f}d.restore()}m._39O(d,l)},_48O:function(){},_47O:function(){}});var Xf=function(t,v){Hm(Xf,this,[t,v])},co=function(I,K,A,X){var v=Mp(I,K);return A=X?h(A,v):ac(A,v),v?A/=v:A=0,{x:I.x+(K.x-I.x)*A,y:I.y+(K.y-I.y)*A}};kl(Xf,Rp,{_3O:function(){var $,X=this,G=X._data,q=X.gv,y=X.s,d=y(uo),V=G.isLooped(),g=y("edge.width"),o=X.getBodyColor("edge.color"),i=y("edge.center"),K=y("edge.offset"),_=q.getBorderColor(G),k=_?y("border.width"):0,M=X.getSelectWidth(),S=G._40I,s=G._41I,U=X._78o=S&&s?{looped:V,type:d,width:g,center:i,color:o,repeatImage:mr(y("edge.repeat.image"),o),borderColor:_,borderWidth:k,_97o:M?X.getSelectColor():f,selectWidth:M,pattern:y("edge.pattern"),cap:y("edge.cap"),join:y("edge.join"),is3d:y("edge.3d"),_67o:y("edge.3d.color"),_66o:y("edge.3d.accuracy"),gray:y("2d.gray")}:f;if(U){var t=L.getEdgeType(d);if(t){var Y=t(G,Kl(X,q,G,V,d),q,X._19Q);Y.points&&Y.points.size()>1?(U.edgeTypeInfo=Y,$=Db(U.edgeTypeInfo.points)):Y[gl]&&Y.rect&&(U.edgeTypeInfo=Y,$=Y.rect)}else{var w=y("edge.source.anchor.x"),N=y("edge.source.anchor.y"),T=y("edge.target.anchor.x"),z=y("edge.target.anchor.y"),Q=Di(q,G,"source"),W=Di(q,G,"target");if(d===we){var c=U.points=y(Ji)||Qp,B=c.size();U.segments=y("edge.segments");var e=w!==E||N!==E||Op(S),r=T!==E||z!==E||Op(s);if(!i)if(K)e||(Q=co(Q,B?c.get(0):W,K,B)),r||(W=co(W,B?c.get(B-1):Q,K,B));else{var H;e||(H=Eo(Q,B?c.get(0):W,Cc(q,S)),H&&(Q={x:H[0],y:H[1]})),r||(H=Eo(B?c.get(B-1):Q,W,Cc(q,s)),H&&(W={x:H[0],y:H[1]}))}$=Ie(Db(U.points),Db(Q,W))}else{var P=Kl(X,q,G,V,d);if(X._19Q||(P=-P),V)Q=ys(Q),Q.x=q.getNodeRect(S).x,U.radius=P,$={x:Q.x-P,y:Q.y-P,width:2*P,height:2*P};else{var b=Mp(Q,W),m=ac(K,b),j={x:m,y:P},u={x:b-m,y:P},x=ts(W.y-Q.y,W.x-Q.x),v=U.mat=new ph(x);if(U.orienAngle=x,U.angle=W.x<Q.x?x+O:x,U.rect={x:j.x,y:j.y,width:u.x-j.x,height:0},U.origin=Q,j=v.tf(j),j.x+=Q.x,j.y+=Q.y,u=v.tf(u),u.x+=Q.x,u.y+=Q.y,i){var D={x:b,y:0};D=v.tf(D),D.x+=Q.x,D.y+=Q.y,$=Db([Q,j,u,D]),U.c1=Q,U.c2=D}else $=Db(j,u);Q=j,W=u}}U.sourcePoint=Q,U.targetPoint=W,G._lastSourcePoint=Q,G._lastTargetPoint=W}var h=0;y("edge.dash")&&(h=y("edge.dash.width")||g);var R="square"===U.cap?.71:.5;en($,p(h*R,g*R+k+M),U.join),X._68o($)}},getRotation:function(Q,d,r){Q=Q||0;var s=this._78o;if(s){var T,l=s.angle,o=s.points,q=s.edgeTypeInfo;if(l!=f)return d?s.orienAngle+Q:l+Q;if(q&&q[gl])return q.getRotation?q.getRotation(this,Q,d,r):0;if(q&&q.points){var U=q.points;return T=U.size(),rf[r]?T&&0===T%2?ij(U.get(T/2-1),U.get(T/2),d,Q):Q:Mk[r]?ij(U.get(0),U.get(1),d,Q):ij(U.get(T-2),U.get(T-1),d,Q)}if(o)return T=o.size(),rf[r]?T&&0===T%2?ij(o.get(T/2-1),o.get(T/2),d,Q):0===T?ij(s.sourcePoint,s.targetPoint,d,Q):Q:Mk[r]?ij(s.sourcePoint,T?o.get(0):s.targetPoint,d,Q):ij(T?o.get(T-1):s.sourcePoint,s.targetPoint,d,Q)}return Q},getPosition:function(r,d,A,s,q){var W=this._78o;if(W){var f,L=W.type,g=W.points,K=W.edgeTypeInfo,T=W.sourcePoint,e=W.targetPoint;if(!L)return W.looped?{x:T.x-W.radius+d,y:T.y+A}:(q&&T&&e&&(T.x>e.x||T.x===e.x&&T.y>e.y)&&(r=sh[r],A=-A),f=Nb(r,W.rect,s),f.x+=d,f.y+=A,f=W.mat.tf(f),f.x+=W.origin.x,f.y+=W.origin.y,f);if(K&&K[gl])return K.getPosition?K.getPosition(this,r,d,A,s,q):{x:(T.x+e.x)/2,y:(T.y+e.y)/2};if(g){var f,c=g.size();if(rf[r]){if(c){var $=c%2;if(0===$)return hb(g.get(c/2-1),g.get(c/2),r,d,A,s,q);f=g.get((c-$)/2)}else f={x:(T.x+e.x)/2,y:(T.y+e.y)/2};return f=Nb(r,{x:f.x,y:f.y,width:0,height:0},s),f.x+=d,f.y+=A,f}return Mk[r]?hb(T,c?g.get(0):e,r,d,A,s,q):hb(c?g.get(c-1):T,e,r,d,A,s,q)}if(K){var i=K.points,c=i.size();if(rf[r]){var $=c%2;return 0===$?hb(i.get(c/2-1),i.get(c/2),r,d,A,s,q):(f=i.get((c-$)/2),f=Nb(r,{x:f.x,y:f.y,width:0,height:0},s),f.x+=d,f.y+=A,f)}return Mk[r]?hb(i.get(0),i.get(1),r,d,A,s,q):hb(i.get(c-2),i.get(c-1),r,d,A,s,q)}}return hq},_42:function(b){this._78o&&Xf.superClass._42.call(this,b)},drawPath:function(I,N){I.beginPath();var D=N.type,Y=N.points,u=N.segments,c=N.edgeTypeInfo;if(!D||Y){var y=N.sourcePoint,z=y.x,t=y.y,E=N.targetPoint,M=E.x,A=E.y;if(D)if(u){var k=new zp({x:z,y:t});k.addAll(Y),k.add({x:M,y:A}),Ko(I,k,u)}else I.moveTo(z,t),Y.each(function(F){I.lineTo(F.x,F.y)}),I.lineTo(M,A);else N.looped?I.arc(z,t,N.radius,0,_,!0):N.center?(I.moveTo(N.c1.x,N.c1.y),I.lineTo(z,t),I.lineTo(M,A),I.lineTo(N.c2.x,N.c2.y)):(I.moveTo(z,t),I.lineTo(M,A))}else c&&(c.points?Ko(I,c.points,c.segments):c[gl]&&c[gl](I,c))},_80o:function(H){var q=this,T=q.s,N=q._78o,U=N.width,K=N.selectWidth,J=N.borderWidth,z=N.repeatImage,f=H.lineJoin,V=H.lineCap,s=N.gray,o=N.pattern;H.lineJoin=N.join,H.lineCap=N.cap,q.drawPath(ko(H,o),N);var p=T("edge.width.absolute");p&&(H.save(),H.setTransform(1,0,0,1,0,0)),K&&(H.strokeStyle=N._97o,H.lineWidth=U+2*(J+K),H.stroke()),J&&(H.strokeStyle=s?L.toGrayColor(N.borderColor):N.borderColor,H.lineWidth=U+2*J,H.stroke());var X=s?L.toGrayColor(N.color):N.color;if(z?Ck(H,z,X,null,q._data,q.gv):H.strokeStyle=X,H.lineWidth=U,H.stroke(),N.is3d){var v=s?L.toGrayColor(N._67o):N._67o;El(H,X,v,U,q.gv._zoom,N._66o)}if(Kh(H,o),T("edge.dash")){o=T("edge.dash.pattern");var l=ko(H,o,q._2Q("edge.dash.offset"));l!==H&&q.drawPath(l,N),q._1Q(H,"edge",T("edge.dash.width")||U,o)}p&&H.restore(),H.lineJoin=f,H.lineCap=V},_48O:function(){},_47O:function(){}});var Mi=function(j,c){Hm(Mi,this,[j,c])};kl(Mi,Ep,{_3O:function(){var k,S,t=this,c=t.s,D=t._data,q=t.gv;if(t._88I=f,D.isExpanded()&&D.eachChild(function(M){if(mq(M)){var J=q.getBoundsForGroup(M);J&&(S||(S=[]),S.push(J),k=Ie(k,J))}}),k){var C=q.getLabel(D),u=c("group.type"),g=c("group.border.width")||0,B=c("group.border.width.absolute"),Z=g/2;B&&(g/=q._zoom),k=Oo(u,S,k),xs(k,D,"group.padding",1),Qd(k,g);var r=t._88I={type:u,rect:k,_64o:k};if(!u&&C!=f){var v,I=t.labelInfo={label:C,color:c("group.title.color"),font:c("group.title.font"),align:c("group.title.align")},$=je(I,C),R=$.width+g,y=$.height+g,V=c("group.title.align"),s=c("group.title.orientation");if(s===Fc||s===ab?(k.height+=g,R>k.width&&(k.width=R)):(s===re||s===ln)&&(k.width+=g,R>k.height&&(k.height=R)),v=V===re?k.x:V===ln?k.x+k.width-R:k.x+k.width/2-R/2,s===ab)r.titleRect={x:k.x,y:k.y+k.height,width:k.width,height:y},r.rect={x:k.x,y:k.y,width:k.width,height:k.height+y},I.rect={x:v,y:k.y+k.height,width:R,height:y};else if(s===re){var L=r.titleRect={x:k.x-y,y:k.y,width:y,height:k.height};r.rect={x:k.x-y,y:k.y,width:k.width+y,height:k.height},I.rect={x:L.x+y/2-k.height/2,y:L.y+k.height/2-y/2,width:k.height,height:y},I.rotation=-Math.PI/2}else if(s===ln){var L=r.titleRect={x:k.x+k.width,y:k.y,width:y,height:k.height};r.rect={x:k.x,y:k.y,width:k.width+y,height:k.height},I.rect={x:L.x+y/2-k.height/2,y:L.y+k.height/2-y/2,width:k.height,height:y},I.rotation=Math.PI/2}else r.titleRect={x:k.x,y:k.y-y,width:k.width,height:y},r.rect={x:k.x,y:k.y-y,width:k.width,height:k.height+y},I.rect={x:v,y:k.y-y-Z,width:R,height:y+g}}t._40O(r,c("group.border.width")/2)}else Mi.superClass._3O.call(t)},getPosition:function(T,E,U,R){var q=this._88I;if(q){var $=Nb(T,q.rect,R);return $.x+=E,$.y+=U,$}return Mi.superClass.getPosition.apply(this,arguments)},_24O:function(M,U){var Y=this._88I;(!Y||Y.type||"label2"===M)&&Mi.superClass._24O.call(this,M,U)},_80o:function(r){var s=this,y=s._88I;if(y){var g=s._data,D=s.s,m=s.gv,Z=y.type,X=y.rect,d=y._64o,J=y.titleRect,i=s.getBodyColor(),t=mr(D("group.image"),i),K=D("group.image.stretch"),T=s.getBodyColor("group.background"),L=mr(D("group.repeat.image"),i),k=D("group.gradient.pack"),V=D("group.gradient"),z=D("group.gradient.color"),$=D("group.border.width"),x=D("group.border.color"),n=D("group.border.pattern"),h=D("group.title.orientation"),q=D("group.depth"),R=D("group.border.radius"),A=D("group.border.join"),G=D("group.border.cap"),S=D("group.border.width.absolute");S&&($/=m._zoom);var p=x,v=D("group.border.repeat.image");if(v&&(v=mr(v,x))&&(p=Tm(r,v,x,null,g,m)),Z){var W=r.lineJoin,C=r.lineCap;if(r.lineJoin=A,r.lineCap=G,t){if(r.save(),Dg(r,Z,X,R),r.clip(),Tc(r,t,K,X.x,X.y,X.width,X.height,g,m,i),r.restore(),$>0){var I=ko(r,n);Dg(I,Z,X,R),r.lineWidth=$,r.strokeStyle=p,r.stroke(),Kh(r,n)}}else{var I=ko(r,n);T||L||k?(Dg(r,Z,X,R),k?Lf(r,k,function(b){return Fm(b,i)},!1,X):L?mn(r,L,i,null,g,m):Le(r,T,V,z,X),r.fill(),k&&r.restore(),r!==I&&Dg(I,Z,X,R)):Dg(I,Z,X,R),$>0&&(r.lineWidth=$,r.strokeStyle=p,r.stroke()),Kh(r,n),Z===Bj&&Sp(r,T,q,X)}r.lineJoin=W,r.lineCap=C}else{var Y=D("group.title.background");if((!R||0>R)&&(R=0),t)Tc(r,t,K,d.x,d.y,d.width,d.height,g,m,s.getBodyColor());else if(T||L)if(L?mn(r,L,i,null,g,m):Le(r,T,V,z,d),0===$)Dg(r,Bj,d),r.fill(),Sp(r,T,q,d);else{switch(r.beginPath(),h){case ab:Jf(r,d.x,d.y,d.width,d.height,R,R,0,0);break;case re:Jf(r,d.x,d.y,d.width,d.height,0,R,0,R);break;case ln:Jf(r,d.x,d.y,d.width,d.height,R,0,R,0);break;case Fc:Jf(r,d.x,d.y,d.width,d.height,0,0,R,R)}r.fill()}if(J&&Y)if(0===$)Nj(r,J.x,J.y,J.width,J.height,Y),Sp(r,Y,q,J);else{switch(r.beginPath(),r.fillStyle=Y,h){case ab:Jf(r,J.x,J.y,J.width,J.height,0,0,R,R);break;case re:Jf(r,J.x,J.y,J.width,J.height,R,0,R,0);break;case ln:Jf(r,J.x,J.y,J.width,J.height,0,R,0,R);break;case Fc:Jf(r,J.x,J.y,J.width,J.height,R,R,0,0)}r.fill()}if($>0){var I=ko(r,n);if(Dg(I,"roundRect",X,R),r.save(),r.lineWidth=$,r.strokeStyle=p,r.lineJoin=A,r.lineCap=G,r.closePath(),r.stroke(),J&&D("group.splitLine")){var o=J.x,E=J.y,O=J.width,M=J.height;r.beginPath(),h===ab?(r.moveTo(o,E),r.lineTo(o+O,E)):h===re?(r.moveTo(o+O,E),r.lineTo(o+O,E+M)):h===ln?(r.moveTo(o,E),r.lineTo(o,E+M)):(r.moveTo(o,E+M),r.lineTo(o+O,E+M))}r.stroke(),r.restore(),Kh(I,n)}}s._39O(r,y)}else Mi.superClass._80o.call(s,r)}});var tg=function(G,T){Hm(tg,this,[G,T])};kl(tg,Ep,{_80o:function(V){this._39O(V,this._83o)}});var ls=function(Q,_){Hm(ls,this,[Q,_])};kl(ls,Ep,{_3O:function(){var _=this,i=_._data,S=_.s,U=_.gv,F=i.getPoints(),n=U.getBorderColor(i),d=n?S("border.width"):0,D=_.getSelectWidth(),t=S("shape.border.width"),M=i.getRect(),J=i.getAnchorRect(),Y=U.getBodyColor(i),O=S("shape.border.color"),Z=_._99o=F.isEmpty()?f:{rect:M,rotation:i.getRotation(),fillRule:S("shape.fill.rule"),scale:i.getScale(),position:i.p(),points:F,segments:i.getSegments(),bodyColor:Y,borderColor:n,borderWidth:d,_94o:S("shape.border.3d"),_95o:S("shape.border.3d.color"),_96o:S("shape.border.3d.accuracy"),_97o:D?_.getSelectColor():f,selectWidth:D,_53o:S("shape.background"),_27Q:mr(S("shape.repeat.image"),Y),shapeGradientPack:S("shape.gradient.pack"),shapeBorderGradientPack:S("shape.border.gradient.pack"),_54o:t,_55o:O,shapeBorderRepeatImage:mr(S("shape.border.repeat.image"),O),shapeGradient:S("shape.gradient"),_59o:S("shape.gradient.color"),_60o:S("shape.border.pattern"),_61o:S("shape.border.cap"),_62o:S("shape.border.join"),shapeForeground:S("shape.foreground"),gray:S("2d.gray")};if(Z){J.x+=Z.position.x,J.y+=Z.position.y,Z.gradientRect=J;var j=i.getScale(),o=p(1,p(a(j.x),a(j.y)));S("shape.dash")&&S("shape.dash.width")>t&&(t=S("shape.dash.width"));var h,K=S("shape.border.width.absolute");h=K?(t+d+D)/_.gv._zoom/o:t*("square"===Z._61o?.71:.5)+d+D/_.gv._zoom/o,h&&(h*=o,M=ys(M),en(M,h,Z._62o)),_._68o(M);var g=S("clip.percentage");g!=E&&(Z.clipRect=jg(i.getAnchorRect(),S("clip.direction"),g));var I=S("shape.fill.clip.percentage");I!=E&&(Z.shapeClipRect=jg(i.getAnchorRect(),S("shape.fill.clip.direction"),I));var V=S("shape.foreground.clip.percentage");V!=E&&(Z.shapeForegroundClipRect=jg(i.getAnchorRect(),S("shape.foreground.clip.direction"),V))}},getPosition:function(l,s,$,r){var u=this._99o;if(u){var N=Nb(l,u.rect,r);return N.x+=s,N.y+=$,N}return hq},_42:function(f){this._99o&&ls.superClass._42.call(this,f)},_80o:function(t){var m,g=this,j=g.s,$=g._99o,F=$.position,U=$.scale,Y=$.rotation,u=$.borderWidth,b=g.gv._zoom,f=$.selectWidth/b,V=$._27Q,E=$.shapeGradientPack,O=$._54o,p=$.clipRect,w=$.shapeClipRect,S=$.points,c=$.segments,x=g._data.isClosePath(),s=$.fillRule,Z=$.gray,z=function($){return Z?L.toGrayColor($):$},h=z($._53o),M=h||V||E;t.save(),rn(t,F.x,F.y),bo(t,Y),wj(t,U.x,U.y),p&&(t.beginPath(),t.rect(p.x,p.y,p.width,p.height),t.clip()),M&&w&&(t.save(),t.beginPath(),t.rect(w.x,w.y,w.width,w.height),t.clip()),H.Default.extractShapeTranslation?(S=ys(S),S.forEach(function(b){b.x-=F.x,b.y-=F.y})):rn(t,-F.x,-F.y);var y=j("shape.border.width.absolute"),P=$._60o;y&&P&&(P=P.map(function(R){return R*b}));var q=ko(t,P),_=t.lineJoin,B=t.lineCap;t.lineJoin=$._62o,t.lineCap=$._61o;var n=z($.bodyColor);M?(Ko(t,S,c,x),E?Lf(t,E,function(g){return Fm(g,$.bodyColor)},!1,$.rect):V?mn(t,V,n,null,g._data,g.gv):(m=n?n:h,Le(t,m,$.shapeGradient,z($._59o),$.gradientRect)),t.fill(s),E&&t.restore(),w&&(t.restore(),rn(t,-F.x,-F.y)),q!==t&&Ko(q,S,c,x)):Ko(q,S,c,x);var a=$.shapeForeground;if(a){t.save();var i=$.shapeForegroundClipRect;i&&(rn(t,F.x,F.y),t.beginPath(),t.rect(i.x,i.y,i.width,i.height),t.clip(),rn(t,-F.x,-F.y)),Ko(t,S,c,x),Le(t,a,j("shape.foreground.gradient"),z(j("shape.foreground.gradient.color")),$.gradientRect),t.fill(s),t.restore()}if(y&&(t.save(),t.setTransform(1,0,0,1,0,0)),f&&(t.strokeStyle=$._97o,t.lineWidth=O+2*(u+f),t.stroke()),u&&(t.strokeStyle=z($.borderColor),t.lineWidth=O+2*u,t.stroke()),O){m=z($._55o);var K=$.shapeBorderGradientPack;K?Lf(t,K,z,!0,$.rect):$.shapeBorderRepeatImage?Ck(t,$.shapeBorderRepeatImage,m,null,g._data,g.gv):(!h&&n&&(m=n),t.strokeStyle=m),t.lineWidth=O,t.stroke(),K&&t.restore(),$._94o&&El(t,m,z($._95o),O,b,$._96o)}if(Kh(t,P),j("shape.dash")){var W=j("shape.dash.width")||O;if(W>0){P=j("shape.dash.pattern"),y&&(P=P.map(function(s){return s*b}));var q=ko(t,P,g._2Q("shape.dash.offset"));q!==t&&Ko(q,S,c,x),g._1Q(t,"shape",W,P)}}y&&t.restore(),t.lineJoin=_,t.lineCap=B,t.restore()},_48O:function(){},_47O:function(){}});var tm=function(Q,a){Hm(tm,this,[Q,a])};kl(tm,ls,{getRotation:function(){var R=new pb,K=new pb,d=new Uo;return function(e,W,P){e=e||0;var i=this._data,r=i.getPoints(),w=r.size();if(w>1){var O,y,S=i.p(),q=i.getScale();if(d.identity().translate(-S.x,-S.y).scale(q.x,q.y).translate(S.x,S.y),rf[P]){var Z=w%2,j=(w-Z)/2;O=r.get(j-1),y=r.get(j)}else Mk[P]?(O=r.get(0),y=r.get(1)):(O=r.get(w-2),y=r.get(w-1));return d.apply(O,R),d.apply(y,K),ij(R,K,W,e)}return e}}(),getPosition:function(){var F=new pb,w=new pb,g=new pb;return function(m,Z,C,r,U){var j=this._data,h=j.getPoints(),a=h.size();if(a>1){var X,f,n=j.getPointsMatrix2d();if(rf[m]){var z=a%2,D=(a-z)/2;if(X=h.get(D-1),f=h.get(D),0!==z){var t=Nb(m,hq,r);return t.x+=Z,t.y+=C,n.apply(X,F),n.apply(f,w),n.identity().rotate(g.copy(w).sub(F).angle()).tf(t).add(w)}}else Mk[m]?(X=h.get(0),f=h.get(1)):(X=h.get(a-2),f=h.get(a-1));return n.apply(X,F),n.apply(f,w),hb(F,w,m,Z,C,r,U)}return hq}}()});var Ec=function(x,F){Hm(Ec,this,[x,F])};kl(Ec,Ep,{_3O:function(){var g=this;Ec.superClass._3O.call(g);var b=g.s,s=g._83o;g._82o=s.img||s.shape?f:{background:g.getBodyColor("grid.background"),depth:b("grid.depth"),rect:s.rect,_88o:b("grid.cell.depth"),cellBorderColor:b("grid.cell.border.color"),_89o:b("grid.row.count"),_90o:b("grid.column.count"),block:b("grid.block"),_91o:b("grid.block.color"),_92o:b("grid.block.padding"),_93o:b("grid.block.width")}},_80o:function(c){var S=this,W=S._82o;if(!W)return Ec.superClass._80o.call(S,c),void 0;var C,f,O=S._data,i=W.background,A=W.rect,$=W.block,E=W._91o,B=W._92o,F=W._93o,Y=W._88o,o=W.cellBorderColor,M=W._89o,p=W._90o;if(i)if(Nj(c,A.x,A.y,A.width,A.height,i),Sp(c,i,W.depth,A),Y)for(C=0;M>C;C++)for(f=0;p>f;f++)A=O.getCellRect(C,f),A&&Sp(c,i,Y,A);else if(o){for(c.beginPath(),C=0;M>C;C++)for(f=0;p>f;f++)A=O.getCellRect(C,f),A&&c.rect(A.x,A.y,A.width,A.height);c.strokeStyle=o,c.lineWidth=1,c.stroke()}if("h"===$)for(C=0;M>C;C++)A=Ie(O.getCellRect(C,0),O.getCellRect(C,p-1)),Qd(A,B),Df(c,E,A.x,A.y,A.width,A.height,F);else if("v"===$)for(f=0;p>f;f++)A=Ie(O.getCellRect(0,f),O.getCellRect(M-1,f)),Qd(A,B),Df(c,E,A.x,A.y,A.width,A.height,F);S._39O(c,S._83o)}});var $l=function(o,F){Hm($l,this,[o,F])},um=Y?Vq().getContext("2d"):f;kl($l,Ep,{_checkEmptyRect:!1,_81o:function(){var c=this._data,A=$l.superClass._81o.call(this),$=c.s("text");if($!=f){$+="";var V,k=c.s("text.font"),u=c.s("text.align"),Z=c.s("text.vAlign"),C=c.s("text.wrap"),H=c.s("text.vertical"),P=c.s("text.vertical.gap"),Y=c.s("text.letter.gap")||0,r=c.getWidth(),v=c.getHeight();if(null==P&&(P=1),H){var t;t=C?fl($,v,k,Y,H,P):[$];var g=(t.length-1)*Y,h=0;um.textBaseline=Fc,um.font=k,t.forEach(function(F){for(var Q=F.length,i=0,s=(Q-1)*P,e=0;Q>e;e++){var G=um.measureText(F[e]);s+=G.fontBoundingBoxDescent||vm(k,F[e]).height,i=p(i,G.width)}g+=i,h=p(s,h)});var s=(t.length-1)*Y;t.forEach(function(u){s+=u}),V={width:g,height:h}}else{var t=C?fl($,r,k,Y,H,P):$.split("\n"),e=t.length;if(e>1){var L=vm(k,$).height,g=0,h=L*e+P*(e-1);t.forEach(function(R){g=p(g,vm(k,R).width)}),V={width:g,height:h}}else V=vm(k,$),Y&&(V.width+=($.length-1)*Y)}var U,j,i=V.width,y=V.height,q=c.getAnchor();"left"===u?U=-r*q.x:"center"===u?U=-r*q.x+(r-i)/2:"right"===u&&(U=r*(1-q.x)-V.width),"top"===Z?j=-v*q.y:"middle"===Z?j=-v*q.y+(v-y)/2:"bottom"===Z&&(j=v*(1-q.y)-V.height);var x,O=c.getMatrix();if(x=Db([O.tf(U,j),O.tf(U+i,j),O.tf(U+i,j+y),O.tf(U,j+y)]),A=Ie(A,x),A&&c.s("text.shadow")){var M=ys(A);M.x+=c.s("text.shadow.offset.x"),M.y+=c.s("text.shadow.offset.y"),Qd(M,c.s("text.shadow.blur")),A=Ie(A,M)}}return A}});var Oi=Gc.Interactor=function(I){this.gv=this._graphView=I};Sc("Interactor",b,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(i){this.gv.fi(i)},setCursor:function(r){dn||this.gv.setCursor(r)},startDragging:function(c){var e=this;e._lastClientPoint=dg(c),e._lastLogicalPoint=e.gv.lp(c),bg(e,c)},clearDragging:function(){var y=this;y._lastClientPoint=y._lastLogicalPoint=y._logicalPoint=f},autoScroll:function(N){return this.gv.autoScroll(N,this._lastClientPoint)}});var Hb=f,af=function(d){Hb.handleWindowTouchMove(d)},Ul=function(l){Hb.handleWindowTouchEnd(l),x(u,ic,af),x(u,Wn,Ul),Hb=f},Ke=function(i){Hb.handleWindowMouseMove(i)},wq=function(q){Hb.handleWindowMouseUp(q),x(u,mo,Ke),x(u,gh,wq),Hb=f},Zl=function(D,R){if(D!==Hb){var n=bj(R);Hb?n?Hb.handleWindowTouchEnd(R):Hb.handleWindowMouseUp(R):n?(w(u,ic,af),w(u,Wn,Ul)):(w(u,mo,Ke),w(u,gh,wq)),Hb=D}},fp=function(K){var o=this;o.gv=K,o._is2d=K instanceof Gc.GraphView,o._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",Xb,"wheel"].forEach(function($){o.addListener($)}),o.initImageResource()};kl(fp,Oi,{enableVR:function(X){var W=this;!!W._vrEnable!==X&&(W._vrEnable=X,X?W.gv.vr.mp(W.onVRControllerChange,W):W.gv.vr.ump(W.onVRControllerChange,W))},onVRControllerChange:function(P){var q=this,c=P.property,k=P.newValue,z=k.id,h=q.gv.vr.getController(z),V=h.getRay();if(V){V.controllerId=z;var g=q.gv.vr.getRayEventType(V,c,k._62O);switch(g){case"down":q.handle_mousedown(V);break;case"up":Hb&&wq(V);break;case"move":q.handle_mousemove(V),Hb&&q.handleWindowMouseMove(V)}}},setPreventEventDefault:function(_,j){var S=this,p=S._eventListeners[_];p?p._prevent=j:S._eventListeners[_]=p={_removal:E,_prevent:j}},removeListener:function(R){var g=this,A=g._eventListeners[R];A&&A._removal&&(A._removal(),A._removal=E)},addListener:function(b){var z=this,C=z._eventListeners[b];if(C||(z._eventListeners[b]=C={_removal:E,_prevent:!0}),!C||!C._removal){var W=function(A){C._prevent&&L.preventDefault(A),z.disabled||z.gv._48Q||("wheel"===b?Wf(z,A):z["handle_"+b](A))};w(z.gv.getView(),b,W),C._removal=function(){x(z.gv.getView(),b,W)}}},handleWindowTouchMove:function(v){this.handleWindowMouseMove(v)},handleWindowMouseMove:function(P){return!this.downInfo||bj(P)&&1!==Ai(P)?(this.isDragging&&(this.handleDownInfo("onEndDrag",P),this.isDragging=!1),void 0):(this.isDragging?this.handleDownInfo("onDrag",P):(this.handleDownInfo("onBeginDrag",P),this.isDragging=!0),void 0)},handleWindowTouchEnd:function(q){this.handleWindowMouseUp(q)},handleWindowMouseUp:function(A){if(this.isDragging&&(this.handleDownInfo("onEndDrag",A),this.isDragging=!1),this.downInfo){var Q=this.handle("onUp",A);if(Q&&Q.data===this.downInfo.data){this.handleMissingUp(A);var $=this,T=2===A.button?"onContextMenu":"onClick";if(!$._dbclickTimer)return $._dbclickTimer=On(function(){delete $._dbclickTimer,$.handleClick(A,T,Q),this.downInfo=f},L.clickDelay),void 0;Zh($._dbclickTimer),delete $._dbclickTimer,T="onDoubleClick",$.handleClick(A,T,Q)}else this.handleDownInfo("onUp",A);this.downInfo=f,this.downComps=f}},handle_mouseleave:function(n){var L=this,r=L.gv;L._hoverTimer&&(Zh(L._hoverTimer),delete L._hoverTimer);var g=L.currentInfo?L.currentInfo.data:f;if(g){g.s("onLeave")&&g.s("onLeave")(n,g,r),L.fire("data","onLeave",n,g);var P=L.currentInfo?L.currentInfo.hits:f;if(P)for(var _ in P)L.handleLeave(n,_);L.currentInfo=f}},handle_mousewheel:function(r){r.scrollDelta=r.wheelDelta/40,this.handle("onScroll",r)},handle_DOMMouseScroll:function(I){I.scrollDelta=2===I.axis?-I.detail:0,this.handle("onScroll",I)},handle_touchstart:function(v){this.handle_mousedown(v)},handle_touchmove:function(i){this.handle("onMove",i)},handle_mousedown:function(o){this.isDragging&&(this.handleDownInfo("onEndDrag",o),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",o),this.downInfo&&Zl(this,o)},handle_mousemove:function(H){var X=this,z=X.gv;if(X._hoverTimer&&(Zh(X._hoverTimer),delete X._hoverTimer),!z._panning&&!z._moving){var F,M,W,a=X.handle("onMove",H),T=this.currentInfo?this.currentInfo.data:f,l=this.currentInfo?this.currentInfo.hits:f;if(a&&(M=a.data,W=a.hits,X._hoverTimer=On(function(){Zh(X._hoverTimer),delete X._hoverTimer,X.handle("onHover",H,a)},z.getHoverDelay()||L.hoverDelay)),M!==T){if(T&&(T.s("onLeave")&&T.s("onLeave")(H,T,z),this.fire("data","onLeave",H,T)),M&&(M.s("onEnter")&&M.s("onEnter")(H,M,z),this.fire("data","onEnter",H,M)),l)for(F in l)this.handleLeave(H,F);if(W)for(F in W){var i=W[F],B=M._interactPrefix=i.prefix,p=B&&M.a(B+"onEnter")||i.target.onEnter;p&&p.call(i.target,H,M,z,i.point,i.width,i.height),this.fire(i.type,"onEnter",i.event,i.data,i.image,i.comp,i.point,i),M._interactPrefix=null}}else{if(l)for(F in l)W&&W[F]||this.handleLeave(H,F);if(W)for(F in W)if(!l||!l[F]){var i=W[F],B=M._interactPrefix=i.prefix,p=B&&M.a(B+"onEnter")||i.target.onEnter;p&&p.call(i.target,H,M,z,i.point,i.width,i.height),this.fire(i.type,"onEnter",i.event,i.data,i.image,i.comp,i.point,i),M._interactPrefix=null}}this.currentInfo=a}},handle:function(k,w,u){var $,_=this,L=_.gv;if(_._is2d){if(u=u||L.getDataInfoAt(w),!u||!L.isInteractive(u.data))return;if($=u.ui.interactiveInfo){var n,R=u.data;if(R.s(k)&&R.s(k)(w,R,L),this.fire("data",k,w,R),"body"===u.part&&$.bodyInfo)n="body",u.hits=this.handleImage(n,L.getImage(R),k,w,R,u.point,$.bodyInfo);else if("icons"===u.part&&$._38o){var D=$._38o[u.name];D&&D[u.index]&&(n="icons|"+u.name+"|"+u.index,u.hits=this.handleImage(n,u.icon,k,w,R,u.point,D[u.index]))}}return u}var R,X;if(!u)if(w&&w instanceof H.Math.Ray&&L.isVREnabled()){var A=L.vr.intersectWorld(w);if(R=A.data,X=A.intersect,L.vr.renderRayDuringInteraction(w,R,X),!R)return;var x=L.getData3dUI(R);if($=x.interactiveInfo,!$)return;u={data:R,part:X.part,ui:x}}else{if(u=this.getDataInfoAt(w),!u)return;u&&(u={data:u.data,part:u.part})}if(L.isInteractive(u.data)){if(!X){R=u.data;var x=L.getData3dUI(R);if(u.ui=x,$=x.interactiveInfo,!$)return u;if(X=L.intersectObject(w,R),!X)return u}R.s(k)&&R.s(k)(w,R,L),this.fire("data",k,w,R);var l,C=X.part;return"body"!==C&&(l=R.s(C+".image")||R.s("shape3d."+C+".image")),l||(l=R.s("all.image")||R.s("shape3d.image")),l?($="object"==typeof l?$[l.uuid]:$[l],$&&$.bodyInfo?(u.part="body",u.interactiveInfo=$,u.point=this._convertUVToPoint(X.uv,$),u.image=l,u.hits=this.handleImage("body",l,k,w,R,u.point,$.bodyInfo),u):u):u}},_handleLeaveOrMissing:function(p,c,Y){var Q="leave"===p?this.currentInfo:this.downInfo;if(Q){var I=Q.interactiveInfo||Q.ui.interactiveInfo;if(I){var Z,f,P=Q.data;if(this._is2d){if(f=this.gv.lp(c),"body"===Q.part&&I.bodyInfo)Z="body","leave"===p?this.handleLeaveImage(Y,Z,this.gv.getImage(P),c,P,f,I.bodyInfo):this.handleMissingUpImage(Z,this.gv.getImage(P),c,P,f,I.bodyInfo);else if("icons"===Q.part&&I._38o){var W=I._38o[Q.name];W&&W[Q.index]&&(Z="icons|"+Q.name+"|"+Q.index,"leave"===p?this.handleLeaveImage(Y,Z,Q.icon,c,P,f,W[Q.index]):this.handleMissingUpImage(Z,Q.icon,c,P,f,W[Q.index]))}}else{if(!I.bodyInfo)return;var R=this.gv.intersectObject(c,P);f=R&&R.uv?this._convertUVToPoint(R.uv,I):{x:1/0,y:1/0},"leave"===p?this.handleLeaveImage(Y,"body",Q.image,c,P,f,I.bodyInfo):this.handleMissingUpImage("body",Q.image,c,P,f,I.bodyInfo)}}}},handleClick:function(F,T,B){var Y=this,A=this.downInfo;if(A&&B){var q,V=B.interactiveInfo||B.ui.interactiveInfo,l=B.data,c=this.gv;if(l.s(T)&&l.s(T)(F,l,c),Y.fire("data",T,F,l),V)if(this._is2d){if(A.part===B.part){var E=c.lp(F);"body"===B.part&&V.bodyInfo&&(q="body",this.handleClickImage(q,c.getImage(l),T,F,l,E,V.bodyInfo,B))}}else{if(!V.bodyInfo)return;var e=c.intersectObject(F,l);if(!e)return;E=this._convertUVToPoint(e.uv,V),this.handleClickImage("body",A.image,T,F,l,E,V.bodyInfo,B)}}},handleDownInfo:function(h,o){if(this.downInfo){var S=this.downInfo,Y=this.gv,z=S.interactiveInfo||S.ui.interactiveInfo;if(z){var l,g=S.data;if(g.s(h)&&g.s(h)(o,g,Y),this.fire("data",h,o,g),this._is2d){var u=Y.lp(o);if("body"===S.part&&z.bodyInfo)l="body",this.handleDownInfoImage(l,Y.getImage(g),h,o,g,u,z.bodyInfo);else if("icons"===S.part&&z._38o){var p=z._38o[S.name];p&&p[S.index]&&(l="icons|"+S.name+"|"+S.index,this.handleDownInfoImage(l,S.icon,h,o,g,u,p[S.index]))}}else{if(!z.bodyInfo)return;var n;if("onBeginDrag"===h?(n=Y._raycaster.intersectObjectAndRecordTriangle(o,g),n&&(z.beginDragIntersectInfo=n.triangleInfo)):n=Y.intersectObject(o,g),!n&&("onDrag"!==h&&"onEndDrag"!==h||!z.beginDragIntersectInfo||(n=Y._raycaster.intersectLastTriangle(o,z.beginDragIntersectInfo)),!n))return;u=this._convertUVToPoint(n.uv,z),this.handleDownInfoImage("body",S.image,h,o,g,u,z.bodyInfo)}}}},fire:function(B,C,o,H,P,O,T,A){this.gv.fi({kind:C,type:B,event:o,data:H,image:P,comp:O,view:this.gv,point:T,width:A?A.width:E,height:A?A.height:E})},handleImage:function(j,O,P,q,R,w,S){var h={};if(O&&(O=mr(O))){var F=this.gv,M=S.rect,W=this.convertPoint(w,S);W.inRect&&(O[P]&&O[P](q,R,F,W,M.width,M.height),this.fire("image",P,q,R,O,E,W,M),h[j+"|image"]={target:O,type:"image",image:O,data:R,event:q,point:W,width:M.width,height:M.height});for(var A,p=S.compInfos,i=O,I=p.length-1;I>=0;I--){var r=p[I],H=r.comp;if(W=this.convertPoint(w,r,i,H,F,R),W.inRect){M=r.rect;var U=R._interactPrefix=r.prefix,f=U&&R.a(U+P)||H[P];if(f&&(A=f.call(H,q,R,F,W,M.width,M.height)),this.fire("comp",P,q,R,O,H,W,M),A!==!0&&(O=M.image)&&(O[P]&&(A=O[P](q,R,F,W,M.width,M.height)),this.fire("image",P,q,R,O,E,W,M)),R._interactPrefix=null,h[j+"|"+I]={target:H,type:"comp",comp:H,image:O,data:R,event:q,point:W,width:M.width,height:M.height,prefix:U},this.downComps&&this.downComps.push(H),O&&(h[j+"|"+I+"|image"]={target:O,type:"image",image:O,data:R,event:q,point:W,width:M.width,height:M.height,prefix:U}),A===!0)break}}}return h},handleLeave:function(O,c){return this._handleLeaveOrMissing("leave",O,c)},handleMissingUp:function(O){return this._handleLeaveOrMissing("missing",O)},handleLeaveImage:function(Y,Z,c,o,O,d,V){if(c&&(c=mr(c))){var P=this.gv,b=V.rect,N=this.convertPoint(d,V);Y===Z+"|image"&&(c.onLeave&&c.onLeave(o,O,P,N,b.width,b.height),this.fire("image","onLeave",o,O,c,E,N,b));for(var h,v=V.compInfos,i=c,q=v.length-1;q>=0;q--){var p=v[q],y=p.comp;N=this.convertPoint(d,p,i,y,P,O),b=p.rect;var C=O._interactPrefix=p.prefix;if(Y===Z+"|"+q){var L=C&&O.a(C+"onLeave")||y.onLeave;L&&(h=L.call(y,o,O,P,N,b.width,b.height)),this.fire("comp","onLeave",o,O,c,y,N,b)}if(h!==!0&&(c=b.image)&&Y===Z+"|"+q+"|image"&&(c.onLeave&&(h=c.onLeave(o,O,P,N,b.width,b.height)),this.fire("image","onLeave",o,O,c,E,N,b)),O._interactPrefix=null,h===!0)break}}},handleMissingUpImage:function(a,u,W,K,P,g){var q="onUp",d=this.downInfo.hits;if(d&&u&&(u=mr(u))){var Y=this.gv,T=g.rect,r=this.convertPoint(P,g);!r.inRect&&d[a+"|image"]&&(u[q]&&u[q](W,K,Y,r,T.width,T.height),this.fire("image",q,W,K,u,E,r,T));for(var s,k=g.compInfos,A=u,n=k.length-1;n>=0;n--){var y=k[n],o=y.comp;if(r=this.convertPoint(P,y,A,o,Y,K),!r.inRect){T=y.rect;var x=K._interactPrefix=y.prefix;if(d[a+"|"+n]){var Q=x&&K.a(x+q)||o[q];Q&&(s=Q.call(o,W,K,Y,r,T.width,T.height)),this.fire("comp",q,W,K,u,o,r,T)}if(s!==!0&&(u=T.image)&&d[a+"|"+n+"|image"]&&(u[q]&&(s=u[q](W,K,Y,r,T.width,T.height)),this.fire("image",q,W,K,u,E,r,T)),K._interactPrefix=null,s===!0)break}}}},handleDownInfoImage:function(u,w,k,a,W,f,D){var z=this.downInfo.hits;if(z&&w&&(w=mr(w))){var i=this.gv,C=D.rect,O=this.convertPoint(f,D);z[u+"|image"]&&(w[k]&&w[k](a,W,i,O,C.width,C.height),this.fire("image",k,a,W,w,E,O,C));for(var V,g=D.compInfos,m=w,X=g.length-1;X>=0;X--){var x=g[X],L=x.comp;O=this.convertPoint(f,x,m,L,i,W),C=x.rect;var Q=W._interactPrefix=x.prefix,F=["onDrag","onEndDrag"].indexOf(k)>=0;if(!F&&z[u+"|"+X]||F&&this.downComps&&this.downComps.indexOf(L)>=0){var N=Q&&W.a(Q+k)||L[k];N&&(V=N.call(L,a,W,i,O,C.width,C.height)),this.fire("comp",k,a,W,w,L,O,C)}if(V!==!0&&(w=C.image)&&z[u+"|"+X+"|image"]&&(w[k]&&(V=w[k](a,W,i,O,C.width,C.height)),this.fire("image",k,a,W,w,E,O,C)),W._interactPrefix=null,V===!0)break}}},handleClickImage:function(A,d,c,D,I,x,g,r){var m=this.downInfo.hits,l=r.hits;if(m&&d&&(d=mr(d))){var J=this.gv,Q=g.rect,i=this.convertPoint(x,g);m[A+"|image"]&&(d[c]&&d[c](D,I,J,i,Q.width,Q.height),this.fire("image",c,D,I,d,E,i,Q));for(var w,B=g.compInfos,O=d,e=B.length-1;e>=0;e--){var _=B[e],b=_.comp;i=this.convertPoint(x,_,O,b,J,I),Q=_.rect;var f=I._interactPrefix=_.prefix;
if(m[A+"|"+e]&&l[A+"|"+e]){var T=f&&I.a(f+c)||b[c];T&&(w=T.call(b,D,I,J,i,Q.width,Q.height)),this.fire("comp",c,D,I,d,b,i,Q)}if(w!==!0&&(d=Q.image)&&m[A+"|"+e+"|image"]&&(d[c]&&(w=d[c](D,I,J,i,Q.width,Q.height)),this.fire("image",c,D,I,d,E,i,Q)),I._interactPrefix=null,w===!0)break}}},initImageResource:function(){L.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(r,_){if(!r)return{x:1/0,y:1/0};var i=_.bodyInfo.rect,H=r.clone(),z=r.multiply({x:i.width,y:i.height});return z.local=H,z},convertPoint:function(o,G,R,n,j,y){var x=G.rect,v=G.matrix.applyInverse(o).sub(x),i=v.x>=0&&v.y>=0&&v.x<=x.width&&v.y<=x.height;if(!i)return v;if(n&&kh(n.pixelPerfect,y,j)){var x,K=1;this._is2d?(K=j.getZoom(),x=Yh(o.x,o.y,E,K)):x=Yh(o.x,o.y);var u=!1,$=x.x,T=x.y,h=x.width,O=x.height,F=L.hitMaxArea,m=h*O*K*K;if(m>F){var q=Math.sqrt(F/m);K*=q}h*=K,O*=K,2>h&&(h=2),2>O&&(O=2),$*=K,T*=K;var S=Mn(h,O),M=new Uo(0,-$,-T,K,K);M.append(G.matrix),j._drawForChecking=!0,n.transform=M;var C=R.fitSize;G.refRect&&G.refRect.fitSize?(n.refRect=G.refRect,R.fitSize=!0):R.fitSize=!1;var t=R.comps;R.comps=[n],Pi(S,R,0,0,h,O,y,self),R.comps=t,R.fitSize=C,delete n.refRect,delete n.unionRect,delete n.transform,j._drawForChecking=!1;try{for(var Q=0,U=S.getImageData(0,0,h,O).data;Q<U.length;Q+=4)if(0!==U[Q+3]){u=!0;break}S.restore()}catch(_){gr=f,u=!1}v.inRect=u}else v.inRect=!0;return v},getDataInfoAt:function(x,i){return Os.prototype.getDataInfoAt.call(this,x,i)}});var Rh=Gc.DefaultInteractor=function(U){Hm(Rh,this,[U])};Sc("DefaultInteractor",Oi,{handle_mousedown:function(g){Lk(g);var h=this,Q=h.gv,q=Q.getDataAt(g);if(Q.setFocus(g)&&!Q._editing&&!Q._scrolling){Md(g)?Q.handleDoubleClick(g,q):Q.handleClick(g,q);var P=Jl(g);!Xc()&&!P&&q&&(Q.isMovable(q)||Q._39Q(q))||!Q.isPannable()||!zj(g)&&!P||vf(g)||(h._tx=Q.tx(),h._ty=Q.ty(),h.startDragging(g))}},handleWindowMouseUp:function(_){var c=this,b=c.gv;b._panning&&(delete b._panning,b.onPanEnded(),c.fi({kind:"endPan",event:_})),delete c._tx,delete c._ty,c.clearDragging()},handle_mousemove:function(l){var K=this,W=K.gv;K._hoverTimer&&(Zh(K._hoverTimer),delete K._hoverTimer),K._hoverTimer=On(function(){K.fi({kind:"hover",event:l}),Zh(K._hoverTimer),delete K._hoverTimer},W.getHoverDelay()||L.hoverDelay)},handle_mouseleave:function(){var m=this;m._hoverTimer&&(Zh(m._hoverTimer),delete m._hoverTimer)},handleWindowMouseMove:function(b){var Y=this,z=Y.gv;Y.fi({kind:z._panning?"betweenPan":"beginPan",event:b}),z._panning=1;var J=dc(z,b,Y._lastClientPoint);z.setTranslate(Y._tx+J.x,Y._ty+J.y)},handle_mousewheel:function($){this.gv.handleScroll($,$.wheelDelta)},handle_DOMMouseScroll:function(x){2===x.axis&&this.gv.handleScroll(x,-x.detail)},handle_keydown:function(S){this.gv.handleKeyDown(S)}});var wp=Gc.SelectInteractor=function(F){Hm(wp,this,[F])};Sc("SelectInteractor",Oi,{_42:function(){var k=this,J=k.gv,R=J.getZoom(),w=k.mark,D=k.div;D||(D=k.div=Rq(),Zg(k.getView(),D));var N={};N.x=w.x*R+J.tx(),N.y=w.y*R+J.ty(),N.width=w.width*R,N.height=w.height*R,kq(D,N),this.intersects()?(D.style.border="",D.style.background=J.getRectSelectBackground()):(D.style.background="",D.style.border="1px solid "+J.getRectSelectBorderColor())},handle_mousedown:function(i){var _=this,y=_.gv;if(_._57I=f,_.pendingClickThrough=f,!(y._editing||y._scrolling||Xc()||Jl(i))){var $=y.getDataAt(i),I=y.sm();$?vf(i)?I.co($)?I.rs($):I.as($):I.co($)?$ instanceof If&&$.isClickThroughEnabled()&&zj(i)&&(_.pendingClickThrough=dg(i)):I.ss($):vf(i)||!y.isPannable()?zj(i)&&(vf(i)||I.cs(),y.isRectSelectable()&&(_.startDragging(i),y._77O=1)):zj(i)&&(_._57I=dg(i))}},handle_mouseup:function(G){var l=this,T=l.gv,P=l._57I;if(P&&(Mp(P,dg(G))<=1&&T.sm().cs(),l._57I=f),l.pendingClickThrough){if(Mp(l.pendingClickThrough,dg(G))<=1){var A=T.getDataAt(G);if(A instanceof If&&A.isClickThroughEnabled()){var B=T.getDataAt(G,function(o){var a=o.getParent()===A&&T.isSelectable(o,!0);return a});B&&(G.clickThrough=!0,T.sm().ss(B))}}l.pendingClickThrough=f}},handleWindowMouseUp:function(w){this.clear(w)},handleWindowMouseMove:function(K){var Q=this,m=Q.gv;Q._logicalPoint=m.lp(K),Q.mark?(Q.fi({kind:"betweenRectSelect",event:K}),m.isPannable()&&Q.autoScroll(K),Q.redraw()):Q.fi({kind:"beginRectSelect",event:K}),Q.mark=Db(Q._lastLogicalPoint,Q._logicalPoint),Q.redraw()},intersects:function(){var G=this,P=G._lastLogicalPoint,U=G._logicalPoint;return P.x>U.x||P.y>U.y},clear:function(Z){var U=this,K=U.gv,q=U.mark;if(U._57I=f,U.pendingClickThrough=f,U._lastLogicalPoint){if(q){if(0!==q.width&&0!==q.height){var w=K.getDatasInRect(q,U.intersects());if(!w.isEmpty()){var Q=K.sm(),p=Q.toSelection(),G=An(Z),N=Z.altKey;w.each(function(K){Q.co(K)?(!G||G&&N)&&p.remove(K):(!N||G&&N)&&p.add(K)}),Q.ss(p)}}bn(U.div),delete U.div,delete U.mark,U.redraw(),U.fi({kind:"endRectSelect",event:Z}),K.onRectSelectEnded()}U.clearDragging(),delete K._77O}},redraw:function(){var T=this;T._draw||(T._draw=1,On(function(){T.mark&&T._42(),delete T._draw},16))}});var yn=Gc.MoveInteractor=function(f){Hm(yn,this,[f])};Sc("MoveInteractor",Oi,{handle_mousedown:function(d){var Q=this,b=Q.gv;if(zj(d)&&!b._editing&&!b._scrolling&&!Xc()){var Y=b.getSelectedDataAt(d);!Y||b._39Q(Y)&&!b.isMovable(Y)?b._focusData=f:(Q._data=Y,b.handleMouseDown&&b.handleMouseDown(d,Y),Q.startDragging(d),b.isMovable(Y)&&(b._moving=1))}},handleWindowMouseUp:function(O){var V=this,U=V.gv;U.handleMouseUp&&U.handleMouseUp(O,V._data),V.clear(O)},handleWindowMouseMove:function(M){var E=this,h=E._data,s=E.gv;if((!s._93O||!s._93O(M,h))&&s._moving){E._logicalPoint||E.fi({kind:"prepareMove",event:M});var w=E._logicalPoint?"betweenMove":"beginMove",H={kind:w,event:M},n=E._logicalPoint=s.lp(M);"beginMove"!==w||E._alreadyBeginTransaction||(E._alreadyBeginTransaction=!0,s.getDataModel().beginTransaction());var j=E._calcShift(w,M),p=j.x,S=j.y,q=E.gv.getMoveMode(M,h);q&&("x"===q?S=0:"y"===q?p=0:"xy"!==q&&(p=S=0)),s.moveSelection(p,S),E._lastLogicalPoint=n,E.autoScroll(M),E.fi(H)}},_calcShift:function(){var y=this,c=y._logicalPoint,F=y._lastLogicalPoint,R=c.x-F.x,X=c.y-F.y;return{x:R,y:X}},clear:function(A){var q=this,n=q.gv;q._lastLogicalPoint&&(q._lastLogicalPoint=q._data=n._moving=f,q._logicalPoint&&(q.fi({kind:"endMove",event:A}),n.onMoveEnded()),q.clearDragging()),q._alreadyBeginTransaction&&(q._alreadyBeginTransaction=!1,n.getDataModel().endTransaction())}});var hc=Gc.TextEditInteractor=function(_){Hm(hc,this,[_]),this.init()};Sc("TextEditInteractor",Oi,{setUp:function(){var h=this;hc.superClass.setUp.call(h),h.gv.mp(h.handleGvPropertyChange,h)},teatDown:function(){var h=this;hc.superClass.teatDown.call(h),h.gv.ump(h.handleGvPropertyChange,h)},handleGvPropertyChange:function(){this._editTarget&&this.endTextEdit()},init:function(){var u=this,N=this.input=Y.createElement("input"),i=N.style;N.text="text",i.border="1px solid #d8d8d8",i.position="absolute",i.padding="2px 3px",i.outline="none",i.marginLeft="-90px",i.marginTop="-16px",i.backgroundColor="rgba(255,255,255, 1)",i.fontSize="14px",i.width="180px",i.height="32px",i.boxShadow="0 0 13px rgba(16,142,233, 0.5)",i.textAlign="center",i.boxSizing="border-box",w(N,"keyup",function(R){return Ll(R)&&u.endTextEdit(),le(R)?(u.endTextEdit(!0),void 0):void 0}),w(N,"focus",function(){N.select()});var $=this.textarea=Y.createElement("textarea"),q=this.wrap=Y.createElement("div");q.appendChild($),i=$.style,i.margin=0,i.padding="4px",i.overflow="hidden",i.boxSizing="border-box",i.position="absolute",i.outline="none",i.backgroundColor="transparent",i.resize="none",i.textAlign="center",i.fontSize="14px",i.borderWidth=0,i.width="100%",i=q.style,i.boxSizing="border-box",i.margin=0,i.padding=0,i.position="absolute",i.boxShadow="0 0 13px rgba(16,142,233, 0.5)",i.border="1px solid #d8d8d8",i.backgroundColor="rgba(255,255,255, 1)",i.zIndex="10",w($,"keydown",function(P){return(An()||vf())&&Ll(P)?(u.endTextEdit(),void 0):le(P)?(u.endTextEdit(!0),void 0):(u._editTarget instanceof ns||u.calculateTextareaHeight(String.fromCharCode(P.keyCode)),void 0)}),w($,"focus",function(){$.select()});var b=function(J){J.stopPropagation()};w(N,"mousedown",b),w(N,"touchstart",b),w($,"mousedown",b),w($,"touchstart",b),w($,"click",b),u.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],u.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",u.handleWindowClick=function(V){var E=u._editingDOM;if(E){var $=E.getBoundingClientRect(),Q=dg(V);Sj($,Q)||u.endTextEdit()}}},handle_mousedown:function(y){var f=this,H=f.gv;if(Md(y)&&!H._editing){var M=H.getDataAt(y);if(M){var c=H.getTextEditInfo(M);c&&(this._editInfo=c,this._editTarget=M,H._editing=!0,c.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var H=this,G=H.gv,o=H._editTarget,B=H.getTargetValue(),v=H.textarea,W=H.wrap,K=this._editInfo;this.hiddenTextarea||this.createHiddenTextarea(),(null===B||B===E)&&(B=""),v.value=B,K.font&&(v.style.font=K.font),H._editingDOM=v,G.appendHTML(W),this.layoutHTML(W,o),o instanceof ns?v.style.height="100%":(v.style.height="auto",this.calculateTextareaHeight()),On(function(){v.focus(),w(u,"mousedown",H.handleWindowClick),w(u,"touchstart",H.handleWindowClick)},10)},handleTextEdit:function(){var M=this,s=M.gv,U=M._editTarget,_=M.getTargetValue(),z=M.input;(null===_||_===E)&&(_=""),z.value=_,M._editingDOM=z,s.getView().appendChild(z),this.layoutHTML(z,U),On(function(){z.focus(),w(u,"mousedown",M.handleWindowClick),w(u,"touchstart",M.handleWindowClick)},10)},layoutHTML:function(U,s){var l=this.gv,z=l.getZoom();if(s instanceof ns){var d=l.getDataUI(s),g=d._6I,E=s.getScale(),h=U.style;U.style.left=g.x*z+l.tx()+"px",U.style.top=g.y*z+l.ty()+"px",U.style.width=d._6I.width+"px",U.style.height=d._6I.height+"px",no(h,"transform","scale("+z*E.x+","+z*E.y+")"),no(h,"transformOrigin","0px 0px")}else if(s instanceof jh){var g=s.getRect(),R=g.width*z;U.style.left=(g.x+g.width/2)*z+l.tx()+"px",U.style.top=(g.y+g.height/2)*z+l.ty()+"px",U.style.width=R+"px",U.style.marginLeft=-R/2+"px"}else if(s instanceof H.Edge){var d=l.getDataUI(s),g=d._6I;U.style.left=(g.x+g.width/2)*z+l.tx()+"px",U.style.top=(g.y+g.height/2)*z+l.ty()+"px"}},endTextEdit:function(U){var D=this,Y=D._editInfo.isMultiline?D.wrap:D.input,A=D._editInfo.isMultiline?D.textarea:D.input;U||D.setTargetValue(A.value),D.gv.getView().removeChild(Y),D.gv._editing=!1,delete D._editingDOM,delete D._editTarget,x(u,"mousedown",D.handleWindowClick),x(u,"touchstart",D.handleWindowClick)},setTargetValue:function(f){var e=this,t=e._editTarget,X=e._editInfo,d=X.accessType,D=X.name;if(D&&d||(d="p",D="name"),"p"===d){var E=H.Default.setter(D);t[E](f)}else"a"===d?t.a(D,f):t.s(D,f)},getTargetValue:function(){var s=this,m=s._editTarget,n=s._editInfo,V=n.accessType,O=n.name;if(O&&V||(V="p",O="name"),"p"===V){var g=H.Default.getter(O);return m[g]()}return"a"===V?m.a(O):m.s(O)},createHiddenTextarea:function(){this.hiddenTextarea=Y.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;pointer-events: none;opacity:0;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function($,l){if(l&&this.computedStyleCache)return this.computedStyleCache;var q=this,G=u.getComputedStyle($),D=G.getPropertyValue("box-sizing")||G.getPropertyValue("-moz-box-sizing")||G.getPropertyValue("-webkit-box-sizing"),s=parseFloat(G.getPropertyValue("padding-bottom"))+parseFloat(G.getPropertyValue("padding-top")),T=parseFloat(G.getPropertyValue("border-bottom-width"))+parseFloat(G.getPropertyValue("border-top-width")),k=q.SIZING_STYLE.map(function(W){return W+":"+G.getPropertyValue(W)}).join(";"),W={sizingStyle:k,paddingSize:s,borderSize:T,boxSizing:D};return l&&(this.computedStyleCache=W),W},calculateTextareaHeight:function(U){U=U||"";var H=this,r=H.textarea,c=H.hiddenTextarea,R=H.wrap,u=32,o=H.calculateHTMLStyle(r,!1),F=o.paddingSize,l=o.borderSize,K=o.boxSizing,j=o.sizingStyle;c.setAttribute("style",j+";"+H.HIDDEN_TEXTAREA_STYLE),c.value=r.value+U;var W=c.scrollHeight;"border-box"===K?W+=l:"content-box"===K&&(W-=F),r.style.height=W+"px",R.style.height=Math.max(W,u)+"px",R.style.marginTop=W*-.5+"px"}});var Vk=Gc.ScrollBarInteractor=function(i){Hm(Vk,this,[i])};Sc("ScrollBarInteractor",Oi,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(U){var y=this.gv.getViewRect();return this._41o()&&(y.x+y.width-this.gv.lp(U).x)*this.gv.getZoom()<Qn},isH:function(K){var H=this.gv.getViewRect();return this._40o()&&(H.y+H.height-this.gv.lp(K).y)*this.gv.getZoom()<Qn},handle_mousemove:function(N){this.handle_touchmove(N)},handle_touchmove:function(B){if(!gk&&zj(B)&&this.gv.isScrollBarVisible()){var h=this,E=h.isV(B),S=h.isH(B);(E||S)&&h.gv.showScrollBar(),h.gv._scrolling=E||S}},handleWindowMouseUp:function(U){this.handleWindowTouchEnd(U)},handleWindowTouchEnd:function(Y){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=f,this.fi({kind:"endScroll",event:Y})},handle_mousedown:function(U){this.handle_touchstart(U)},handle_touchstart:function(V){var P=this;if(P.gv.setFocus(V),Lk(V),P.handle_touchmove(V),!(Ai(V)>1)&&P.gv._scrolling&&P.gv.isScrollBarVisible()){P._cp=dg(V),P._tx=P.gv.tx(),P._ty=P.gv.ty();var B=P.isV(V);P._state=B?"vScroll":"hScroll",bg(P,V),P.fi({kind:"beginScroll",event:V})}},handleWindowMouseMove:function(r){this.handleWindowTouchMove(r)},handleWindowTouchMove:function(j){var _=dg(j),n=this.gv.getViewRect(),T=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-_.y)*T.height/n.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-_.x)*T.width/n.width),this.fi({kind:"betweenScroll",event:j})}});var bf=Gc.TouchInteractor=function(r,X){X=X||{},X.selectable===E&&(X.selectable=!0),X.movable===E&&(X.movable=!0),X.pannable===E&&(X.pannable=!0),X.pinchable===E&&(X.pinchable=!0),X.editable===E&&(X.editable=!0),this.params=X,Hm(bf,this,[r])};Sc("TouchInteractor",Oi,{ms_edit:1,setUp:function(){var T=this;bf.superClass.setUp.call(T),dn&&T.params.editable&&T.gv.setEditInteractor(T)},tearDown:function(){var s=this;bf.superClass.tearDown.call(s),dn&&s.params.editable&&s.gv.setEditInteractor(f)},clear:function(i){var y=this,Z=y.gv;Z._moving&&(y.fi({kind:"endMove",event:i}),delete Z._moving,Z.onMoveEnded(),Z.dm().endTransaction()),Z._panning&&(y.fi({kind:"endPan",event:i}),delete Z._panning,Z.onPanEnded()),Z._pinching&&(y.fi({kind:"endPinch",event:i}),delete Z._pinching,Z.onPinchEnded()),Z._editing&&(y._46O(i),y._77I=y._node=y._edge=y._shape=y._rect=y._89I=y._index=Z._editing=f),y.pendingClickThrough=y._moving=y._panning=y._pinching=y._editing=y._57I=y._data=y._beginHistory=f,y.clearDragging()},handle_touchstart:function(L){var m=this;if(!m.gv._editing){Lk(L),m._57I=f,m.pendingClickThrough=f;var W=m.params,R=m.gv,x=R.sm(),M=R.getDataAt(L),k=Ai(L);if(1===k){if(Md(L))return R.handleDoubleClick(L,M),void 0;R.handleClick(L,M),M&&(R.handleMouseDown&&R.handleMouseDown(L,M),m._data=M),W.selectable||(M=f),M&&(x.co(M)?M instanceof If&&M.isClickThroughEnabled()&&(m.pendingClickThrough=dg(L)):x.ss(M),W.editable&&R.isEditable(M)&&m._79I(L,M,!0)?(m._editing=1,m.startDragging(L)):W.movable&&R.isMovable(M)&&(m._moving=1,m.startDragging(L))),M&&(R.isMovable(M)||R._39Q(M))||(m._57I=dg(L),W.pannable&&R.isPannable()&&(m._panning=1,m.startDragging(L),m._translate={x:R.tx(),y:R.ty()}))}else if(W.pinchable&&2===k){if(!R.getEditInteractor()&&M){var p=mr(R.getImage(M));if(p&&kh(p.scrollable,M,this))return}m._pinching=1,m.startDragging(L);var N=R.getView(),i=R.getZoom(),D=N.getBoundingClientRect(),q=L.touches[0],I=L.touches[1],o={x:(q.clientX+I.clientX)/2-D.left,y:(q.clientY+I.clientY)/2-D.top};o.x-=R.tx(),o.y-=R.ty(),o.x/=i,o.y/=i,m._p=o,m._d=Zb(L)}}},handle_touchend:function(Q){var Y=this,$=Y.gv,c=Y._57I,U=Y._data;if(c&&(Mp(c,dg(Q))<=1&&!$.getDataAt(Q)&&$.sm().cs(),Y._57I=f),U&&$.handleMouseUp&&$.handleMouseUp(Q,U),Y.pendingClickThrough){if(Mp(Y.pendingClickThrough,dg(Q))<=1){var U=$.getDataAt(Q);if(U instanceof If&&U.isClickThroughEnabled()){var Z=$.getDataAt(Q,function(F){var Y=F.getParent()===U&&$.isSelectable(F,!0);return Y});Z&&(Q.clickThrough=!0,$.sm().ss(Z))}}Y.pendingClickThrough=f}},handleWindowTouchEnd:function(N){this.clear(N)},handleWindowTouchMove:function(D){var U=this,r=U.gv,w=Ai(D);if(1===w){var y=dg(D),M=dc(r,y,U._lastClientPoint),o=Mp({x:0,y:0},M);if(U._editing&&(U._beginHistory||(U._beginHistory=1,r.dm().beginTransaction()),r._editing=1,U._78I(D)),U._moving){if(!r._moving&&o<L.touchMoveThreshold)return;U._beginHistory||(U._beginHistory=1,r.dm().beginTransaction()),U.handleMove(D)}else if(U._panning){if(!r._panning&&o<L.touchMoveThreshold)return;r.setTranslate(U._translate.x+M.x,U._translate.y+M.y),U.fi({kind:r._panning?"betweenPan":"beginPan",event:D}),r._panning=1}}else if(2===w&&U._pinching){var E=Zb(D);r.handlePinch(U._p,E,U._d),U._d=E,U.fi({kind:r._pinching?"betweenPinch":"beginPinch",event:D}),r._pinching=1}},handleMove:function(v){var J=this,W=J.gv,G=W.lp(v);W._93O&&W._93O(v,J._data)||(W.moveSelection(G.x-J._lastLogicalPoint.x,G.y-J._lastLogicalPoint.y),J._lastLogicalPoint=G,J.autoScroll(v),J.fi({kind:W._moving?"betweenMove":"beginMove",event:v}),W._moving=1)}});var H=u.ht,al=H.graph._editor={Math:H.Math,Guide:{}};al.getStyle=function(D){var o,w=al.StyleMap;return w&&(o=w[D],o!==E)?o:al.DefaultStyleMap[D]},al.setStyle=function(V,e){var Z=al.StyleMap;Z||(Z=al.StyleMap={}),Z[V]=e},al.inEdit=function(b){return b._inXEdit===!0},al.startEdit=function(p){p._inXEdit=!0,al.Inject.doInject(p)},al._46O=function(X){X._inXEdit=!1,al.Inject.undoInject(X)},al.toScreenPosition=function(j,J){var E=j.tx(),W=j.ty(),r=j._zoom;return new al.Math.Vector2(J.x*r+E,J.y*r+W)},al.checkHit=function(B,J,_){return B.distanceTo(J)<_?!0:!1},al.toWorldPosition=function(e,R){var U=e.tx(),w=e.ty(),$=e._zoom;return{x:(R.x-U)/$,y:(R.y-w)/$}},al.setAntialias=function(A,F){for(var J,l=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],z=0,v=l.length;v>z&&(J=l[z],!(J in A));z++);A[J],A[J]=F},al.getTargetCornersOnScreen=function(m,g){if(!g)return null;var V,k=[];if(vc(g,m)){var w=Cc(m,g);V=[{x:w.x,y:w.y},{x:w.x+w.width,y:w.y},{x:w.x+w.width,y:w.y+w.height},{x:w.x,y:w.y+w.height}]}else{if(!g.getCorners)return null;V=g.getCorners()}return V.forEach(function(V){var H=al.toScreenPosition(m,V);k.push(H.x,H.y)}),k},al.log=function(){};var ud;al.updateTipInfo=function(q,U,x){if(x){var y=H.Default.getLogicalPoint(q,U._canvas);y.x+=al.Icons.TipShiftX,y.y+=al.Icons.TipShiftY,ud={helperPos:y,text:x,size:x.length}}else ud=f},al.drawTip=function(h,b){ud&&al.Icons.DrawIcon(b,h,al.Icons.TipHelper,ud)};var ri=al.Inject={_modules:[]};ri.registAsModule=function(z,Q){var W={},u={};for(var V in z){var X=Q.prototype[V];W[V]=X}z.getBackup=function(N){return W[N]},z.getBackups=function(){return W},u.doInject=function(){for(var n in z)"getBackup"!==n&&(Q.prototype[n]=z[n])},u.undoInject=function(){for(var Z in z)"getBackup"!==Z&&(Q.prototype[Z]=W[Z])},ri._modules.push(u)},ri.doInject=function(O){for(var X,x=ri._modules,f=0,F=x.length;F>f;f++)X=x[f],X.doInject(O)},ri.undoInject=function(D){for(var q,G=ri._modules,O=0,R=G.length;R>O;O++)q=G[O],q.undoInject(D)};var Oi=H.graph.EditInteractor=function(a){var N=this,f=Y.createElement("canvas");f.className="editCanvas",f.style.position="absolute",N._uuid=H.Math.generateUUID(),N._styleMap={},N._canvas=f,N._context=f.getContext("2d"),Oi.superClass.constructor.call(N,a),this._editDetail=!1,al.setAntialias(N._context,!1),N._subModules=N.initSubModule(),N._gridGuide=new al.Guide.Grid(N),N._rectGuide=new al.Guide.Rect(N),N._hoverGuide=new al.Guide.Hover(N)},ed=Oi;H.Default.def(Oi,H.graph.Interactor,{ms_edit:1,ms_fire:1}),b.defineProperties(Oi.prototype,{editDetail:{get:function(){var z=!!this._editDetail;return z},set:function(i){var T=this,b=T._editDetail;b!==i&&(T._editDetail=i,T.gv._editing=i,T.fp("editDetail",b,i),T.fp("pointsEditingMode",b,i),T.fi({kind:i?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(R){(!this._editDetail||R)&&(this.gv._editing=R,R||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(G){this._editing=G,this.gvEditing=G}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(v){var O=this;O.editDetail!==v&&(v?O._tryEnterEditDetailMode():O._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var q=this._gridEnabled;if(!q)return!1;var d=this.gv;return d?!0:!0},set:function(i){i!==this._gridEnabled&&(this._gridEnabled=i,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(A){A!==this._agEnabled&&(this._agEnabled=A,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),Oi.prototype.initSubModule=function(){var C=this;return[new al.Anchor(C),new al.RotateX(C),new al.MoveDummy(C),new al.Rect(C),new al.Curve(C),new al.MoveHelper(C)]},Oi.prototype.getSubModule=function(W){var j,f,P,E=this._subModules;for(f=0,P=E.length;P>f;f++)if(j=E[f],j.catalog===W)return j},Oi.prototype.invokeSubModule=function(e,j){for(var T,Q,y,t=this,o=t._subModules,i=Array.prototype.slice.call(arguments,2),L=0,g=o.length;g>L;L++)if(T=o[L],Q=T[e],Q&&(y=Q.apply(T,i),y!=E&&j))return T},Oi.prototype.invokeSubModuleInverse=function(f,v){var L=this,R=L._subModules;if(R)for(var n,c,H,W=Array.prototype.slice.call(arguments,2),h=R.length-1;h>=0;h--)if(n=R[h],c=n[f],c&&(H=c.apply(n,W),H!=E&&v))return n},Oi.prototype.setUp=function(){al.log("setUp");var C=this,u=C.gv,l=u.getView(),k=C._canvas;Oi.superClass.setUp.call(C),u.setEditInteractor(C),u._79O?l.insertBefore(k,u._79O):l.appendChild(k),al.startEdit(u),C.invokeSubModule("setUp"),u.dm().mm(C._onDataModelChanged,C),u.dm().md(C._onDataPropertyChanged,C)},Oi.prototype.tearDown=function(){al.log("tearDown");var l=this,w=l.gv,$=w.getView();l._resetCustomCursorStyle(),Oi.superClass.tearDown.call(l),w.dm().umm(l._onDataModelChanged,l),w.dm().umd(l._onDataPropertyChanged,l),w.setEditInteractor(null),$.removeChild(l._canvas),l._drawTimer&&(Zh(l._drawTimer),l._drawTimer=null),al._46O(w),l.invokeSubModule("tearDown")},Oi.prototype._onDataModelChanged=function(M){var l=this;("clear"===M.kind||"remove"===M.kind&&l.editDetail&&M.data===l.getSubModule("Curve").target)&&(l.editDetail=!1,l._42())},Oi.prototype._onDataPropertyChanged=function(i){var j=this;if(j.editDetail){var L=j.getSubModule("Curve"),M=i.data;M===L.target&&(M._writing||L._handleDataChanged(i))}},Oi.prototype.clear=function(){al.log("clear")},Oi.prototype.redraw=function(){this._42()},Oi.prototype._42=function(){var $=this;$._drawTimer||($._drawTimer=On(function(){$._drawTimer=null,$.drawImpl()},0))},Oi.prototype.drawImpl=function(){var l;for(l in{_42:!0})break;return function(){var $=this,g=$._canvas,a=$.gv,O=a.getWidth(),j=a.getHeight(),h=$._context,_=H.Default.getInternal(),q=L.devicePixelRatio;(g.width!==O||g.height!==j)&&_.setCanvas(g,O,j,q),h.clearRect(0,0,g.width,g.height);var U=$._getValidSelection();h.save(),h.scale(q,q),$._gridGuide._42(),$.invokeSubModuleInverse(l,!1,h,a,U),$._rectGuide._42(),$._hoverGuide._42(),h.restore()}}(),Oi.prototype._getValidSelection=function(){var F=this,V=F.gv,E=V.sm().getSelection(),k=[];return E.each(function(s){V.isVisible(s)&&V.isEditable(s)&&k.push(s)}),k},Oi.prototype.handle_touchmove=function(e){return this.handle_mousemove(e)},Oi.prototype.handle_mousemove=function(d){if(!H.Default.isDragging()){var B=this;if((B.editDetail||!Xc()&&!Jl(d))&&!B.gv._externalEditing){if(B.gvEditing=!1,B._checkEdit(d))B.gvEditing=!0;else{if(!B.getStyle("hoverGuideVisible"))return;B.hoverData=B.gv.getDataAt(d)}B._42()}}},Oi.prototype.handle_touchstart=function(F){return this.handle_mousedown(F)},Oi.prototype.handle_mousedown=function(s){Lk(s);var O=this;if((O.editDetail||!Xc()&&!Jl(s))&&!O.gv._externalEditing){if(Md(s)&&!s.clickThrough){if(O.editDetail){if(O._tryQuitEditDetailMode(s))return}else if(O._tryEnterEditDetailMode())return;O.gv.dm().beginTransaction();var D=O.invokeSubModule("handleDoubleClick",!0,s);if(O.gv.dm().endTransaction(),D)return}var a=O._checkEdit(s);a&&(O._downPosition=O._getLogicalPoint(s),O.gv.dm().beginTransaction(),a.startEdit(O,s),O.editing=!0)}},Oi.prototype._checkEdit=function(x){var o=this,t=o.gv,N=o._getLogicalPoint(x),T=o.invokeSubModule("check",!0,t,x,N)||null;return o._editMod=T,T},Oi.prototype.handleWindowTouchMove=function(f){return this.handleWindowMouseMove(f)},Oi.prototype.handleWindowMouseMove=function(i){var H=this,q=H._downPosition;if(q){var N=H._getLogicalPoint(i);if(N.distanceTo(q)<H.getStyle("moveSensitivity"))return;delete H._downPosition}var f=H._editMod;f&&f.handleEdit(H.gv,i),H.redraw()},Oi.prototype._getLogicalPoint=function(Q){var D=this,u=H.Default.getLogicalPoint(Q,D._canvas);return new al.Math.Vector2(u)},Oi.prototype.handleWindowTouchEnd=function(L){return this.handleWindowMouseUp(L)},Oi.prototype.handleWindowMouseUp=function(){var T;for(T in{_46O:!0})break;return function(k){var V=this;V.editing=!1,V.setCursor("default"),V.invokeSubModule(T,!1,k),V._42(),V.gv.dm().endTransaction()}}(),Oi.prototype.handle_mousewheel=function(m){var u=this;Lk(m),u.invokeSubModule("preHandleScroll",!0)||u.gv.handleScroll(m,m.wheelDelta)},Oi.prototype.handleDelete=function(){var p=this;if(!p.editDetail){p.gv.dm().beginTransaction();var d=p.invokeSubModule("handleNormalStateDelete",!0);return p.gv.dm().endTransaction(),d||p.gv.removeSelection(),void 0}p.gv.dm().beginTransaction(),p.invokeSubModule("handleDelete",!0),p.gv.dm().endTransaction(),p._42()},Oi.prototype.handle_keydown=function(M){var T=this;if((M.metaKey||M.ctrlKey)&&T._42(),Xc(M)&&!T.editing)return T.gvEditing=!1,T.setCursor("default"),T._42(),void 0;var b=Ll(M);return T.editDetail?((b||le(M))&&(T.editDetail=!1,T._42()),T.gv.dm().beginTransaction(),T.invokeSubModule("handle_keydown",!0,M),T.gv.dm().endTransaction(),void 0):(T.gv.dm().beginTransaction(),T.invokeSubModule("handleNormalStateKeyDown",!0,M),T.gv.dm().endTransaction(),b&&T._tryEnterEditDetailMode(),void 0)},Oi.prototype.handle_keyup=function(o){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,o),this.gv.dm().endTransaction()},Oi.prototype._tryEnterEditDetailMode=function(){var Q=this;return!Q.editDetail&&Q.invokeSubModule("canEnterEditDetailMode",!0)&&1===Q._getValidSelection().length?(Q.editDetail=!0,Q._42(),!0):void 0},Oi.prototype._tryQuitEditDetailMode=function(s){var M=this;return M.editDetail?!s||M.invokeSubModule("canQuitEditDetailMode",!0,s)?(M.editDetail=!1,M._42(),!0):!1:!1},Oi.prototype.setStyle=function(P,J,X){var S=this;X?al.setStyle(P,J):S._styleMap[P]=J,"baseColor"===P&&(pl=J),S.fp("styleChanged",null,{key:P,value:J,base:X}),S._42()},Oi.prototype.getStyle=function(u){var L=this,A=L._styleMap[u];return A!==E?A:al.getStyle(u)},Oi.prototype.setCursor=function(J){this._resetCustomCursorStyle(),H.graph.EditInteractor.superClass.setCursor.call(this,J)},Oi.prototype._drawHostGuide=function(A){var t=this,h=t._context,r=t.gv;al.Icons.DrawIcon(t,h,al.Icons.NodeHoverGuide,A.corners);var w=A.host;if(w){var d=r.getAttachPoints(w);if(d&&d.length)for(var b=0,G=d.length;G>b;b++){var i=d[b],W=$q(r,w,0,i.offsetX||0,i.offsetY||0,i.x,i.y);W=al.toScreenPosition(r,W),W.isAttach=A.attach===b,al.Icons.DrawIcon(t,h,al.Icons.AttachPoint,W)}}},Oi.prototype._resetCustomCursorStyle=function(){var D=this;if(D._customStyle){var t=this.gv.getView();t.classList&&t.classList.remove&&t.classList.remove(D._customStyle),D._customStyle=null}},Oi.prototype._setRotateCursor=function(s){var R=this,B=R._cursorFactory;B||(B=R._cursorFactory=new al.CursorFactory(R));var Y=B.getRotateCursor(s),y=R.gv.getView();R._resetCustomCursorStyle(),R._customStyle=Y,y.classList&&y.classList.add&&y.classList.add(Y)};var tp=al.Group=function(S){var V=this;V._entities=S,V._64O=0,V._position={x:0,y:0},V._scale={x:1,y:1},V._anchor={x:.5,y:.5},V._anchor2={x:.5,y:.5}};tp.prototype={},tp.prototype.constructor=tp;var Lr=null,hr=null;tp.findOrCreateGroup=function(s,D){if(hr===D&&Lr&&Lr.checkIsMe(s))return Lr;hr=D;var M=new al.Group(s);return M.getKeyOb()?(Lr=M,M):void 0},tp.prototype.checkIsMe=function(J){var F=this._entities;if(F.length!==J.length)return!1;var l,S={},E=J.length;for(l=0;E>l;l++)S[J[l]._id]=!0;for(l=0;E>l;l++)if(!S[F[l]._id])return!1;return!0},tp.prototype.getRotation=function(){return this._64O},tp.prototype.getPosition=function(){return this._position},tp.prototype.getAnchor=function(){return this._anchor},tp.prototype.getWidth=function(){return this._width},tp.prototype.getScale=function(){return this._scale},tp.prototype.getSize=function(){return{width:this._width,height:this._height}},tp.prototype.getHeight=function(){return this._height},tp.prototype.getKeyOb=function(){for(var H=this._entities,C=H.length-1;C>=0;C--){var y=H[C];if(this.isNode(y))return y}},tp.prototype.getAnchor2=function(){var g=this,P=g.rotateCenter;if(P)return P;var T=g.getKeyOb();if(!T)return g._anchor;var K=g._anchor2,F=T.getMatrix();return F.tf({x:T.getWidth()*(K.x-T.getAnchor().x),y:T.getHeight()*(K.y-T.getAnchor().y)})},tp.prototype.setAnchor2=function(B,g){var Z=this,G=Z.getKeyOb();if(G){var y,l=G.getMatrix();y="number"==typeof B?{x:B,y:g}:B;var m=l.tfi(y);Z._anchor2={x:G.getAnchor().x+m.x/G.getWidth(),y:G.getAnchor().y+m.y/G.getHeight()}}},tp.prototype.setRotation=function(){},tp.prototype.beginRotate=function(H){this.rotateCenter=H.pos,this.rotateMode=H.groupRotateMode},tp.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},tp.prototype.addRotation=function(y,g,Z){return"batch"===g?this._addRotationInBatchMode(y,Z):"block"===g?this._addRotationInBlockMode(y,Z):void 0},tp.prototype._addRotationInBlockMode=function(h,o){var H=this,S=H.rotateCenter||H.getPosition();H._entities.forEach(function(N){if(H.isNode(N)&&(!o||o(N))){var p=N.getMatrix();p.translate(-S.x,-S.y),p.rotate(h),p.translate(S.x,S.y);var A=Math.sign(N.getScale().x);N.setRotation(ts(p.b*A,p.a*A)),N.setPosition(p.tx,p.ty)}})},tp.prototype._addRotationInBatchMode=function(c,W){var t=this,N=t._anchor2;t._entities.forEach(function(J){if(t.isNode(J)&&(!W||W(J))){var i=J.getAnchor(),L=J.getMatrix(),X=L.tf({x:J.getWidth()*(N.x-i.x),y:J.getHeight()*(N.y-i.y)}),f=new al.Math.Matrix2d;f.set(L.a,L.b,L.c,L.d,L.tx,L.ty),f.translate(-X.x,-X.y),f.rotate(c),f.translate(X.x,X.y);var T=Math.sign(J.getScale().x);J.setRotation(ts(f.b*T,f.a*T)),J.setPosition(f.tx,f.ty)}})},tp.prototype.setPosition=function($){var I,j,D,J,x=this,w=x._position,P=$.x-w.x,o=$.y-w.y,R=x._entities;for(j=0,D=R.length;D>j;j++)I=R[j],mq(I)&&(J=I.getPosition(),I.setPosition(J.x+P,J.y+o));x._position=$},tp.prototype.setScale=function(g,W){var B=this,i=g/B._scale.x,Q=W/B._scale.y;B._adjustChildScaleOrSize(i,Q,"size"),B._scale={x:g,y:W}},tp.prototype.getRect=function(){var M=this,F=M._position,y=M._width,t=M._height;return{x:F.x-y/2,y:F.y-t/2,width:y,height:t}},tp.prototype.setSize=function(u,V){var s=this,u=Math.max(1,u),V=Math.max(1,V),E=u/s._width,B=V/s._height;
s._adjustChildScaleOrSize(E,B,"size"),s._width=u,s._height=V},tp.prototype._adjustChildScaleOrSize=function(W,s,r){var k,t,c,I,P,p,a,C,y,U,L,d,f,O,q=this,S=q._position,B=q._entities,v=new al.Math.Matrix2d;for(t=0,c=B.length;c>t;t++)if(k=B[t],q.isNode(k)){if(I=k.getPosition(),P=k.getRotation(),p=k.getWidth(),a=k.getHeight(),C=k.getScale(),L=C.x*p,d=C.y*a,v.identity().scale(L,d).rotate(P).translate(I.x,I.y).translate(-S.x,-S.y).rotate(-q._64O),P=ts(v.b*Math.sign(L),v.a*Math.sign(L)),v.scale(W,s),y=Math.cos(P),U=Math.sin(P),Math.abs(y)<.001?(f=v.b/U,O=-v.c/U):(f=v.a/y,O=v.d/y),"scale"===r)k.setScale(f/p,O/a);else if("size"===r){var x=f/C.x,u=O/C.y;k.setScale(Wd(f)*Math.abs(C.x),Wd(O)*Math.abs(C.y)),k.setSize(Math.max(.1,Math.abs(x)),Math.max(.1,Math.abs(u)))}v.rotate(q._64O).translate(S.x,S.y),k.setPosition(v.tx,v.ty)}},tp.prototype.getMatrix=function(){var x=this,v=x._position,C=H.Default.getInternal(),r=x._scale;return new C.Mat(x._64O,v.x,v.y,r.x,r.y)},tp.prototype.toGlobal=function(g){return this.getMatrix().tf(g)},tp.prototype.getCorners=function(){var A=this,X=A._width,h=A._height,r=A._anchor,R=-X*r.x,p=-h*r.y,k=A.getMatrix();return[k.tf(R,p),k.tf(R,p+h),k.tf(R+X,p+h),k.tf(R+X,p)]},tp.prototype.calcInfo=function(){var $,K,V,t,k,s,Z=this,f=[],y=Z._entities,m=Z._64O;for(t=0,k=y.length;k>t;t++)s=y[t],Z.isNode(s)&&s.getCorners&&f.push.apply(f,s.getCorners());if(f.length){var o=Math.cos(-m),n=Math.sin(-m),F=1/0,U=-1/0,w=1/0,u=-1/0;for(t=0,k=f.length;k>t;t++)V=f[t],$=V.x,K=V.y,V.x=o*$-n*K,V.y=n*$+o*K,F=Math.min(F,V.x),U=Math.max(U,V.x),w=Math.min(w,V.y),u=Math.max(u,V.y);Z._width=(U-F)/Z._scale.x,Z._height=(u-w)/Z._scale.y,o=Math.cos(m),n=Math.sin(m);var g=Z._anchor;$=F+(U-F)*g.x,K=w+(u-w)*g.y,Z._position={x:o*$-n*K,y:n*$+o*K}}},tp.prototype.isNode=function(w){return mq(w)?vc(w)?w.size()?!1:!0:!0:!1},tp.prototype._42=function(c,w,P){var X,V,n,I,L,v,x,E,o=this,q=o._entities,t=o.rotateMode;for("batch"===t&&(E=o.getKeyOb()),X=0,V=q.length;V>X;X++)n=q[X],o.isNode(n)&&(v=n.getRect(),I=al.toScreenPosition(P,{x:v.x,y:v.y}),L=al.toScreenPosition(P,{x:v.x+v.width,y:v.y+v.height}),x={min:I,max:L},n===E&&(x.isKeyOb=!0),al.Icons.DrawIcon(c,w,al.Icons.GroupSubEntityRect,x))};var Uk=al.CurveActiving=function(m,$){this._curve=m,this._interactor=m._interactor,this.silent=!0;for(var A in $)this[A]=$[A];delete this.silent};Uk.prototype={},Uk.prototype.constructor=Uk,b.defineProperties(Uk.prototype,{point:{get:function(){return this._point},set:function(j){var s=this;s._point=j,s.editingCtrl||s.silent||s._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(e){var V=this;V._pairs=e,V.editingCtrl&&!V.silent&&V._firePointChange()}}}),Uk.prototype._firePointChange=function(){var n=this,l=n.getCurrentEditingPoint(),s=n._interactor;if(!l)return s.fi({kind:"selectPoint"}),void 0;var f=this._curve.target;if(f){var y=al.getDataMatrix(f).invert(),S=l.e;l=y.apply(al.toWorldPosition(s.gv,l)),l.e=S;var K=n._lastFirePoint;K&&Math.abs(l.x-K.x)<1e-5&&Math.abs(l.y-K.y)<1e-5&&(l.e==E&&K.e==E||Math.abs(l.e-K.e)<1e-5)||(n._lastFirePoint=l,s.fi({kind:"selectPoint",x:l.x,y:l.y,e:l.e}))}},Uk.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Uk.prototype.getCurrentEditingPoint=function(){var c=this,M=c.editingCtrl;if(M){var A=c.pairs;if(A){var z=A[M.pairId];if(z){var i=z[M.type];if(i)return i}}}return c._point};var lm=al.CursorFactory=function(X){var b=this;b._interactor=X,b._rotateCursorStyles={}};lm.prototype={},lm.prototype.constructor=lm,lm.prototype.getRotateCursor=function(b){var P=this;0>b&&(b+=2*Math.PI);var N=P._interactor,e=N.getStyle("rotateCursorSize"),L=N.getStyle("rotateCursorRound"),r=Math.round(180*(b/Math.PI)/L);r*L>=360&&(r=0);var o=P._rotateCursorStyles,S="htCustomRotateStyle_"+e+"_"+L+"_"+r;return o[S]||(P._produceRotateCursor(S,e,L,r),o[S]=!0),S},lm.prototype._produceRotateCursor=function(I,e,X,l){var P=this;P._interactor;var n=P._canvas;n||(n=P._canvas=Y.createElement("canvas"));var g=L.devicePixelRatio;n.width=n.height=e*g,n.style.width=n.style.height=e+" px";var h=n.getContext("2d");al.setAntialias(h,!1),h.scale(g,g);var i,F,z,V,T,r=Math.round(e/2),b=""+r+" "+r+",auto !important;",m=4;i=Math.PI/180*l*X,h.clearRect(0,0,e,e),h.save(),h.scale(e/32,e/32),h.translate(16,15),h.rotate(i+Math.PI/2),h.beginPath(),h.moveTo(-8,0),h.lineTo(-8,m),h.lineTo(-8+m,m),h.moveTo(8,0),h.lineTo(8,m),h.lineTo(8-m,m),h.moveTo(-8,m),h.quadraticCurveTo(0,-6,8,m),h.restore(),h.lineCap="round",h.lineJoin="miter",h.strokeStyle="white",h.lineWidth=4,h.stroke(),h.strokeStyle="black",h.lineWidth=2,h.stroke(),F=JSON.stringify(n.toDataURL()),V="cursor:url("+F+")"+b,1!==g&&(z='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+e+'px" height="'+e+'px"><image xlink:href='+F+' width="'+e+'" height="'+e+'"/></svg>',V+="cursor:url(data:image/svg+xml;base64,"+btoa(z)+")"+b,V+="cursor:-webkit-image-set(url("+F+")"+g+"x,url("+F+")1x)"+b),T=Y.createElement("style"),T.textContent="body."+I+" *, ."+I+"{"+V+"}",Y.head.appendChild(T)};var nq=al.Guide.Grid=function(y){var Z=this;Z._interactor=y,Z._alignmentGuideId=0,Z._xAlignmentGuide=[],Z._yAlignmentGuide=[]};nq.prototype={},nq.prototype.constructor=nq,b.defineProperties(nq.prototype,{gridBlockSize:{get:function(){var V=this;return V._gridBlockSize||V._interactor.getStyle("gridBlockSize")},set:function(f){this._gridBlockSize=f,this._interactor._42()}},gridThickLinesEvery:{get:function(){var n=this;return n._gridThickLinesEvery||n._interactor.getStyle("gridThickLinesEvery")},set:function(x){this._gridThickLinesEvery=x,this._interactor._42()}},gridEnabled:{get:function(){var w=this,A=w._interactor;return A.gridEnabled&&w.isValidGrid()}}}),nq.prototype._42=function(){var Q=this,c=Q._interactor;Q.gridEnabled&&Q.drawGrid(),c.alignmentGuideEnabled&&Q.drawAlignmentGuide()},nq.prototype.makeMatrix=function(){var b=this,J=b._interactor.getStyle("gridAngle"),y=b._interactor.getStyle("gridRotation"),$=new al.Math.Matrix2d,k=Math.sin(J),r=Math.cos(J);return $.set(1,0,r,k,0,0),$.rotate(y),$},nq.prototype.isValidGrid=function(){var F=this,J=Math.PI,U=F._interactor,I=U.gv;if(I._zoom<U.getStyle("gridZoomThreshold"))return!1;var K=U.getStyle("gridAngle"),i=Math.abs(180*(K%J/J)),d=1-1e-8;return d>i||i>180-d?!1:!0},nq.prototype.drawAlignmentGuide=function(){var b=this,f=b._interactor,E=f.gv,d=f._canvas,D=f._context,N=d.width,k=d.height,r=E.tx(),w=E.ty(),_=E._zoom;D.beginPath(),D.strokeStyle=f.getStyle("gridAlignmentGuideColor"),D.lineWidth=1,b._xAlignmentGuide.forEach(function(N){var p=N.p*_+r;D.moveTo(p,0),D.lineTo(p,k)}),b._yAlignmentGuide.forEach(function(P){var E=P.p*_+w;D.moveTo(0,E),D.lineTo(N,E)}),D.stroke()},nq.prototype.drawGrid=function(){function y(F,s,Y,B){var q=al.toScreenPosition(e,U.apply({x:F,y:s})),P=al.toScreenPosition(e,U.apply({x:Y,y:B}));t.moveTo(q.x,q.y),t.lineTo(P.x,P.y)}var o=this,l=o._interactor,n=o.gridBlockSize,O=o.gridThickLinesEvery,M=l.getStyle("gridThickColor"),c=l.getStyle("gridLightColor"),e=l.gv,D=l._canvas,t=l._context,P=D.width,S=D.height,U=o.makeMatrix(),a=U.applyInverse(al.toWorldPosition(e,{x:0,y:0})),q=U.applyInverse(al.toWorldPosition(e,{x:P,y:0})),A=U.applyInverse(al.toWorldPosition(e,{x:0,y:S})),C=U.applyInverse(al.toWorldPosition(e,{x:P,y:S})),d=Math.min(a.x,q.x,A.x,C.x),Q=Math.max(a.x,q.x,A.x,C.x),W=Math.min(a.y,q.y,A.y,C.y),k=Math.max(a.y,q.y,A.y,C.y);P=Q-d,S=k-W;var N=Math.ceil(d/n),E=Math.floor(Q/n),R=Math.ceil(W/n),j=Math.floor(k/n);e.tx(),e.ty(),e._zoom;var J,p,K;for(t.save(),t.lineWidth=1,t.beginPath(),t.strokeStyle=M,K=Math.ceil(N/O)*O;E>=K;K+=O)J=K*n,y(J,W,J,k);for(K=Math.ceil(R/O)*O;j>=K;K+=O)p=K*n,y(d,p,Q,p);for(t.stroke(),t.beginPath(),t.strokeStyle=c,K=N;E>=K;K++)0!==K%O&&(J=K*n,y(J,W,J,k));for(K=R;j>=K;K++)0!==K%O&&(p=K*n,y(d,p,Q,p));t.stroke(),t.restore()},nq.prototype.getAlignmentGuides=function(){var s=this;return{x:s._xAlignmentGuide,y:s._yAlignmentGuide}},nq.prototype.addAlignmentGuide=function(k,t,l){var S=this,c="x"===k?S._xAlignmentGuide:S._yAlignmentGuide,l=l?l:++S._alignmentGuideId,x={p:t,id:l};if(c.length){var L=S._findClosestAlignmentGuide(x.p,c);L.dis<0?c.splice(L.index+1,0,x):c.splice(L.index,0,x)}else c.push(x);return S._interactor._42(),l},nq.prototype.findClosest=function(t,n,e){var A=this,F=A._interactor,D=F.gv;e&&(t=al.toWorldPosition(D,t));var g,R,B,T=1/0,j=1/0,z=t.x,H=t.y;if(A.gridEnabled){var J=A.gridBlockSize,K=A.makeMatrix(),O=K.applyInverse(t);O=K.apply({x:Math.round(O.x/J)*J,y:Math.round(O.y/J)*J}),T=O.x-z,j=O.y-H,B=!0}if(F.alignmentGuideEnabled&&(g=A._findClosestAlignmentGuide(z,A._xAlignmentGuide).dis,R=A._findClosestAlignmentGuide(H,A._yAlignmentGuide).dis,Math.abs(g)<Math.abs(T)&&(T=g,B=!0),Math.abs(R)<Math.abs(j)&&(j=R,B=!0)),B){B=!1;var G=D._zoom,l=F.getStyle("smartGuideThreshold")/G,P={};if(Math.abs(T)<l&&"y"!==n&&(P.x=e?T*G:T,B=!0),Math.abs(j)<l&&"x"!==n&&(P.y=e?j*G:j,B=!0),B)return P}},nq.prototype._findClosestAlignmentGuide=function(n,N){if(!N.length)return{dis:1/0};for(var P,b=0,F=N.length-1;F-b>1;)P=Math.floor((b+F)/2),N[P].p<n?b=P:F=P;var o=N[b].p-n,U=N[F].p-n;return Math.abs(o)<=Math.abs(U)?{line:N[b],dis:o,index:b}:{line:N[F],dis:U,index:F}},nq.prototype.removeAllAlignmentGuide=function(H){var y=this;"y"!==H&&(y._xAlignmentGuide=[]),"x"!==H&&(y._yAlignmentGuide=[]),y._interactor._42()},nq.prototype.removeAlignmentGuide=function(Y){for(var C,I,g,b=this,S=b._xAlignmentGuide,y=0;2>y;y++)for(S=0===y?b._xAlignmentGuide:b._yAlignmentGuide,C=0,I=S.length;I>C;C++)if(g=S[C],g.id===Y)return S.splice(C,1),b._interactor._42(),{axis:0===y?"x":"y",position:g.p};return!1},nq.prototype.adjustAlignmentGuide=function(j,x){var T=this,k=T.removeAlignmentGuide(j);return k?(T.addAlignmentGuide(k.axis,x,j),!0):!1};var Ph=al.Guide.Rect=function(f){var V=this;V._interactor=f};Ph.prototype={},Ph.prototype.constructor=Ph,Ph.prototype.gatherRects=function(){var z,g,x,l,t=this,N=t._interactor.gv,w=[],e=[],W={x:w,y:e},o={},T=N.getDataModel(),y=T.a("width"),P=T.a("height");y&&P&&(z=0,g=0,x=y,l=P,w.push({node:T,type:0,p:z},{node:T,type:1,p:z+x/2},{node:T,type:2,p:z+x}),e.push({node:T,type:0,p:g},{node:T,type:1,p:g+l/2},{node:T,type:2,p:g+l}),o[T._id||0]={x:z,y:g,width:x,height:l}),T.each(function(n){if(mq(n)&&!N.isSelected(n)&&N.isVisible(n)&&N.isValidGuideLineSource(n)){var f=!1;if(N.sm().getSelection().each(function(R){f||(n.isHostOn(R)?f=!0:n.isDescendantOf(R)&&(f=!0))}),!f){var B=n.getRect();z=B.x,g=B.y,x=B.width,l=B.height,w.push({node:n,type:0,p:z},{node:n,type:1,p:z+x/2},{node:n,type:2,p:z+x}),e.push({node:n,type:0,p:g},{node:n,type:1,p:g+l/2},{node:n,type:2,p:g+l}),o[n._id]=B}}}),w.sort(function(K,A){return K.p-A.p}),e.sort(function(X,o){return X.p-o.p}),t._grid=W,t._87I=o},Ph.prototype.gatherLines=function(L,u,A){var x,h,W,f,z,e,c,H,w,$,R,b,m=this,T=[m.findClosest({x:L.x,y:L.y},u),m.findClosest({x:L.x+L.w/2,y:L.y+L.h/2},u),m.findClosest({x:L.x+L.w,y:L.y+L.h},u)],O={},Q=m._87I;A=A||255;var p,J;for(m._guideLine=[],x=0;2>x;x++)for(O={},0===x?(f="y",H=L.x,w=H+L.w):(f="x",H=L.y,w=H+L.h),h=0;3>h;h++)z=T[h],z&&isFinite(z[f])&&(p=1<<3*x+h,A&p&&(e=z[f+"Line"],c=e.node,J=c._id||0,O[J]||(O[J]=!0,b=Q[J],"y"===f?($=b.x,R=b.x+b.width):($=b.y,R=b.y+b.height),W=e.p,m._guideLine.push({type:f,a:H,b:w,c:$,d:R,p:W,center:1===e.type}))))},Ph.prototype._binarySearchClosest=function(d,P){if(!P.length)return{dis:1/0};for(var h,N=0,b=P.length-1;b-N>1;)h=Math.floor((N+b)/2),P[h].p<d?N=h:b=h;var Z=P[N].p-d,c=P[b].p-d;return Math.abs(Z)<=Math.abs(c)?{line:P[N],dis:Z}:{line:P[b],dis:c}},Ph.prototype.findClosest=function(q,T,I){var k=this,o=k._interactor,O=o.gv,N=k._grid;I&&(q=al.toWorldPosition(O,q));var A,X=k._binarySearchClosest(q.x,N.x),S=k._binarySearchClosest(q.y,N.y),J=X.dis,R=S.dis,C=O._zoom,b=o.getStyle("smartGuideThreshold")/C,H={};return Math.abs(J)<b&&"y"!==T&&(H.x=I?J*C:J,H.xLine=X.line,A=!0),Math.abs(R)<b&&"x"!==T&&(H.y=I?R*C:R,H.yLine=S.line,A=!0),A?H:void 0},Ph.prototype._42=function(){var F=this,b=F._guideLine;if(b&&!H.Default.isCtrlDown()){var q=F._interactor;if(q.getStyle("guideLineVisible")){var j,t,R,G,Z,X,m,f,T,k,D,O,d,h,E,z,n,x=q.gv,w=q._context,Y=x.tx(),I=x.ty(),Q=x._zoom,W=q.getStyle("guideLineTextSpacing");for(j=0,t=b.length;t>j;j++)R=b[j],f=R.type,T=R.p,k=R.a,D=R.b,O=R.c,d=R.d,h=Math.min(k,O),E=Math.max(D,d),"x"===f?(G=T*Q+Y,Z=h*Q+I,X=G,m=E*Q+I):(G=h*Q+Y,Z=T*Q+I,X=E*Q+Y,m=Z),al.Icons.DrawIcon(q,w,al.Icons.MoveLineGuide,{rect:[G,Z,X,m],center:R.center}),d>=k&&D>=O||(h=k>d?d:D,E=k>d?k:O,n=E-h,"x"===f?(R.center2center||(G-=W,X=G),Z=h*Q+I,m=E*Q+I,z=al.Icons.MoveLineGuideDistanceV):"y"===f&&(R.center2center||(Z-=W,m=Z),G=h*Q+Y,X=E*Q+Y,z=al.Icons.MoveLineGuideDistanceH),al.Icons.DrawIcon(q,w,z,{x0:G,y0:Z,x1:X,y1:m,dis:n}))}}},Ph.prototype.clear=function(){this._guideLine=null};var sb=al.Guide.Hover=function(h){var o=this;o._interactor=h};sb.prototype={},sb.prototype.constructor=sb,b.defineProperties(sb.prototype,{}),sb.prototype._42=function(){var U=this._interactor;if(U.getStyle("hoverGuideVisible")&&!U.gvEditing){var o=U.hoverData,G=U.gv;if(!mq(o)||G.isSelected(o))return U.hoverData=null,void 0;var y=Cc(G,o),P=al.toScreenPosition(G,{x:y.x,y:y.y}),m=al.toScreenPosition(G,{x:y.x+y.width,y:y.y+y.height});al.Icons.DrawIcon(U,U._context,al.Icons.HoverDataRect,{min:P,max:m,color:U.getStyle("hoverGuideColor")||U.getStyle("baseColor"),borderWidth:U.getStyle("hoverGuideBorderWidth")||1,borderPattern:U.getStyle("hoverGuideBorderPattern")||[1,4]})}},al.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,rotateTipVisible:!0,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Hq=al.Icons={},$i=1e4,Pc=null,pl=al.DefaultStyleMap.baseColor,sm="rgb(183,232,135)",Nn="rgb(255,204,153)",fs=6;H.Default.setImage("Icons.RectPoint",{width:fs,height:fs,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return pl}},rect:[0,0,fs,fs]}]}),Hq.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var X=Hq.GroupSubEntityRect.data;if(!X)return[];var d=X.min,V=X.max;return[d.x,d.y,d.x,V.y,V.x,V.y,V.x,d.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Hq.GroupSubEntityRect.data.isKeyOb?pl:pl}}}]};var Dd=4;Hq.HoverDataRect={comps:[{type:"shape",points:{func:function(){var X=Hq.HoverDataRect.data;if(!X)return[];var g=X.min,b=X.max,m=Dd;return g.x-=m,g.y-=m,b.x+=m,b.y+=m,[g.x,g.y,g.x,b.y,b.x,b.y,b.x,g.y]}},segments:[1,2,2,2,5],background:null,borderWidth:{func:function(){return Hq.HoverDataRect.data.borderWidth}},borderColor:{func:function(){return Hq.HoverDataRect.data.color}},borderCap:"butt",borderPattern:{func:function(){return Hq.HoverDataRect.data.borderPattern}}}]},Hq.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Hq.Line.data.P1.x,Hq.Line.data.P1.y],fs,fs]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Hq.Line.data.P2.x,Hq.Line.data.P2.y],fs,fs]}}}]},Hq.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Hq.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Hq.Rect={comps:[{type:"shape",points:{func:function(){var O=Hq.Rect.data;if(!O)return[];var w=O.LT,c=O.LB,Y=O.RB,J=O.RT;return[w.x,w.y,c.x,c.y,Y.x,Y.y,J.x,J.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return pl}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Hq.Rect.data.rotation}},rect:{func:function(){return[[Hq.Rect.data.LT.x,Hq.Rect.data.LT.y],fs,fs]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Hq.Rect.data.rotation}},rect:{func:function(){return[[Hq.Rect.data.LB.x,Hq.Rect.data.LB.y],fs,fs]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Hq.Rect.data.rotation}},rect:{func:function(){return[[Hq.Rect.data.RB.x,Hq.Rect.data.RB.y],fs,fs]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Hq.Rect.data.rotation}},rect:{func:function(){return[[Hq.Rect.data.RT.x,Hq.Rect.data.RT.y],fs,fs]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Hq.Rect.data.rotation}},visible:{func:function(){return Hq.Rect.data.L?!0:!1}},rect:{func:function(){return[[Hq.Rect.data.L.x,Hq.Rect.data.L.y],fs,fs]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Hq.Rect.data.rotation}},visible:{func:function(){return Hq.Rect.data.R?!0:!1}},rect:{func:function(){return[[Hq.Rect.data.R.x,Hq.Rect.data.R.y],fs,fs]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Hq.Rect.data.rotation}},visible:{func:function(){return Hq.Rect.data.T?!0:!1}},rect:{func:function(){return[[Hq.Rect.data.T.x,Hq.Rect.data.T.y],fs,fs]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Hq.Rect.data.rotation}},visible:{func:function(){return Hq.Rect.data.B?!0:!1}},rect:{func:function(){return[[Hq.Rect.data.B.x,Hq.Rect.data.B.y],fs,fs]}}}]};var Fj=16;H.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return pl}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return pl}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Hq.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Hq.Anchor.data.POS.x,Hq.Anchor.data.POS.y],Fj,Fj]}}}]},Hq.TipShiftX=12,Hq.TipShiftY=12;var zb=[8,28];Hq.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Hq.TipHelper.data.helperPos.x,Hq.TipHelper.data.helperPos.y,zb[0]*Hq.TipHelper.data.size,zb[1]]}},background:{func:function(){return Pc.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Hq.TipHelper.data.text}},rect:{func:function(){return[Hq.TipHelper.data.helperPos.x,Hq.TipHelper.data.helperPos.y,zb[0]*Hq.TipHelper.data.size,zb[1]]}},color:{func:function(){return Pc.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var hd=7;Hq.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Hq.ShapePoint.data.dynamicVisible}},rect:{func:function(){var r=Hq.ShapePoint.data.point,C=Hq.ShapePoint.data.size||hd;return[r,C+10,C+10]}},background:{func:function(){var O=Date.now(),H=Hq.ShapePoint.data.dynamicPeriod||1500,B=Math.sin(O%H/H*Math.PI);return"rgba(27,124,22,"+.5*B+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var z=Hq.ShapePoint.data.point,H=Hq.ShapePoint.data.size||hd;return[z,H,H]}},background:{func:function(){var T=Hq.ShapePoint.data.isEnd;return T?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Hq.ShapePoint.data.color||pl}}},{type:"rect",visible:{func:function(){return!!Hq.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return pl}},rect:{func:function(){var E=5;return[Hq.ShapePoint.data.point,E,E]}}}]},Hq.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Hq.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Hq.ShapeBgCurve.data.P}},segments:{func:function(){return Hq.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var C=Date.now(),a=Hq.ShapeBgCurve.data.dynamicPeriod||1500,R=Math.sin(C%a/a*Math.PI);return"rgba(27,124,22,"+.3*R+")"}}},{type:"shape",points:{func:function(){return Hq.ShapeBgCurve.data.P}},segments:{func:function(){return Hq.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Hq.ShapeBgCurve.data.color||pl}}}]};var Km=8;Hq.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var Q=Hq.ShapeHighlighPoint.data;return[[Q.x,Q.y],Km,Km]}},background:{func:function(){return Pc.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var db=10;Hq.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var l=Hq.ShapeHighlighRealPoint.data;return[[l.x,l.y],db,db]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return pl}}}]};var im=8;Hq.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var j=Hq.ShapeHighlighCtrlPoint.data,g=j.x,M=j.y,c=im/2;return[g-c,M-c,g-c,M+c,g+c,M+c,g+c,M-c]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Pc.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Pc.getStyle("shapeCtrlPointBorderColor")||pl}}}]};var Og=3;Hq.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Hq.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Og,borderColor:{func:function(){return Pc.getStyle("curveHighlightColor")}}}]},Hq.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Hq.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Hq.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Hq.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Hq.MoveLineGuide.data.center?sm:Nn}}}]};var is=5;Hq.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var h=Hq.MoveLineGuideDistanceH.data,E=h.x0,H=h.y0;return[E,H-is,E,H+is]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Nn},{type:"shape",points:{func:function(){var Z=Hq.MoveLineGuideDistanceH.data,p=Z.x1,o=Z.y1;return[p,o-is,p,o+is]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Nn},{type:"text",text:{func:function(){return Math.round(Hq.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var s=Hq.MoveLineGuideDistanceH.data;return[[(s.x0+s.x1)/2,s.y0-10],20,20]}},color:Nn,font:"12px Arial",align:"center"}]},Hq.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var Q=Hq.MoveLineGuideDistanceV.data,J=Q.x0,l=Q.y0;return[J-is,l,J+is,l]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Nn},{type:"shape",points:{func:function(){var G=Hq.MoveLineGuideDistanceV.data,M=G.x1,f=G.y1;return[M-is,f,M+is,f]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Nn},{type:"text",text:{func:function(){return Math.round(Hq.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var T=Hq.MoveLineGuideDistanceV.data;return[[T.x0-10,(T.y0+T.y1)/2],20,20]}},color:Nn,font:"12px Arial",align:"center"}]},H.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Hq.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var X=Hq.EdgeElevationGuide.data,c=X.x,E=X.y,O=Pc.getStyle("curveElevationIntersectSize"),n=Pc.getStyle("curveElevationGuideShift");return c+=n[0],E+=n[1],[c-O,E-O,2*O,2*O]}}}]},H.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),H.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Hq.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Hq.ConnectGuide.data.rotation}},rect:{func:function(){var t=Hq.ConnectGuide.data.connect;t.x,t.y;var j=Pc.getStyle("connectGuideIntersectSize");return[[t.x,t.y],2*j,2*j]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var V=Hq.ConnectGuide.data.cursorPos||Hq.ConnectGuide.data.connect,U=Pc.getStyle("connectGuideIntersectSize");return[[V.x,V.y],2*U-2,2*U-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var Y=Hq.ConnectGuide.data.connect,V=Hq.ConnectGuide.data.cursorPos||Y;return[Y.x,Y.y,Y.x+.5*(V.x-Y.x),Y.y,V.x+.5*(Y.x-V.x),V.y,V.x,V.y]}}}]},H.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),H.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Hq.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var F=Hq.ConnectGuideGarbage.data.hover;return F?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var e=Hq.ConnectGuideGarbage.data,o=Pc.getStyle("connectGuideGarbageIntersectsize");return e.hover&&(o+=5),[[e.x,e.y],2*o,2*o]}}}]};var Dr=6;Hq.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Hq.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var P=Hq.ShapeActivingCtrl.data;return[P.point.x,P.point.y,P.c1.x,P.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return pl}}},{type:"shape",visible:{func:function(){return Hq.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var k=Hq.ShapeActivingCtrl.data;return[k.point.x,k.point.y,k.c2.x,k.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return pl}}},{type:"shape",visible:{func:function(){return Hq.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var f=Hq.ShapeActivingCtrl.data.c1,u=f.x,J=f.y,p=Dr/2;return"c1"===Hq.ShapeActivingCtrl.data.hl&&(p+=.5),[u-p,J-p,u-p,J+p,u+p,J+p,u+p,J-p]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Pc.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Hq.ShapeActivingCtrl.data.hl?Pc.getStyle("shapeCtrlPointHighlightBorder")||pl:Pc.getStyle("shapeCtrlPointBorderColor")||pl}}},{type:"shape",visible:{func:function(){return Hq.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var z=Hq.ShapeActivingCtrl.data.c2,g=z.x,I=z.y,s=Dr/2;return"c2"===Hq.ShapeActivingCtrl.data.hl&&(s+=.5),[g-s,I-s,g-s,I+s,g+s,I+s,g+s,I-s]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Pc.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Hq.ShapeActivingCtrl.data.hl?Pc.getStyle("shapeCtrlPointHighlightBorder")||pl:Pc.getStyle("shapeCtrlPointBorderColor")||pl}}}]},Hq.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return pl}},rect:{func:function(){return[[Hq.RoundPoint.data.x,Hq.RoundPoint.data.y],fs,fs]}}}]},Hq.AttachPoint={comps:[{type:"rect",background:{func:function(){return Hq.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return pl}},rect:{func:function(){var V=Hq.AttachPoint.data.isAttach?fs+4:fs;return[[Hq.AttachPoint.data.x,Hq.AttachPoint.data.y],V,V]}}}]},Hq.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Hq.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Hq.SimpleRect.data.color||pl}},rect:{func:function(){var B=Hq.SimpleRect.data;return[B.x,B.y,B.width,B.height]}}}]},H.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Hq.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var u=Hq.MoveDummy.data;
return[[u.pos.x,u.pos.y],2*u.size,2*u.size]}}}]},al.Icons.DrawIcon=function(X,A,I,N){I.width=I.height=$i,I.data=N,Pc=X,H.Default.drawImage(A,I,0,0,$i,$i),Pc=E},al.Icons.MapPoints=function(o,T){for(var J=0,K=o.length;K>J;J++)o[J]/=T},al.roundTo=function(E,W,U){var t=Math.abs(E%W);return U>t||U>W-t?W*Math.round(E/W):E},al.toFixed=function(e){return Math.round(100*e)/100},al.getDataMatrix=function(g){if(g instanceof H.Shape){var C=new H.Math.Matrix2d,G=g.getPosition();return C.translate(-G.x,-G.y).scale(g.getScale().x,g.getScale().y).rotate(g.getRotation()).translate(G.x,G.y),C}return g.getMatrix?g.getMatrix():new H.Math.Matrix2d};var Me=al.Math.Curve=function(){this._curves=[]};Me.prototype={},Me.prototype.constructor=Me,Me.prototype.createFromHtShape=function(j,y,b){y instanceof H.List&&(y=y.toArray());var W,M,I,k,x,C,s,Y=this,u=null,$=null,P=0,d=al.Math.Vector2,B=al.Math.CubicBezier,F=function(G){return new d(j[G],j[G+1],b?b[G/2]:E)};for(M=0,I=y.length;I>M;M++){switch(k=y[M],x=null,k){case 1:$=F(P),u=$,P+=2;break;case 2:W=F(P),P+=2,x=new B($,$.clone(),W.clone(),W),$=W;break;case 3:C=F(P),W=F(P+2),P+=4,x=new B($,C.clone().sub($).multiplyScalar(2/3).add($),C.clone().sub(W).multiplyScalar(2/3).add(W),W),$=W;break;case 4:C=F(P),s=F(P+2),W=F(P+4),P+=6,x=new B($,C,s,W),$=W;break;case 5:if(!u)break;x=new B($,$.clone(),u.clone(),u),$=null,u=null}x&&(x._index=Y._curves.length,Y._curves.push(x))}},Me.prototype.checkPoint=function(w,L){var k,Z,a,t,W,r=this,c=r._curves;for(k=0,Z=c.length;Z>k;k++)if(t=c[k],W=t.intersectRect(w,L,L),W.length)return a=0,W.forEach(function(O){a+=O.t}),a/=W.length,w=t.getPointAt(a),w.t=a,{bezier:t,intersection:w}},Me.prototype.insertKnot=function(d,B){var Q=d.insertKnot(B),U=this,p=U._curves;p.splice(d._index,1,Q[0],Q[1])},Me.prototype._isCloseEnough=function(J,z){return Math.abs(J.x-z.x)<1e-6&&Math.abs(J.y-z.y)<1e-6},Me.prototype._isSamePoint=function(y,d){return y===d},Me.prototype.moveRealPoint=function(n,g){var i=this,f=i._curves,w=g.clone().sub(n);f.forEach(function(c){var s=c._p1;c._p2,c._p3;var N=c._p4;i._isSamePoint(s,n)&&(c._p2.add(w),c._p1=g),i._isSamePoint(N,n)&&(c._p3.add(w),c._p4=g)})},Me.prototype.moveCtrlDueToRealPointMovement=function(L,n){var H=this,U=H._curves,y=function(l){l.add(n),l.e&&n.e&&(l.e+=n.e)};U.forEach(function(w){var o=w._p1;w._p2,w._p3;var n=w._p4;H._isSamePoint(o,L)&&y(w._p2),H._isSamePoint(n,L)&&y(w._p3)})},Me.prototype.moveCtrlPoint=function(V,b,O){var T=V[O];if(T){T.e!==E&&(b.e=T.e);var Z=this,G=Z._curves;b.clone().sub(T),G.forEach(function(Y){var z;"c2"===O?z="_p2":"c1"===O&&(z="_p3"),Z._isSamePoint(Y[z],T)&&(Y[z]=b)}),V[O]=b}},Me.prototype.deleteRealPoint=function(j,Q){var C,i,L,G,p,u,A,v=this,k=v._curves,h={},H=[],M=al.Math.CubicBezier;for(i=0,L=k.length;L>i;i++)C=k[i],G=C._p1,p=C._p2,u=C._p3,A=C._p4,(h[i]||!v._isSamePoint(G,j))&&(v._isSamePoint(A,j)?L>i+1&&v._isSamePoint(k[i+1]._p1,j)&&(Q||H.push(new M(G,p,k[i+1]._p3,k[i+1]._p4))):H.push(C));v._curves=H},Me.prototype.findPairs=function(a,$){var s,V,n,e,N,_,x,t,L=this,v=L._curves,f={},G=[];for(V=0,n=v.length;n>V;V++)s=v[V],e=s._p1,N=s._p2,_=s._p3,x=s._p4,!f[V]&&L._isSamePoint(e,a)&&($?G.push({point:e,r2:x}):G.push({point:e,c2:N})),L._isSamePoint(x,a)&&(t=$?{point:x,r1:e}:{point:x,c1:_},n>V+1&&L._isSamePoint(v[V+1]._p1,a)&&($?t.r2=v[V+1]._p4:t.c2=v[V+1]._p2,f[V+1]=!0),G.push(t));return G},Me.prototype.toHtShape=function(){var _=this,N=_._curves,x=[],P=[],p={x:1/0,y:1/0};return N.forEach(function(n){var j=n._p1,U=n._p2,Q=n._p3,L=n._p4;return _._isCloseEnough(j,p)||(x.push(1),P.push(j.clone())),p=L,_._isCloseEnough(j,U)&&_._isCloseEnough(Q,L)?(x.push(2),P.push(L.clone()),void 0):(x.push(4),P.push(U.clone(),Q.clone(),L.clone()),void 0)}),{segments:x,points:P}};var Nq=al.Math.CubicBezier=function(T,L,e,U){var O=this;O._id=al.Math.CubicBezier._globalId++,O._p1=T,O._p2=L,O._p3=e,O._p4=U};Nq._globalId=1,Nq.prototype={},Nq.prototype.constructor=Nq,Nq.prototype.toString=function(){return this._id},Nq.prototype.intersectRect=function(m,q,P){var u=q/2,k=P/2,R=m.x,F=m.y,s=al.Math.Vector2,o=new s(-u+R,-k+F),Q=new s(u+R,k+F),O=new s(Q.x,o.y),j=new s(o.x,Q.y),c=this,x=c.intersectLine(o,O),T=c.intersectLine(O,Q),p=c.intersectLine(Q,j),v=c.intersectLine(j,o),y=x.concat(T).concat(p).concat(v);return y},Nq.prototype.intersectLine=function(F,m){var h,Q,i,Y,u,V,E,y,D,W,C,n,H,R=this,b=F.clone().min(m),e=F.clone().max(m);Y=R._p1,u=R._p2,V=R._p3,E=R._p4,h=Y.clone().multiplyScalar(-1),Q=u.clone().multiplyScalar(3),i=V.clone().multiplyScalar(-3),C=h.add(Q).add(i).add(E),h=Y.clone().multiplyScalar(3),Q=u.clone().multiplyScalar(-6),i=V.clone().multiplyScalar(3),W=h.add(Q).add(i),h=Y.clone().multiplyScalar(-3),Q=u.clone().multiplyScalar(3),D=h.add(Q),y=Y.clone(),H=new al.Math.Vector2(F.y-m.y,m.x-F.x),n=F.x*m.y-m.x*F.y;for(var B=R.getRoots(H.dot(C),H.dot(W),H.dot(D),H.dot(y)+n),l=new Array,z=0,w=B.length;w>z;z++){var A=B[z];if(!(0>A||A>1)){var q=R.getPointAt(A);q.t=A,F.x==m.x?b.y<=q.y&&q.y<=e.y&&l.push(q):F.y==m.y?b.x<=q.x&&q.x<=e.x&&l.push(q):q.x>=b.x&&q.y>=b.y&&q.x<=e.x&&q.y<=e.y&&l.push(q)}}return l},Nq.prototype.solveTForPoint=function(O){var h,s,z,B,J=this;h=J._p1.x-O.x,s=J._p2.x-O.x,z=J._p3.x-O.x,B=J._p4.x-O.x;for(var q=J.getRoots(B-3*z+3*s-h,3*z-6*s+3*h,3*s-3*h,h),t=E,D=1/0,V=0,o=q.length;o>V;V++){var Y=q[V];if(!(0>Y||Y>1)){var $=J.getPointAt(Y);$.t=Y;var F=Math.abs($.y-O.y);D>F&&(D=F,t=$)}}return t},Nq.prototype.getPointAt=function(W){var c=this,A=c._p1,d=c._p2,q=c._p3,g=c._p4,Z=A.clone().lerp(d,W),z=d.clone().lerp(q,W),B=q.clone().lerp(g,W),o=Z.lerp(z,W),Y=z.lerp(B,W);return o.lerp(Y,W)},Nq.prototype.getPointByPercentage=function(_){var Q=this.length*_,h=this._cacheLength,o=h.length;if(0===Q)return h[0].point;if(_>=1)return h[o-1].point;for(var b=0;o>b;b++){var e=h[b];if(!(e.len<Q)){var z=h[b-1];return e.point.clone().sub(z.point).setLength(Q-z.len).add(z.point)}}},Nq.prototype.getTByPercentage=function(S){var w=this.length*S,l=this._cacheLength,Q=l.length;if(0===w||0>=S)return l[0].t;if(S>=1)return l[Q-1].t;for(var F=0;Q>F;F++){var G=l[F];if(!(G.len<w)){var I=l[F-1];return(w-I.len)/(G.len-I.len)*(G.t-I.t)+I.t}}},Nq.prototype.getRoots=function(T,t,F,e){var G,w,y,W,l,o=new Array;if(Math.abs(T)<1e-6){var G=t,w=F/G,y=e/G,W=w*w-4*y;if(W>0){var l=Math.sqrt(W);o.push(.5*(-w+l)),o.push(.5*(-w-l))}else 0==W&&o.push(.5*-w)}t/=T,F/=T,e/=T,G=(3*F-t*t)/3,w=(2*t*t*t-9*F*t+27*e)/27;var c=t/3,A=w*w/4+G*G*G/27,x=w/2;if(Math.abs(A)<=1e-6&&(A=0),A>0){var k,Z,l=Math.sqrt(A);k=-x+l,Z=k>=0?Math.pow(k,1/3):-Math.pow(-k,1/3),k=-x-l,k>=0?Z+=Math.pow(k,1/3):Z-=Math.pow(-k,1/3),o.push(Z-c)}else if(0>A){var r=Math.sqrt(-G/3),b=Math.atan2(Math.sqrt(-A),-x)/3,f=Math.cos(b),z=Math.sin(b),h=Math.sqrt(3);o.push(2*r*f-c),o.push(-r*(f+h*z)-c),o.push(-r*(f-h*z)-c)}else{var k;k=x>=0?-Math.pow(x,1/3):Math.pow(-x,1/3),o.push(2*k-c),o.push(-k-c)}return o},Nq.prototype._70I=function(){var X=this;return X._p1.distanceToSquared(X._p2)<1e-10&&X._p3.distanceToSquared(X._p4)<1e-10},Nq.prototype.insertKnot=function(Z){var e=this,k=e._p1,W=e._p2,E=e._p3,_=e._p4,A=k.clone().lerp(W,Z),z=W.clone().lerp(E,Z),j=E.clone().lerp(_,Z),p=A.clone().lerp(z,Z),Q=z.clone().lerp(j,Z),b=p.clone().lerp(Q,Z);return e._70I()?(k.clone().lerp(_,Z),[new al.Math.CubicBezier(k,k.clone(),b.clone(),b),new al.Math.CubicBezier(b,b.clone(),_.clone(),_)]):[new al.Math.CubicBezier(k,A,p,b),new al.Math.CubicBezier(b,Q,j,_)]},b.defineProperties(Nq.prototype,{length:{get:function(){var f=this._cacheLength;if(!f){f=this._cacheLength=[];for(var J=this._p1,$=0,Z=0;1>=$;){var w=this.getPointAt($+=.001);Z+=w.clone().sub(J).length(),J=w,f.push({len:Z,t:$,point:w.clone()})}}return f[f.length-1].len}},p1:{get:function(){return this._p1},set:function(j){this._p1=j,this._cacheLength=E}},p2:{get:function(){return this._p2},set:function(G){this._p2=G,this._cacheLength=E}},p3:{get:function(){return this._p3},set:function(b){this._p3=b,this._cacheLength=E}},p4:{get:function(){return this._p4},set:function(t){this._p4=t,this._cacheLength=E}}});var Xf=H.Default.getInternal().ui().EdgeUI,gd={_47O:function(m){var i=this,W=gd.getBackups()._47O;al.inEdit(i.gv)||W.call(i,m)}};al.Inject.registAsModule(gd,Xf);var Ep=H.Default.getInternal().ui().NodeUI,Zo={_47O:function(E){var T=this,v=Zo.getBackups()._47O;al.inEdit(T.gv)||v.call(T,E)},getSelectWidth:function(){var G=this,V=G.gv,t=G._data;if(V.isEditable(t)&&al.inEdit(V))return 0;var r=Zo.getBackup("getSelectWidth");return r.call(G)}};al.Inject.registAsModule(Zo,Ep);var qb=H.graph.GraphView,rk={_editPointSize:function(){var Y=H.Default.isTouchable,L=al.getStyle("pointSize");return L[Y?0:1]}(),isPointEditable:function(B){var w=this;if(al.inEdit(w))return w._pointEditableFunc?w._pointEditableFunc(B):!0;var i=rk.getBackup("isPointEditable");i.call(w,B)},isEditable:function(h){var z,J=this,v=rk.getBackup("isEditable");if(z=h instanceof al.Group?!0:v.call(J,h),!al.inEdit(J))return z;if(!(h instanceof H.Edge))return z;if(!h.s("2d.editable"))return!1;var B=J.getEditableFunc();return B?B(h):!0},_42:function(y,Z){var O=this,n=rk.getBackups()._42;if(n.call(O,y,Z),al.inEdit(O)){var K=O.getEditInteractor();K.drawImpl()}}};al.Inject.registAsModule(rk,qb);var ls=H.Default.getInternal().ui().ShapeUI,pd={_47O:function(T){var F=this,L=pd.getBackups()._47O;al.inEdit(F.gv)||L.call(F,T)}};al.Inject.registAsModule(pd,ls);var Rh=H.graph.DefaultInteractor,Fo={handle_mousewheel:function($){var C=this,w=Fo.getBackup("handle_mousewheel");al.inEdit(C.gv)||w.call(C,$)}};al.Inject.registAsModule(Fo,Rh);var yn=H.graph.MoveInteractor,$b={_calcShift:function(b,C){var l=this,R=$b.getBackup("_calcShift"),G=l.gv;if(!al.inEdit(G))return R.call(l,b,C);var Z=G.getEditInteractor(),B=Z.getSubModule("Move").calcShift(b,C,l);return B||R.call(l,b,C)},clear:function(l){var M=this,k=$b.getBackup("clear");k.call(M,l);var e=M.gv;if(al.inEdit(e)){var i=e.getEditInteractor();i.getSubModule("Move").clear(l)}}};al.Inject.registAsModule($b,yn);var Ph=al.Rect=function(u){this.catalog="Rect",this._interactor=u};Ph.prototype={},Ph.prototype.constructor=Ph,Ph.prototype.gatherInfo=function(Q,W){var A=this;if(1===W.length){var y=W[0];return y instanceof H.Shape&&y._70I()?A.gatherLine(Q,y):vc(y,Q)?!1:A.gatherSingleTarget(Q,y)}return W.length>1?A.gatherMultiTargets(Q,W):!1},Ph.prototype.gatherSingleTarget=function(I,V){if(V.getCorners){var c,R=this,u=R.info;R.target=V,c=R.screenInfo={};var k=V.getCorners();u.LT=new al.Math.Vector2(k[0]),u.LB=new al.Math.Vector2(k[1]),u.RB=new al.Math.Vector2(k[2]),u.RT=new al.Math.Vector2(k[3]),u.T=u.LT.clone().add(u.RT).divideScalar(2),u.B=u.LB.clone().add(u.RB).divideScalar(2),u.L=u.LT.clone().add(u.LB).divideScalar(2),u.R=u.RT.clone().add(u.RB).divideScalar(2);for(var j in u)c[j]=al.toScreenPosition(I,u[j]);var X=R._interactor,B=X.getStyle("checkSize"),F=function(p,Q,g){var S=Q.clone().sub(p).setLength(-B),J=g.clone().sub(p).setLength(-B),C=S.add(J).add(p);return C};return c.rotLT=F(c.LT,c.RT,c.LB),c.rotLB=F(c.LB,c.LT,c.RB),c.rotRB=F(c.RB,c.LB,c.RT),c.rotRT=F(c.RT,c.LT,c.RB),c.rotT=c.rotLT.clone().add(c.rotRT).divideScalar(2),c.rotB=c.rotLB.clone().add(c.rotRB).divideScalar(2),c.rotL=c.rotLT.clone().add(c.rotLB).divideScalar(2),c.rotR=c.rotRT.clone().add(c.rotRB).divideScalar(2),c.rotation=V.getRotation(),R.gatherConnectInfo(),!0}},Ph.prototype.gatherConnectInfo=function(){var Q=this,a=Q.target,z=Q._interactor,b=Q.screenInfo,D=z.gv;if(D.isConnectActionVisible(a)&&z.getStyle("connectGuideVisible")){var X;a.s&&(X=a.s("connectGuideShift")),X||(X=z.getStyle("connectGuideShift"));var W=a.getAnchor(),l=a.getSize(),Y=a.toGlobal({x:l.width*(X[0]-W.x),y:l.height*(X[1]-W.y)});Y=al.toScreenPosition(D,Y),b.P1?Y.add(b.P2.clone().sub(b.P1).setLength(X[2])):(Y.add(b.RT.clone().sub(b.LT).setLength(X[2])),Y.add(b.LB.clone().sub(b.LT).setLength(X[3]))),b.connect=Y}},Ph.prototype.gatherMultiTargets=function(C,c){var $=al.Group.findOrCreateGroup(c,this._interactor._uuid);if(!$)return!1;var p=this;return p.editing&&"rotate"!==p.editing.mode||$.calcInfo(),p.gatherSingleTarget(C,$)},Ph.prototype.gatherLine=function(J,H){this.target=H;var v=this.screenInfo={},t=H.getPoints(),I=al.getDataMatrix(H);return v.P1=al.toScreenPosition(J,I.apply(t.get(0))),v.P2=al.toScreenPosition(J,I.apply(t.get(1))),this.gatherConnectInfo(),!0},Ph.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Ph.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Ph.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Ph.prototype.check=function(e,f,K){if(H.Default.isLeftButton(f)){var Q=this;if(Q.editing=null,Q.tipInfo=null,Q.screenInfo){var o=Q.target,P=e.isEditable(o),w=Q.screenInfo;if(P&&w.connect){var F=Q._checkConnect(K);if(F)return F}if(w.P1)return Q._checkLine(K);var r,G,Y,p=null,R=Q._interactor,_=R.getStyle("checkSize");if(P&&e.isRectEditable(o))for(G=0;G<al.Rect.ResizeKeys.length;G++)if(Y=al.Rect.ResizeKeys[G],al.checkHit(K,w[Y],_)){p=Y,r="resize";break}if(!p&&P&&e.isRotationEditable(o)&&!R.getStyle("rotateAsClock")){var j=R.getStyle("rotateCheckSize");for(G=0;G<al.Rect.RotateKeys.length;G++)if(Y=al.Rect.RotateKeys[G],al.checkHit(K,w[Y],j)){p=Y,r="rotate";break}}if(!p)return R.setCursor("default"),void 0;if("rotate"===r){var m,b=e.lp(f);if(o instanceof al.Group){var S=R.getStyle("groupRotateModeKey");"string"==typeof S&&(S=[S]);for(var c=!1,s=0,l=S.length;l>s;s++)if(f[S[s]]){c=!0;break}var T=R.getStyle("groupRotateModeDefault");m=c?"batch"===T?"block":"batch":T}var k="batch"===m?o.getAnchor2():o.getPosition(),y=Math.atan2(b.y-k.y,b.x-k.x);R._setRotateCursor(y),Q.editing={mode:r,key:p,pos:k,flipY:o.getScale().y<0,rotation:o.getRotation(),hitRot:y},m&&(Q.editing.groupRotateMode=m)}else{var N=al.Rect.ResizeKeys.indexOf(p),O=al.Rect.ResizeDirection[N],X=Math.cos(o.getRotation()),U=Math.sin(o.getRotation()),I=O.x*Math.sign(o.getScale().x),z=O.y*Math.sign(o.getScale().y),h=Math.atan2(-U*I-X*z,X*I-U*z),q=(Math.round(h/(Math.PI/4))+8)%8,C=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][q];this._interactor.setCursor(C);var i=o.getWidth(),g=o.getHeight(),E=o.getAnchor();Q.editing={mode:r,key:p,rect:{x:-i*E.x,y:-g*E.y,width:i,height:g},anchor:E,matrix:o.getMatrix()}}return p}}},Ph.prototype._checkLine=function(j){var t=this;t.screenInfo;var q,Z=t._interactor.getStyle("checkSize");if(al.checkHit(j,t.screenInfo.P1,Z))q="P1";else{if(!al.checkHit(j,t.screenInfo.P2,Z))return this._interactor.setCursor("default"),void 0;q="P2"}return t.editing={mode:"line",key:q},q},Ph.prototype._checkConnect=function(f){var i=this,s=i.screenInfo,V=i._interactor,u=V.getStyle("connectGuideIntersectSize"),P=s.connect,$=f.x,F=P.x;if(F>$&&u>F-$&&Math.abs(P.y-f.y)<u||$>=F&&al.checkHit(f,P,u)){var D="connect",y=L.getConnectAction(V.gv);if(i.editing={mode:D},y&&y.delete)if(i.target instanceof al.Group){var a=!0;V.gv.sm().getSelection().each(function(J){y.delete.visible.call(null,V.gv,J)||(a=!1)}),i.editing.hasDeleteAction=a}else y.delete.visible.call(null,V.gv,i.target)&&(i.editing.hasDeleteAction=!0);return V.setCursor("default"),D}},Ph.prototype._fireEditEvent=function(b,P){var S=this._interactor,T=this.editing;if(T){var f=T.mode;f="rotate"===f?"Rotation":"connect"===f?"Connection":"resize"===f?"Rect":f[0].toUpperCase()+f.slice(1),S.fi({kind:b+"Edit"+f,event:P})}},Ph.prototype.startEdit=function(d,f){d.startDragging(f);var y=this;y._interactor.fi({kind:"prepareEdit",event:f});var P=y.editing,i=y.target;if(P){if(y._fireEditEvent("begin",f),P.started=!0,"rotate"===P.mode)return P.groupRotateMode&&i.beginRotate(P),d._42(),void 0;if("connect"!==P.mode)("line"===P.mode||i&&0===i.getRotation())&&(y._inSmartGuide=!0,y._interactor.rectGuide.gatherRects());else if(P.hasDeleteAction){var I=d.gv,q=y._interactor.getStyle("connectGuideGarbageShift");P.garbageInfo={x:I.getWidth()*q[0]+q[2],y:I.getHeight()*q[1]+q[3],size:y._interactor.getStyle("connectGuideGarbageIntersectsize")},d._42()}}},Ph.prototype._46O=function(y){var I,J,$=this,Y=$.editing,D=$.target;if(Y){if("connect"===Y.mode&&!Y.canceled&&!Y.deleted)try{Y.garbageInfo&&Y.garbageInfo.hover?L.doDeleteConnectionAction($._interactor.gv,D):L.doConnectAction($._interactor.gv,D,Y.target)}catch(F){console.error(F)}J=Y.freezeFlag,I=$.editing.groupRotateMode,$._fireEditEvent("end",y),$.editing=null}$.tipInfo=null,$._inSmartGuide&&($._interactor.rectGuide.clear(),$._inSmartGuide=!1),I&&D&&D.endRotate(),D instanceof H.Block&&(J===E?delete D._freezeSyncFromChildren:D._freezeSyncFromChildren=J,D.updateFromChildren())},Ph.prototype.handleNormalStateDelete=function(){var H=this,u=H.editing;if(u&&"connect"===u.mode&&!u.canceled&&!u.deleted){if(u.garbageInfo){try{L.doDeleteConnectionAction(H._interactor.gv,H.target)}catch(V){console.error(V)}u.garbageInfo=null}return u.cursorPos=null,u.targetCorners=null,u.deleted=!0,H._interactor._42(),!0}},Ph.prototype.handleNormalStateKeyDown=function(B){var e=this,q=e.editing;return!q||"connect"!==q.mode||q.canceled||q.deleted?void 0:H.Default.isEsc(B)?(q.cursorPos=null,q.targetCorners=null,q.canceled=!0,e._interactor._42(),!0):void 0},Ph.prototype.handleEdit=function(l,T){var f=this,o=f.editing;if(o){var X,w,S,Z,u,k=f.target,G=o.key,V=o.mode,P=l.lp(T),m=f._interactor;if("connect"===V){if(o.canceled)return;if(o.deleted)return;o.cursorPos=m._getLogicalPoint(T);var U=o.garbageInfo;return U&&al.checkHit(o.cursorPos,U,U.size)?(U.hover=!0,o.target=null,o.targetCorners=null):(U&&(U.hover=!1),o.target=l.getDataAt(P,function(w){return l.isSelectable(w)?mq(w)?!0:!1:!1})||null,o.targetCorners=al.getTargetCornersOnScreen(l,o.target)),m._42(),void 0}if("rotate"===V){var $,j,E=o.pos,O=Math.atan2(P.y-E.y,P.x-E.x);if(o.groupRotateMode?j=O-o.hitRot:($=O-o.hitRot,j=o.rotation+$),j%=2*Math.PI,0>j&&(j+=2*Math.PI),!H.Default.isCtrlDown(T)){var v,x;An(T)?(v=m.getStyle("shiftRotateRound"),x=v/2):(v=m.getStyle("rotateRound"),x=m.getStyle("rotateSensitivity")),j=al.roundTo(j,v,x)}o.groupRotateMode?($=j-(o.lastRotation||0),0!==$&&(k.addRotation($,o.groupRotateMode,function(A){return l.isRotationEditable(A)}),o.lastRotation=j)):k.setRotation(j),m._setRotateCursor(O),j>Math.PI&&(j-=2*Math.PI);var F=180*(j/Math.PI);F=F.toFixed(2),X=""+F+"°"}else if("resize"===V){var M=o.rect;S=M.x,Z=M.y;var g,n=M.width,L=M.height,y=o.anchor,d=o.matrix,c=k.s&&k.s("keepAspectRatio")||m.getStyle("keepAspectRatio");An(T)&&(c=!c);var W=f._unionPointMode1,K=f._unionPointMode2;if(f._inSmartGuide&&!H.Default.isCtrlDown(T)&&!c){var C;"L"===G||"R"===G?C="x":("T"===G||"B"===G)&&(C="y"),f._adsorbedToClosest(P,C),u=!0}g=d.tfi(P);var s;"LT"===G?(M=W(g,{x:S+n,y:Z+L},n,L,c),s=9):"T"===G?(M=K({x:S,y:g.y},{x:S+n,y:Z+L},n,L,c,"v"),s=1):"RT"===G?(M=W(g,{x:S,y:Z+L},n,L,c),s=33):"L"===G?(M=K({x:g.x,y:Z},{x:S+n,y:Z+L},n,L,c,"h"),s=8):"R"===G?(M=K({x:S,y:Z},{x:g.x,y:Z+L},n,L,c,"h"),s=32):"LB"===G?(M=W(g,{x:S+n,y:Z},n,L,c),s=12):"B"===G?(M=K({x:S,y:Z},{x:S+n,y:g.y},n,L,c,"v"),s=4):"RB"===G&&(M=W(g,{x:S,y:Z},n,L,c),s=36);var z=d.tf(M.x+M.width*y.x,M.y+M.height*y.y);k instanceof H.Block&&(o.hasOwnProperty("freezeFlag")||(o.freezeFlag=k._freezeSyncFromChildren,k._freezeSyncFromChildren=!0)),k.setPosition(z),k.setSize(M.width,M.height),u&&(w=k.getRect(),m.rectGuide.gatherLines({node:k,x:w.x,y:w.y,w:w.width,h:w.height},C,s)),X=""+Math.round(M.width)+" * "+Math.round(M.height)}else if("line"===V){if(An(T)){var R=k.getPoints(),D="P1"===G?R.get(1):R.get(0),b={x:P.x-D.x,y:P.y-D.y},i=m.getStyle("shiftLineRotateRound"),e=f._shiftDirList;if(!e||f._shiftRotateRound!==i){f._shiftRotateRound=i,f._shiftDirList=e=[];for(var Y=0;Y<Math.PI;Y+=i)e.push({x:B(Y),y:J(Y)})}for(var p,N=0,h=0,a=e.length;a>h;h++){var q=e[h],A=q.x*b.x+q.y*b.y;Math.abs(A)>Math.abs(N)&&(N=A,p=q)}P={x:D.x+p.x*N,y:D.y+p.y*N},m.rectGuide.clear()}else f._inSmartGuide&&!H.Default.isCtrlDown(T)&&(f._adsorbedToClosest(P),u=!0);var I=al.getDataMatrix(k).applyInverse(P);k.setPoint("P1"===G?0:1,I,!0);var Q=k.getPoints(),_=Q.get(0),t=Q.get(1);S=_.x-t.x,Z=_.y-t.y,X=" "+Math.round(Math.sqrt(S*S+Z*Z))+" ",u&&(w=k.getRect(),m.rectGuide.gatherLines({node:k,x:w.x,y:w.y,w:w.width,h:w.height}))}if(X){var r=H.Default.getLogicalPoint(T,m._canvas);r.x+=al.Icons.TipShiftX,r.y+=al.Icons.TipShiftY,f.tipInfo={helperPos:r,text:X,size:X.length}}f._fireEditEvent("between",T)}},Ph.prototype._unionPointMode1=function(w,f,s,N,K){if(K&&s&&N){var u=w.x-f.x,T=w.y-f.y;Math.abs(u*N)<Math.abs(T*s)?(T=Math.sign(T)*Math.abs(u*N/s),w.y=f.y+T):(u=Math.sign(u)*Math.abs(T*s/N),w.x=f.x+u)}return H.Default.unionPoint(w,f)},Ph.prototype._unionPointMode2=function(n,q,z,p,Q,L){var S=H.Default.unionPoint(n,q);if(Q&&z&&p){var T;"v"===L?(T=S.x+S.width/2,S.width=z*S.height/p,S.x=T-S.width/2):(T=S.y+S.height/2,S.height=p*S.width/z,S.y=T-S.height/2)}return S},Ph.prototype._adsorbedToClosest=function(p,J){var S=this,b=S._interactor,y=b.rectGuide.findClosest(p,J),W=b.gridGuide.findClosest(p,J),R=1/0,T=1/0;y&&(isFinite(y.x)&&(R=y.x),isFinite(y.y)&&(T=y.y)),W&&(isFinite(W.x)&&Math.abs(W.x)<Math.abs(R)&&(R=W.x),isFinite(W.y)&&Math.abs(W.y)<Math.abs(T)&&(T=W.y)),isFinite(R)&&(p.x+=R),isFinite(T)&&(p.y+=T)},Ph.prototype._42=function(h,v,Y){var p=this;p.info={},p.screenInfo=null;var W=p._interactor;if(!W.editDetail&&p.gatherInfo(v,Y)){var B=p.editing,Q=B?B.groupRotateMode:null,K=p.screenInfo;if("block"!==Q||!B||!B.started){if(K.P1?al.Icons.DrawIcon(W,h,al.Icons.Line,K):al.Icons.DrawIcon(W,h,al.Icons.Rect,K),K.connect&&(al.Icons.DrawIcon(W,h,al.Icons.ConnectGuide,{rotation:K.rotation,connect:K.connect,cursorPos:B?B.cursorPos:null}),B)){if(B.targetCorners){for(var X={x:1/0,y:1/0},z={x:-1/0,y:-1/0},G=0,P=B.targetCorners.length;P>G;G+=2)X.x=Math.min(X.x,B.targetCorners[G]),z.x=Math.max(z.x,B.targetCorners[G]),X.y=Math.min(X.y,B.targetCorners[G+1]),z.y=Math.max(z.y,B.targetCorners[G+1]);al.Icons.DrawIcon(W,h,al.Icons.HoverDataRect,{min:X,max:z,color:W.getStyle("hoverGuideColor")||W.getStyle("baseColor")})}B.garbageInfo&&al.Icons.DrawIcon(W,h,al.Icons.ConnectGuideGarbage,B.garbageInfo)}W.getStyle("rotateTipVisible")&&p.tipInfo&&al.Icons.DrawIcon(W,h,al.Icons.TipHelper,p.tipInfo)}p.target instanceof al.Group&&p.target._42(W,h,v)}};var hs=al.Anchor=function(i){this.catalog="Anchor",this._interactor=i};hs.prototype={},hs.prototype.constructor=hs,hs.prototype.gatherInfo=function(Q,C){var i=this;if(1===C.length){var W=C[0];if(!W.getAnchor)return;if(W instanceof H.Shape&&W._70I())return;if(vc(W,Q))return;return i.gatherSingleTarget(Q,C[0])}return C.length>1?i.gatherMultiTargets(Q,C):!1},hs.prototype.gatherSingleTarget=function(B,r){var k=this;return k.info.POS=r.getPosition(),k.screenInfo.POS=al.toScreenPosition(B,k.info.POS),k.target=r,!0},hs.prototype.gatherMultiTargets=function(K,s){var z=this,O=al.Group.findOrCreateGroup(s,this._interactor._uuid);return O?(z.screenInfo.POS=al.toScreenPosition(K,O.getAnchor2()),z.target=O,!0):!1},hs.prototype.isVisible=function(){var y=this,i=y._interactor;if(i.getStyle("anchorVisible")===!1)return!1;var d=y.target;if(d){if(this.editing)return!0;var x=d.getAnchor(),Y=i.getStyle("anchorOutsideVisibleThreshold");if(x.x<-Y||x.x>1+Y||x.y<-Y||x.y>1+Y)return!0;var H=d.getSize(),A=d.getScale(),D=Math.min(Math.abs(H.width*A.x),Math.abs(H.height*A.y));if(D*i.gv._zoom<i.getStyle("anchorHideThreshold"))return!1}return!0},hs.prototype.check=function(Q,s,h){if(H.Default.isLeftButton(s)){var o=this,F=o._interactor;if(o.isVisible()&&F.getStyle("anchorMovable")!==!1){o.editing=null,o.tipInfo=null;var r=o.target;if(r&&Q.isAnchorEditable(r)&&Q.isEditable(r)){var W;if(o.screenInfo&&(W=o.screenInfo.POS)&&al.checkHit(h,new al.Math.Vector2(W),F.getStyle("checkSize"))){if(r instanceof al.Group)return o.editing={},!0;var f=r.getWidth(),E=r.getHeight(),L=r.getAnchor();return o.editing={rect:{x:-f*L.x,y:-E*L.y,width:f,height:E},anchor:L,matrix:r.getMatrix()},!0}}}}},hs.prototype.startEdit=function(s,p){s.startDragging(p),s.fi({kind:"beginEditAnchor",event:p})},hs.prototype._46O=function(D){var c=this;c.editing&&(c.editing=null,c._interactor.fi({kind:"endEditAnchor",event:D})),c.tipInfo=null},hs.prototype.handleEdit=function($,e){var I=this,c=I.target;if(c){var R=I.editing;if(R){var C=$.lp(e),F=I._interactor;if(c instanceof al.Group)return c.setAnchor2(C),F._42(),void 0;var O=R.matrix,E=O.tfi(C),t=R.rect,l=(E.x-t.x)/t.width,Q=(E.y-t.y)/t.height;if(!H.Default.isCtrlDown(e)){var M=F.getStyle("anchorRound"),g=F.getStyle("anchorSensitivity");l=al.roundTo(l,M,g),Q=al.roundTo(Q,M,g)}c.setAnchor(l,Q,!0);var y=H.Default.getLogicalPoint(e,F._canvas);y.x+=al.Icons.TipShiftX,y.y+=al.Icons.TipShiftY;var L=""+l.toFixed(2)+", "+Q.toFixed(2);I.tipInfo={helperPos:y,text:L,size:L.length},F.fi({kind:"betweenEditAnchor",event:e})}}},hs.prototype._42=function(J,z,g){var t=this;t.info={},t.screenInfo={};var h=t._interactor;h.editDetail||t.gatherInfo(z,g)&&t.isVisible()&&(al.Icons.DrawIcon(h,J,al.Icons.Anchor,t.screenInfo),t.tipInfo&&al.Icons.DrawIcon(h,J,al.Icons.TipHelper,t.tipInfo))};var qd=al.MoveDummy=function(A){this.catalog="MoveDummy",this._interactor=A};qd.prototype={},qd.prototype.constructor=qd,qd.prototype.gatherInfo=function(){var h=this,a=this._interactor.getSubModule("Rect");if(a){var g=a.screenInfo;if(g){var P=h._interactor,M=h.getMovableTarget(a.target);if(M){var E=P.getStyle("moveDummyThreshold");if(E!==!1){var l=g.LT||g.P1,k=g.RT||g.P2,m=g.LB||l;if(l){var Z=g.P1,F=Math.min(l.distanceTo(m),l.distanceTo(k));if(!(E!==!0&&F>E)){var c=P.getStyle("moveDummyPosition"),J=k.clone().sub(l),y=m.clone().sub(l),j=c[2],d=c[3];if(Z){var i=P.getStyle("moveDummyLineExtraShift");i&&(j+=i[0],d+=i[1])}var O=l.clone().add(J.clone().multiplyScalar(c[0])).add(J.setLength(j)).add(y.clone().multiplyScalar(c[1])).add(y.setLength(d));return h.screenInfo.pos=O,h.screenInfo.size=P.getStyle("moveDummySensitivity"),!0}}}}}}},qd.prototype.getMovableTarget=function(V){var z=this._interactor.gv;if(mq(V)){if(z.isMovable(V))return V}else if(V instanceof al.Group)for(var T=V._entities,K=T.length-1;K>=0;K--){var B=T[K];if(mq(B)&&z.isMovable(B))return B}return null},qd.prototype.getMoveInteractor=function(){for(var Q,M,l,H=this._interactor.gv,d=H.getInteractors(),Q=0,M=d.length;M>Q;Q++)if(l=d.get(Q),l instanceof yn)return l},qd.prototype.startEdit=function(y,e){y.startDragging(e);var M=this.getMoveInteractor();if(M){var o=this.selectedTarget,P=y.gv;P._moving=1,M._data=o,P.handleMouseDown&&P.handleMouseDown(e,o)}},qd.prototype._46O=function(s){var Z=this,v=Z.getMoveInteractor();v&&(v.handleWindowMouseUp(s),Z.selectedTarget=null)},qd.prototype.handleEdit=function(l,h){var b=this.getMoveInteractor();b&&b.handleWindowMouseMove(h)},qd.prototype.check=function(K,F,$){if(this.selectedTarget=null,H.Default.isLeftButton(F)&&!K._scrolling&&!Xc()){var M=this;if(M.screenInfo){var n=M.screenInfo.pos;if(n&&!($.distanceTo(n)>M.screenInfo.size)){var B=M._interactor;return M.selectedTarget=M.getMovableTarget(B.getSubModule("Rect").target),B.setCursor("default"),!0}}}},qd.prototype._42=function(c,z,s){var n=this;n.screenInfo={};var x=n._interactor;x.editDetail||n.gatherInfo(z,s)&&(!x.editing||n.selectedTarget)&&al.Icons.DrawIcon(x,c,al.Icons.MoveDummy,n.screenInfo)};var Ki=al.RotateX=function(E){this.catalog="RotateX",this._interactor=E};Ki.prototype={},Ki.prototype.constructor=Ki,Ki.prototype.gatherInfo=function(J,j){var X=this;if(1===j.length){var E=j[0];return E instanceof H.Shape&&E._70I()||vc(E,J)?!1:X.gatherSingleTarget(J,E)}return j.length>1?X.gatherMultiTargets(J,j):!1},Ki.prototype.gatherSingleTarget=function(){var z=new H.Math.Vector2,A=new H.Math.Vector2,p=new H.Math.Vector2,Q=new H.Math.Vector2,i=function(s,y){var Z=s.x-y.x,f=s.y-y.y;return Z*Z+f*f};return function(y,q){if(q.getCorners){var N=this,l=q.getCorners(),x=15,d=q.getPosition();z.copy(l[0]),p.copy(l[1]),Q.copy(l[3]),A.copy(z).add(Q).divideScalar(2).add(z.sub(p).setLength(x/y.getZoom()));var h=Math.max(i(d,l[0]),i(d,l[1]),i(d,l[2]),i(d,l[3]));return N.info.POS=A.clone(),N.screenInfo.POS=al.toScreenPosition(y,N.info.POS),N.screenInfo.LEN=Math.sqrt(h)*y.getZoom()+x,N.screenInfo.CENTER=al.toScreenPosition(y,d),N.target=q,!0}}}(),Ki.prototype.gatherMultiTargets=function(c,$){var g=this,J=al.Group.findOrCreateGroup($,this._interactor._uuid);if(!J)return!1;var g=this;return g.gatherSingleTarget(c,J)},Ki.prototype.isVisible=function(){var X=this._interactor;if(!X.getStyle("rotateAsClock"))return!1;var G=this.target;if(!G)return!0;var y=X.gv;return y.isEditable(G)&&y.isRotationEditable(G)?!0:!1},Ki.prototype.check=function(I,G,W){var D=this,h=D._checkImpl(I,G,W);return(h||D._clockPainted)&&D._interactor._42(),h},Ki.prototype._checkImpl=function(N,b,s){if(H.Default.isLeftButton(b)){var e=this;e.editing=null,e.tipInfo=null;var W;if(e.screenInfo&&(W=e.screenInfo.POS)&&e.isVisible()){var B=e._interactor;if(al.checkHit(s,W,B.getStyle("checkSize"))){var _=e.target,y=N.lp(b),P=_.getPosition(),Z=Math.atan2(y.y-P.y,y.x-P.x);return B._setRotateCursor(Z),e.editing={pos:P,rotation:_.getRotation(),hitRot:Z,groupRotateMode:"block",screenInfo:{CENTER:e.screenInfo.CENTER,LEN:e.screenInfo.LEN}},!0}}}},Ki.prototype.startEdit=function(S,U){S.startDragging(U),S.fi({kind:"beginEditRotation",event:U}),this.target instanceof al.Group&&this.target.beginRotate(this.editing)},Ki.prototype._46O=function(W){var b=this;b.editing&&(b.editing=null,b._interactor.fi({kind:"endEditRotation",event:W})),b.target instanceof al.Group&&b.target.endRotate(),b.tipInfo=null},Ki.prototype.handleEdit=function(k,R){var t=this,O=t.editing;if(O){var r,x,p=t.target,h=k.lp(R),e=t._interactor,q=O.pos,l=Math.atan2(h.y-q.y,h.x-q.x),L=p instanceof al.Group;if(L?x=l-O.hitRot:(r=l-O.hitRot,x=O.rotation+r),x%=2*Math.PI,0>x&&(x+=2*Math.PI),!H.Default.isCtrlDown(R)){var E,z;An(R)?(E=e.getStyle("shiftRotateRound"),z=E/2):(E=e.getStyle("rotateRound"),z=e.getStyle("rotateSensitivity")),x=al.roundTo(x,E,z)}L?(r=x-(O.lastRotation||0),0!==r&&(p.addRotation(r,O.groupRotateMode,function(G){return k.isRotationEditable(G)}),O.lastRotation=x)):p.setRotation(x),e._setRotateCursor(l),x>Math.PI&&(x-=2*Math.PI);var C=180*(x/Math.PI),y=""+C.toFixed(2)+"°",Q=H.Default.getLogicalPoint(R,e._canvas);Q.x+=al.Icons.TipShiftX,Q.y+=al.Icons.TipShiftY,t.tipInfo={helperPos:Q,text:y,size:y.length},e.fi({kind:"betweenEditRotation",event:R})}},Ki.prototype._42=function(P,B,D){var Q=this;Q._clockPainted=!1,Q.info={},Q.screenInfo={};var J=Q._interactor;J.editDetail||Q.gatherInfo(B,D)&&Q.isVisible()&&(al.Icons.DrawIcon(J,P,al.Icons.RoundPoint,Q.screenInfo.POS),J.getStyle("rotateTipVisible")&&Q.tipInfo&&al.Icons.DrawIcon(J,P,al.Icons.TipHelper,Q.tipInfo),Q.editing&&Q.drawClock(P))},Ki.prototype.drawClock=function(F){F.save();var X=this;X._clockPainted=!0;var H=X.editing||{},s=H.screenInfo||X.screenInfo,T=s.LEN,y=T+8,l=T+18;F.save(),F.translate(s.CENTER.x,s.CENTER.y),F.beginPath(),F.strokeStyle="rgb(150, 150, 150)";for(var A,g,u,h,k,Z=0;360>Z;Z++)A=Z*Math.PI/180,0===Z%5&&(g=J(A)*T,u=B(A)*T,h=J(A)*y,k=B(A)*y,F.moveTo(g,u),F.lineTo(h,k)),0===Z%45&&(g=J(A)*T,u=B(A)*T,h=J(A)*l,k=B(A)*l,F.moveTo(g,u),F.lineTo(h,k));F.stroke(),F.rotate(-qq);var z=H.lastRotation||X.target.getRotation();F.beginPath(),F.fillStyle="rgba(255, 0, 0, 0.1)",F.strokeStyle="rgb(157, 157, 157)",F.moveTo(0,0),F.arc(0,0,l,0,z,!1),F.fill(),F.beginPath(),F.moveTo(0+l,0),F.arc(0,0,l,0,z,!1),F.stroke(),F.restore()};var Me=al.Curve=function(l){this.catalog="Curve",this._interactor=l};Me.prototype={},Me.prototype.constructor=Me,b.defineProperties(Me.prototype,{activing:{get:function(){return this._activing},set:function(K){var q=this;if(K)q._activing=new al.CurveActiving(this,K),q.gatherSingleTarget(q._interactor.gv,q.target);else{var Q=q._activing;Q&&Q.dispose(),q._activing=null}}}}),Me.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},Me.prototype.setUp=function(){var l=this,L=l._interactor;L&&L.gv.mp(l._onGraphviewPropertyChanged,l)},Me.prototype._onGraphviewPropertyChanged=function(M){("zoom"===M.property||"translateX"===M.property||"translateY"===M.property)&&this._handleDataChanged()},Me.prototype.tearDown=function(){var R=this,K=R._interactor;K&&K.gv.ump(R._onGraphviewPropertyChanged,R)
},Me.prototype.canEnterEditDetailMode=function(){var _=kc(this._interactor);return _?this.target=_:void 0},Me.prototype.canQuitEditDetailMode=function($){var S=this,G=S._interactor._getLogicalPoint($);return S._checkEditRealPoint(G)?void 0:S._interactor.gv.getDataAt($)!==S.target?!0:void 0},Me.prototype.preHandleScroll=function(){var c=this.editing;return c&&c.inEdit?!0:void 0},Me.prototype.getCurrentSelectintStatus=function(){var w=this;if(w.activing&&!w.activing.selections){if(w.activing.status!=E)return w.activing.status;var f=function(R){var T=w.activing.status;w.activing.status=R,w._interactor.fp("shapePointStatus",T,R)},p=al.Curve.PointType,Z=w.activing.point,C=w.activing.pairs;if(!C||1!==C.length)return f(p.Mirrored);var B=C[0],x=B.c1&&B.c1.isNearEnough(Z),t=B.c2&&B.c2.isNearEnough(Z);if(!B.c1||!B.c2)return x||t?f(p.Straight):f(p.Disconnected);if(x&&t)return f(p.Straight);if(x||t)return f(p.Asymmetric);var L=B.c1.clone().sub(Z),T=B.c2.clone().sub(Z);return Math.abs(L.x*T.y-L.y*T.x)>1e-5||L.x*T.x>0?f(p.Disconnected):Math.abs(L.length()-T.length())>1e-5?f(p.Asymmetric):f(p.Mirrored)}},Me.prototype.handle_keydown=function(e){var n=this;if(n._interactor.editDetail){var S=al.Curve.PointType;"1"===e.key?n._setCurrentSelectionStatus(S.Straight):"2"===e.key?n._setCurrentSelectionStatus(S.Mirrored):"3"===e.key?n._setCurrentSelectionStatus(S.Disconnected):"4"===e.key&&n._setCurrentSelectionStatus(S.Asymmetric)}},Me.prototype.setCurrentSelectionStatus=function(X){var N=this,$=N._interactor;if($){var Q=$.gv;Q.dm().beginTransaction(),this._setCurrentSelectionStatus(X),Q.dm().endTransaction()}},Me.prototype._setCurrentSelectionStatus=function(s){var X=this,_=X.activing;if(_){var b=X.getCurrentSelectintStatus();if(null!==b&&b!==s){_.status=s;var o=X.activing.point,L=X.activing.pairs;if(L&&1===L.length){var l=L[0],n=X.screenInfo.curve,p=al.Curve.PointType,E=X._interactor,z=function(){X._writeToHt(),E.fp("shapePointStatus",b,s),X.check(E.gv,null,new al.Math.Vector2(E._lastLogicalPoint))};if(s===p.Straight)return n.moveCtrlPoint(l,o,"c1"),n.moveCtrlPoint(l,o,"c2"),z(),void 0;if(b===p.Straight){var r=n.findPairs(o,!0),e=r[0],d=e.r1||o,x=e.r2||o,t=x.clone().sub(d).multiplyScalar(.25);return n.moveCtrlPoint(l,o.clone().sub(t),"c1"),n.moveCtrlPoint(l,o.clone().add(t),"c2"),z(),void 0}var P=l.c1,I=l.c2;if(P&&I){if(s===p.Mirrored)return n.moveCtrlPoint(l,o.clone().multiplyScalar(2).sub(I),"c1"),z(),void 0;if(s===p.Asymmetric&&b===p.Disconnected){var $=P.clone().sub(o).length(),t=o.clone().sub(I).setLength($).add(o);return n.moveCtrlPoint(l,t,"c1"),z(),void 0}}_._firePointChange(),E.fp("shapePointStatus",b,s),X.check(E.gv,null,new al.Math.Vector2(E._lastLogicalPoint))}}}},Me.prototype._handleDataChanged=function(){var q="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(x){var S=this;if(S.screenInfo&&S.target){if(x&&q.indexOf(x.property)<0)return;var $=S._interactor;S.gatherSingleTarget($.gv,S.target,!0),S.check($.gv,null,new al.Math.Vector2($._lastLogicalPoint)),$._42()}}}(),Me.prototype.gatherSingleTarget=function(L,u,V){var Q,C,S=this;S.screenInfo&&S.screenInfo.curve&&(C=S.screenInfo.curve._curves);var F=S.editing;Q=F?S.screenInfo:S.screenInfo={};var R,v,x=u instanceof H.Edge;x?(R=u.s("edge.segments"),v=u.s("edge.points")||new H.List):(R=u._58O,v=u._59O),Q.S=R;var P,d=Q.P=[],G=al.getDataMatrix(u);if(u instanceof H.Polyline||u instanceof H.Edge&&S._interactor.getStyle("edgeElevationEditable"))P=u.getElevation&&u.getElevation()||0,Q.E=[];else{var j=!1;v.each(function(P){P.e!==E&&(j=!0)}),j&&(Q.E=[])}if(v.each(function(f){Q.E&&Q.E.push(f.e!=E?f.e:P),f=G.apply(f);var K=al.toScreenPosition(L,f);d.push(K.x,K.y)}),x){var g=d.length,a=al.toScreenPosition(L,u._lastSourcePoint||(g?{x:d[0],y:d[1]}:{x:0,y:0})),J=al.toScreenPosition(L,u._lastTargetPoint||(g?{x:d[g-2],y:d[g-1]}:{x:0,y:0}));if(d.splice(0,0,a.x,a.y),d.push(J.x,J.y),Q.E){var $=u.getSourceAgent();$ instanceof H.Edge?Q.E.splice(0,0,u.s("edge.source.offset.elevation")):Q.E.splice(0,0,((u.s("edge.source.anchor.elevation")||.5)-.5)*$.getTall()*$.getScaleTall()+$.getElevation()+u.s("edge.source.offset.elevation"));var t=u.getTargetAgent();t instanceof H.Edge?Q.E.push(u.s("edge.target.offset.elevation")):Q.E.push(((u.s("edge.target.anchor.elevation")||.5)-.5)*t.getTall()*t.getScaleTall()+t.getElevation()+u.s("edge.target.offset.elevation"))}}if(!Q.S||!Q.S.size()){Q.S=new H.List,Q.S.add(1);for(var X=0;X<d.length/2-1;X++)Q.S.add(2)}if((!F||V)&&S.convertToCubicBezier(C),S.activing&&(V||!S.editing||"realPoint"===S.editing.type)){var I=Q.curve.findPairs(S.activing.point);S.activing.pairs=I}},Me.prototype._convertToNewPoint=function(r,j,p,F){var $,U,y;for($=0,U=j.length;U>$;$++){if(y=j[$],y._p1.isNearEnough(r)&&(!F||F.indexOf(y._p1)<0))return y._p1;if(y._p4.isNearEnough(r)&&(!F||F.indexOf(y._p4)<0))return y._p4}if(p)for($=0,U=Math.min(p.length,U);U>$;$++){if(y=p[$],y._p1===r&&(!F||F.indexOf(j[$]._p1)<0))return j[$]._p1;if(y._p4===r&&(!F||F.indexOf(j[$]._p4)<0))return j[$]._p4}},Me.prototype.convertToCubicBezier=function(w){var Q,M,h=this,J=new al.Math.Curve,W=h.screenInfo;if(J.createFromHtShape(W.P,W.S,W.E),W.curve=J,h.activing){var F=J._curves;Q=h.activing.point,M=h._convertToNewPoint(Q,F,w);var e=[];if(M&&(h.activing.point=M,e.push(M)),h.activing.selections){var X=-1,D=h.activing.selections;D.forEach(function(Q){X++,M=h._convertToNewPoint(Q,F,w,e),M&&(D[X]=M,e.push(M))})}}},Me.prototype.check=function(R,b,F){if(!b||zj(b)||Jl(b)){var S=this;if(S._interactor.setCursor("default"),S.editing=null,S.highlight=null,S.tipInfo=null,S.edgeEditResult=null,S.screenInfo){if(Xc()||b&&Jl(b))return S._interactor._42(),!0;if(S._checkEditCtrlPoint(F))return S._interactor._42(),!0;if(S._checkEditRealPoint(F))return S._interactor._42(),!0;if(S._checkEditElevation(F))return S._interactor._42(),!0;var D=S.screenInfo.curve,d=D.checkPoint(F,S._interactor.getStyle("curveIntersectSize"));if(d){var r=S.highlight={};r.type="insertKnot",r.bezier=d.bezier,r.point=d.intersection}return S._interactor._42(),!0}}},Me.prototype.getAdjacentBeziers=function(X){var $=this.screenInfo;if($){var U,s,c,h=$.curve._curves,p=[],V=E;for(U=0,s=h.length;s>U;U++)if(c=h[U],V===E){if(c._p4.isNearEnough(X)){p.push(c),V=U;continue}}else{if(c._p1.isNearEnough(X))return p.push(c),p;if(c._p4.isNearEnough(X)){p[0]=c,V=U;continue}}}},Me.prototype.roundCorner=function(e){if(this.activing&&this.screenInfo){var s=this.screenInfo.curve,T=s._curves,l=this.getAdjacentBeziers(this.activing.point),v=l[1],b=v._index;v=v.insertKnot(v.getTByPercentage(e/v.length))[1],T[b]=v;var X=v.p1,c=l[0],K=c._index;c=c.insertKnot(c.getTByPercentage(1-e/c.length))[0],T[K]=c;var z=c.p4,O=this.activing.point,L=new al.Math.CubicBezier(z,O.clone().sub(z).multiplyScalar(2/3).add(z),O.clone().sub(X).multiplyScalar(2/3).add(X),X);T.splice(b,0,L),this._writeToHt(),this.activing=null,this._interactor._42()}},Me.prototype._checkEditRealPoint=function(B){var Q,m,u,U,l,J,S=this,t=S.screenInfo.curve._curves,R=S._interactor.getStyle("curvePointIntersectSize"),P=1/0;for(R*=R,u=0,U=t.length;U>u;u++)Q=t[u],l=Q._p1,J=B.distanceToSquared(l),P>J&&(P=J,m=l),l=Q._p4,J=B.distanceToSquared(l),P>J&&(P=J,m=l);if(P>R)return!1;var Y=S.highlight={};return Y.type="changeRealPoint",Y.point=m,S.editing={type:"realPoint",point:m,shiftGuide:{point:m.clone(),dir:"x",limit:0}},S._interactor.setCursor("crosshair"),!0},Me.prototype._checkEditElevation=function(X){var t=this;if(!t._interactor.getStyle("curveElevationVisible"))return!1;var a=t.target;if(a instanceof H.Edge&&!t._interactor.getStyle("edgeElevationEditable"))return!1;var y=t.activing;if(!y)return!1;var d=y.getCurrentEditingPoint();if(!d)return!1;var i=t._interactor,o=i.getStyle("curveElevationGuideShift"),q=i.getStyle("curveElevationIntersectSize"),O=X.distanceToSquared({x:d.x+o[0],y:d.y+o[1]});if(!(O>q*q)){var U=t.highlight={};U.type="elevation";var z=new al.Math.Vector2(X.x,X.y,d.e);return t.editing={type:"elevation",startPoint:z},t._interactor.setCursor("crosshair"),!0}},Me.prototype._checkEditCtrlPoint=function(i){var h=this;if(h.activing&&!h.activing.selections){var I=h.getCurrentSelectintStatus();if(I!==al.Curve.PointType.Straight){var a=h.activing.pairs;if(a){var C=h._interactor.getStyle("curvePointIntersectSize");C*=C;var A,n,N,S,t,P,e,O,B,G=1/0;for(e=0,B=a.length;B>e;e++)for(S=a[e],O=0;2>O;O++)t=0===O?"c1":"c2",S[t]&&(P=i.distanceToSquared(S[t]),G>P&&(G=P,A=S,n=e,N=t));if(G>C)return!1;h.activing.hlpair=A,h.activing.hltype=N;var Y=h.highlight={};return Y.type="changeCtrlPoint",Y.point=A[N],h.editing={type:"ctrlPoint",pair:A,pairId:n,ctrlType:N,direction:A[N].clone().sub(h.activing.point).normalize()},h._interactor.setCursor("crosshair"),!0}}}},Me.prototype.startEdit=function(t,S){t.startDragging(S);var O=this;O.highlight&&"insertKnot"===O.highlight.type&&(O.insertKnot(),O.gatherSingleTarget(O._interactor.gv,O.target),O.activing=null,O._checkEditRealPoint(O._interactor._getLogicalPoint(S)));var b=O._activing;if(b){var N=O.editing?O.editing.type:null;"ctrlPoint"===N?b.editingCtrl={pairId:O.editing.pairId,type:b.hltype}:"realPoint"===N&&(b.editingCtrl=!1)}var e=O.highlight,J=H.Default.isCtrlDown(S);if(!e||Xc()||Jl(S)){var C=O._interactor.gv;if(!C.setFocus(S)||C._scrolling)return;return J?O._multiSelect={startPoint:C.lp(S)}:C.isPannable()&&(zj(S)||Jl(S))&&(O._pan={tx:C.tx(),ty:C.ty()},t.fi({kind:"beginPan",event:S})),void 0}if("changeRealPoint"===e.type){var W,M=O.activing?O.activing.point:null,I=O.activing?O.activing.selections:null;if(J&&O.activing)M===e.point?(I?(O.activing={point:I[0]},I.length>1&&(I.splice(0,1),O.activing.selections=I)):O.activing=null,O.editing=null):I&&(W=I.indexOf(e.point))>=0?(I.length>1?I.splice(W,1):delete O.activing.selections,O.editing=null):I?(I.push(M),O.activing={point:e.point,selections:I}):O.activing={point:e.point,selections:[M]};else if(I)M===e.point||((W=I.indexOf(e.point))>=0?(I.splice(W,1,M),O.activing={point:e.point,selections:I}):O.activing={point:e.point});else{var r;M===e.point&&(r=O.activing.status),O.activing={point:e.point},r&&(O.activing.status=r)}t.fi({kind:"beginEditPoint",event:S})}},Me.prototype.insertKnot=function(){var K=this,X=K.highlight,p=K.screenInfo.curve;p.insertKnot(X.bezier,X.point.t),K._writeToHt()},Me.prototype._writeToHt=function(){var u,$,x=this,k=x.screenInfo.curve,c=k.toHtShape(),p=c.points,j=[],M=c.segments,r=x._interactor.gv;r.dm().beginTransaction();var n,W,d=x.target,E=d instanceof H.Edge,X=al.getDataMatrix(d).invert();W=d instanceof H.Polyline||E&&x._interactor.getStyle("edgeElevationEditable"),W&&(n=d.getElevation&&d.getElevation()||0);for(var Z=0,G=p.length;G>Z;Z++)u=p[Z],$=al.toWorldPosition(r,u),$=X.apply($),isFinite(u.e)&&u.e!==n&&($.e=u.e),j.push($);if(d._writing=!0,E){d.s("edge.type","points"),d.setStyle("edge.segments",M),d.setStyle("edge.points",j.slice(1,j.length-1)),d.setStyle("edge.source.offset.x",0),d.setStyle("edge.source.offset.y",0),d.setStyle("edge.target.offset.x",0),d.setStyle("edge.target.offset.y",0);var f=x._nextChangeEdgeHost;delete x._nextChangeEdgeHost,f&&("source"===f.type?d.setSource(f.host):d.setTarget(f.host)),x._writeEdgeHostAnchor("source",j[0]),x._writeEdgeHostAnchor("target",j[j.length-1])}else j.length?(d.setSegments(M),d.setPoints(j,!0)):d.removeFromDataModel();r.dm().endTransaction(),delete d._writing},Me.prototype._writeEdgeHostAnchor=function(C,i){var X=this,G=X.target,u=X._calcHostAnchor(G,C,i);u.index!==E?(G.setStyle("edge."+C+".index",u.index),G.setStyle("edge."+C+".percent",E),G.setStyle("edge."+C+".anchor.x",E),G.setStyle("edge."+C+".anchor.y",E),G.setStyle("edge."+C+".anchor.elevation",E),G.setStyle("edge."+C+".offset.elevation",i.e)):u.percent!==E?(G.setStyle("edge."+C+".percent",u.percent),G.setStyle("edge."+C+".index",E),G.setStyle("edge."+C+".anchor.x",E),G.setStyle("edge."+C+".anchor.y",E),G.setStyle("edge."+C+".anchor.elevation",E),G.setStyle("edge."+C+".offset.elevation",i.e)):(G.s("edge."+C+".anchor.x",u.x),G.s("edge."+C+".anchor.y",u.y),G.s("edge."+C+".anchor.elevation",u.e),u.offsetX||u.offsetY||u.offsetElevation?(G.s("edge."+C+".offset.x",u.offsetX),G.s("edge."+C+".offset.y",u.offsetY),G.s("edge."+C+".offset.elevation",u.offsetElevation)):(G.s("edge."+C+".offset.x",0),G.s("edge."+C+".offset.y",0),G.s("edge."+C+".offset.elevation",0)))},Me.prototype._calcHostAnchor=function(x,h,P,C){C||(C="source"===h?x.getSource():x.getTarget());var t=this._interactor.gv,r=t.calculateAttachPoint(C,P);if(r)return r.info;if(Op(C)){var c=t.calculateEdgePosition(C,P);return c}var Y=C.getRotation(),e=C.getAnchor();vc(C,t)&&(Y=0);var y=C.getElevation(),G=C.getTall()*C.getScaleTall();y=((P.e||0)-x.s("edge."+h+".offset.elevation")-y)/G+.5;var J=C.getScale();if(Y||J.x<0||J.y<0){var Q=C.getMatrix(),M=Q.tfi(P),N=C.getSize();return{x:M.x/N.width+e.x,y:M.y/N.height+e.y,e:y}}var d=Cc(t,C),O={x:(P.x-d.x)/d.width,y:(P.y-d.y)/d.height,e:y};return O},Me.prototype._handlePanning=function($){var f=this,U=f._pan;if(U){U.started=!0;var L=f._interactor,B=L.gv,k=L._lastClientPoint,i=dg($),D=dc(B,i,k);B.setTranslate(U.tx+D.x,U.ty+D.y),f.gatherSingleTarget(L.gv,f.target),L._42(),L.fi({kind:"betweenPan",event:$})}},Me.prototype.handleEdit=function(k,o){var b=this,x=b.editing;if(b._pan)return b._handlePanning(o),void 0;if(b._multiSelect)return b._multiSelect.endPoint=k.lp(o),b._interactor.redraw(),void 0;if(x){x.inEdit=!0;var v,Y,d,S=b._interactor._getLogicalPoint(o),T=H.Default.isCtrlDown(o),R=H.Default.isShiftDown(o),z=x.type,p=b.activing;if(b._guideInfo=null,"ctrlPoint"===z&&R){var c=b.editing.direction.clone();v=p.point;var V=c.dot(S.clone().sub(v));S=c.setLength(V).add(v)}else if("ctrlPoint"===z||"realPoint"===z){var c;if("realPoint"===z&&R){var O=b.editing.shiftGuide;Y=O.point;var u=Math.abs(S.x-Y.x),n=Math.abs(S.y-Y.y);u>n&&u>O.limit&&"y"===O.dir&&(O.dir="x"),n>u&&n>O.limit&&"x"===O.dir&&(O.dir="y"),c=O.dir,"x"===c?(S.y=Y.y,O.limit=Math.max(O.limit,u)):"y"===c&&(S.x=Y.x,O.limit=Math.max(O.limit,n))}if(!T){var r,X=b._isEditEdgeSourceTarget();X&&(r=S.clone());var y=b._guidingToEdit(S,c),m="realPoint"===z?b._interactor.gridGuide.findClosest(S,c,!0):null,B=1/0,_=1/0;m&&(m.x&&(B=m.x),m.y&&(_=m.y));var M=!1;if(y&&(y.xList&&(Math.abs(y.x)<=Math.abs(B)?(M=!0,B=y.x):delete y.xList),y.yList&&(Math.abs(y.y)<=Math.abs(_)?(M=!0,_=y.y):delete y.yList),M&&(b._guideInfo=y)),isFinite(B)&&(S.x+=B),isFinite(_)&&(S.y+=_),M&&(y.v=S),X){var h=M?S.clone():null;S.copy(r);var L=b._editEdgeSourceTarget(X,S,T,h);L&&(b.edgeEditResult=L,d=L.tipText,L.isFixed&&(b._guideInfo=null))}}}var I=b.screenInfo.curve;if("realPoint"===x.type){v=x.point,v.e!==E&&(S.e=v.e),I.moveRealPoint(v,S),x.point=S,b.highlight.point=S;var D=p.status,t=p.selections;if(b.activing={point:S,status:D},t){var g=S.clone().sub(v),Q=0;t.forEach(function(N){var L=N.clone().add(g);I.moveRealPoint(N,L),t[Q++]=L}),b.activing.selections=t}}else if("ctrlPoint"===x.type){var J=p.pairs,W=J[x.pairId];I.moveCtrlPoint(W,S,x.ctrlType);var i=p.status,U=al.Curve.PointType;if((i===U.Mirrored||i===U.Asymmetric)&&W.c1&&W.c2){var v=new al.Math.Vector2(p.point),N="c1"===x.ctrlType?"c2":"c1";if(i===al.Curve.PointType.Mirrored)I.moveCtrlPoint(W,v.clone().multiplyScalar(2).sub(S),N);else if(i===U.Asymmetric){var V=W[N].clone().sub(v).length(),j=v.clone().sub(W[x.ctrlType]).setLength(V).add(v);isNaN(j.x)||I.moveCtrlPoint(W,j,N)}}p._firePointChange()}else if("elevation"===x.type){Y=x.startPoint;var q=Y.e+(Y.y-S.y)/k._zoom;b._setCurrentPointImpl("e",q),p._firePointChange(),d="E: "+al.toFixed(q)}var f=H.Default.getLogicalPoint(o,b._interactor._canvas);if(f.x+=al.Icons.TipShiftX,f.y+=al.Icons.TipShiftY,!d){var C=al.toWorldPosition(k,S);d=""+al.toFixed(C.x)+", "+al.toFixed(C.y)}b.tipInfo={helperPos:f,text:d,size:d.length},b._writeToHt(),b._interactor.fi({kind:"betweenEditPoint",event:o})}},Me.prototype._setCurrentPointImpl=function(r,x){var Q=this,S=Q._activing;if(!S)return!1;var y=Q.target;if(!y)return!1;var B=S.getCurrentEditingPoint();if(!B)return!1;var N=S.editingCtrl;if(!N)var H=B.clone();if("e"===r)B.e=x;else{var m;if("x"===r||"y"===r){var i=S._lastFirePoint;m="x"===r?{x:x,y:i?i.y:0}:{x:i?i.x:0,y:x}}else"object"==typeof r?(m=r,r.e!==E&&(B.e=r.e)):(m={x:arguments[0],y:arguments[1]},arguments[2]!==E&&(B.e=arguments[2]));var O=al.getDataMatrix(y);m=al.toScreenPosition(Q._interactor.gv,O.apply(m)),B.x=m.x,B.y=m.y}if(!N){var f=H.multiplyScalar(-1).add(B);$c(B.e)&&$c(H.e)&&(f.e=B.e-H.e);var e=Q.screenInfo.curve;e.moveCtrlDueToRealPointMovement(B,f);var A=S.selections;if(A){var s=0;A.forEach(function(i){var G=i.clone().add(f);isFinite(f.e)&&(G.e=(isFinite(i.e)?i.e:y.getElevation()||0)+f.e),e.moveRealPoint(i,G),A[s++]=G}),S.selections=A}}return!0},Me.prototype.setCurrentPoint=function(b,p){return this._setCurrentPointImpl(b,p)?(this._writeToHt(),!0):!1},Me.prototype._isEditEdgeSourceTarget=function(){var M=this,x=M.target;if(!(x instanceof H.Edge))return!1;var U=M.editing.point,h=M.screenInfo.curve._curves;return U===h[0]._p1?"source":U===h[h.length-1]._p4?"target":!1},Me.prototype._editEdgeSourceTarget=function(C,L,c,b){var l,S=this,K=S.target;if(l="source"===C?K.getSource():K.getTarget()){var N,m=S._interactor.gv,o=al.toWorldPosition(m,L),I=S._calcHostAnchor(K,C,o,l);if(N=I.index!==E||I.percent!==E?I.distance*m.getZoom()>S._interactor.getStyle("edgeHostEdgeMaxDistance"):S._interactor.getStyle("edgeHostDetectPerFrame")?!0:I.x<0||I.x>1||I.y<0||I.y>1?!0:!1){var G=m.getDataAt(o,function(Y){return m.isSelectable(Y)?m.isSourceTargetEditable(K,Y,C)?K.canSetSourceTarget(Y,C)?!0:!1:!1:!1});if(G){var k=S._calcHostAnchor(K,C,o,G);l=G,S._nextChangeEdgeHost={type:C,host:G},I=k}}var z,R,X,t=!1;if(c||I.x===E)(I.percent!==E||I.index!==E)&&(t=!0,R=I.point);else{var s=S._interactor.getStyle("anchorRound"),P=S._interactor.getStyle("anchorSensitivity");z=m.calculateAttachPoint(l,o),z?(I=z.info,t=!0):(b&&(I=S._calcHostAnchor(K,C,al.toWorldPosition(m,b),l)),I.x=al.roundTo(I.x,s,P),I.y=al.roundTo(I.y,s,P)),R=$q(m,l,0,I.offsetX||0,I.offsetY||0,I.x,I.y)}R&&(X=al.toScreenPosition(m,R),L.x=X.x,L.y=X.y),S._edgeHostGuideInfo={corners:al.getTargetCornersOnScreen(m,l),attach:z?z.index:-1,host:l};var M;return I.percent!==E?M="percent: "+I.percent.toFixed(2):I.index!==E?M="index: "+I.index:(M=""+I.x.toFixed(2)+", "+I.y.toFixed(2),(I.offsetX||I.offsetY)&&(M+=" offset: "+I.offsetX.toFixed(2)+", "+I.offsetY.toFixed(2))),{host:l,anchor:I,tipText:M,isFixed:t}}},Me.prototype._guidingToEdit=function(N,t){var m,Z,J=this;if(m=J.screenInfo.curve){Z=m._curves;var X,W,Y,a,D,_,w,G,s=1/0,x=1/0,O=[];for(J.editing&&"realPoint"===J.editing.type&&(G=J.editing.point),D=0,_=2*Z.length;_>D;D++)w=Z[Math.floor(D/2)][D%2?"_p4":"_p1"],O.indexOf(w)>=0||(O.push(w),G&&G===w||(Y=w.x-N.x,a=w.y-N.y,Math.abs(Y)<Math.abs(s)?(s=Y,X=[w]):Y===s&&X.push(w),Math.abs(a)<Math.abs(x)?(x=a,W=[w]):a===x&&W.push(w)));var l=J._interactor.getStyle("smartGuideThreshold");if((Math.abs(s)>l||"y"===t)&&(X=null),(Math.abs(x)>l||"x"===t)&&(W=null),X||W){var j=!1,g={};if(X&&(j=!0,g.xList=X,g.x=s),W&&(j=!0,g.yList=W,g.y=x),j)return g}}},Me.prototype._46O=function(_){var C=this;C.editing&&(C.editing=null,C._interactor.fi({kind:"endEditPoint",event:_})),C._guideInfo=null,C._edgeHostGuideInfo=null,C._pan&&(C._pan=null,C._interactor.fi({kind:"endPan",event:_})),C._multiSelect&&(C._handleMultiSelect(C._multiSelect,_),C._multiSelect=null),C.tipInfo=null,C.edgeEditResult=null},Me.prototype._handleMultiSelect=function(W,t){if(W.startPoint&&W.endPoint){var w,o,d,r,z,D,u=this,O=u._interactor,_=O.gv,Y=al.toScreenPosition(_,W.startPoint),$=al.toScreenPosition(_,W.endPoint),k=H.Default.unionPoint(Y,$),B=u.screenInfo.curve._curves,L=[],j=function(C){C.x>=k.x&&C.y>=k.y&&C.x<=k.x+k.width&&C.y<=k.y+k.height&&L.indexOf(C)<0&&L.push(C)};for(w=0,o=B.length;o>w;w++)z=B[w],j(z._p1),j(z._p4);if(L.length){var Z=u.activing||{},F=Z.selections||[];Z.point&&F.push(Z.point);var T=H.Default.isShiftDown(t),I=t.altKey;if(I&&!T)for(D=L,L=[],w=0,o=D.length;o>w;w++)d=D[w],r=F.indexOf(d),r>=0&&L.push(d);for(w=0,o=F.length;o>w;w++)d=F[w],r=L.indexOf(d),r>=0?(!T||T&&I)&&(L[r]=E):L.push(d);for(D=L,L=[],w=0,o=D.length;o>w;w++)D[w]&&L.push(D[w]);o=L.length,0===o?u.activing=null:1===o?u.activing={point:L[0]}:(d=L[o-1],u.activing={point:d,selections:L.splice(0,o-1)}),O.redraw()}}},Me.prototype._canDeletePoint=function(y,W){var M=this.target;if(!(M instanceof H.Edge))return!0;var j=y._curves[0],Q=y._curves[y._curves.length-1];return j._p1===W||Q._p4===W?!1:!0},Me.prototype.handleDelete=function(){var Q=this;if(Q.activing&&Q.screenInfo){var b=H.Default.isShiftDown(),n=Q.screenInfo.curve;Q._canDeletePoint(n,Q.activing.point)&&n.deleteRealPoint(Q.activing.point,b),Q.activing.selections&&Q.activing.selections.forEach(function(X){Q._canDeletePoint(n,X)&&n.deleteRealPoint(X,b)}),Q.activing=null,delete Q.editing,delete Q.tipInfo,delete Q.edgeEditResult,delete Q._pan,delete Q._multiSelect,Q._writeToHt(),Q._interactor.fp("deleteShapePoint",!1,!0)}},Me.prototype.handleDoubleClick=function(v){var K=this,F=K._interactor._getLogicalPoint(v);if(K.screenInfo&&K._checkEditRealPoint(F)){var u=K.getCurrentSelectintStatus(),m=al.Curve.PointType;return u=u===m.Mirrored?m.Straight:m.Mirrored,K._setCurrentSelectionStatus(u),K._interactor._42(),!0}},Me.prototype._drawHighlight=function(g){var z=this,H=z.highlight;if(H){var v=H.bezier,t=z._interactor;v&&al.Icons.DrawIcon(t,g,al.Icons.ShapeHighlightCurve,[v._p1.x,v._p1.y,v._p2.x,v._p2.y,v._p3.x,v._p3.y,v._p4.x,v._p4.y]);var F=H.point;F&&"insertKnot"===H.type&&al.Icons.DrawIcon(t,g,al.Icons.ShapeHighlighPoint,F)}},Me.prototype._drawGuide=function(n){var e=this,R=e._guideInfo;if(R){var X,S,A,P,b=R.v;for(X=0;2>X;X++)if(P=0===X?R.xList:R.yList)for(S=0,A=P.length;A>S;S++)al.Icons.DrawIcon(e._interactor,n,al.Icons.ShapeGuideLine,[b.x,b.y,P[S].x,P[S].y])}},Me.prototype._drawCurrentPoint=function(i){var c=this;if(c.activing){var X=c.activing,v=c.getCurrentSelectintStatus(),e=c._interactor;if(v!==al.Curve.PointType.Straight){var F=X.pairs;X.hlpair,X.hltype;var d=X.selections,O=X.editingCtrl;if(F&&!d){var f,V,A;for(V=0,A=F.length;A>V;V++)f=F[V],O&&V===O.pairId&&f[O.type]?al.Icons.DrawIcon(e,i,al.Icons.ShapeActivingCtrl,{point:f.point,c1:f.c1,c2:f.c2,hl:O.type}):al.Icons.DrawIcon(e,i,al.Icons.ShapeActivingCtrl,f)}}al.Icons.DrawIcon(e,i,al.Icons.ShapeHighlighRealPoint,c.activing.point),d&&d.forEach(function(E){al.Icons.DrawIcon(e,i,al.Icons.ShapeHighlighRealPoint,E)})}},Me.prototype.clear=function(){var I=this;I.editing=null,I._guideInfo=null,I.activing=null,I.highlight=null},Me.prototype._42=function(s){var d=this;d.info={},d.editing||(d.screenInfo=null);var A=d._interactor;if(!A.editDetail)return d.clear(),void 0;var g=A.gv;if(!d.target||!g.isSelected(d.target)||!g.isVisible(d.target))return A.editDetail=!1,d.clear(),void 0;if(d.gatherSingleTarget(g,d.target),al.Icons.DrawIcon(A,s,al.Icons.ShapeBgCurve,d.screenInfo),d._interactor.getStyle("curveElevationVisible")&&(d.target instanceof H.Polyline||d.target instanceof H.Edge&&d._interactor.getStyle("edgeElevationEditable"))&&d.activing){var t=d.activing.getCurrentEditingPoint();t&&"string"!=typeof t.e&&al.Icons.DrawIcon(A,s,al.Icons.EdgeElevationGuide,t)}if(d._drawHighlight(s),d._drawCurrentPoint(s),d._getRealPoint().forEach(function(D){al.Icons.DrawIcon(A,s,al.Icons.ShapePoint,D)}),d._drawGuide(s),d.tipInfo&&d._interactor.getStyle("curveTipVisible")&&al.Icons.DrawIcon(A,s,al.Icons.TipHelper,d.tipInfo),d._edgeHostGuideInfo&&A._drawHostGuide(d._edgeHostGuideInfo),d.edgeEditResult&&d._drawEdgeHostHighlight(s,d.edgeEditResult.host,d.edgeEditResult.anchor),d._multiSelect&&d._multiSelect.endPoint){var P=H.Default.unionPoint(al.toScreenPosition(g,d._multiSelect.startPoint),al.toScreenPosition(g,d._multiSelect.endPoint));P.color=g.getRectSelectBorderColor(),s.save(),s.setTransform(1,0,0,1,0,0);var y=L.devicePixelRatio,x=P.borderWidth=Math.round(y);x/=2,P.x=Math.round(P.x*y)+x,P.y=Math.round(P.y*y)+x,P.width=Math.round(P.width*y),P.height=Math.round(P.height*y),al.Icons.DrawIcon(A,s,al.Icons.SimpleRect,P),s.restore()}},Me.prototype._drawEdgeHostHighlight=function(p,q,J){this.drawEdgeHostHighlight(p,q,J),this._interactor.redraw()},Me.prototype.drawEdgeHostHighlight=function(g,X,a){if(Op(X)){var s,t,k,P,T=this,N=T._interactor,i=N.gv,j=i.getDataUI(X),Q=jn(j),C=[];for(k=0,P=Q.points.length;P>k;k++)t=al.toScreenPosition(i,Q.points.get(k)),C.push(t.x,t.y);Q.segments&&(s=Q.segments.toArray());var n=N.getStyle("edgeHostHighlighPeriod"),b=N.getStyle("edgeHostEdgeHighlighColor");al.Icons.DrawIcon(N,g,al.Icons.ShapeBgCurve,{P:C,S:s,color:b,dynamicVisible:a.index===E,dynamicPeriod:n}),b=N.getStyle("edgeHostPointHighlighColor");var d=xe(j);for(k=0,P=d.length;P>k;k++){var q=d[k],c=al.toScreenPosition(i,q);al.Icons.DrawIcon(N,g,al.Icons.ShapePoint,{point:{x:c.x,y:c.y},color:b,size:12,dynamicVisible:k===a.index,dynamicPeriod:n})}}},Me.prototype._getRealPoint=function(){var F,p=this.screenInfo,W=p.P,X=p.S,E=-1,k=[],c=-1,g=X.length;return X.each(function(o){c++;var R=1;if(3===o)R=2;else if(4===o)R=3;else if(5===o)return;E+=R,F=c+1>=g?!0:1===X.get(c+1)?!0:!1,k.push({point:{x:W[2*E],y:W[2*E+1]},segmentIndex:c,pointIndex:E,isEnd:F})}),k},Me.prototype.getEditingPointsInfo=function(f){var a=this,C=a.activing;if(!C)return!1;var d=C.point;if(!d)return!1;var M=this._getRealPoint(),P=[{screen:d}];C.selections&&C.selections.forEach(function(L){P.push({screen:L})});var s,k,q=M.length;return P.forEach(function(g){for(s=0;q>s;s++)if(k=M[s],g.screen.isNearEnough(k.point)){g.segmentIndex=k.segmentIndex,g.pointIndex=k.pointIndex,g.point=a.target.getPoints().get(k.pointIndex);break}}),f&&P.sort(function(p,H){return p.segmentIndex-H.segmentIndex}),P};var Jj=al.MoveHelper=function(L){var n=this;n.catalog="Move",n._interactor=L};Jj.prototype={},Jj.prototype.constructor=Jj,Jj.prototype.calcShift=function($,G,d){var D,e,O=this,g=O._interactor.gv,S=g.lp(G);if("beginMove"===$&&O._gatherGridInfo(d._lastLogicalPoint||S),D=O._target){var I=D.downPosition;if(I){var x=O._interactor.getStyle("moveSensitivity")/g._zoom;if(I.distanceTo(S)<x)return{x:0,y:0};delete D.downPosition}var E;e=H.Default.isShiftDown(G),e&&(S=O._dealShiftDown(S),E=D.shiftGuide.dir);var q,U=D.rawPos={x:D.pos.x+S.x-D.lp.x,y:D.pos.y+S.y-D.lp.y};if(H.Default.isCtrlDown(G)){if(q=O._calcShiftByAddon(),O._target.node instanceof al.Group){var f=O._target.node;f._position.x+=q.x,f._position.y+=q.y}return q}var v=O._interactor.rectGuide;if(D.node instanceof H.Data&&D.node.s("2d.attachable")){var s=O._calcAttachNodeShift(D.node,U);if(v.clear(),s)return s}for(var u,m=D.x+U.x,Y=D.y+U.y,y={x:m,y:Y},b={x:m+D.w/2,y:Y+D.h/2},t={x:m+D.w,y:Y+D.h},L=O._interactor.gridGuide,k=[v.findClosest(y,E),v.findClosest(b,E),v.findClosest(t,E),L.findClosest(y,E),L.findClosest(b,E),L.findClosest(t,E)],R=1/0,Q=1/0,c=0,l=k.length;l>c;c++)u=k[c],u&&(m=u.x,Y=u.y,isFinite(m)&&Math.abs(m)<Math.abs(R)&&(R=m),isFinite(Y)&&Math.abs(Y)<Math.abs(Q)&&(Q=Y));if(isFinite(R)||(R=0),isFinite(Q)||(Q=0),q=O._calcShiftByAddon(R,Q),O._target.node instanceof al.Group){var f=O._target.node;f._position.x+=q.x,f._position.y+=q.y}var M=D.node;if(!vc(M,g)){var o=U.x+R,n=U.y+Q;O._interactor.rectGuide.gatherLines({node:M,x:D.x+o,y:D.y+n,w:D.w,h:D.h},E)}return q}},Jj.prototype._calcShiftByAddon=function(J,k){var P=this._target,s=P.rawPos,c=P.node.getPosition();return J=J||0,k=k||0,{x:s.x-c.x+J,y:s.y-c.y+k}},Jj.prototype._dealShiftDown=function(m){var L=this,H=L._target.shiftGuide,K=L._target.lp,X=Math.abs(m.x-K.x),j=Math.abs(m.y-K.y);X>j&&X>H.limit&&"y"===H.dir&&(H.dir="x"),j>X&&j>H.limit&&"x"===H.dir&&(H.dir="y");var Q=H.dir;return"x"===Q?(m.y=K.y,H.limit=Math.max(H.limit,X)):"y"===Q&&(m.x=K.x,H.limit=Math.max(H.limit,j)),m},Jj.prototype._isAttachableLineShape=function(s){if(!s.getSegments)return!1;var i=s.getSegments();if(!i)return!0;i instanceof H.List&&(i=i.getArray());for(var I=1,J=i.length;J>I;I++)if(2!==i[I])return!1;return!0},Jj.prototype._calcAttachNodeShift=function(){var L=new pb,q=new pb,r=new pb,i=new pb;return function(y,H){var n=this._interactor.gv,S=y.getHost(),v=n.getDataAt(H,function(L){return L.s("2d.hostable")?!0:!1});if(v&&S!==v&&y.setHost(v),!v)return this._edgeHostGuideInfo=null,y.setHost(null);var t=this._edgeHostGuideInfo={corners:al.getTargetCornersOnScreen(n,v),host:v,attach:-1};if(this._isAttachableLineShape(v)){for(var F,K,o,Q,G,T,M=v.getPoints(),f=M.size(),m=v.getPointsMatrix2d(),P=1/0,D=0;f>D&&(D!==f-1||v.isClosePath());D++)0!==D?q.copy(r):m.apply(M.get(D),q),m.apply(D===f-1?M.get(0):M.get(D+1),r),L.copy(H).sub(q),i.copy(r).sub(q),F=i.length(),i.divideScalar(F),K=L.dot(i),0>K?K=0:K>F&&(K=F),i.multiplyScalar(K).add(q),o=L.copy(H).sub(i).lengthSq(),P>o&&(P=o,T=D,Q=K,G=F);return Math.sqrt(P)*n.getZoom()>this._interactor.getStyle("attachThreshold")?(y.s({"attach.index":-1}),y.setHost(null),void 0):(y.s("attach.offset.opposite")&&(Q=G-Q),y.s({"attach.index":T,"attach.offset":y.s("attach.offset.relative")?Q/G:Q}),{x:0,y:0})}var e=n.calculateAttachPoint(v,H);if(e){var g=e.point;return t.attach=e.index,this._calcShiftByAddon(g.x-H.x,g.y-H.y)}}}(),Jj.prototype._gatherGridInfo=function(e){var Z,y=this,x=y._interactor,d=x._getValidSelection();if(d.length){if(1===d.length){if(Z=d[0],!Z.getRect)return y._target=null,void 0}else if(Z=al.Group.findOrCreateGroup(d,x._uuid),!Z)return y._target=null,void 0}else{var d=x.gv.sm().getSelection();if(d.length&&(Z=d.get(0),!Z.getRect))return y._target=null,void 0}if(Z){var Q=Z.getPosition(),v=Z.getRect();y._target={node:Z,x:v.x-Q.x,y:v.y-Q.y,w:v.width,h:v.height,lp:{x:e.x,y:e.y},pos:{x:Q.x,y:Q.y},shiftGuide:{dir:"x",limit:0},downPosition:new al.Math.Vector2(e)},x.rectGuide.gatherRects()}},Jj.prototype.clear=function(){var u=this;u._edgeHostGuideInfo=null,u._interactor.rectGuide.clear(),u._interactor._42()},Jj.prototype._42=function(){var T=this._edgeHostGuideInfo;T&&this._interactor._drawHostGuide(T)};var os=b.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),Uh=function(){function K(C,w){var e=E;
return function(){return e||(e=C.getExtension(w)),e}}function W(s,M){M==E&&(M={}),M.version=$&&(s instanceof WebGL2RenderingContext||b.prototype.toString.call(s)===Q)?2:1,M.extensions=function(){for(var _={},r=s.getSupportedExtensions(),o=r.length;o--;)_[name]=K(s,r[o]);return _}();for(var t=b.keys(a),h=0,T=t.length;T>h;++h){var B=t[h];M[B]=s.getParameter(a[B])}if(M.version>1){t=b.keys(D);for(var h=0,T=t.length;T>h;++h){var B=t[h];M[B]=s.getParameter(D[B])}}return M}var $="undefined"!=typeof WebGL2RenderingContext,Q="[object WebGL2RenderingContext]",a={aliasedLineWidthRange:os.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:os.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:os.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:os.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:os.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:os.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:os.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:os.MAX_TEXTURE_SIZE,maxVaryingVectors:os.MAX_VARYING_VECTORS,maxVertexAttribs:os.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:os.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:os.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:os.MAX_VIEWPORT_DIMS},D={max3DTextureSize:os.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:os.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:os.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:os.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:os.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:os.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:os.MAX_DRAW_BUFFERS,maxElementIndex:os.MAX_ELEMENT_INDEX,maxElementsIndices:os.MAX_ELEMENTS_INDICES,maxElementsVertices:os.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:os.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:os.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:os.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:os.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:os.MAX_SAMPLES,maxTextureLODBias:os.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:os.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:os.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:os.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:os.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:os.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:os.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:os.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:os.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:os.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:os.MIN_PROGRAM_TEXEL_OFFSET};return{"for":function(L){var J=L._info;return J||(L._info=J=W(L,J)),J}}}(),Dp=function(){function s($,I,m){return{def:$,getter:m?function(U){var O=Uh.for(U);return O.version>1?U.getParameter(I):$}:function(r){return r.getParameter(I)},setter:m?function(r,S){var o=Uh.for(r);o.version>1&&r.pixelStorei(I,S)}:function(O,B){O.pixelStorei(I,B)}}}function f(o){return"string"==typeof o?$r(o):o.r!==E?(X[0]=o.r,X[1]=o.g,X[2]=o.b,X[3]=o.a,X):o.red!==E?(X[0]=o.red,X[1]=o.green,X[2]=o.blue,X[3]=o.alpha,X):o}function w(I){return R(I)?Array.prototype.slice.call(I,0):I}function e(i,v,W){this.gl=v,this._record=W||{},this._branches={},this._leafSync={},this._struct=i;for(var P=i.children,q=P.length;q--;){var s=P[q],O=s.name;s.isLeaf?(this._leafSync[O]=!1,this._record[O]=w(s.desc.def)):this._record[O]={}}}function o(K){function h(k,z){e.call(this,K,k,z);for(var H=Z.length;H--;){var E=Z[H];this._branches[E._name]=new E._type(k,this._record[E._name])}}function m(W,H){function i(D,H){for(var p=B,L=!1;p--;)D[p]!==H[p]&&(D[p]=H[p],L=!0);return L}var O=W.name,T=R(W.desc.def),B=T&&W.desc.def.length;if(W.isLeaf){var q=W.desc.setter,h=W.desc.parse;b.defineProperty(H,O,{configurable:!1,enumerable:!0,get:function(){return this._record[O]},set:T?function(B){h&&(B=h(B)),(i(this._record[O],B)||!this._leafSync[O])&&(q(this.gl,this._record[O]),this._leafSync[O]=!0)}:function(u){this._record[O]===u&&this._leafSync[O]||(q(this.gl,u),this._record[O]=u,this._leafSync[O]=!0)}})}else Z.push({_name:O,_type:o(W)}),b.defineProperty(H,O,{configurable:!1,enumerable:!0,get:function(){return this._branches[O]},set:function(b){this._branches[O].apply(b)}})}var Z=[];return r(h,e),K.forEach(m,h.prototype),h}var X="undefined"!=typeof Float32Array&&new Float32Array(4),_={viewport:{def:[0,0,0/0,0/0],getter:function(l){return l.getParameter(l.VIEWPORT)},setter:function(i,J){var W=J[2]!==J[2]?i.drawingBufferWidth-J[0]:J[2],e=J[3]!==J[3]?i.drawingBufferHeight-J[1]:J[3];i.viewport(J[0],J[1],W,e)}},dither:{def:!1,getter:function($){return $.isEnabled($.DITHER)},setter:function(k,E){E?k.enable(k.DITHER):k.disable(k.DITHER)}},rasterizerDiscard:{def:!1,getter:function(Q){var p=Uh.for(Q);return p.version>1&&Q.isEnabled(Q.RASTERIZER_DISCARD)},setter:function(R,U){var q=Uh.for(R);1!==q.version&&(U?R.enable(R.RASTERIZER_DISCARD):R.disable(R.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(M){return M.lineWidth?M.getParameter(M.LINE_WIDTH):1},setter:function(K,c){K.lineWidth&&K.lineWidth(c)}},color:{clear:{def:[0,0,0,0],getter:function(l){return l.getParameter(l.COLOR_CLEAR_VALUE)},setter:function(T,y){T.clearColor(y[0],y[1],y[2],y[3])},parse:f},mask:{def:[!0,!0,!0,!0],getter:function(f){return f.getParameter(f.COLOR_WRITEMASK)},setter:function(u,p){u.colorMask(p[0],p[1],p[2],p[3])}}},blend:{enabled:{def:!1,getter:function(n){return n.isEnabled(n.BLEND)},setter:function(S,I){I?S.enable(S.BLEND):S.disable(S.BLEND)}},color:{def:[0,0,0,0],getter:function(F){return F.getParameter(F.BLEND_COLOR)},setter:function(H,D){H.blendColor(D[0],D[1],D[2],D[3])},parse:f},equation:{def:[os.FUNC_ADD,os.FUNC_ADD],getter:function(W){return[W.getParameter(W.BLEND_EQUATION_RGB),W.getParameter(W.BLEND_EQUATION_ALPHA)]},setter:function(o,W){o.blendEquationSeparate(W[0],W[1])},parse:function(n){var H=n.length;return H>1?n:1===H?(X[1]=X[0]=n[0],X):(X[1]=X[0]=n,X)}},func:{def:[os.ONE,os.ZERO,os.ONE,os.ZERO],getter:function(V){return[V.getParameter(V.BLEND_SRC_RGB),V.getParameter(V.BLEND_DST_RGB),V.getParameter(V.BLEND_SRC_ALPHA),V.getParameter(V.BLEND_DST_ALPHA)]},setter:function(w,k){w.blendFuncSeparate(k[0],k[1],k[2],k[3])},parse:function(O){var e=O.length;return e>3?O:(X[2]=X[0]=O[0],X[3]=X[1]=O[1],X)}}},cullFace:{enabled:{def:!1,getter:function(H){return H.isEnabled(H.CULL_FACE)},setter:function(z,B){B?z.enable(z.CULL_FACE):z.disable(z.CULL_FACE)}},mode:{def:os.BACK,getter:function(l){return l.getParameter(l.CULL_FACE_MODE)},setter:function(j,a){j.cullFace(a)}},frontFace:{def:os.CCW,getter:function(H){return H.getParameter(H.FRONT_FACE)},setter:function(k,q){k.frontFace(q)}}},scissor:{enabled:{def:!1,getter:function(Y){return Y.isEnabled(Y.SCISSOR_TEST)},setter:function(Q,y){y?Q.enable(Q.SCISSOR_TEST):Q.disable(Q.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function(q){return q.getParameter(q.SCISSOR_BOX)},setter:function(R,o){var z=o[2]!==o[2]?R.drawingBufferWidth-o[0]:o[2],w=o[3]!==o[3]?R.drawingBufferHeight-o[1]:o[3];R.scissor(o[0],o[1],z,w)}}},depth:{enabled:{def:!1,getter:function(r){return r.isEnabled(r.DEPTH_TEST)},setter:function(r,q){q?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST)}},clear:{def:1,getter:function(x){return x.getParameter(x.DEPTH_CLEAR_VALUE)},setter:function(n,e){n.clearDepth(e)}},mask:{def:!0,getter:function(E){return E.getParameter(E.DEPTH_WRITEMASK)},setter:function(N,H){N.depthMask(H)}},range:{def:[-1,1],getter:function(C){return C.getParameter(C.DEPTH_RANGE)},setter:function(Q,i){Q.depthRange(i[0],i[1])}},func:{def:os.LESS,getter:function(W){return W.getParameter(W.DEPTH_FUNC)},setter:function(e,y){e.depthFunc(y)}}},stencil:{enabled:{def:!1,getter:function(H){return H.isEnabled(H.STENCIL_TEST)},setter:function(F,U){U?F.enable(F.STENCIL_TEST):F.disable(F.STENCIL_TEST)}},clear:{def:0,getter:function(v){return v.getParameter(v.STENCIL_CLEAR_VALUE)},setter:function(W,y){W.clearStencil(y)}},frontMask:{def:255,getter:function(R){return R.getParameter(R.STENCIL_WRITEMASK)},setter:function(I,E){I.stencilMaskSeparate(I.FRONT,E)}},frontOp:{def:[os.KEEP,os.KEEP,os.KEEP],getter:function(F){return[F.getParameter(F.STENCIL_FAIL),F.getParameter(F.STENCIL_PASS_DEPTH_FAIL),F.getParameter(F.STENCIL_PASS_DEPTH_PASS)]},setter:function(c,G){c.stencilOpSeparate(c.FRONT,G[0],G[1],G[2])}},frontFunc:{def:[os.ALWAYS,0,255],getter:function(E){return[E.getParameter(E.STENCIL_FUNC),E.getParameter(E.STENCIL_REF),E.getParameter(E.STENCIL_VALUE_MASK)]},setter:function(t,k){t.stencilFuncSeparate(t.FRONT,k[0],k[1],k[2])}},backMask:{def:255,getter:function(D){return D.getParameter(D.STENCIL_BACK_WRITEMASK)},setter:function(t,N){t.stencilMaskSeparate(t.BACK,N)}},backOp:{def:[os.KEEP,os.KEEP,os.KEEP],getter:function(l){return[l.getParameter(l.STENCIL_BACK_FAIL),l.getParameter(l.STENCIL_BACK_PASS_DEPTH_FAIL),l.getParameter(l.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(K,Z){K.stencilOpSeparate(K.BACK,Z[0],Z[1],Z[2])}},backFunc:{def:[os.ALWAYS,0,255],getter:function(B){return[B.getParameter(B.STENCIL_BACK_FUNC),B.getParameter(B.STENCIL_BACK_REF),B.getParameter(B.STENCIL_BACK_VALUE_MASK)]},setter:function(Y,$){Y.stencilFuncSeparate(Y.BACK,$[0],$[1],$[2])}}},hint:{generateMipmap:{def:os.DONT_CARE,getter:function(q){return q.getParameter(q.GENERATE_MIPMAP_HINT)},setter:function(W,N){W.hint(W.GENERATE_MIPMAP_HINT,N)}},fragmentShaderDerivative:{def:os.DONT_CARE,getter:function(Y){var T=Uh.for(Y);return 1!==T.version||T.extensions.OES_standard_derivatives?Y.getParameter(os.FRAGMENT_SHADER_DERIVATIVE_HINT):os.DONT_CARE},setter:function(F,U){var o=Uh.for(F);return o.version>1||o.extensions.OES_standard_derivatives?(F.hint(os.FRAGMENT_SHADER_DERIVATIVE_HINT,U),void 0):void 0}}},pixelStore:{packAlignment:s(4,os.PACK_ALIGNMENT,!1),unpackAlignment:s(4,os.UNPACK_ALIGNMENT,!1),unpackFlipY:s(!1,os.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:s(!1,os.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:s(os.BROWSER_DEFAULT_WEBGL,os.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:s(0,os.PACK_ROW_LENGTH,!0),packSkipPixels:s(0,os.PACK_SKIP_PIXELS,!0),packSkipRows:s(0,os.PACK_SKIP_ROWS,!0),unpackRowLength:s(0,os.UNPACK_ROW_LENGTH,!0),unpackImageHeight:s(0,os.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:s(0,os.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:s(0,os.UNPACK_SKIP_ROWS,!0),unpackSkipImages:s(0,os.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(b){return b.isEnabled(b.POLYGON_OFFSET_FILL)},setter:function(c,I){I?c.enable(c.POLYGON_OFFSET_FILL):c.disable(c.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function(F){return[F.getParameter(F.POLYGON_OFFSET_FACTOR),F.getParameter(F.POLYGON_OFFSET_UNITS)]},setter:function(i,C){i.polygonOffset(C[0],C[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(k){return k.isEnabled(k.SAMPLE_COVERAGE)},setter:function(A,k){k?A.enable(A.SAMPLE_COVERAGE):A.disable(A.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(f){return f.isEnabled(f.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(m,S){S?m.enable(m.SAMPLE_ALPHA_TO_COVERAGE):m.disable(m.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(F){return[F.getParameter(F.SAMPLE_COVERAGE_VALUE),F.getParameter(F.SAMPLE_COVERAGE_INVERT)]},setter:function(A,O){A.sampleCoverage(O[0],O[1])}}}},i=ah.create(_,function(s){return"def"in s});e.prototype.reset=function(){for(var m=this._struct.children,B=m.length;B--;){var D=m[B],l=D.name;D.isLeaf?this[l]=D.desc.def:this._branches[l].reset()}},e.prototype.save=function(V){V==E&&(V={});for(var n=this._struct.children,R=n.length;R--;){var Z=n[R],K=Z.name;if(Z.isLeaf)V[K]=w(this._record[K]);else{var L=V[K];L==E&&(V[K]=L={}),this._branches[K].save(L)}}return V},e.prototype.sync=function(e,o){for(var X=this._struct.children,Y=X.length;Y--;){var w=X[Y],I=w.name;w.isLeaf?(o||!this._leafSync[I])&&(e?(this._record[I]=w.desc.getter(this.gl),this._leafSync[I]=!0):(w.desc.setter(this.gl,this._record[I]),this._leafSync[I]=!0)):this._branches[I].sync(e,o)}},e.prototype.syncLoss=function(){for(var W=this._struct.children,N=W.length;N--;){var n=W[N];n.isLeaf?this._leafSync[n.name]=!1:this._branches[n.name].syncLoss()}},e.prototype.apply=function(P){for(var d=this._struct.children,u=d.length;u--;){var E=d[u],G=E.name;G in P&&(E.isLeaf?this[G]=P[G]:this._branches[G].apply(P[G]))}},e.prototype.append=function(Z){var S=this._struct.childMap;for(var D in Z){var r=S[D];r&&(r.isLeaf?this[D]=Z[D]:this._branches[D].append(Z[D]))}};var C=o(i);return function(x){var Z=x._state;return Z||(x._state=Z=new C(x)),Z}}(),ui=function(){function d(h,b,B,O){if(h){var R=h.length;if(R!=E)for(var w=0;O>w;++w)b[B+w]=h[w];else h.toArray&&h.toArray(b,B)}else for(var w=0;O>w;++w)b[B+w]=0}function W(N,A,j){var T=N[0];if(0>=T||T>0)return N;var K=A*j,o=P[K];if(o==E&&(P[K]=o=new Float32Array(K)),0!==A){d(T,o,0,j);for(var D=1,x=0;D!==A;++D)x+=j,d(N[D],o,x,j)}return o}function B(u,E){u.uniform1f(this.addr,E)}function A(F,T){F.uniform1fv(this.addr,T)}function R(L,W){if(W.x!=E)L.uniform2f(this.addr,W.x,W.y);else{var f=P[2];f.set(W,0),L.uniform2fv(this.addr,f)}}function n(L,R){L.uniform2fv(this.addr,W(R,this.size,2))}function X(T,C){if(C.x!=E)T.uniform3f(this.addr,C.x,C.y,C.z);else if(C.r!=E)T.uniform3f(this.addr,C.r,C.g,C.b);else if(C.red!=E)T.uniform3f(this.addr,C.red,C.green,C.blue);else{var $=P[3];$.set(C,0),T.uniform3fv(this.addr,$)}}function Q(e,f){e.uniform3fv(this.addr,W(f,this.size,3))}function s(N,f){if("string"==typeof f&&(f=$r(f)),f.x!=E)N.uniform4f(this.addr,f.x,f.y,f.z,f.w);else if(f.r!=E)N.uniform4f(this.addr,f.r,f.g,f.b,f.a);else if(f.red!=E)N.uniform4f(this.addr,f.red,f.green,f.blue,f.alpha);else{var B=P[4];B.set(f,0),N.uniform4fv(this.addr,B)}}function C(S,i){S.uniform4fv(this.addr,W(i,this.size,4))}function o(Y,E){Y.uniform1i(this.addr,E)}function M(T,C){T.uniform1iv(this.addr,C)}function w(Y,X){Y.uniform2iv(this.addr,X)}function f(u,g){u.uniform3iv(this.addr,g)}function J(i,n){i.uniform4iv(this.addr,n)}function H(c,G){c.uniform1i(this.addr,D[G?1:0])}function V(b,T){var I=P[4];I.set(T,0),b.uniformMatrix2fv(this.addr,!1,I)}function I(r,f){r.uniformMatrix2fv(this.addr,!1,W(f,this.size,4))}function $(D,Y){var F=P[9];F.set(Y,0),D.uniformMatrix3fv(this.addr,!1,F)}function j(m,J){m.uniformMatrix3fv(this.addr,!1,W(J,this.size,9))}function v(h,s){var r=P[16];r.set(s,0),h.uniformMatrix4fv(this.addr,!1,r)}function p(t,U){t.uniformMatrix4fv(this.addr,!1,W(U,this.size,16))}function g(g,e){g.uniform1i(this.addr,this.slots[0]),g.activeTexture(g.TEXTURE0+this.slots[0]),g.bindTexture(g.TEXTURE_2D,e||g._emptyTexture)}function Y(G,P){G.uniform1iv(this.addr,this.slots);for(var r=this.slots.length;r--;)G.activeTexture(G.TEXTURE0+this.slots[r]),G.bindTexture(G.TEXTURE_2D,P[r]||G._emptyTexture)}function N(O,p){O.uniform1i(this.addr,this.slots[0]),O.activeTexture(O.TEXTURE0+this.slots[0]),O.bindTexture(O.TEXTURE_CUBE_MAP,p||O._emptyCubeTexture)}function Z(W,r){W.uniform1iv(this.addr,this.slots);for(var k=this.slots.length;k--;)W.activeTexture(W.TEXTURE0+this.slots[k]),W.bindTexture(W.TEXTURE_CUBE_MAP,r[k]||W._emptyCubeTexture)}function k(x,k,_){F[x]=[k,_]}function u(F,V,D){switch(F.type){case 35678:case 35680:if("uSampler"===D)return[0];if("uBlendSampler"===D)return[1];for(var b=F.size,t=new Int32Array(b),w=0;b>w;++w)t[w]=V.usedTextureSlot++;return t}return E}function K(k,S,B,N,j){this.name=k,this.addr=S,this.size=N?B.size:0,this.activeInfo=B,this.setter=F[B.type][N?1:0],this.slots=u(B,j,k),Pk(this)}function e(l,b,y,Q){var i=l.name,V=i.length;for(z.lastIndex=0;;){var O=z.exec(i),f=z.lastIndex,H=O[1],w="]"===O[2],C=O[3];if(w&&(H=0|H),C===E||"["===C&&f+2===V){y[H]=new K(H,b,l,C!==E,Q);break}var Y=y[H];Y==E&&(y[H]=Y={}),y=Y}}function a(H,b,q){this.gl=b,this._program=q,this._leaves={},this._branches={},this._struct=H}function T(m){function z(o,$){a.call(this,m,o,$);for(var C=I.length;C--;){var Z=I[C];this._branches[Z._name]=new Z._type(o,$)}this.uuid=xc.generateUUID()}function q(E,N){var n=E.name;if(E.isLeaf){var R=i("d.setter(this.gl, v);",["v"],["d"],[E.desc]);b.defineProperty(N,n,{configurable:!1,enumerable:!0,get:function(){return R},set:R})}else I.push({_name:n,_type:T(E)}),b.defineProperty(N,n,{configurable:!1,enumerable:!0,get:function(){return this._branches[n]},set:function(v){this._branches[n].apply(v)}})}var I=[];return r(z,a),m.forEach(q,z.prototype),z}function x(W,t){for(var M=W.getProgramParameter(t,W.ACTIVE_UNIFORMS),Z={},B={usedTextureSlot:2};M--;){var V=W.getActiveUniform(t,M),J=V.name,C=W.getUniformLocation(t,J);e(V,C,Z,B)}var v=ah.create(Z,function(O){return"addr"in O}),q=T(v);return b.defineProperty(q.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:B.usedTextureSlot}),new q(W,t)}var P=[];if("function"==typeof Float32Array)for(var h=1;17>h;++h)P[h]=new Float32Array(h);var D=[0,1],F=[];k(os.FLOAT,B,A),k(os.FLOAT_VEC2,R,n),k(os.FLOAT_VEC3,X,Q),k(os.FLOAT_VEC4,s,C),k(os.INT,o,M),k(os.INT_VEC2,w,w),k(os.INT_VEC3,f,f),k(os.INT_VEC4,J,J),k(os.BOOL,H,M),k(os.BOOL_VEC2,w,w),k(os.BOOL_VEC3,f,f),k(os.BOOL_VEC4,J,J),k(os.FLOAT_MAT2,V,I),k(os.FLOAT_MAT3,$,j),k(os.FLOAT_MAT4,v,p),k(os.SAMPLER_2D,g,Y),k(os.SAMPLER_CUBE,N,Z);var z=/([\w\d_]+)(\])?(\[|\.)?/g;return a.prototype.apply=function(E){for(var S=this._struct.children,e=S.length;e--;){var M=S[e],w=M.name;w in E&&(M.isLeaf?this[w]=E[w]:this._branches[w].apply(E[w]))}},a.prototype.append=function(L){var X=this._struct.childMap;for(var n in L){var r=X[n];r&&(r.isLeaf?this[n]=L[n]:this._branches[n].append(L[n]))}},function(s,G){var P=G._uniforms;return P||(G._uniforms=P=x(s,G)),P}}(),be=function(){function W(a,F,v){F.vertexAttrib1f(a.addr,v)}function T(O,z,c){if(c.x!=E)z.vertexAttrib2f(O.addr,c.x,c.y);else{var P=L[2];P.set(c,0),z.vertexAttrib2fv(O.addr,P)}}function j(N,w,O){if(O.x!=E)w.vertexAttrib3f(N.addr,O.x,O.y,O.z);else if(O.r!=E)w.vertexAttrib3f(N.addr,O.r,O.g,O.b);else if(O.red!=E)w.vertexAttrib3f(N.addr,O.red,O.green,O.blue);else{var t=L[3];t.set(O,0),w.vertexAttrib3fv(N.addr,t)}}function u(D,s,g){if("string"==typeof g&&(g=$r(g)),g.x!=E)s.vertexAttrib4f(D.addr,g.x,g.y,g.z,g.w);else if(g.r!=E)s.vertexAttrib4f(D.addr,g.r,g.g,g.b,g.a);else if(g.red!=E)s.vertexAttrib4f(D.addr,g.red,g.green,g.blue,g.alpha);else{var o=L[4];o.set(g,0),s.vertexAttrib4fv(D.addr,o)}}function Z(T,L,E){E=E.el||E;for(var i=0,e=0;2>i;++i)L.vertexAttrib2f(T.addr,E[e++],E[e++])}function c(v,H,u){u=u.el||u;for(var t=0,q=0;3>t;++t)H.vertexAttrib3f(v.addr,u[q++],u[q++],u[q++])}function U(u,W,m){m=m.el||m;for(var z=0,D=0;4>z;++z)W.vertexAttrib4f(u.addr,m[D++],m[D++],m[D++],m[D++])}function n($,C,k,A){for(var m,e=k?1:0,i=C.addr,L=$._divisorState,s=0;A>s;s++)m=L[i+s]||0,m!==e&&(L[i+s]=e,$.vertexAttribDivisor(i+s,e))}function k(L,M,l,B,u,o,h){M.bindBuffer(M.ARRAY_BUFFER,l);var Y=L.addr;M.enableVertexAttribArray(Y),n(M,L,l.instanced,1),M.vertexAttribPointer(Y,1,B||M.FLOAT,!!u,o||0,h||0),M.bindBuffer(M.ARRAY_BUFFER,null)}function F(O,N,C,K,V,j,m){N.bindBuffer(N.ARRAY_BUFFER,C);var l=O.addr;N.enableVertexAttribArray(l),n(N,O,C.instanced,1),N.vertexAttribPointer(l,2,K||N.FLOAT,!!V,j||0,m||0),N.bindBuffer(N.ARRAY_BUFFER,null)}function C(o,s,U,N,E,$,_){s.bindBuffer(s.ARRAY_BUFFER,U);var m=o.addr;s.enableVertexAttribArray(m),n(s,o,U.instanced,1),s.vertexAttribPointer(m,3,N||s.FLOAT,!!E,$||0,_||0),s.bindBuffer(s.ARRAY_BUFFER,null)}function G(S,r,u,O,A,P,i){r.bindBuffer(r.ARRAY_BUFFER,u);var K=S.addr;r.enableVertexAttribArray(K),n(r,S,u.instanced,1),r.vertexAttribPointer(K,4,O||r.FLOAT,!!A,P||0,i||0),r.bindBuffer(r.ARRAY_BUFFER,null)}function t(o,I,P,C,$,u,v){var u=u||16,v=v||0,W=o.addr;I.bindBuffer(I.ARRAY_BUFFER,P),I.enableVertexAttribArray(W),I.vertexAttribPointer(W,2,C||I.FLOAT,!!$,u,v),I.enableVertexAttribArray(W+1),I.vertexAttribPointer(W+1,2,C||I.FLOAT,!!$,u,v+8),n(I,o,P.instanced,2),I.bindBuffer(I.ARRAY_BUFFER,null)}function m(H,h,u,E,P,L,p){var L=L||36,p=p||0,f=H.addr;h.bindBuffer(h.ARRAY_BUFFER,u);for(var S=0;3>S;S++)h.enableVertexAttribArray(f+S),h.vertexAttribPointer(f+S,3,E||h.FLOAT,!!P,L,p+12*S);n(h,H,u.instanced,3),h.bindBuffer(h.ARRAY_BUFFER,null)}function P(d,R,u,r,m,y,h){var y=y||64,h=h||0,T=d.addr;R.bindBuffer(R.ARRAY_BUFFER,u);for(var c=0;4>c;c++)R.enableVertexAttribArray(T+c),R.vertexAttribPointer(T+c,4,r||R.FLOAT,!!m,y,h+16*c);n(R,d,u.instanced,4),R.bindBuffer(R.ARRAY_BUFFER,null)}function p(B,j,N,V){Q[B]=function(H,B,J,G,T,P){this.addr==E||this.addr<0||(B==E||B===!1?V(H,this.addr):qj(B)===$?N(this,H,B,J,G,T,P):(V(H,this.addr),j(this,H,B)))}}function O(c,y){c.disableVertexAttribArray(y)}function Y(w,C){w.disableVertexAttribArray(C),w.disableVertexAttribArray(C+1)}function w(Y,n){Y.disableVertexAttribArray(n),Y.disableVertexAttribArray(n+1),Y.disableVertexAttribArray(n+2)}function e(h,o){h.disableVertexAttribArray(o),h.disableVertexAttribArray(o+1),h.disableVertexAttribArray(o+2),h.disableVertexAttribArray(o+3)}function f(g,Y,J){this.name=g,this.addr=Y,this.activeInfo=J,this.setter=Q[J.type],Pk(this)}function v(A,V,I){this.gl=V,this.program=I,this._branches={},this._struct=A}function B(m){function g(q,e){v.call(this,m,q,e);for(var s=S.length;s--;){var X=S[s];this._branches[X._name]=new X._type(q,e)}}function D(A,_){var N=A.name;if(A.isLeaf){var r=i("d.setter(this.gl, v);",["v"],["d"],[A.desc]);b.defineProperty(_,N,{configurable:!1,enumerable:!0,get:function(){return r},set:r})}else S.push({_name:N,_type:B(A)}),b.defineProperty(_,N,{configurable:!1,enumerable:!0,get:function(){return this._branches[N]},set:function(T){this._branches[N].apply(T)}})}var S=[];return r(g,v),m.forEach(D,g.prototype),g}function I(O,S){for(var m=O.getProgramParameter(S,O.ACTIVE_ATTRIBUTES),J={};m--;){var M=O.getActiveAttrib(S,m),w=M.name,u=O.getAttribLocation(S,w);J[w]=new f(w,u,M)}var Z=ah.create(J,function(b){return"addr"in b}),j=B(Z);return new j(O,S)}for(var L=[],g=1;17>g;++g)L[g]=new Qb(g);var Q=[],$="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return p(os.FLOAT,W,k,O),p(os.FLOAT_VEC2,T,F,O),p(os.FLOAT_VEC3,j,C,O),p(os.FLOAT_VEC4,u,G,O),p(os.FLOAT_MAT2,Z,t,Y),p(os.FLOAT_MAT3,c,m,w),p(os.FLOAT_MAT4,U,P,e),v.prototype.disable=function(){for(var L=this._struct.children,Y=L.length;Y--;){var t=L[Y],O=t.name;t.isLeaf?this[O]=E:this._branches[O].disable()}},v.prototype.apply=function(K){for(var t=this._struct.children,Z=t.length;Z--;){var f=t[Z],C=f.name;C in K&&(f.isLeaf?this[C]=K[C]:this._branches[C].apply(K[C]))}},v.prototype.append=function(Y){var H=this._struct.childMap;for(var l in Y){var b=H[l];b&&(b.isLeaf?this[l]=Y[l]:this._branches[l].append(Y[l]))}},function(X,Z){var q=Z._attribs;return q||(Z._attribs=q=I(X,Z)),q}}(),se=function(W){var n=this;b.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:W,writable:!1},glState:{configurable:!1,enumerable:!1,value:Dp(W),writable:!1}}),n._currProgram=E,n._currUniforms=E,n._currAttribs=E,n._sync=!0};b.defineProperties(se.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(H){var W=this;W._sync&&H===W._currProgram||(W.gl.useProgram(H),W._currProgram=H,W._currUniforms=ui(W.gl,H),W._currAttribs=be(W.gl,H),W._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var s=this;return s._currProgram&&!s._sync&&(s.gl.useProgram(s._currProgram),s._sync=!0),s._currUniforms},set:function(K){var m=this;m._currUniforms&&(m._currProgram&&!m._sync&&(m.gl.useProgram(m._currProgram),this._sync=!0),m._currUniforms.apply(K))}},attribs:{configurable:!1,enumerable:!1,get:function(){var t=this;return t._currProgram&&!t._sync&&(t.gl.useProgram(t._currProgram),t._sync=!0),t._currAttribs},set:function(R){var J=this;J._currUniforms&&(J._currProgram&&!J._sync&&(J.gl.useProgram(J._currProgram),this._sync=!0),J._currAttribs.apply(R))}}}),se.prototype.useProgram=function(o){var T=this;T._sync&&o===T._currProgram||(T.gl.useProgram(o),T._currProgram=o,T._currUniforms=ui(T.gl,o),T._currAttribs=be(T.gl,o),T._sync=!0)},se.prototype.directState=function(){return this.glState},se.prototype.directUniforms=function(){return this._currUniforms},se.prototype.directAttribs=function(){return this._currAttribs},se.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},se.for=function(i){var Q=i._renderState;return Q||(i._renderState=Q=new se(i)),Q};var Cm="directional",Dn="point",ur="spot",Vb="light.color",Sd=4294967295,Ee=0,Sm={},Wk=[],xi=0,nn=function(p,F){Vn(F)&&nh.test(F)?Hj(p,F):Mr(F)&&F.modelType?ro(p,F):F===E?delete Xo[p]:Xo[p]=F},wf=function(t){return t},Cb=function(R){R=L.convertShape3dModelName(R);var m;if(Mr(R)){if(R.modelType){if(R.uuid){if(m=Xo[R.uuid])return m}else R.uuid=H.Math.generateUUID();return m===E&&(Ae&&Ae[R.uuid]||ro(R.uuid,R)),E}return R}return m=Xo[R],R&&m===E&&nh.test(R)&&(Ae&&Ae[R]||Hj(R,R)),m},Kj=function(p,g){p.frameStack?p.frameStack.push(g):p.frameStack=[g],p.bindFramebuffer(p.FRAMEBUFFER,g)},li=function(W){var w=W.frameStack;if(w){if(w.pop(),w.length)return W.bindFramebuffer(W.FRAMEBUFFER,w[w.length-1]),void 0;W.frameStack=null}W.bindFramebuffer(W.FRAMEBUFFER,null)};Hi(L,{graph3dViewAttributes:f,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:O/60,graph3dViewSortable:!1,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Gl,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:O,graph3dViewRotateMinPhi:0,graph3dViewShadowDisabled:!0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewSyncEyeWithOrthoWidth:!1,graph3dViewFovy:O/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewDataNumWarningLine:1e4,graph3dViewHeadlightDirection:"camera",graph3dViewHeadlightRange:0,graph3dViewHeadlightGroup:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewUvClipEnabled:!1,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dViewBatchInstancedDisabled:!0,graph3dViewFlowBlendMode:"addRGB",graph3dViewEnvmapType:"legacy",graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:nn,getShape3dModel:Cb,convertShape3dModelName:wf,getShape3dModelMap:function(){return Xo},getCachedShape3dModelMap:function(){return ld},createMatrix:function(z,m){br(z)||(z=[z]);for(var r=z.length-1;r>=0;r--){var p=z[r];m=gs(p.mat,p.s3,p.r3,p.rotationMode,p.t3,m)}return m},transformVec:function(V,Y){return Vh(V,Y)},glBindFrame:Kj,glUnbindFrame:li,createBoxModel:function(){return{vs:jd,ns:Eg,uv:Tp,is:Fl}},createRoundRectModel:function(E,n){return ps.roundRect(E,n)},createStarModel:function(E,V){return ps.star(E,V)},createRectModel:function(g,q){return ps.rect(g,q)},createTriangleModel:function(G,B){return ps.triangle(G,B)},createRightTriangleModel:function(H,K){return ps.rightTriangle(H,K)},createParallelogramModel:function(Q,A){return ps.parallelogram(Q,A)},createTrapezoidModel:function(t,H){return ps.trapezoid(t,H)},createSmoothSphereModel:function(J,o,b,m,p,W,g){return wi(new kb(J,o,b,m,p,W,g))},createSphereModel:function(B,K,w,b,X,i,p){return B?xr(B,K,w,b,X,i,p):L.createSmoothSphereModel()},createSmoothConeModel:function(D,Q,Z,A,v){return bs(D,Q,Z,A,v)},createConeModel:function(e,l,M,X,U,p,w,n){return e?Ir(e,l,M,X,U,p,w,n):bs(p)},createSmoothCylinderModel:function($,i,E,q,N,t,S,u){return wi(new gj($,i,E,q,N,t,S,u))},createCylinderModel:function(x,s,d,I,e,Z,k,Y){return x?Hl(x,s,d,I,e,Z,k,Y):Ld(Z,k)},createSmoothTorusModel:function(y,r,$,O,J,H){return wi(new ai(y,r,$,O,J,H))},createTorusModel:function(p,m,M,w,v,y,_,L){return p?ob(p,m,M,w,v,y,_,L):jl(y,_)},createExtrusionModel:function(e,a,B,T,G,f,D,t){return uc(e,a,B,T,G,f,D,t)},createSmoothRingModel:function(R,H,d,e,V,f){for(var B=[],u=0;u<R.length-1;u+=2)B.push({x:R[u],y:R[u+1]});for(R=Hc(B,H,d)[0],B=[],u=0;u<R.length;u++){var Y=R[u];B.push(new Fb(Y.x,0,Y.y))}return wi(new Jo(B,f,e,V))},createTextGeometry:function(R,W){var Q=wi(new wb(R,W));if(W.cube)for(var K=Ci(Q),y=K.min,H=K.max,S=y.x,c=y.y,C=y.z,g=H.x-S||1,a=H.y-c||1,M=H.z-C||1,p=["vs","top_vs","bottom_vs"],n=0,V=p.length;V>n;n++){var u=Q[p[n]];if(u)for(var D=0,k=u.length;k>D;D+=3)u[D]=(u[D]-S)/g-.5,u[D+1]=(u[D+1]-c)/a-.5,u[D+2]=(u[D+2]-C)/M-.5}return Q},loadFontFace:function(x,P){L.xhrLoad(x,function(p){if(!p)return P();var c;try{c=JSON.parse(p)}catch(D){c=JSON.parse(p.substring(65,p.length-2))}ds.loadFace(c),P&&P(c.familyName.toLowerCase())},P?null:{sync:!0})},getShaderErrorLog:function(){return Wk.join("\n")},createRingModel:function(k,C,j,D,n,Z,N,v,d,y){for(var q=[],U=0;U<k.length-1;U+=2)q.push({x:k[U],y:k[U+1]});Z=Z||L.shapeSide,N=N||0,v=v||Z;var R,O,o,l,X,I,E,Y,r,c,U,m,A,t,x,S,K,p,M=[],a=[],W=d?[]:f,F=d?[]:f,b=y?[]:f,V=y?[]:f,s=D?[]:f,$=D?[]:f,T=n?[]:f,i=n?[]:f,k=Hc(q,C,j),H=Gn(k),Q=0,G=2*Math.PI/Z;return k.forEach(function(k){if(o=k.length,o>1){if(l=k[0],D)for(I=l.x,Y=l.y,U=N;v>U;U++)m=U+1,A=U*G,t=m*G,x=J(A),S=B(A),K=J(t),p=B(t),s.push(x*I,Y,-S*I,K*I,Y,-p*I,0,Y,0),$.push(.5-.5*x,.5-.5*S,.5-.5*K,.5-.5*p,.5,.5);for(c=0;o>c;c++){for(X=k[c],I=l.x,E=X.x,Y=l.y,r=X.y,R=Q/H,Q+=Mp(l,X),O=Q/H,U=N;v>U;U++)m=U+1,A=U*G,t=m*G,x=J(A),S=B(A),K=J(t),p=B(t),M.push(x*E,r,-S*E,K*E,r,-p*E,x*I,Y,-S*I,K*E,r,-p*E,K*I,Y,-p*I,x*I,Y,-S*I),a.push(U/Z,O,m/Z,O,U/Z,R,m/Z,O,m/Z,R,U/Z,R),d&&U===N&&(W.push(0,Y,0,0,r,0,x*E,r,-S*E,x*E,r,-S*E,x*I,Y,-S*I,0,Y,0),F.push(0,.5-Y,0,.5-r,2*E,.5-r,2*E,.5-r,2*I,.5-Y,0,.5-Y)),y&&m===v&&(b.push(0,Y,0,K*E,r,-p*E,0,r,0,K*E,r,-p*E,0,Y,0,K*I,Y,-p*I),V.push(1,.5-Y,1-2*E,.5-r,1,.5-r,1-2*E,.5-r,1,.5-Y,1-2*I,.5-Y));l=X}if(n)for(I=l.x,Y=l.y,U=N;v>U;U++)m=U+1,A=U*G,t=m*G,x=J(A),S=B(A),K=J(t),p=B(t),T.push(K*I,Y,-p*I,x*I,Y,-S*I,0,Y,0),i.push(.5-.5*K,.5+.5*p,.5-.5*x,.5+.5*S,.5,.5)}}),{vs:M,uv:a,bottom_vs:T,bottom_uv:i,top_vs:s,top_uv:$,from_vs:W,from_uv:F,to_vs:b,to_uv:V}}},!0),Hi(W,{"3d.move.mode":E,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":E,"edge.gradient.color":E,"edge.source.t3":E,"edge.target.t3":E,"light.type":Dn,"light.group":0,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":O/4,"light.range":0,"light.exponent":1,"light.intensity":1,"light.mask":Sd,"headlight.ambientIntensity":E,"wf.visible":!1,"wf.width":1,"wf.fog":!0,"wf.color":to,"wf.short":!1,"wf.mat":E,"wf.boundingBox":!1,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:E,"transparent.mask":!1,brightness:E,"select.brightness":.7,"repeat.uv.length":E,"shadow.cast":!0,"shadow.receive":!0,"3d.clipbox":E,"3d.clipbox.mask":Sd,"3d.clipbox.group":0,"3d.clipbox.shape":"cube","effect.flow":!1,"effect.flow.gradient":"spread.horizontal","effect.flow.uvshape":"rect","effect.flow.size":512,"effect.flow.group":0,"effect.flow.intensity":1,"effect.flow.blend":E,"effect.flow.mask":Sd,bloom:!1,envmap:0,"envmap.probe":0,roughness:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":E,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.type":"hard","highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","highlight.glow":.8,"highlight.strength":2,"color.empty":[0,0,0,0],"label.face":Bc,"label.t3":E,"label.r3":E,"label.texture.scale":2,"label.rotationMode":Xq,"label.light":!1,"label.blend":E,"label.reverse.flip":!1,"label.reverse.color":Mh,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Bc,"label2.t3":E,"label2.r3":E,"label2.texture.scale":2,"label2.rotationMode":Xq,"label2.light":!1,"label2.blend":E,"label2.reverse.flip":!1,"label2.reverse.color":Mh,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Bc,"note.t3":E,"note.r3":E,"note.texture.scale":2,"note.rotationMode":Xq,"note.light":!1,"note.blend":E,"note.reverse.flip":!1,"note.reverse.color":Mh,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Bc,"note2.t3":E,"note2.r3":E,"note2.texture.scale":2,"note2.rotationMode":Xq,"note2.light":!1,"note2.blend":E,"note2.reverse.flip":!1,"note2.reverse.color":Mh,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:E,"shape3d.color":Dk,"shape3d.top.color":E,"shape3d.bottom.color":E,"shape3d.from.color":E,"shape3d.to.color":E,"shape3d.image":E,"shape3d.image.projection":E,"shape3d.top.image":E,"shape3d.bottom.image":E,"shape3d.from.image":E,"shape3d.to.image":E,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":E,"shape3d.side.to":E,"shape3d.smooth":E,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":E,"shape3d.opacity":E,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Mh,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":E,"shape3d.uv.scale":E,"shape3d.uv.rotation":E,"shape3d.uv.anchor":E,"shape3d.uv.union":E,"shape3d.top.uv.offset":E,"shape3d.top.uv.scale":E,"shape3d.top.uv.rotation":E,"shape3d.top.uv.anchor":E,"shape3d.bottom.uv.offset":E,"shape3d.bottom.uv.scale":E,"shape3d.bottom.uv.rotation":E,"shape3d.bottom.uv.anchor":E,"shape3d.from.uv.offset":E,"shape3d.from.uv.scale":E,"shape3d.from.uv.rotation":E,"shape3d.from.uv.anchor":E,"shape3d.to.uv.offset":E,"shape3d.to.uv.scale":E,"shape3d.to.uv.rotation":E,"shape3d.to.uv.anchor":E,"shape3d.top.cap":E,"shape3d.bottom.cap":E,"shape3d.start.angle":0,"shape3d.sweep.angle":_,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.iterations":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"shape3d.reflector.shadow":"scene","camera.type":"perspective","camera.aspect":1,"camera.fovy":E,"camera.ortho.width":E,"camera.near":E,"camera.far":E,"camera.background":0,"camera.renderSky":!0,"camera.renderAxis":!1,"camera.renderGrid":!1,"camera.renderEdit":!1,"camera.onlySky":!1,"texture.mipmap.max":E,"texture.filter":E,"texture.filter.min":E,"texture.filter.mag":E,"texture.wrap":E,"points.image":"rect","points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"points.uv.scale":[1,1],"points.uv.offset":[0,0],"points.discard.selectable":!1,"all.light":!0,"all.visible":!0,"all.color":Dk,"all.image":E,"all.blend":E,"all.opacity":E,"all.reverse.flip":!1,"all.reverse.color":Mh,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":E,"all.uv.offset":E,"all.uv.scale":E,"all.uv.rotation":E,"all.uv.anchor":E,"all.uv.union":E,"all.discard.selectable":!0,mat:E,"left.mat":E,"right.mat":E,"top.mat":E,"bottom.mat":E,"front.mat":E,"back.mat":E,"edge.source.anchor.elevation":E,"edge.target.anchor.elevation":E,"edge.source.offset.elevation":0,"edge.target.offset.elevation":0},!0);
var sq,Qk=!1,_h=[0,0,0,0],Fh=function(t){return t instanceof Tl},Xl=function(J){return[J.x,J.e||0,J.y]},ap=function(x,M,j){for(var M=$r(M||0),w=M[0],c=M[1],g=M[2];j--;)x.push(w,c,g)},Lc=function(z,R,J){for(var R=$r(R||0),k=R[0],c=R[1],i=R[2],E=R[3];J--;)z.push(k,c,i,E)},kk=function(E,f,F){if(f)for(var O,H,U,l=f[0],w=f[1],r=f[2],Q=f[4],P=f[5],D=f[6],g=f[8],b=f[9],N=f[10],x=f[12],R=f[13],T=f[14],d=F.length,Y=0,Y=0;d>Y;Y+=3)O=F[Y],H=F[Y+1],U=F[Y+2],E.push(l*O+Q*H+g*U+x,w*O+P*H+b*U+R,r*O+D*H+N*U+T);else eq(E,F);return E},wn=function(j,d,I){var a=d.s("light.intensity"),y=$r(d.s(Vb)),g=y[0],n=y[1],M=y[2];1!==a&&(g*=a,n*=a,M*=a);var G=d.s("light.disabled");j.push(g,n,M,G?1:0),I.c.push(g,n,M),I.g.push(G?-1:d.s("light.group")),I.e.push(G?1:0)},Jn=function(i,j){var x,P=se.for(j),d=P.directUniforms(),o=i._lastLightUploadInfo={c:[],g:[],e:[]},K=i._headlightDirection;K&&3===K.length?x=K:"shadow"===K&&(x=i.shadowMap.getDirection()),x=x?np.normalizeArray(i._transformDirectionToViewSpace(null,x)):[0,0,0],d.uHeadlightDirection=x,d.uHeadlightRange=i._headlightRange;var U=d.uHeadlightAmbientIntensity=i._headlightAmbientIntensity,c=i._headlightIntensity,Q=$r(i._headlightColor);1!==c&&(Q=[Q[0]*c,Q[1]*c,Q[2]*c]);var H;d.uHeadlightColor=[Q[0],Q[1],Q[2],(H=i._headlightDisabled)?1:0],o.c.push(Q[0],Q[1],Q[2]),o.g.push(H?-1:i._headlightGroup),o.e.push(H?1:0);var $=i._59O,r=i._spots,y=i._dirs;if($.length){var M=[],B=[],e=[];$.forEach(function(b){wn(M,b,o),eq(B,i._transformPointToViewSpace(b.p3())),e.push(b.s("light.range"))}),d.uPointColor=M,d.uPointRange=e,d.uPointPosition=B}if(r.length){var l=[],Y=[],p=[],L=[],h=[],G=[];r.forEach(function(k){wn(l,k,o),eq(Y,i._transformPointToViewSpace(k.p3())),eq(h,i._transformDirectionToViewSpace(k.p3(),k.s("light.center"))),p.push(k.s("light.range")),L.push(J(k.s("light.angle")/2)),G.push(k.s("light.exponent"))}),d.uSpotColor=l,d.uSpotRange=p,d.uSpotAngle=L,d.uSpotExponent=G,d.uSpotPosition=Y,d.uSpotDirection=h}if(y.length){var n=[],s=[];y.forEach(function($){wn(n,$,o),eq(s,i._transformDirectionToViewSpace($.p3()))}),d.uDirColor=n,d.uDirDirection=s}i._lastLightMask=Sd,i._lastHeadlightAmbientIntensity=U},Nf=function(g,P,t,d){if(d===E&&(d=g._headlightAmbientIntensity),d!==g._lastHeadlightAmbientIntensity&&(P.uHeadlightAmbientIntensity=g._lastHeadlightAmbientIntensity=d),t!==g._lastLightMask){g._lastLightMask=t;var Z=g._lastLightUploadInfo;if(Z){var R,Y,b,_=Z.g,q=Z.e,C=_.length,r=new Array(C),H=!1;for(Y=0;C>Y;Y++)R=_[Y],b=0>R||R>=32?1:t&1<<R?0:1,r[Y]=b,b!==q[Y]&&(H=!0);if(H){Z.e=q=r;var F=Z.c;P.uHeadlightColor=[F[0],F[1],F[2],q[0]];var h,j=g._59O,m=g._spots,y=g._dirs,O=3,s=1;if(C=j.length){for(Y=0,h=[];C>Y;Y++)h.push(F[O++],F[O++],F[O++],q[s++]);P.uPointColor=h}if(C=m.length){for(Y=0,h=[];C>Y;Y++)h.push(F[O++],F[O++],F[O++],q[s++]);P.uSpotColor=h}if(C=y.length){for(Y=0,h=[];C>Y;Y++)h.push(F[O++],F[O++],F[O++],q[s++]);P.uDirColor=h}}}}},po=function(r,l){return Math.max(r.getRotateMinPhi()+_m,Math.min(r.getRotateMaxPhi()-_m,l))},es=function(){return.05+ml()/2},Lm=function(d,s,V,q){var T,m=d.getEye();return d.isOrtho()?(T=ch(d.getCenter(),m),T[0]+=q[0],T[1]+=q[1],T[2]+=q[2]):T=m,Rc(s,V,q,T)},Rc=function(n,S,A,g){var R=Cl(n,S),$=ch(g,A,!0),_=Cl($,S);if(a(_)<_m)return f;var t=(R-Cl(A,S))/_;return[A[0]+$[0]*t,A[1]+$[1]*t,A[2]+$[2]*t]},zr=function(t,X){return{x:2*t.x-X.x,y:2*t.y-X.y}},Ng=function(M,C,K,i){var V,k;if(!M)return V=ts(C.y-K.y,K.x-C.x),{x:C.x+i*B(V),y:C.y+i*J(V)};if(!K)return V=ts(M.y-C.y,C.x-M.x),{x:C.x+i*B(V),y:C.y+i*J(V)};var a=ch([M.x,M.y,0],[C.x,C.y,0],!0),D=ch([K.x,K.y,0],[C.x,C.y,0],!0),Q=-(a[0]+D[0])/2,d=-(a[1]+D[1])/2,v=G(Q*Q+d*d);if(_m>v)return V=ts(M.y-C.y,C.x-M.x),{x:C.x+i*B(V),y:C.y+i*J(V)};var l=M.x-C.x,S=M.y-C.y,m=K.x-C.x,U=K.y-C.y,b=G(l*l+S*S),X=G(m*m+U*U);V=Z(Cl(a,D))/2,k=a[1]*D[0]-a[0]*D[1]>0?-1:1,Q/=v,d/=v;var r=i/B(V),N=p(b,X)/J(V);v=Math.min(r,N);var q={x:C.x+k*v*Q,y:C.y+k*v*d};return K.b&&r>X/J(V)&&(q.adjust=!0),q},ye=function(H){var M=H[1],O=H[2],T=H[3],F=H[6],e=H[7],o=H[11];H[1]=H[4],H[2]=H[8],H[3]=H[12],H[4]=M,H[6]=H[9],H[7]=H[13],H[8]=O,H[9]=F,H[11]=H[14],H[12]=T,H[13]=e,H[14]=o},tj=function(x){var $=x[0],y=x[1],m=x[2],Q=x[3],u=x[4],E=x[5],s=x[6],t=x[7],g=x[8],L=x[9],H=x[10],e=x[11],M=x[12],i=x[13],a=x[14],P=x[15],X=$*E-y*u,U=$*s-m*u,G=$*t-Q*u,A=y*s-m*E,R=y*t-Q*E,B=m*t-Q*s,n=g*i-L*M,T=g*a-H*M,v=g*P-e*M,N=L*a-H*i,r=L*P-e*i,l=H*P-e*a,D=X*l-U*r+G*N+A*v-R*T+B*n;return D?(D=1/D,x[0]=(E*l-s*r+t*N)*D,x[1]=(m*r-y*l-Q*N)*D,x[2]=(i*B-a*R+P*A)*D,x[3]=(H*R-L*B-e*A)*D,x[4]=(s*v-u*l-t*T)*D,x[5]=($*l-m*v+Q*T)*D,x[6]=(a*G-M*B-P*U)*D,x[7]=(g*B-H*G+e*U)*D,x[8]=(u*r-E*v+t*n)*D,x[9]=(y*v-$*r-Q*n)*D,x[10]=(M*R-i*G+P*X)*D,x[11]=(L*G-g*R-e*X)*D,x[12]=(E*T-u*N-s*n)*D,x[13]=($*N-y*T+m*n)*D,x[14]=(i*U-M*A-a*X)*D,x[15]=(g*A-L*U+H*X)*D,void 0):f},tf=function(g,V){if(V){var t=V[0],j=V[1],z=V[2];g[12]=g[0]*t+g[4]*j+g[8]*z+g[12],g[13]=g[1]*t+g[5]*j+g[9]*z+g[13],g[14]=g[2]*t+g[6]*j+g[10]*z+g[14],g[15]=g[3]*t+g[7]*j+g[11]*z+g[15]}},Hr=function(C,M){if(M){var R=M[0],Y=M[1],f=M[2];C[0]=C[0]*R,C[1]=C[1]*R,C[2]=C[2]*R,C[3]=C[3]*R,C[4]=C[4]*Y,C[5]=C[5]*Y,C[6]=C[6]*Y,C[7]=C[7]*Y,C[8]=C[8]*f,C[9]=C[9]*f,C[10]=C[10]*f,C[11]=C[11]*f}},Tq=function(v,U,o){var i=U[0],m=U[1],n=U[2],t=U[3],H=U[4],L=U[5],s=U[6],z=U[7],M=U[8],O=U[9],Q=U[10],f=U[11],Z=U[12],J=U[13],h=U[14],l=U[15],R=o[0],e=o[1],A=o[2],y=o[3];return v[0]=R*i+e*H+A*M+y*Z,v[1]=R*m+e*L+A*O+y*J,v[2]=R*n+e*s+A*Q+y*h,v[3]=R*t+e*z+A*f+y*l,R=o[4],e=o[5],A=o[6],y=o[7],v[4]=R*i+e*H+A*M+y*Z,v[5]=R*m+e*L+A*O+y*J,v[6]=R*n+e*s+A*Q+y*h,v[7]=R*t+e*z+A*f+y*l,R=o[8],e=o[9],A=o[10],y=o[11],v[8]=R*i+e*H+A*M+y*Z,v[9]=R*m+e*L+A*O+y*J,v[10]=R*n+e*s+A*Q+y*h,v[11]=R*t+e*z+A*f+y*l,R=o[12],e=o[13],A=o[14],y=o[15],v[12]=R*i+e*H+A*M+y*Z,v[13]=R*m+e*L+A*O+y*J,v[14]=R*n+e*s+A*Q+y*h,v[15]=R*t+e*z+A*f+y*l,v},Qc=function(g,W,Z,D){var w,F,X,q,V,y,v,A,I,J,d=W[0],L=W[1],T=W[2],e=D[0],E=D[1],l=D[2],x=Z[0],P=Z[1],U=Z[2];return a(d-x)<_m&&a(L-P)<_m&&a(T-U)<_m?pg(g):(v=d-x,A=L-P,I=T-U,J=1/G(v*v+A*A+I*I),v*=J,A*=J,I*=J,w=E*I-l*A,F=l*v-e*I,X=e*A-E*v,J=G(w*w+F*F+X*X),J?(J=1/J,w*=J,F*=J,X*=J):(w=0,F=0,X=0),q=A*X-I*F,V=I*w-v*X,y=v*F-A*w,J=G(q*q+V*V+y*y),J?(J=1/J,q*=J,V*=J,y*=J):(q=0,V=0,y=0),g[0]=w,g[1]=q,g[2]=v,g[3]=0,g[4]=F,g[5]=V,g[6]=A,g[7]=0,g[8]=X,g[9]=y,g[10]=I,g[11]=0,g[12]=-(w*d+F*L+X*T),g[13]=-(q*d+V*L+y*T),g[14]=-(v*d+A*L+I*T),g[15]=1,g)},Ag=function(R,V,O,n,f){var e=1/Kc(V/2),L=1/(n-f);return R[0]=e/O,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=e,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=(f+n)*L,R[11]=-1,R[12]=0,R[13]=0,R[14]=2*f*n*L,R[15]=0,R},_j=function(w,R,r,n,b,k,O){var I=1/(R-r),g=1/(n-b),j=1/(k-O);return w[0]=-2*I,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*g,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=2*j,w[11]=0,w[12]=(R+r)*I,w[13]=(b+n)*g,w[14]=(O+k)*j,w[15]=1,w},Mf=function(r,Z){var q=Z[0],D=Z[1],y=Z[2],E=Z[3],g=q*q+D*D+y*y+E*E,O=g?1/g:0;return r[0]=-q*O,r[1]=-D*O,r[2]=-y*O,r[3]=E*O,r},$f=function(Z,N){var d=N[0]+N[5]+N[10],h=0;return d>0?(h=2*Math.sqrt(d+1),Z[3]=.25*h,Z[0]=(N[6]-N[9])/h,Z[1]=(N[8]-N[2])/h,Z[2]=(N[1]-N[4])/h):N[0]>N[5]&N[0]>N[10]?(h=2*Math.sqrt(1+N[0]-N[5]-N[10]),Z[3]=(N[6]-N[9])/h,Z[0]=.25*h,Z[1]=(N[1]+N[4])/h,Z[2]=(N[8]+N[2])/h):N[5]>N[10]?(h=2*Math.sqrt(1+N[5]-N[0]-N[10]),Z[3]=(N[8]-N[2])/h,Z[0]=(N[1]+N[4])/h,Z[1]=.25*h,Z[2]=(N[6]+N[9])/h):(h=2*Math.sqrt(1+N[10]-N[0]-N[5]),Z[3]=(N[1]-N[4])/h,Z[0]=(N[8]+N[2])/h,Z[1]=(N[6]+N[9])/h,Z[2]=.25*h),Z},ke=function(k,B,D){var c=B[0],b=B[1],g=B[2],t=B[3],V=c+c,H=b+b,u=g+g,a=c*V,r=c*H,i=c*u,G=b*H,x=b*u,R=g*u,z=t*V,w=t*H,T=t*u;return k[0]=1-(G+R),k[1]=r+T,k[2]=i-w,k[3]=0,k[4]=r-T,k[5]=1-(a+R),k[6]=x+z,k[7]=0,k[8]=i+w,k[9]=x-z,k[10]=1-(a+G),k[11]=0,k[12]=D[0],k[13]=D[1],k[14]=D[2],k[15]=1,k},Fp=function(h,W){if(h.isVREnabled()){var i=h.vr.getViewMatrix(W);if(i)return i}return h._camera?h._camera.getViewMatrix(W):Qc(W?W:ue(),h._eye,h._center,h._up)},So=function(Q,F){if(Q.isVREnabled()){var l=Q.vr.getProjectMatrix();if(l)return l}if(Q._camera)return Q._camera.getProjectMatrix();if(!F&&Q._computedProjectMatrix)return Nd(Q._computedProjectMatrix);var j=Q.getAspect(),J=Q._near,L=Q._far,h=ue();if(Q._ortho){var N=Q._orthoWidth/2,B=N/j;_j(h,-N,N,-B,B,J,L)}else Ag(h,Q._fovy,j,J,L);return h},Bk=function(A,o){if(!A)return f;var K=0,U=1,J=2,h=[],y=0,S=A.length,Q=S/3;if(o){for(;S>y;y++)h[y]=0;for(y=0;y<o.length;y+=3){var Y=[],O=[],X=[];Y[K]=A[3*o[y+1]+K]-A[3*o[y]+K],Y[U]=A[3*o[y+1]+U]-A[3*o[y]+U],Y[J]=A[3*o[y+1]+J]-A[3*o[y]+J],O[K]=A[3*o[y+2]+K]-A[3*o[y+1]+K],O[U]=A[3*o[y+2]+U]-A[3*o[y+1]+U],O[J]=A[3*o[y+2]+J]-A[3*o[y+1]+J],X[K]=Y[U]*O[J]-Y[J]*O[U],X[U]=Y[J]*O[K]-Y[K]*O[J],X[J]=Y[K]*O[U]-Y[U]*O[K];for(var p=0;3>p;p++)h[3*o[y+p]+K]+=X[K],h[3*o[y+p]+U]+=X[U],h[3*o[y+p]+J]+=X[J]}}else for(y=0;Q>y;y+=3){var Y=[],O=[],X=[];Y[K]=A[3*(y+1)+K]-A[3*y+K],Y[U]=A[3*(y+1)+U]-A[3*y+U],Y[J]=A[3*(y+1)+J]-A[3*y+J],O[K]=A[3*(y+2)+K]-A[3*(y+1)+K],O[U]=A[3*(y+2)+U]-A[3*(y+1)+U],O[J]=A[3*(y+2)+J]-A[3*(y+1)+J],X[K]=Y[U]*O[J]-Y[J]*O[U],X[U]=Y[J]*O[K]-Y[K]*O[J],X[J]=Y[K]*O[U]-Y[U]*O[K];for(var p=0;3>p;p++)h[3*(y+p)+K]=X[K],h[3*(y+p)+U]=X[U],h[3*(y+p)+J]=X[J]}for(y=0;S>y;y+=3){var m=[];m[K]=h[y+K],m[U]=h[y+U],m[J]=h[y+J];var H=G(m[K]*m[K]+m[U]*m[U]+m[J]*m[J]);0===H&&(H=_m),m[K]=m[K]/H,m[U]=m[U]/H,m[J]=m[J]/H,h[y+K]=m[K],h[y+U]=m[U],h[y+J]=m[J]}return new Qb(h)},Nm=function(q,Y,C,O){if(C||(C=q.createTexture()),Y){var s=q.TEXTURE_2D,L=q.REPEAT,g=q.CLAMP_TO_EDGE,a=q.TEXTURE_MIN_FILTER;O=O||Cq;var V=O.minFilter||O.filter||q.LINEAR,z=O.magFilter||O.filter||q.LINEAR;q.activeTexture(q.TEXTURE0),or(q,C),q.texImage2D(s,0,q.RGBA,q.RGBA,q.UNSIGNED_BYTE,Y),xn(q,q.TEXTURE_MAG_FILTER,z);var Z=Y.naturalWidth||Y.width,U=Y.naturalHeight||Y.height;xc.isPOT(Z)&&xc.isPOT(U)&&!O.clampToEdge&&!Y.clampToEdge?(xn(q,q.TEXTURE_WRAP_S,L),xn(q,q.TEXTURE_WRAP_T,L),xn(q,a,V===q.NEAREST?q.NEAREST_MIPMAP_NEAREST:q.LINEAR_MIPMAP_LINEAR),O.mipmapMaxLevel!==E&&xn(q,q.TEXTURE_MAX_LEVEL,O.mipmapMaxLevel),q.generateMipmap(s)):(xn(q,q.TEXTURE_WRAP_S,g),xn(q,q.TEXTURE_WRAP_T,g),xn(q,a,V)),or(q,f)}return C},Ur=function(e,p,f){var y=new Uint8Array(f||4);return p=p||e.createTexture(),e.activeTexture(e.TEXTURE0),or(e,p),xn(e,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,y),p},kd=function(x,n,e){var S=new Uint8Array(e||4);return n=n||x.createTexture(),x.activeTexture(x.TEXTURE0),x.bindTexture(x.TEXTURE_CUBE_MAP,n),x.texParameteri(x.TEXTURE_CUBE_MAP,x.TEXTURE_MAG_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_CUBE_MAP,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,x.RGBA,1,1,0,x.RGBA,x.UNSIGNED_BYTE,S),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,x.RGBA,1,1,0,x.RGBA,x.UNSIGNED_BYTE,S),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,x.RGBA,1,1,0,x.RGBA,x.UNSIGNED_BYTE,S),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,x.RGBA,1,1,0,x.RGBA,x.UNSIGNED_BYTE,S),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,x.RGBA,1,1,0,x.RGBA,x.UNSIGNED_BYTE,S),x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,x.RGBA,1,1,0,x.RGBA,x.UNSIGNED_BYTE,S),n},nc=function(P){P._26I&&P._prg&&(P._26I.deleteProgram(P._prg),P._prg=f)},Xd=function(){function A(J){if(J.match(D))return cm(J);var s=p[J];if(s)return s;var h=new RegExp("#define\\s+"+J+"\\s+(\\d+)"),S=Z.match(h);return p[J]=S?cm(S[1]):0}function t(V){p={},Z=V;var n=V.replace(Y,o).replace(B,C);return Z=null,p=null,n}function o(i,a,W){W=A(W);for(var _="",e=0;W>e;e++)_+=a+e+";";return _}function C(o,B,n,m){for(var r="",U=A(B);U<A(n);U++)r+=m.replace(/\[\s*i\s*\]/g,"["+U+"]").replace(/\[\s*I\s*\]/g,U);return r}var p,Z,Y=/(uniform\s+sampler2D\s+\w+)\[([\S\d]+)\];/g,B=/#UNROLL_LOOP_START\s+for\s*\(\s*int\s+i\s*=\s*([\S\d]+)\s*;\s*i\s*<\s*([\S\d]+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#UNROLL_LOOP_END/g,D=/^\d+$/;return function(m){return t(m)}}(),kf=function(U,X,t,h){var L=U.createShader(t);return U.shaderSource(L,Xd(h)),U.compileShader(L),U.attachShader(X,L),L},Od=function(F){return F.createBuffer()},or=function(j,D){j.bindTexture(j.TEXTURE_2D,D||j._emptyTexture)},xn=function(w,e,_){w.texParameteri(w.TEXTURE_2D,e,_)},il=function(j,c){var Q=se.for(j).directState();Q.polygonOffset.enabled=!0,Q.polygonOffset.value=c},dr=function(B){var j=se.for(B).directState();j.polygonOffset.enabled=!1},Ej=function(I,k){if(k){var q=se.for(I).directState();q.color.clear=$r(k)}},Gp=function(s,o,P){if(P!==o._lastClipboxEnabled){var K=s._boxClipperGroups,O=s._boxClipperShape,n=K?K.length:0,g=new Array(n);if(P)for(var f=0;n>f;f++)g[f]=P&1<<K[f]?O[f]:0;o._lastClipboxEnabled=P,o.uClipperShape=g}},Nk=Gp,mh=function(f){var i=se.for(f),z=i.directUniforms(),j=i.directAttribs();z.uFix=!0,j.aNormal=!1},ug=function(U){var n=se.for(U),y=n.directUniforms();y.uFix=!1},_d=function(P,S,W,y,h,Y,M,u){var A=se.for(P),T=A.directState(),L=A.directUniforms();P._picking||(W?(L.uBlend=!0,L.uBlendColor=W):L.uBlend=!1,L.uLight=L.uFog=y==f?!0:y,$c(h)&&1!==h&&(L.uPartOpacity=h),L.uReverseFlip=Y==f?!1:Y,L.uFixPickReverseColor=M||Mh),T.cullFace.enabled=u?!0:!1},Yd=function(u){if(!u._picking){var c=se.for(u),a=c.directUniforms();a.uPartOpacity=1}},di=function(){var h=new H.Math.Matrix2d,S=[1,0,0,0,1,0,0,0,0];return function(r,V,C,Y,R,y,Z,N,K,X,O){var $=se.for(r),M=$.directUniforms(),D=$.directAttribs();return C?(M.uTexture=!0,M.uDiscardSelectable=dk(Y)?Y:!0,D.aUv=Xi(r,R,y,f,2),O?(M.uBlendTexture=!0,M.uBlendSampler=O):(M.uBlendTexture=!1,M.uBlendSampler=r._emptyBlendTexture),M.uSampler=C,M.uUvMatrix=Z||N||K||X?zs(K,Z,N,X,h).toArray9():S,void 0):(M.uSampler=r._emptyTexture,M.uBlendSampler=r._emptyBlendTexture,void 0)}}(),Ib=function(p,Y,b){var Z=se.for(p),Q=Z.directUniforms(),j=Z.directAttribs();p.activeTexture(p.TEXTURE0),or(p,f),p.activeTexture(p.TEXTURE1),or(p,f),b&&(j.aUv=!1,Q.uTexture=!1,Q.uSampler=p._emptyTexture,Q.uBlendTexture=!1,Q.uBlendSampler=p._emptyBlendTexture)},gi=function(Z,o,K,v,O,H){var h=se.for(Z),D=h.directUniforms(),p=h.directAttribs();!K||xf||dh||Z.lineWidth(K),v&&!Z._picking&&(D.uFixPickReverseColor=v),O&&(p.aPosition=Xi(Z,O,H,f))},En=function(Q,E,S,c,_){sq&&(c=Q[sq]),_?Q.drawArraysInstanced(c==f?Q.TRIANGLES:c,E,S,_):Q.drawArrays(c==f?Q.TRIANGLES:c,E,S);var g=Q._renderInfo;g&&(g.calls++,_&&(S*=_),g.vertices+=S,(c==f||c===Q.TRIANGLES)&&(g.faces+=S/3),c===Q.LINES&&(g.lines+=S/2),c===Q.POINTS&&(g.points+=S))},fe=function(b,l,W,w,O,s){sq&&(w=b[sq]),s?b.drawElementsInstanced(w==f?b.TRIANGLES:w,W,O==f?b.UNSIGNED_SHORT:O,l==f?0:2*l,s):b.drawElements(w==f?b.TRIANGLES:w,W,O==f?b.UNSIGNED_SHORT:O,l==f?0:2*l);var P=b._renderInfo;P&&(P.calls++,s&&(W*=s),P.vertices+=W,(w==f||w===b.TRIANGLES)&&(P.faces+=W/3),w===b.LINES&&(P.lines+=W/2),w===b.POINTS&&(P.points+=W))},zi=function(N,f,j){var e=N.ARRAY_BUFFER;return N.bindBuffer(e,f),j&&N.bufferData(e,j,N.STATIC_DRAW),f},hi=function(g,Y,u,J,X){var Y=Xi(g,Y,u,J,X);return Y.instanced=!0,Y},Xi=function(F,e,A,Q,Z){return A?Ig(F,F.ARRAY_BUFFER,e,A):zi(F,e,A,Q,Z)},un=function(r,R,S){var I=r.ELEMENT_ARRAY_BUFFER;r.bindBuffer(I,R),S&&r.bufferData(I,S,r.STATIC_DRAW)},Wh=function(y,h,C){Ig(y,y.ELEMENT_ARRAY_BUFFER,h,C)},Ig=function(u,B,T,j){var G=j._bufId;G||(G=j._bufId=H.Math.generateIncreasingID());var T,w=u._bufPool;return(T=w[G])&&T._buf?u.bindBuffer(B,T._buf):(T=w[G]={_buf:Od(u)},u.bindBuffer(B,T._buf),u.bufferData(B,j,u.STATIC_DRAW)),T._fid=u._renderInfo.frame,T._buf},cj=function(H,F){F!=f&&F>=0&&H.enableVertexAttribArray(F)},Ik=function(j,F){F!=f&&F>=0&&j.disableVertexAttribArray(F)},ni=function(X,s){var H=X.getGL(),e=se.for(H),c=e.directUniforms();X._7O=X._8O.pop(),s&&(c.uMVMatrix=X._7O,X._6O=s,c.uNMatrix=s)},_g=function(c,I){return I||(I=ue()),Tj(I,c),tj(I),ye(I),I},Qi=function(o,n){var A=o.getGL(),P=o._7O,M=se.for(A),h=M.directUniforms();n?(o._8O.push(Nd(P)),h.uMMatrix=n,Tq(P,P,n),o._7O=P):h.uMMatrix=ql,h.uMVMatrix=P,h.uNMatrix=_g(P,o._6O)},tc={body:0,label:1,label2:2,note:3,note2:4,symbol:5},ok=10,fh=function(O,i,M,W,y,V){var F;if(M){var g=W._pickId;g||(g=W._pickId=i._pickIdUsed,i._pickIdUsed+=ok);var e,P=tc[y];if(null!=P)e=g+P;else{var l=W._pickExtraPartMap;l||(l=W._pickExtraPartMap={}),(e=l[y])||(e=l[y]=i._pickIdUsed++)}i[e]||(i[e]={data:W.data,part:y}),F=Us(e)}else F=_h;if(!V){var b=se.for(O),n=b.directUniforms();n.uFixPickReverseColor=F}return F},hk=fh,qr=function(g,B,l){"target"!==l&&(l="source");var t="target"===l?B.getTargetAgent():B.getSourceAgent(),n="edge."+l+".";if(mq(t)){var d=B.s(n+"anchor.x"),W=B.s(n+"anchor.elevation"),b=B.s(n+"anchor.y"),X=ec(t,g.getMat(t)),s=t.getAnchor3d(),x=Vh([(d===E?.5:d)-s.x,(W===E?.5:W)-s.y,(b===E?.5:b)-s.z],X);return x[1]+=B.s(n+"offset.elevation"),x}var z=B.s(n+"index"),m=g.getData3dUI(t);if(!m.info||!m.info.list)return!1;if(z>=0){var C,Q,F,P,i,w=m.info._lastPointsSegments,A=w.points,S=w.segments,f=-1,N=-1;for(F=0,P=S?S.length:A.length;P>F;F++){if(Q=S?S.get(F):1,3===Q)i=2;else if(4===Q)i=3;else{if(5===Q)continue;i=1}if(f+=i,N++,N===z){C=A.get(f);break}}return C||(C=A.get(A.length-1)),[C.x,(C.e||0)+B.s(n+"offset.elevation"),C.y]}var k=B.s(n+"percent")||.5;if(k=Math.max(0,Math.min(k,1)),!m||!m.getCache)return!1;var L=m.getCache(),P=L[L.length-1].length,w=g.getLineOffset(t,k*P),x=w.point;return[x.x,x.y+B.s(n+"offset.elevation"),x.z]},oq=function(){var n={center:function(Z,F,p,$,h){var T=-F[1]/2,a={x:-F[0]/2,y:T,width:F[0],height:F[1]},U=Nb(Z,a,p);return[U.x+$,-U.y-h,L.getPosition3dGap()]},front:function(r,c,Z,t,B){var s=-c[1]/2,f={x:-c[0]/2,y:s,width:c[0],height:c[1]},E=Nb(r,f,Z);return[E.x+t,-E.y-B,c[2]/2+L.getPosition3dGap()]},back:function(M,q,U,X,Y){var s=-q[0]/2,J=-q[1]/2,m={x:s,y:J,width:q[0],height:q[1]},a=Nb(M,m,U);return[-a.x-X,-a.y-Y,-q[2]/2-L.getPosition3dGap()]},left:function(z,y,A,C,q){var Q=-y[1]/2,D={x:-y[2]/2,y:Q,width:y[2],height:y[1]},w=Nb(z,D,A);return[-y[0]/2-L.getPosition3dGap(),-w.y-q,w.x+C]},right:function(Q,B,f,H,U){var r=-B[2]/2,$=-B[1]/2,d={x:r,y:$,width:B[2],height:B[1]},S=Nb(Q,d,f);return[B[0]/2+L.getPosition3dGap(),-S.y-U,-S.x-H]},top:function(u,b,K,m,V){var Z={x:-b[0]/2,y:-b[2]/2,width:b[0],height:b[2]},n=Nb(u,Z,K);return[n.x+m,b[1]/2+L.getPosition3dGap(),n.y+V]},bottom:function(h,P,A,_,d){var e=-P[2]/2,K={x:-P[0]/2,y:e,width:P[0],height:P[2]},C=Nb(h,K,A);return[C.x+_,-P[1]/2-L.getPosition3dGap(),-C.y-d]}};return function(u,x,t,p,J,r){return n[p](u,x,t,J||0,r||0)}}(),Ah=function(Q,A,E,e,Z,H,M,s,k,x){if(Z&&(A[0]+=Z[0],A[1]+=Z[1],A[2]+=Z[2]),tf(Q,E),s){var j=ue();if(qe(j,k,x),Vh(A,j),tf(Q,A),Q.auto=s,Q.pos=Vh([0,0,0],Q),H){var c=Q.mat2=ue();qe(c,H,M)}}else qe(Q,k,x),tf(Q,A),e===re?Th(Q,-qq):e===ln?Th(Q,qq):e===Fc?ll(Q,-qq):e===ab?ll(Q,qq):e===qo&&Th(Q,O),qe(Q,H,M);return Q},Wc=function(b,y){var $=y.auto,M=y.mat2,J=b.gv;if($){var h,s=ue(),W=[0,0,0,0];h="string"==typeof $?[$.indexOf("x")<0?J._eye[0]:J._center[0],$.indexOf("y")<0?J._eye[1]:J._center[1],$.indexOf("z")<0?J._eye[2]:J._center[2]]:J._eye,$f(W,Qc(ue(),h,J._center,J._up)),ke(s,Mf(W,W),y.pos),M&&Tq(s,s,M),Qi(J,s)}else Qi(J,y)},Gi=function(P,r,E,p,X){var i=P.s,F=P.gv,z=F.getGL(),B=F._prg,g=F._buffer,l=F._1O,y=se.for(z),h=y.directAttribs();Nm(z,gr,l),Wc(P,E),_d(z,B,i(r+".blend"),i(r+".light"),i(r+".opacity"),i(r+".reverse.flip"),i(r+".reverse.color"),i(r+".reverse.cull")),di(z,B,l,X,g.uv,Yr),h.aPosition=Xi(z,g.vs,p,f),h.aNormal=Xi(z,g.ns,xb,f),Wh(z,g.is,Dc),fe(z,0,Dc.length),Ib(z,B,l),Yd(z,B),ni(F)},rj=function(c,T,I){var y=c.gv,J=c.data,t=c[T]={blend:y.getBodyColor(J)||y.getFaceBlend(J,T),light:y.getFaceLight(J,T),color:y.getFaceColor(J,T),opacity:y.getFaceOpacity(J,T),transparent:y.getFaceTransparent(J,T),reverseFlip:y.getFaceReverseFlip(J,T),reverseColor:y.getFaceReverseColor(J,T),reverseCull:y.getFaceReverseCull(J,T),texture:y.getFaceImage(J,T),blendTexture:y.getFaceBlendImage(J,T),discardSelectable:y.getFaceDiscardSelectable(J,T)};if("csg"!==T){t.uv=y.getFaceUv(J,T)||I&&I[T+"Uv"],t.uvScale=y.getFaceUvScale(J,T)||I&&I[T+"UvScale"],t.uvOffset=y.getFaceUvOffset(J,T)||I&&I[T+"UvOffset"],t.uvRotation=y.getFaceUvRotation(J,T)||I&&I[T+"uvRotation"],t.uvAnchor=y.getFaceUvAnchor(J,T)||I&&I[T+"uvAnchor"];var $=y.getFaceMat(J,T);if($){var z=ec(J,$);J.appendAnchorMatrix3d(z),t.mat=z}}return t},Um=function(v,P,B,i,g){var M=v[i];if(M){if(!g(M.transparent))return;var q=v.data,u=v.gv,k=u._buffer,D=u.getTexture(M.texture,q,i),A=u.getTexture(M.blendTexture,q),o=se.for(P),j=o.directUniforms(),V=o.directAttribs();di(P,B,D,M.discardSelectable,k.uv,M.tuv,M.uvOffset,M.uvScale,M.uvRotation,M.uvAnchor,A),_d(P,B,M.blend,M.light,M.opacity,M.reverseFlip,M.reverseColor,M.reverseCull),M.cs&&!u._batchColorDisabled?(j.uBatchColor=!0,V.aBatchColor=Xi(P,k.batchColor,M.cs,B.aBatchColor,4)):j.uDiffuse=M.color||W["color.empty"],V.aPosition=Xi(P,k.vs,M.vs,f),V.aNormal=Xi(P,k.ns,M.ns,f),En(P,0,M.vs.length/3),M.cs&&!u._batchColorDisabled&&(j.uBatchColor=!1,Ik(P,B.aBatchColor)),Yd(P,B),Ib(P,B,D)}},mm=function(a,$,j){br(a)?a.forEach(function(c){mm(c,$,j)}):Vn(a)?mm(Kq($,a),$,j):Mr(a)?a.shape3d?mm(a.shape3d,$,j):j.push(a):j.push(a)},Lh=function(){for(var Q=50,d=arguments.length,j=[],N=0;d>N;N++)j[N]=arguments[N];Wk[xi]="Time : "+(new Date).toLocaleString()+", Info :"+j.join(", "),xi=(xi+1)%Q,console.error("Failed to create shader.")},zs=function(){var u=new xc.Matrix2d;return function(M,Y,Z,o,w){return w||(w=u),w.identity(),o&&w.translate(-o[0],-o[1]),Z&&w.scale(Z[0],Z[1]),M&&w.rotate(M),o&&w.translate(o[0],o[1]),Y&&w.translate(Y[0],Y[1]),w}}(),Li=function(K,e,m,v,q,n){var Z,R,g,b,A,u,V,P,B,o,r,X=[v-e,q-m],h=K?K.length:0;for(g=0;h>g;g++){for(b=2,Z=K[g],A=Z[0],u=Z[1];b+1<Z.length;){if(V=Z[b],P=Z[b+1],R=Tb(e,m,v,q,A,u,V,P,!0)){B=[V-A,P-u],o=Mp(B),B[0]/=o,B[1]/=o,o=Cl(X,B),o=o>0?n:-n,r=[B[0]*o,B[1]*o];break}A=V,u=P,b+=2}if(r)break}if(r)for(v=e+r[0],q=m+r[1],g=0;h>g;g++)for(b=2,Z=K[g],A=Z[0],u=Z[1];b+1<Z.length;){if(V=Z[b],P=Z[b+1],R=Tb(e,m,v,q,A,u,V,P,!0))return[0,0];A=V,u=P,b+=2}return r?r:[v-e,q-m]},Rr=function(m){return"nearest"===m?os.NEAREST:"linear"===m?os.LINEAR:m},nj=H.graph3d={WebGLConstants:os},Ri=function(J,u,y){kl(K+".graph3d."+J,u,y)},gp="!~!<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~!<6/1!,!*{/mbdpMwVxpmg!,!z/mbdpMwVxpmg!-y/mbdpMwVxpmg)3dfw!>!^j]wVxpmg!<{zy/*enspgtobsu!+!yjsubNNv!+!^j]yjsubNxpmg)!>!mbdpMwVxpmg!|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1!>!j!uoj)!spg!<mbdpMwVxpmg!4dfw!1!?!UDFKCP`XPMG`YBN!gj$!gjeof$!<enspgtobsu!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!gjeof$!~!<fdobutjEfojMb!>!fdobutjEfojMw!|!*itbEv)!gj!ITBE!gfegj$!gjeof$!~!<ttfouihjsCidubCb!>!ttfouihjsCidubCw!|!*ttfouihjsCidubCv)!gj!TTFOUIHJSCIDUBC!gfegj$!gjeof$!~!<eofmCidubCb!>!eofmCidubCw!|!*eofmCidubCv)!gj!EOFMCIDUBC!gfegj$!gjeof$!~!<spmpDidubCb!>!spmpDidubCw!|!*spmpDidubCv)!gj!SPMPDIDUBC!gfegj$!gjeof$!~!<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw!|!*fsvuyfUv)!gj!ftmf$!<*y/wVb!-**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw)4dfw!>!wVw!QJMD`WV!gfegj$!<*enspgtobsu)4dfw!>!opjujtpQw!gjeof$!~!1!>>!SFQQJMD`YPC`YBN!gj$!<*enspgtobsu!+!yjsubNNv)4dfw!>!emspXw!<*yfusfw)4dfw!>!yfusfWw!gjeof$!<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!ftmf$!<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!ftmf!~!<**1/2!-mbnspOw!+!n)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!<**^3]n!-^3]n)upe!-*^2]n!-^2]n)upe!-*^1]n!-^1]n)upe)4dfw!0!mbnspOb!>!mbnspOw!<*!efdobutoJyjsubNb!)4ubn!>!n!4ubn!|!*fdobutoJftVv)!gj!FDOBUTOJIDUBC!gfegj$!gjeof$!|!*ldjQva)!gj!1!>>!SFQQJMD`YPC`YBN!gj$!<enspgtobsu!+!yjsubNWNv!>!yfusfw!5dfw!gjeof$!~!<enspgtobsu!+!efdobutoJyjsubNb!>!enspgtobsu!|!*fdobutoJftVv)!gj!FDOBUTOJIDUBC!gfegj$!<*1/2!-opjujtpQb)5dfw!>!enspgtobsu!5dfw!|!*ejpw)ojbn!ejpw!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw!<^UDFKCP`XPMG`YBN]yjsubNxpmg!5ubn!nspgjov!1!?!UDFKCP`XPMG`YBN!gj$!gjeof$!<esppDxpebit!5dfw!hojzsbw!<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw!<fdobutjEfojMb!ubpmg!fuvcjsuub!<itbEv!mppc!nspgjov!ITBE!gfegj$!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov!<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov!<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov!<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov!<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!gjeof$!<eofmCidubCw!4dfw!hojzsbw!<eofmCidubCb!4dfw!fuvcjsuub!<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw!<ttfouihjsCidubCb!ubpmg!fuvcjsuub!<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!gjeof$!<spmpDidubCw!5dfw!hojzsbw!<spmpDidubCb!5dfw!fuvcjsuub!<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw!<emspXw!4dfw!hojzsbw!<yfusfWw!4dfw!hojzsbw!<mbnspOw!4dfw!hojzsbw!<yjGv!mppc!nspgjov!<ldjQv!mppc!nspgjov!<yjsubNxfjWv!5ubn!nspgjov!<yjsubNOv!5ubn!nspgjov!<yjsubNQv!5ubn!nspgjov!<yjsubNNv!5ubn!nspgjov!<yjsubNWNv!5ubn!nspgjov!<opjujtpQb!4dfw!fuvcjsuub!gjeof$!~!<*{zy/**1/1!-sje)5dfw!+!yjsubn))f{jmbnspo!osvufs!|!*yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsu!4dfw!<efdobutoJyjsubNb!5ubn!fuvcjsuub!<fdobutoJftVv!mppc!nspgjov!FDOBUTOJIDUBC!gfegj$!<mbnspOb!4dfw!fuvcjsuub!gjeof$!<wVw!3dfw!hojzsbw!ftmf$!<wVw!4dfw!hojzsbw!QJMD`WV!gfegj$!<wVb!3dfw!fuvcjsuub!<yjsubNwVv!4ubn!nspgjov!<fsvuyfUeofmCv!mppc!nspgjov!<fsvuyfUv!mppc!nspgjov!YJGFSQ$!^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Hf="!~!~!<eJ!>!spmpDhbsG`mh!~!<spmpDsfmqnbTwv!>+!eJ!<*zy/wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw!|!*fsvuyfUeofmCv)!gj!gjeof$!~!<ttfouihjsCidubCw!>+!chs/eJ!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~!<ttfouihjsCv!>+!chs/eJ!|*1/2!>a!ttfouihjsCv)gj!gjeof$!~!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!|!*hpGv)!gj!HPG!gfegj$!~!~!<zujdbqPusbQv!>+!b/eJ!|*1/2!>a!zujdbqPusbQv)gj!~!gjeof$!~!<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ!gjeof$!<*spmpDwof)sbfojMpUmfyfUqbNwof!>!spmpDwof!<**{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv)fcvDfsvuyfu!>!spmpDwof!5dfw!ftmf$!<**ttfoihvps!-*{z/dfWudfmgfs!-y/dfWudfmgfs.)4dfw!-qbNwoFv)WVfcvDfsvuyfu)CHStpUsbfojM!>!spmpDwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!gjeof$!<*mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!>!dfWudfmgfs!4dfw!ftmf$!<***mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!-ubvRqbnwoFv)spudfWfubups)f{jmbnspo!>!dfWudfmgfs!4dfw!FUBUPS`QBNWOF!gfegj$!<*yjsubNxfjWv!-O)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw!<*opjujtpQbsfnbDv!.!emspXw)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw!|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!gjeof$!~!~!~!~!<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ!<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt!|*^j]fmhoBupqTv!?!udfggFupqt)gj!<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg!<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw!|*1/1!?!fhobSm)!gj!~!<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm!|*1/1!?!^j]fhobSupqTv)!gj!<1/2!>!fhobSm!ubpmg!<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw!|*1/1!>>!x/^j]spmpDupqTv)gj!|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!gjeof$!~!~!~!<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ!|*1/1!?!fhobSm)!gj!~!<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm!|*1/1!?!^j]fhobSuojpQv)!gj!<1/2!>!fhobSm!ubpmg!<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw!|*1/1!>>!x/^j]spmpDuojpQv)gj!|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!gjeof$!~!~!<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ!|*1/1!>>!x/^j]spmpDsjEv)gj!|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~!<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~!<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!<osvufs!<esbdtje!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj!<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg!|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~!<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!>+!nsfUusfcnbm!|*1/1!?!fhobSuihjmebfIv)gj!<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!nsfUusfcnbm)ybn!>!nsfUusfcnbm!<*opjudfsjEuihjmebfIv.!-O)upe!>!nsfUusfcnbm!ftmf!<*M.!-O)upe!>!nsfUusfcnbm!*1/1!>>!{/opjudfsjEuihjmebfIv!%%!1/1!>>!z/opjudfsjEuihjmebfIv!%%!1/1!>>!y/opjudfsjEuihjmebfIv)!gj!<nsfUusfcnbm!ubpmg!|*1/1!>>!x/spmpDuihjmebfIv)gj!gjeof$!EOF`QPPM`MMPSOV$!~!gjeof$!<chs/mfyfUxpmg!>,!chs/eJ!ftmf$!<bchs/mfyfUxpmg!>,!bchs/eJ!*!BCHS`EEB`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<bchs/mfyfUxpmg!>!bchs/eJ!*!BCHS`FEJSSFWP`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<b/mfyfUxpmg!>!b/eJ!*!B`FEJSSFWP`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<chs/mfyfUxpmg!>!chs/eJ!*!CHS`FEJSSFWP`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<bchs/mfyfUxpmg!>+!bchs/eJ!*!BCHS`ZMQJUMVN`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<chs/mfyfUxpmg!>+!chs/eJ!*!CHS`ZMQJUMVN`FEPN`EOFMC`XPMG!)efojgfe!gj$!****1/1)3dfw!-^j]wVxpmg)obiUsfubfsh)mmb!%%!***1/2)3dfw!-^j]wVxpmg)obiUttfm)mmb!%%!^j]efmcboFxpmg)!gj!<*^j]wVxpmg!-^J]fsvuyfUxpmg)E3fsvuyfu!>!mfyfUxpmg!|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)!spg!USBUT`QPPM`MMPSOV$!<mfyfUxpmg!5dfw!1!?!UDFKCP`XPMG`YBN!gj$!|!*uihjMv)!gj!~!gjeof$!~!<spmpDeofmCv!>+!eJ!|*eofmCv)gj!ftmf$!~!<spmpDeofmCv!>+!eJ!|*eofmCv)gj!ftmf!~!<eofmCidubCw!>+!chs/eJ!|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~!~!<esbdtje!|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~!<ftvggjEv!>!eJ!|ftmf~!<spmpDidubCw!>!eJ!|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|!ftmf!~!<spmpDwv!>!eJ!|*fsvuyfUv)gj!|!ftmf!~!<spmpDftsfwfSldjQyjGv!>!eJ!|*qjmGftsfwfSva!%%!ldbCtj)gj!~!<fvsu!>!ldbCtj!<O.!>!O!|*1/1!=!*O!-F)upe)gj!<ftmbg!>!ldbCtj!mppc!<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw!|!ftmf!~!gjeof$!~!~!<ftvggjEv!>!eJ!|ftmf!~!<esbdtje!|*1/1!>>!x/ftvggjEv)gj!|!*fdobutjEitbEv!?!*fdobutjEqbHitbEv!-fdobutjEfojMw)epn!%%!itbEv)!gj!ITBE!gfegj$!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~!<spmpDftsfwfSldjQyjGv!>!eJ!|!ftmf!~!<spmpDidubCw!>!eJ!|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|!*yjGv)!gj!<eJ!5dfw!|!ftmf!~!~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!|!ftmf!~!<spmpDidubCw!>!spmpDhbsG`mh!|!*spmpDidubCv)!gj!SPMPDIDUBC!gfegj$!|!*ldjQv)!gj!~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj!gjeof$!~!~!<osvufs!<esbdtje!|!**6/1!=!*mbdpMw)iuhofm)!>a!^j]sfooJqjmDsfqqjmDv!%%!3!>>!^j]fqbiTsfqqjmDv!}}!***ojNqjmd!-mbdpMw)obiUsfubfsh)mmb!%%!**ybNqjmd!-mbdpMw)obiUttfm)mmb)!>a!^j]sfooJqjmDsfqqjmDv!%%!2!>>!^j]fqbiTsfqqjmDv)!gj!<**1/2!-emspXw)5dfw!+!^j]yjsubNsfqqjmDv)4dfw!>!mbdpMw!|!*,,j!<SFQQJMD`YPC`YBN!=!j!<1!>!j!uoj)!spg!<mbdpMw!4dfw!1!?!SFQQJMD`YPC`YBN!gj$!~!gjeof$!~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj!ftmf$!~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQqjmd!-sje)upe)!gj!~!<*1/1!-1/1!-{/wVw)4dfw!>!opjujtpQqjmd!<1/2.!>!y/sje!|!*:!=!opjudfsjEqjmDv)!gj!ftmf!~!<*1/1!-1/1!-{/wVw)4dfw!>!opjujtpQqjmd!<1/2!>!y/sje!|!*9!=!opjudfsjEqjmDv)!gj!ftmf!QJMD`WV!gfegj$!~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj!gjeof$!<opjujtpQw!>!opjujtpQqjmd!4dfw!QJMD`WV!gfegj$!<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw!|!*1!?!opjudfsjEqjmDv)!gj!~!~!~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!|!ftmf!~!~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!|!*uofsbqtobsUv)!gj!gjeof$!<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv!ftmf$!<*zy/wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv!QJMD`WV!gfegj$!|!**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)!gj!<spmpDwv!5dfw!|!*ejpw)ojbn!ejpw!<uvpldbmc!mppc!nspgjov!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw!<^UDFKCP`XPMG`YBN]efmcboFxpmg!mppc!nspgjov!<^UDFKCP`XPMG`YBN]fsvuyfUxpmg!E3sfmqnbt!nspgjov!1!?!UDFKCP`XPMG`YBN!gj$!gjeof$!gjeof$!~!~!<*1/2!-*Gqjn!-2spmpd!-1spmpd)yjn)5dfw!osvufs!<*1/2!,!uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!2spmpd!4dfw!|!ftmf!~!<*1/2!-1spmpd)5dfw!osvufs!|!*1/1!>>!Gqjn)!gj!<*uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!1spmpd!4dfw!<*qjn)sppmg!>!uoJqjn!ubpmg!<*qjn)udbsg!>!Gqjn!ubpmg!<*mfwfMqjNybn`WVfcvd!-1n!-*ttfoihvps)qjNpUttfoihvps)qnbmd!>!qjn!ubpmg!|!*ttfoihvps!ubpmg!-sjEfmqnbt!4dfw!-qbNwof!E3sfmqnbt)WVfcvDfsvuyfu!5dfw!~!<qjn!osvufs!~!<*ttfoihvps!+!72/2)3hpm!+!1/3!.!>!qjn!|!ftmf!~!<6n!,!*7s!.!6s)!0!*6n!.!7n)!+!*ttfoihvps!.!6s)!>!qjn!|!*7s!>?!ttfoihvps)!gj!ftmf!~!<5n!,!*6s!.!5s)!0!*5n!.!6n)!+!*ttfoihvps!.!5s)!>!qjn!|!*6s!>?!ttfoihvps)!gj!ftmf!~!<2n!,!*5s!.!2s)!0!*2n!.!5n)!+!*ttfoihvps!.!2s)!>!qjn!|!*5s!>?!ttfoihvps)!gj!ftmf!~!<1n!,!*2s!.!1s)!0!*1n!.!2n)!+!*ttfoihvps!.!1s)!>!qjn!|!*2s!>?!ttfoihvps)!gj!<1/1!>!qjn!ubpmg!|!*ttfoihvps!ubpmg)qjNpUttfoihvps!ubpmg!1/5!7n!fojgfe$!9411/1!7w!fojgfe$!23/1!7s!fojgfe$!1/4!6n!fojgfe$!721/1!6w!fojgfe$!614/1!6s!fojgfe$!1/3!5n!fojgfe$!751/1!5w!fojgfe$!5/1!5s!fojgfe$!1/2!.!2n!fojgfe$!783/1!2w!fojgfe$!9/1!2s!fojgfe$!1/3!.!1n!fojgfe$!:44/1!1w!fojgfe$!1/2!1s!fojgfe$!~!<*z/g!-nc!-nu)yjn!osvufs!<*y/g!-sc!-mc)yjn!>!nc!4dfw!<*y/g!-su!-mu)yjn!>!nu!4dfw!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mc!4dfw!<f{jTmfyfu!>.!y/wv!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!sc!4dfw!<f{jTmfyfu!>,!z/wv!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!su!4dfw!<f{jTmfyfu!>,!y/wv!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mu!4dfw!<f{jTmfyfu!>+!wv!<*f{jTfdbg!+!1/3!.!f{jTfmjUybn`WVfcvd!-1/1)ybn!+!1/4!>,!y/wv!<f{jTfmjUojn`WVfcvd!+!1/3!+!uoJsfumjg!>,!z/wv!~!<f{jTfmjUybn`WVfcvd!+!1/3!>,!z/wv!|!*mfwfMqjNybn`WVfcvd!=!uoJqjn)!gj!<f{jTfdbg!+!fdbg!>,!y/wv!~!<1/4!>.!fdbg!<f{jTfdbg!>,!z/wv!|!*1/3!?!fdbg)!gj!<g!.!6/1!>,!wv!<*wv)udbsg!>!g!3dfw!<*1/2!.!f{jTfdbg)!+!*fdbg!-opjudfsje)WVufh!>!wv!3dfw!<*f{jTfmjUybn`WVfcvd!+!1/4)!0!1/2!>!f{jTmfyfu!ubpmg!<*uoJqjn)3qyf!>!f{jTfdbg!ubpmg!<*mfwfMqjNojn`WVfcvd!-uoJqjn)ybn!>!uoJqjn!<*1/1!-uoJqjn!.!mfwfMqjNojn`WVfcvd)ybn!>!uoJsfumjg!ubpmg!<*opjudfsje)fdbGufh!>!fdbg!ubpmg!|!*uoJqjn!ubpmg!-opjudfsje!4dfw!-qbNwof!E3sfmqnbt)WVfcvDsbfojmjc!4dfw!~!<*1/2!,!wv)!+!6/1!osvufs!~!<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje)3dfw!>!wv!|!ftmf!~!<*z/opjudfsje)tcb!0!*{/opjudfsje!-y/opjudfsje!.)3dfw!>!wv!|!*1/5!>>!fdbg)!gj!ftmf!~!<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje!.)3dfw!>!wv!|!*1/4!>>!fdbg)!gj!ftmf!~!<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje!.)3dfw!>!wv!|!*1/3!>>!fdbg)!gj!ftmf!~!<*z/opjudfsje)tcb!0!*{/opjudfsje!.!-y/opjudfsje!.)3dfw!>!wv!|!*1/2!>>!fdbg)!gj!ftmf!~!<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje)3dfw!>!wv!|!*1/1!>>!fdbg)!gj!<wv!3dfw!|!*fdbg!ubpmg!-opjudfsje!4dfw)WVufh!3dfw!~!<fdbg!osvufs!~!<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/6!;!1/3!@!1/1!?!{/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!{/opjudfsjEtcb)!gj!|!ftmf!~!<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/4!;!1/1!@!1/1!?!y/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj!|!*{/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj!<1/2!.!>!fdbg!ubpmg!<*opjudfsje)tcb!>!opjudfsjEtcb!4dfw!|!*opjudfsje!4dfw)fdbGufh!ubpmg!1/72!f{jTfmjUojn`WVfcvd!fojgfe$!1/763!f{jTfmjUybn`WVfcvd!fojgfe$!1/5!mfwfMqjNojn`WVfcvd!fojgfe$!1/9!mfwfMqjNybn`WVfcvd!fojgfe$!WV`FCVD`FQZU`QBNWOF!gfegj$!~!<*{zy/*yjsubn!+!*1/1!-sje)5dfw))f{jmbnspo!osvufs!|!*yjsubn!5ubn!oj!-sje!4dfw!oj)opjudfsjEnspgtobsUftsfwoj!4dfw!gjeof$!~!<*x/fvmbw!-**SPUDBG`BNNBH)4dfw!-{zy/fvmbw)xpq)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!ftmf$!~<*!b/fvmbw!-*!*!*!*!9142411/1!)4dfw!-chs/fvmbw!)mbvrFobiUttfm!)4dfw!-3:/32!+!chs/fvmbw!-*!661/1!)4dfw!.!661/2!+!*!*!77725/1!)4dfw!-chs/fvmbw!)xpq!)yjn!)5dfw!osvufs!|!*!fvmbw!5dfw!oj!)CHStpUsbfojM!5dfw!~!<*b/fvmbw!-****65151/1)4dfw!-chs/fvmbw)mbvrFobiUttfm)4dfw!-9194::4881/1!+!chs/fvmbw!-**5/3)4dfw!-*5218342361/1)4dfw!,!79:387985:/1!+!chs/fvmbw)xpq)yjn)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!gjeof$!~!<{zy/*!*x/ubvr!-{/ubvr.!-z/ubvr.!-y/ubvr.)5dfw!-wr!)ubvRumvn!osvufs!<*!*1/1!-dfw)5dfw!-ubvr!)ubvRumvn!>!wr!5dfw!|!*!dfw!4dfw!-ubvr!5dfw!)spudfWfubups!4dfw!~!<*!{/3r!+!{/2r!.!z/3r!+!z/2r!.!y/3r!+!y/2r!.!x/3r!+!x/2r!-z/3r!+!y/2r!.!y/3r!+!z/2r!,!x/3r!+!{/2r!,!{/3r!+!x/2r!-y/3r!+!{/2r!.!{/3r!+!y/2r!,!x/3r!+!z/2r!,!z/3r!+!x/2r!-{/3r!+!z/2r!.!z/3r!+!{/2r!,!x/3r!+!y/2r!,!y/3r!+!x/2r)5dfw!osvufs!|!*3r!5dfw!-2r!5dfw)ubvRumvn!5dfw!<ubvRqbnwoFv!5dfw!nspgjov!FUBUPS`QBNWOF!gfegj$!<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!QBNWOF`FTV!gfegj$!gjeof$!~!gjeof$!<*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!osvufs!ftmf$!<*1/:!0!1/2)!+!*!*qe!-*z/f{jTmfyfu!-yyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-yyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-yzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-yzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!)!osvufs!<z/f{jTmfyfu!+!tvjebSxpebit!+!*2!-2!.)3dfw!>!uftggp!3dfw!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!}}!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!<*opjujtpQpUuihjm)f{jmbnspo!>!E4ec!4dfw!<tbjCxpebit!>,!qe!<*sbfObsfnbDxpebit!.!sbGbsfnbDxpebit)!0!*sbfObsfnbDxpebit!.!*opjujtpQpUuihjm)iuhofm)!>!qe!ubpmg!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!<**1/3!-1/5)3dfw!+!f{jTqbNxpebit)!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!|!*sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTuojpQufh!ubpmg!~!<*68/1!-684/1)3dfw!,!sbobmq!+!*63/1!-632/1)3dfw!osvufs!~!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!<*z/w)ohjt!>!Zohjt!ubpmg!|!*foPutpnmb!>?!z/Wtcb)!gj!ftmf!~!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!<*y/w)ohjt!>!Yohjt!ubpmg!|!*foPutpnmb!>?!y/Wtcb)!gj!ftmf!~!<y/w!.!1/5!>!y/sbobmq!*1/1!?!{/w)!gj!|!*foPutpnmb!>?!{/Wtcb)!gj!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!<zy/w!>!sbobmq!3dfw!<*Zf{jTmfyfu!+!1/3!.!1/2)!+!fcvDpUfmbdt!>+!w!<fcvDpUfmbdt!>+!Wtcb!<**{/Wtcb!-z/Wtcb)ybn!-y/Wtcb)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!<*w)tcb!>!Wtcb!4dfw!|!*Zf{jTmfyfu!ubpmg!-w!4dfw)WVpUfcvd!3dfw!~!<xpebit!osvufs!~!gjeof$!<*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!>!xpebit!ftmf$!<*1/:!0!1/2)!+!*!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!)!>!xpebit!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!gjmf$!<*1/:!0!1/2)!+!*!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!)!>!xpebit!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!|!*utfUnvutvsg)!gj!<*dfWutfUnvutvsg)mmb!>!utfUnvutvsg!mppc!<*1/2!>=!{/esppDxpebit!-nvutvsGoj)3dfwc!>!dfWutfUnvutvsg!3dfwc!<*dfWnvutvsGoj)mmb!>!nvutvsGoj!mppc!<*1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit)!5dfwc!>!dfWnvutvsGoj!5dfwc!<tbjCxpebit!>,!{/esppDxpebit!<x/esppDxpebit!>0!{zy/esppDxpebit!<1/2!>!xpebit!ubpmg!|!*esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTufh!ubpmg!~!<d!osvufs!<*y/g!-c!-b)yjn!>!d!ubpmg!<*z/g!-us!-cs)yjn!>!c!ubpmg!<*z/g!-um!-cm)yjn!>!b!ubpmg!<*6/1!,!f{jt!+!wv)udbsg!>!g!3dfw!<*fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!us!ubpmg!<*fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cs!ubpmg!<*fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!um!ubpmg!<*fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cm!ubpmg!<f{jt!0!*6/1!,!f{jt!+!wv)sppmg!>!WVejpsuofd!3dfw!<f{jt!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!<*1/2!-1/1)3dfw!>!uftggp!3dfw!utopd!|!*fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt)qsfMxpebiTE3fsvuyfu!ubpmg!~!<***wv!-tiuqfe)E3fsvuyfu)iuqfEpUBCHSldbqov!-fsbqnpd)qfut!osvufs!|!*fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt)fsbqnpDE3fsvuyfu!ubpmg!~!<*tspudbGldbqoV!-w)upe!osvufs!|!*w!5dfw!oj!utopd)iuqfEpUBCHSldbqov!ubpmg!<*/2!-tspudbGldbQ)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!<*/763!-/763!+!/763!-/763!+!/763!+!/763)4dfw!>!tspudbGldbQ!4dfw!utopd!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!<esppDxpebit!5dfw!hojzsbw!<fwjfdfSxpebit!mppc!nspgjov!<tvjebSxpebit!ubpmg!nspgjov!<tbjCxpebit!ubpmg!nspgjov!<zujtofuoJxpebit!ubpmg!nspgjov!<f{jTxpebit!3dfw!nspgjov!<qbNxpebit!E3sfmqnbt!nspgjov!<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw!<fdobutjEqbHitbEv!ubpmg!nspgjov!<fdobutjEitbEv!ubpmg!nspgjov!<itbEv!mppc!nspgjov!ITBE!gfegj$!gjeof$!gjeof$!<sbGhpGv!ubpmg!nspgjov!<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<hpGv!mppc!nspgjov!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!gjeof$!<*6/1!-6/1!-6/1)4dfw!>!ybNqjmd!4dfw!utopd!<*6/1.!-6/1.!-6/1.)4dfw!>!ojNqjmd!4dfw!utopd!<^SFQQJMD`YPC`YBN]yjsubNsfqqjmDv!5ubn!nspgjov!<^SFQQJMD`YPC`YBN]sfooJqjmDsfqqjmDv!mppc!nspgjov!<^SFQQJMD`YPC`YBN]fqbiTsfqqjmDv!uoj!nspgjov!1!?!SFQQJMD`YPC`YBN!gj$!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov!<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov!<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov!<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov!<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov!<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov!<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov!<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov!<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!gjeof$!<eofmCidubCw!4dfw!hojzsbw!<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw!<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!gjeof$!<spmpDidubCw!5dfw!hojzsbw!<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjudfsjEuihjmebfIv!4dfw!nspgjov!<spmpDuihjmebfIv!5dfw!nspgjov!<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov!<fhobSuihjmebfIv!ubpmg!nspgjov!<emspXw!4dfw!hojzsbw!<opjujtpQbsfnbDv!4dfw!nspgjov!<yjsubNxfjWv!5ubn!nspgjov!gjeof$!gjeof$!<qbNwoFv!fcvDsfmqnbt!nspgjov!ftmf$!<ttfoihvps!ubpmg!nspgjov!<qbNwoFv!E3sfmqnbt!nspgjov!WV`FCVD`FQZU`QBNWOF!gfegj$!<zujwjudfmgfSv!ubpmg!nspgjov!<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw!<yfusfWw!4dfw!hojzsbw!<mbnspOw!4dfw!hojzsbw!<ftvggjEv!5dfw!nspgjov!<zujdbqPusbQv!ubpmg!nspgjov!<ttfouihjsCv!ubpmg!nspgjov!<uihjMv!mppc!nspgjov!<spmpDeofmCv!5dfw!nspgjov!<eofmCv!mppc!nspgjov!<uofdsfQqjmDv!ubpmg!nspgjov!<opjudfsjEqjmDv!uoj!nspgjov!<sfmqnbTeofmCv!E3sfmqnbt!nspgjov!<sfmqnbTv!E3sfmqnbt!nspgjov!gjeof$!<wVw!3dfw!hojzsbw!ftmf$!<wVw!4dfw!hojzsbw!QJMD`WV!gfegj$!<fsvuyfUeofmCv!mppc!nspgjov!<fsvuyfUv!mppc!nspgjov!<uofsbqtobsUv!mppc!nspgjov!<utfUbiqmBv!ubpmg!nspgjov!<spmpDftsfwfSldjQyjGv!5dfw!nspgjov!<qjmGftsfwfSv!mppc!nspgjov!<ldjQv!mppc!nspgjov!<yjGv!mppc!nspgjov!<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ$!gjeof$!gjeof$!<ubpmg!qnvjefn!opjtjdfsq!ftmf$!<ubpmg!qihji!opjtjdfsq!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!TF`MH!gfegj$!";
Hi(L,{setBatchInfo:function(Z,u){gb[Z]=u},getBatchInfo:function(Y){return gb[Y]},getBatchInfoMap:function(){return gb},setBatchInfoMap:function(e){gb=e}},!0);var cf=[1,1,1],ss=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],pq=[1,0,0,0,0,1,0,1,1,1,1,0],zc=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],yr=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],zq=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Rm=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Hg=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],$g=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Ye=function(x,K){var d=x._40Q;d.each(function(l){l.ivBatch(K)})},Kr=function(o,c,u){var N=u._id,F=c[N];if(F){var x=F.batch,k=o[x],z=k.ds,B=F.index;if(k.invalidate=!0,delete c[N],z.splice(B,1),jj(z))return delete o[x],void 0;for(var v=B,y=F.begin,p=F.size;B<z.length;B++)F=c[z[B]._id],F.index--,F.begin-=p;if(k.ms&&k.ms.length)return k.ms.splice(16*v,16),k.ics&&k.ics.splice(4*v,4),k.ps&&k.ps.splice(4*v,4),void 0;var H=3*y,_=3*p,s=4*y,O=4*p,m=k.vs,i=k.ps,G=k.uv,K=k.cs,W=k.bs,b=k.rs,X=k.ns,R=k.ls;m.splice(H,_),i.splice(s,O),G&&G.splice(2*y,2*p),K&&K.splice(s,O),W&&W.splice(H,_),b&&b.splice(y,p),X&&X.splice(H,_),R&&R.splice(y,p)}},zd=function(I,y,Z,W,E){if(!W)return f;var A=y[W];if(!A){var j=E.getBatchInfo(W)||Cq,s=j.image?[]:f;A=y[W]={vs:[],ns:[],uv:s,cs:s?f:j.color?f:[],bs:j.blend?[]:f,ps:[],rs:j.brightness?[]:f,ds:[],ms:j.instanced?[]:f,ics:s?f:j.color||!j.instanced?f:[]}}return A.invalidate=!0,I[Z._id]={index:A.ds.length,begin:A.vs.length/3,batch:W},A.ds.push(Z),A},Jd=function(P,E){return E!=f&&1!==E?[P[0]*E,P[1]*E,P[2]*E,P[3]]:P},gf=function(R){var Z=R.shapeModel;Z||(Z=Kq(R)),Z&&(Z._ctlineModel=[],Z._lineModel=E)},dd=function(){var g;return function(J,b,W){var G=J.getData3dUI(b),t=G.shapeModel;if(t||(t=Kq(G)),t||!G.shapeName){var o,l=b.s("wf.combineTriangle");if(W.geometry){if(!t&&(b instanceof H.Node&&!(b instanceof H.Shape)?(g||(g={vs:jd,is:Fl,uv:Tp}),t=g):t=[G.left,G.front,G.right,G.back,G.top,G.bottom],!t))return E;if(l){var X=b.s("wf.normEpsilon");isNaN(X)&&(X=2),l=0|Math.min(3,Math.max(1,isNaN(l)?1:l)),o=jo[l-1](t,G,180/(Math.PI*X))}else o=Ue(t,G);if(!o||0===o.length)return}else if(o=W.short?vs:pf,b.s("wf.boundingBox")){var P=G.getBoundingBox();if(P){var i=(new jf).scale(P.max.clone().sub(P.min)).setPosition(P.max.clone().add(P.min).divideScalar(2)).toArray();o=kk([],i,o)}}var x,N,V,u=J.getBrightness(b),z=b.s("bloom"),Z=b.s("3d.reflectable"),T=$r(W.color||"white"),y=T[3]<1,h=Math.ceil(W.width)||1,Y=b.s("3d.clipbox")?Ee:b.s("3d.clipbox.mask"),A=b.s("wf.fog"),c=b.getRenderLayer(),R=J._40Q.get(c),C=R.wireframeIndexMap,v=R.wireframeModelMap,m=b.s("batch"),r=b.s("3d.clip.direction");if(r){if(N=b.s("3d.clip.percentage"),0===N)return;x="_"+b._id,V=G._formatClipUniforms(r,N,b)}else x=m?(y?"T":"O")+m:(y?"T":"O")+(z?"_1":"_0")+(Z?"1_":"0_")+Y+"_"+h+(A?"1_":"0_");var s=v[x];s||(s=v[x]={vs:[],cs:[],ps:[],ds:[],T:y,B:z,clipboxMask:Y,reflectable:!!Z,W:h,batch:m,fog:A}),s.invalidate=!0;var f=s.vs,I=s.cs,p=s.ds,U=C[b._id]={index:p.length,begin:f.length/3,batch:x};p.push(b);var n,S=G.mat;W.geometry&&b instanceof H.Shape&&(L.extractShapeTranslation||L.extractPolylineTranslation||L.extractVerticesTranslation)&&(n=G._vsTranslation)&&S&&(S=(new xc.Matrix4).fromArray(S).multiply(n).toArray()),b instanceof H.Edge||!(!S||!W.geometry&&b instanceof H.Shape)||(S=ec(b,W.mat),b.appendAnchorMatrix3d(S)),V?(s.mat=Nd(S),s.clipDirection=V[0],s.clipPercent=V[1],kk(f,null,o)):kk(f,S,o);var q=U.size=f.length/3-U.begin;Lc(I,Jd(T,u),q)}}}(),Fg=function(W,t,k,Y,G,N,l,O,D){var F=W.getBrightness(t);F==f&&(F=1);var $=Jd($r(Y),F),A=$[3]<1;N=Math.ceil(N)||1;var C=(A?"T":"O")+N;if(l){var L=l[0],x=(l[1]||L)+L;C+="-"+L+"-"+x,D&&(C+="-"+si(D)+"-"+F,D=Jd($r(D),F))}var s=t.getRenderLayer(),H=W._40Q.get(s),o=H.polylineIndexMap,S=H.polylineModelMap,B=S[C];B||(B=S[C]={vs:[],cs:[],ps:[],ds:[],ls:l?[]:f,T:A,W:N},l&&(B.D=L,B.G=x,B.A=D)),B.invalidate=!0;var w,T=B.vs,e=B.cs,q=B.ds,Q=B.ls,h=o[t._id]={index:q.length,begin:T.length/3,batch:C};q.push(t),eq(T,k);var j,z=h.size=T.length/3-h.begin,b=k.length,i=0,r=[];if(l||G)for(w=0;b>w;w+=6)j=Mp([k[w],k[w+1],k[w+2]],[k[w+3],k[w+4],k[w+5]]),r.push(j),i+=j;if(i&&G){var X,v=Jd($r(G),F),M=[v[0]-$[0],v[1]-$[1],v[2]-$[2],v[3]-$[3]],m=0;for(w=0;b>w;w+=6)X=m/i,Lc(e,[$[0]+M[0]*X,$[1]+M[1]*X,$[2]+M[2]*X,$[3]+M[3]*X],1),m+=r[w/6],X=m/i,Lc(e,[$[0]+M[0]*X,$[1]+M[1]*X,$[2]+M[2]*X,$[3]+M[3]*X],1)}else Lc(e,$,z);if(l)for(m=O||0,w=0;b>w;w+=6)Q.push(m),m+=r[w/6],Q.push(m)},Jg=function(r,U,V){if(U){var P=V[U.batch],n=P.ps,O=P.ms&&P.ms.length,$=O?4*U.index:4*U.begin,R=O?1:U.size;if(n[$]!==r[0]||n[$+1]!==r[1]||n[$+2]!==r[2]||n[$+3]!==r[3]){for(var M=0;R>M;M++)n[$++]=r[0],n[$++]=r[1],n[$++]=r[2],n[$++]=r[3];n._invalidateThisFrame=!0}}},qp=function(){var O=new H.Math.Vector3,J=new H.Math.Vector3;return function(I,r){var C=r+["32"],b=I[r],A=I[C];if(b){if((L.extractBatchTranslation||L.extractVerticesTranslation)&&"vs"===r){J.set(0,0,0);for(var u=b.length,W=0;u>W;W+=3)J.add(O.fromArray(b,W));J.divideScalar(u/3);for(var y=J.x,$=J.y,q=J.z,Y=new Array(u),W=0;u>W;W+=3)Y[W]=b[W]-y,Y[W+1]=b[W+1]-$,Y[W+2]=b[W+2]-q;b=Y,I.translate=[y,$,q]}A&&A.length===b.length?(A.set(b),A._bufId=null):I[C]=new Qb(b)}else delete I[C]}}(),Mm=function(p,A,Z,J,s,R,k,S){var d=A instanceof H.Shape,n=R[0],y=R.length;if(y>1){n=Nd(n);for(var C=1;y>C;C++)Tq(n,n,R[C])}if(d){var X=A.p3();tf(n,X)}eq(k.ms,n);var w;if(k.ics&&(w=A.s("shape3d.color"))&&Lc(k.ics,w,1),!k.vs.length){var F=Nd(ss);d&&tf(F,eh(X)),Pj(p,A,Z,J,s,[F],k,S)}},Pj=function(d,W,K,H,Z,h,A,L){if(br(K))K.forEach(function(i){Pj(d,W,i,H,Z,h,A,L)});else if(Vn(K))Pj(d,W,Kq(H,K),H,Z,h,A,L);else if(Mr(K)){var N,B=kh(K.mat,W,d),y=kh(K.s3,W,d),U=kh(K.t3,W,d),s=kh(K.r3,W,d);if((y||s||U||B)&&(N=gs(B,y,s,kh(K.rotationMode,W,d),U),h.push(N)),K.shape3d)Pj(d,W,K.shape3d,H,Z,h,A,K);else{var e=H.s;L=L||Cq;var w=h[0],S=h.length,D=e("shape3d.color",K.color,L.color);if(Z||(Z=e("shape3d.blend",K.blend,L.blend)),S>1){w=Nd(w);for(var k=1;S>k;k++)Tq(w,w,h[k])}var v=w?_g(w):f;K.vs&&e(zk,K.visible,L.visible)&&Rk(w,A,K.vs,K.uv,K.is,K.ns,v,Z,D),K.top_vs&&e(Rd,K.topVisible,L.topVisible)&&Rk(w,A,K.top_vs,K.top_uv,K.top_is,K.top_ns,v,Z,e("shape3d.top.color",K.topColor,L.topColor)||D),K.bottom_vs&&e(Hk,K.bottomVisible,L.bottomVisible)&&Rk(w,A,K.bottom_vs,K.bottom_uv,K.bottom_is,K.bottom_ns,v,Z,e("shape3d.bottom.color",K.bottomColor,L.bottomColor)||D),K.from_vs&&e(mb,K.fromVisible,L.fromVisible)&&Rk(w,A,K.from_vs,K.from_uv,K.from_is,K.from_ns,v,Z,e("shape3d.from.color",K.fromColor,L.fromColor)||D),K.to_vs&&e(Tg,K.toVisible,L.toVisible)&&Rk(w,A,K.to_vs,K.to_uv,K.to_is,K.to_ns,v,Z,e("shape3d.to.color",K.toColor,L.toColor)||D)}N&&h.pop()}},Rk=function(x,v,e,d,g,h,i,t,P){var p,V=v.cs,c=v.uv,k=v.bs,K=v.ns,E=v.vs;if(h&&0!==h.length||(h=Bk(e,g)),g){p=g.length;for(var W=0;p>W;W++){var R=g[W],r=3*R;kk(E,x,[e[r],e[r+1],e[r+2]]),kk(K,i,[h[r],h[r+1],h[r+2]]),c&&eq(c,[d[2*R],d[2*R+1]])}}else p=e.length/3,kk(E,x,e),kk(K,i,h),c&&eq(c,d);V&&Lc(V,P,p),k&&(t?ap(k,t,p):eq(k,cf,p))},Hn=function(R,P,t){var m=R.data.p3();if(P=Nd(P),tf(P,m),eq(t.ms,P),!t.vs.length){var g=Nd(ss);tf(g,eh(m)),Sg(R,g,t)}},Sg=function(X,M,q){rs(X,re,M,q),rs(X,ln,M,q),rs(X,Bc,M,q),rs(X,qo,M,q),rs(X,Fc,M,q),rs(X,ab,M,q),rs(X,"csg",M,q)},df=function(H,A,d,u,C,q){eq(d.ms,C);var l;d.ics&&(l=A.s("all.color"))&&Lc(d.ics,l,1),d.vs.length||Ch(H,A,d,u,Nd(ss),q)},Ch=function(u,z,Y,M,I,B){Ao(u,z,Y,M,I,B,re,zc),Ao(u,z,Y,M,I,B,ln,yr),Ao(u,z,Y,M,I,B,Fc,zq),Ao(u,z,Y,M,I,B,ab,Rm),Ao(u,z,Y,M,I,B,Bc,Hg),Ao(u,z,Y,M,I,B,qo,$g)},hl=function(D,i,w,v,m){v?m.instanced?D.gv.batchInstancedModel(D.data,v,D,D.getBodyColor(),[i],w):Pj(D.gv,D.data,v,D,D.getBodyColor(),[i],w):m.instanced?D.gv.batchInstancedShapeFace(D,i,w):Sg(D,i,w)},rs=function(H,c,g,R){var w=H[c];if(w){var s=w.tuv;if(s){var j=w.uvScale,I=w.uvOffset,D=w.uvRotation,o=w.uvAnchor;if(j||I||D){var E,V,i,Y=zs(D,I,j,o),m=Y.a,X=Y.b,P=Y.c,G=Y.d,M=Y.tx,p=Y.ty,h=s.length;for(i=0;h>i;i+=2)E=s[i],V=s[i+1],s[i]=m*E+P*V+M,s[i+1]=X*E+G*V+p}}Rk(g,R,w.vs,s,f,f,g?_g(g):f,w.blend,w.color)}},Ao=function(l,K,W,N,X,Y,O,q){var S,M=W.cs,_=W.uv,T=W.bs,F=W.vs,D=W.ns,s=Bk(q);if(l.getFaceVisible(K,O)){var C=l.getFaceMat(K,O);if(C&&(X=ec(K,C),Y=_g(X)),kk(F,X,q),kk(D,Y,s),M&&Lc(M,l.getFaceColor(K,O),6),_){var P=l.getFaceUv(K,O)||N[O+"Uv"],t=l.getFaceUvScale(K,O)||N[O+"UvScale"],k=l.getFaceUvOffset(K,O)||N[O+"UvOffset"],g=l.getFaceUvRotation(K,O)||N[O+"UvRotation"],n=l.getFaceUvAnchor(K,O)||N[O+"UvAnchor"];P=P?[P[6],P[7],P[0],P[1],P[2],P[3],P[2],P[3],P[4],P[5],P[6],P[7]]:pq;var h=P[0],U=P[1],e=P[2],L=P[3],Q=P[4],p=P[5],b=P[6],c=P[7],E=P[8],w=P[9],R=P[10],v=P[11];if(t||k||g||n){var A=zs(g,k,t,n),m=A.a,u=A.b,z=A.c,d=A.d,G=A.tx,f=A.ty;h=m*h+z*U+G,U=u*h+d*U+f,e=m*e+z*L+G,L=u*e+d*L+f,Q=m*Q+z*p+G,p=u*Q+d*p+f,b=m*b+z*c+G,c=u*b+d*c+f,E=m*E+z*w+G,w=u*E+d*w+f,R=m*R+z*v+G,v=u*R+d*v+f}_.push(h,U,e,L,Q,p,b,c,E,w,R,v)}T&&(S=l.getBodyColor(K)||l.getFaceBlend(K,O),S?ap(T,S,6):eq(T,cf,6))}},ki=function(k,u,A,h){var A=k._picking?k.pickColorMap:null,x=k.getGL(),L=k._prg,P=k._buffer;if(!cc(u)){Qi(k,ss),mh(x);var b,i,m,S;for(var Q in u){var T,B,O,I,p=u[Q];if(p.batch){var z=k.getBatchInfo(p.batch)||Cq;T=z.wfBloom===E?z.bloom:z.wfBloom,B=z.wfReflectable===E?z.reflectable:z.wfReflectable,O=z.wfClipboxMask===E?z.clipboxMask:z.wfClipboxMask,I=z.width}else T=p.B,B=p.reflectable,O=p.clipboxMask,I=p.W;if(!(h&&!p.T||!h&&p.T||k.isReflecting(x)&&B===!1)){p.invalidate?(p.invalidate=!1,qp(p,"vs"),qp(p,"cs"),qp(p,"ls"),qp(p,"ps")):A&&p.ps&&p.ps._invalidateThisFrame&&(p.ps._invalidateThisFrame=!1,qp(p,"ps")),b=p.translate,i=p.clipDirection,b||i?(m=i?Nd(p.mat):[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],b&&tf(m,b),S=Nd(k._6O),Qi(k,m)):m=null;var R=p.vs32,o=A?p.ps32:p.cs32;gi(x,L,I,f,P.vs,R);var C=se.for(x),s=C.directUniforms(),V=C.directAttribs(),D=p.D,q=!k._dashDisabled&&D;s.uAlphaTest=W.alphaTest,x._blooming&&!T&&(s.blackout=!0),i&&(s.uClipPercent=p.clipPercent,s.uClipDirection=i),Nk(k,s,O===E?Sd:O),q&&(s.uDash=!0,s.uDashDistance=D,s.uDashGapDistance=p.G,s.uDiffuse=p.A||W["color.empty"],V.aLineDistance=Xi(x,P.lineDistance,p.ls32,f,1));var X=!k._batchColorDisabled;X&&o.length?(s.uBatchColor=!0,V.aBatchColor=Xi(x,P.batchColor,o,f,4)):(s.uBatchColor=!1,V.aBatchColor=!1);var K=p.fog!==!1;K||(s.uFog=!1),di(x),En(x,0,R.length/3,x.LINES),Ib(x),K||(s.uFog=!0),X&&(s.uBatchColor=!1,V.aBatchColor=!1),q&&(s.uDash=!1,V.aLineDistance=!1),x._blooming&&!T&&(s.blackout=!1),m&&(i&&(s.uClipDirection=0),ni(k,S))}}ug(x),ni(k)}},uq=function(z){z.invalidate=!1,qp(z,"vs"),qp(z,"ns"),qp(z,"cs"),qp(z,"rs"),qp(z,"ps"),qp(z,"bs"),qp(z,"uv"),qp(z,"ms"),qp(z,"ics")},Qh=function(M,p,x,w,N){var H,C,n,r,U,g,P,l,k,Q,v,u,t,x=M._picking?M.pickColorMap:null,F=M.getGL(),Z=M._prg,Y=se.for(F),i=Y.directUniforms(),O=Y.directAttribs(),L=M._buffer;if(!cc(p)&&!M.drawFilter){var _=M._flowObjects.length?M.flowMap:null;Qi(M,ss);for(C in p)if(n=M.getBatchInfo(C)||Cq,n.visible!==!1&&!(w&&!n.transparent||!w&&n.transparent||M.isReflecting(F)&&n.reflectable===!1)){var m=n.renderLayerMask;if(m==f&&(m=id),N==f&&(N=id),cd(N,m)&&(r=p[C],x||!n.transparentMask)){var V=w&&n.autoSort===!0&&(M._33Q||r.invalidate);r.invalidate?uq(r):x&&r.ps&&r.ps._invalidateThisFrame&&(r.ps._invalidateThisFrame=!1,qp(r,"ps"));var h=r.ms32,J=h&&h.length;if(g=r.vs32,P=x?r.ps32:J?r.ics32:r.cs32,Q=r.uv32,l=r.bs32,k=r.rs32,u=g.length/3,V){var $=ii(g,M.getEye(),M);$?(r.is=$.is,r.elementTypeUint=$.useUint32):(r.is=null,r.elementTypeUint=null)}if(u){t=r.translate,t&&Qi(M,[1,0,0,0,0,1,0,0,0,0,1,0,t[0],t[1],t[2],1]),U=n.light,v=M.getTexture(n.image),_d(F,Z,f,n.light,n.opacity,n.reverseFlip,n.reverseColor,n.reverseCull),H=n.polygonOffset,H&&il(F,H),P?M._batchColorDisabled?(i.uBatchColor=!1,O.aBatchColor=!1):(i.uBatchColor=!0,O.aBatchColor=J?hi(F,L.instancedBatchColor,P,f,4):Xi(F,L.batchColor,P,f,4)):(i.uBatchColor=!1,i.uDiffuse=n.color||W["color.empty"]);var B=n.alphaTest;i.uAlphaTest=B===E?W.alphaTest:B,i.shadowReceive=!x&&n.shadowReceive!==!1,Nk(M,i,n.clipboxMask===E?Sd:n.clipboxMask),Nf(M,i,n.lightMask===E?Sd:n.lightMask,n.headlightAmbientIntensity),_&&_.resetFlowUniform(n.effectFlowMask===E?Sd:n.effectFlowMask,i),F._blooming&&!n.bloom&&(i.blackout=!0),n.envmap!==E?(i.uUseEnvMap=!0,i.uReflectivity=n.envmap,i.roughness=n.roughness||0,M._setEnvmapByProbeId(i,n.envmapProbe||0)):(i.uUseEnvMap=!1,i.uReflectivity=0);var e=l&&!M._batchBlendDisabled;e&&(i.uBatchBlend=!0,O.aBatchBlend=Xi(F,L.batchBlend,l,f));var A=k&&!M._batchBrightnessDisabled;A&&(i.uBatchBrightness=!0,O.aBatchBrightness=Xi(F,L.batchBrightness,k,f,1)),Q?di(F,Z,v,n.discardSelectable,L.uv,Q,n.uvOffset,n.uvScale,n.uvRotation,n.uvAnchor):di(F),O.aPosition=Xi(F,L.vs,g,f),O.aNormal=Xi(F,L.ns,r.ns32,f),J&&(i.uUseInstance=!0,O.aMatrixInstanced=hi(F,L.ms,h,f)),r.is?(un(F,L.is,r.is),fe(F,0,u,null,r.elementTypeUint?F.UNSIGNED_INT:null,null,J?r.ms32.length/16:0)):En(F,0,u,null,J?r.ms32.length/16:0),Q?Ib(F,Z,v):Ib(F),P&&!M._batchColorDisabled&&(i.uBatchColor=!1,O.aBatchColor=!1),e&&(i.uBatchBlend=!1,O.aBatchBlend=!1),A&&(i.uBatchBrightness=!1,O.aBatchBrightness=!1),F._blooming&&!n.bloom&&(i.blackout=!1),J&&(i.uUseInstance=!1,O.aMatrixInstanced=E),H&&dr(F),Yd(F,Z),t&&ni(M)}}}ni(M)}},ii=function(G,U,E){var J=G.length/3,q=J>65535,d=E._glCapabilities.elementTypeUint&&q;if(!d&&q)return null;for(var n=new Array(J),c=J/3,z=new Array(c),W=0;c>W;W++)z[W]=W;z.sort(function($,d){var b=9*$,f=[(G[b]+G[b+3]+2*G[b+6])/4,(G[b+1]+G[b+4]+2*G[b+7])/4,(G[b+2]+G[b+5]+2*G[b+8])/4];b=9*d;var r=[(G[b]+G[b+3]+2*G[b+6])/4,(G[b+1]+G[b+4]+2*G[b+7])/4,(G[b+2]+G[b+5]+2*G[b+8])/4],h=Mp(U,f)-Mp(U,r);return h>0?-1:0>h?1:0});for(var W=0;c>W;W++){var F=3*W,T=3*z[W];n[F]=T,n[F+1]=T+1,n[F+2]=T+2}return{useUint32:d,is:d?new Uint32Array(n):new _q(n)}},Se={obj:function(g,E){var S={mat:g.mat,s3:g.s3,r3:g.r3,rotationMode:g.rotationMode,t3:g.t3,cube:g.cube==f?!0:g.cube,center:g.center==f?!0:g.center,ignoreMtls:g.ignoreMtls,ignoreTransparent:g.ignoreTransparent,ignoreColor:g.ignoreColor,ignoreImage:g.ignoreImage,ignoreNormal:g.ignoreNormal,prefix:g.prefix,flipY:g.flipY,flipFace:g.flipFace,reverseFlipMtls:g.reverseFlipMtls,finishFunc:function(i,O){if(i){var O=[];for(var B in i){var a=i[B];O.rawS3=a.rawS3,a.center&&(O.center=a.center),O.push(a),g.eachModel&&g.eachModel(B,a)}O.json=g,E(O)}else E()}};L.loadObj(g.obj,g.mtl,S)},bin:function(y,b){var $={finishFunc:function(r){r?b(r):b()}};L.loadBin(y.url,$)}};L.getModelTypeHandlers=function(){return Se},L.setModelTypeHandler=function(C,f){Se[C]=f},L.getModelTypeHandler=function(G){return Se[G]},L.handleModelLoaded=function(){},L.handleUnfoundModel=function(){};var Ae=f,Ii=f,Dl=function(j){Ae&&!j._loadingModelView_&&(Ii||(Ii={}),Ii[j._loadingModelView_=Vi()]=j)},Hj=function(b,S){Ae||(Ae={});var y=Ae[b];if(y){if(y.url===S)return;y.request.onload=vi,y.request.onerror=vi}if(S.indexOf(".bin")===S.length-4)return ro(b,{modelType:"bin",url:S},S);if(S=L.beforeLoadURL(S),S.data){var X=L.parse(S.data);ro(b,X,S)}else{var c=new yk;Ae[b]={request:c,url:S},c.onload=function(){if(200===this.status||0===this.status){delete Ae[b];var A=L.parse(c.getResponseText());ro(b,A,S)}else ag(b,L.handleUnfoundModel(b,S)||f)},c.onerror=function(){ag(b,L.handleUnfoundModel(b,S)||f)};var t={};t.url=encodeURI(S),t.sync=!1,c.send(t)}},ro=function(c,H,r){var U=H.modelType;if(!U)return ag(c,H),L.handleModelLoaded(c,H),void 0;var e=L.getModelTypeHandler(U);if(e){if(Ae||(Ae={}),Ae[c])return;Ae[c]=!0;var Y=function(I){I?(ag(c,I),L.handleModelLoaded(c,I)):ag(c,L.handleUnfoundModel(c,r,H)||f)};e(H,Y)}else ag(c,L.handleUnfoundModel(c,r,H)||f)},ag=function(I,Q){if(delete Ae[I],Vn(Q)&&nh.test(Q))return Hj(I,Q),void 0;if(Xo[I]=Q,cc(Ae)&&(Ae=f,Ii)){for(var _ in Ii){var O=Ii[_];O.invalidateAll&&O.invalidateAll(E,"modelLoaded",I),O.redraw&&O.redraw(),O.iv(),delete O._loadingModelView_}Ii=f}if(Q&&Ii)for(var _ in Ii){var O=Ii[_];O.invalidateAll&&O.invalidateAll(E,"modelLoading",I),O.redraw&&O.redraw(),O.iv()}},Yr=new Qb([0,0,0,1,1,1,1,0]),xb=new Qb([0,0,1,0,0,1,0,0,1,0,0,1]),Dc=new _q([0,1,2,2,3,0]),jd=new Qb([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Fl=new _q([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Tp=new Qb([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Eg=Bk(jd,Fl),ad=(new Qb([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new _q([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[re,Bc,ln,qo,Fc,ab]),pf=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],vs=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],xr=function(E,V,A,r,g,C,v){C=C||16,E=E||16,V=V||0,A=A||E;var H,W,R,q,b,u,p,t,x,d=.5,G=[],f=[],F=_/E,s=O/C;for(H=0;C>H;H++)for(u=H+1,q=H*s,x=u*s,W=V;A>W;W++)p=W+1,R=W*F,t=p*F,G.push(d*B(q)*J(R),d*J(q),-d*B(q)*B(R),d*B(x)*J(t),d*J(x),-d*B(x)*B(t),d*B(q)*J(t),d*J(q),-d*B(q)*B(t),d*B(q)*J(R),d*J(q),-d*B(q)*B(R),d*B(x)*J(R),d*J(x),-d*B(x)*B(R),d*B(x)*J(t),d*J(x),-d*B(x)*B(t)),f.push(W/E,H/C,p/E,u/C,p/E,H/C,W/E,H/C,W/E,u/C,p/E,u/C);if(v){var i=[];for(H=0,b=G.length;b>H;H+=3)i.push(2*G[H],2*G[H+1],2*G[H+2])}if(r){var S=[],D=[];for(R=V*F,H=0;C>H;H++)u=H+1,q=H*s,x=u*s,S.push(0,0,0,d*B(x)*J(R),d*J(x),-d*B(x)*B(R),d*B(q)*J(R),d*J(q),-d*B(q)*B(R)),D.push(0,.5,V/E,u/C,V/E,H/C)}if(g){var I=[],T=[];for(R=A*F,H=0;C>H;H++)u=H+1,q=H*s,x=u*s,I.push(0,0,0,d*B(q)*J(R),d*J(q),-d*B(q)*B(R),d*B(x)*J(R),d*J(x),-d*B(x)*B(R)),T.push(1,.5,A/E,H/C,A/E,u/C)}var n={vs:G,uv:f,from_vs:S,from_uv:D,to_vs:I,to_uv:T};return v&&(n.ns=i),n},jl=function(F,a,u){F=F||.17,a=a||12,u=u||18,0>F?F=0:F>.25&&(F=.25);var $,y,s,R,p,D,G,w=.5,A=[],X=[],W=[],x=_/u,t=_/a,q=w-F;for(y=0;a>=y;y++)for(R=-O+y*t,D=J(R),p=B(R),$=0;u>=$;$++)s=$*x,G=q+F*D,A.push(J(s)*G,p*F,-B(s)*G),X.push($/u,1-y/a);for(y=0;a>y;y++){var K=y*(u+1),H=(y+1)*(u+1);for($=0;u>$;$++)W.push(K+$,H+$+1,H+$,K+$,K+$+1,H+$+1)}return{vs:A,uv:X,is:W}},ob=function(U,P,W,h,t,g,A,u){A=A||12,U=U||18,P=P||0,W=W||U,g=g||.17,0>g?g=0:g>.25&&(g=.25);var v,R,l,K,I,k,z,b,r,o,Z=.5,p=[],w=[],V=_/U,c=_/A,L=Z-g,Y=u?[]:E;for(l=0;A>l;l++)for(K=l+1,z=-O+l*c,b=-O+K*c,v=P;W>v;v++)R=v+1,I=v*V,k=R*V,r=L+g*J(z),o=L+g*J(b),p.push(J(I)*r,B(z)*g,-B(I)*r,J(k)*r,B(z)*g,-B(k)*r,J(k)*o,B(b)*g,-B(k)*o,J(I)*r,B(z)*g,-B(I)*r,J(k)*o,B(b)*g,-B(k)*o,J(I)*o,B(b)*g,-B(I)*o),w.push(v/U,1-l/A,R/U,1-l/A,R/U,1-K/A,v/U,1-l/A,R/U,1-K/A,v/U,1-K/A),u&&Y.push(J(I)*J(z),B(z),-B(I)*J(z),J(k)*J(z),B(z),-B(k)*J(z),J(k)*J(b),B(b),-B(k)*J(b),J(I)*J(z),B(z),-B(I)*J(z),J(k)*J(b),B(b),-B(k)*J(b),J(I)*J(b),B(b),-B(I)*J(b));if(h){var H=[],n=[];for(l=0;A>l;l++)K=l+1,z=-O+l*c,b=-O+K*c,I=P*V,r=L+g*J(z),o=L+g*J(b),H.push(J(I)*r,B(z)*g,-B(I)*r,J(I)*o,B(b)*g,-B(I)*o,J(I)*L,0,-B(I)*L),n.push(.5+.5*J(z),.5-.5*B(z),.5+.5*J(b),.5-.5*B(b),.5,.5)}if(t){var y=[],X=[];for(l=0;A>l;l++)K=l+1,z=-O+l*c,b=-O+K*c,I=W*V,r=L+g*J(z),o=L+g*J(b),y.push(J(I)*r,B(z)*g,-B(I)*r,J(I)*L,0,-B(I)*L,J(I)*o,B(b)*g,-B(I)*o),X.push(.5-.5*J(z),.5-.5*B(z),.5,.5,.5-.5*J(b),.5-.5*B(b))}var q={vs:p,uv:w,from_vs:H,from_uv:n,to_vs:y,to_uv:X};return u&&(q.ns=Y),q},Ld=function(E,i){for(var v,t,Q,c,x,H=.5,R=16,b=[],A=[],K=[],p=[],L=_/R,M=0;R>=M;M++)v=M*L,t=J(v),c=t*H,Q=B(v),x=Q*H,b.push(c,-H,x,c,H,x),K.push(t,0,Q,t,0,Q),A.push(1-M/R,1,1-M/R,0);for(M=0;R>M;M++)p.push(2*M,2*M+1,2*M+3,2*M,2*M+3,2*M+2);if(i){var I=[],f=[],y=[];for(I.push(0,-H,0),f.push(.5,.5),M=0;R>=M;M++)v=M*L,t=J(v),Q=B(v),I.push(t*H,-H,-Q*H),f.push(.5+.5*t,.5+.5*Q);for(M=0;R>M;M++)y.push(0,M+2,M+1)}if(E){var z=[],j=[],N=[];for(z.push(0,H,0),j.push(.5,.5),M=0;R>=M;M++)v=M*L,t=J(v),Q=B(v),z.push(t*H,H,-Q*H),j.push(.5+.5*t,.5-.5*Q);for(M=0;R>M;M++)N.push(0,M+1,M+2)}return{vs:b,uv:A,is:p,ns:K,bottom_vs:I,bottom_uv:f,bottom_is:y,top_vs:z,top_uv:j,top_is:N}},Hl=function(w,H,v,T,q,p,Y,x){w=w||12,H=H||0,v=v||w;for(var y,h,D,u,C,k,r,P,S,F=.5,W=[],L=[],m=_/w,Q=H;v>Q;Q++)y=Q+1,h=Q*m,D=y*m,u=J(h)*F,C=B(h)*F,k=J(D)*F,r=B(D)*F,W.push(u,-F,-C,k,-F,-r,u,F,-C,k,-F,-r,k,F,-r,u,F,-C),L.push(Q/w,1,y/w,1,Q/w,0,y/w,1,y/w,0,Q/w,0);if(x){var j=[];for(Q=0,S=W.length;S>Q;Q+=3)j.push(2*W[Q],0,2*W[Q+2])}if(Y){var N=[],R=[];for(Q=H;v>Q;Q++)h=m*Q,D=m*(Q+1),u=J(h),C=B(h),k=J(D),r=B(D),N.push(u*F,-F,-C*F,0,-F,0,k*F,-F,-r*F),R.push(.5+.5*u,.5+.5*C,.5,.5,.5+.5*k,.5+.5*r)}if(p){var d=[],U=[];for(Q=H;v>Q;Q++)h=m*Q,D=m*(Q+1),u=J(h),C=B(h),k=J(D),r=B(D),d.push(u*F,F,-C*F,k*F,F,-r*F,0,F,0),U.push(.5+.5*u,.5-.5*C,.5+.5*k,.5-.5*r,.5,.5)}if(T){var i=[],b=[];h=m*H,u=J(h)*F,C=B(h)*F,P=H/w,i.push(0,F,0,0,-F,0,u,-F,-C,u,-F,-C,u,F,-C,0,F,0),b.push(0,0,0,1,P,1,P,1,P,0,0,0)}if(q){var g=[],$=[];h=m*v,u=J(h)*F,C=B(h)*F,P=v/w,g.push(0,-F,0,0,F,0,u,F,-C,u,F,-C,u,-F,-C,0,-F,0),$.push(1,1,1,0,P,0,P,0,P,1,1,1)}var s={vs:W,uv:L,bottom_vs:N,bottom_uv:R,top_vs:d,top_uv:U,from_vs:i,from_uv:b,to_vs:g,to_uv:$};return x&&(s.ns=j),s},bs=function(w,Z,e,S,z){Z=Z||18,e=e||0,S=S==f?_:S,z=z==f?.5:z;for(var K,L,G,j,y,V,d=[0,.5,.75,.875,.9375],u=[],F=[],o=[],I=S/Z,P=0;P<d.length;P++){var N=0===P%2?0:.5;for(K=0;Z>=K;K++)L=(K+N)*I+e,G=1-d[P],u.push(J(L)*z*G,-z+2*d[P]*z,-B(L)*z*G),F.push((K+N)/Z,G)}for(P=0;P<d.length-1;P++){var c=P*(Z+1),D=(P+1)*(Z+1);for(K=0;Z>K;K++)o.push(c+K,D+K+1,D+K,c+K,c+K+1,D+K+1)}for(V=u.length/3-(Z+1),K=0;Z>K;K++)u.push(0,z,0),F.push((K+.5)/Z,0);for(K=0;Z>K;K++)o.push(V+K,V+K+1,V+(Z+1)+K);if(w){var s=[],$=[],l=[];for(s.push(0,-z,0),$.push(.5,.5),K=0;Z>=K;K++)L=K*I+e,j=J(L),y=B(L),s.push(j*z,-z,-y*z),$.push(.5+.5*j,.5+.5*y);for(K=0;Z>K;K++)l.push(0,K+2,K+1)}return{vs:u,uv:F,is:o,bottom_vs:s,bottom_uv:$,bottom_is:l}},Ir=function(e,$,o,u,v,f,q,m){e=e||16,$=$||0,o=o||e,q=q||1;var C,t,K,T,y,F,i,n=.5,O=[],G=[],g=_/e,L=$,Q=1/q,t=new np,K=new np,D=new np,j=new np,A=new np,z=new np,d=new np;for(m&&(C=[],y=new np,F=new np,i=new np);o>L;L++){var r=L+1,H=g*L,E=g*r;for(t.set(J(H)*n,-n,-B(H)*n),K.set(J(E)*n,-n,-B(E)*n),D.set(0,n,0),m&&(y.set(J(H),.5,-B(H)).normalize(),F.set(J(E),.5,-B(E)).normalize(),i.copy(y).add(F).normalize()),j.lerpVectors(D,t,Q),A.lerpVectors(D,K,Q),O.push(j.x,j.y,j.z,A.x,A.y,A.z,D.x,D.y,D.z),G.push(L/e,Q,r/e,Q,(L+r)/2/e,0),m&&C.push(y.x,y.y,y.z,F.x,F.y,F.z,i.x,i.y,i.z),T=1;q>T;T++)j.lerpVectors(D,t,Q*(T+1)),A.lerpVectors(D,K,Q*(T+1)),z.lerpVectors(D,t,Q*T),d.lerpVectors(D,K,Q*T),O.push(j.x,j.y,j.z,A.x,A.y,A.z,z.x,z.y,z.z,z.x,z.y,z.z,A.x,A.y,A.z,d.x,d.y,d.z),G.push(L/e,Q*(T+1),r/e,Q*(T+1),L/e,Q*T,L/e,Q*T,r/e,Q*(T+1),r/e,Q*T),m&&C.push(y.x,y.y,y.z,F.x,F.y,F.z,y.x,y.y,y.z,y.x,y.y,y.z,F.x,F.y,F.z,F.x,F.y,F.z)}if(f){var Z=[],k=[];for(L=$;o>L;L++){H=g*L,E=g*(L+1);var s=J(H),X=B(H),V=J(E),p=B(E);Z.push(s*n,-n,-X*n,0,-n,0,V*n,-n,-p*n),k.push(.5+.5*s,.5+.5*X,.5,.5,.5+.5*V,.5+.5*p)}}if(u){var W=[],M=[];H=g*$,W.push(0,n,0,0,-n,0,J(H)*n,-n,-B(H)*n),M.push(0,0,0,1,$/e,1)}if(v){var l=[],Y=[];H=g*o,l.push(0,-n,0,0,n,0,J(H)*n,-n,-B(H)*n),Y.push(1,1,1,0,o/e,1)}var N={vs:O,uv:G,bottom_vs:Z,bottom_uv:k,from_vs:W,from_uv:M,to_vs:l,to_uv:Y};return m&&(N.ns=C),N},uc=function(n,A,r,$,b,z,y,u){for(var c=[],p=0;p<n.length-1;p+=2)c.push({x:n[p],y:n[p+1]});return Rg(c,A,r,$,b,z,y,u,!1)},ps={roundRect:function(S,o){return uc([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],S,o,3)},star:function(T,$){return uc([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],T,$)},rect:function(i,T){return uc([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],i,T)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(J,Q){return uc([0,-.5,.5,.5,-.5,.5],[1,2,2,5],J,Q)},rightTriangle:function(b,L){return uc([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],b,L)},parallelogram:function(N,t){return uc([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],N,t)},trapezoid:function(X,m){return uc([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],X,m)}},Vf={sphere:1,cylinder:1,cone:1,torus:1},Pl={torus:1,sphere:1,cone:1},Jk=Hi(ys(ps),{cylinder:1}),Bq=Hi(ys(ps),{cylinder:1,cone:1}),Pr=function(W,q,G){var z,i=kh(W.anchor3d,G,q),Z=kh(W.mat,G,q),U=kh(W.s3,G,q),s=kh(W.t3,G,q),J=kh(W.r3,G,q),S=U||J||s||Z;if(i||S){z=Nd(q._6O);var n=S?gs(Z,U,J,kh(W.rotationMode,G,q),s):ue();i&&tf(n,[.5-i[0],.5-i[1],.5-i[2]]),Qi(q,n)}return z},$j=function(i,b,c,e,z,v,d){if(br(c))c.forEach(function(S){$j(i,b,S,e,z,v,d)});else if(Vn(c))$j(i,b,Kq(e,c),e,z,v,d);else if(Mr(c))if(c.shape3d){var F=Pr(c,i,b);$j(i,b,c.shape3d,e,z,v,c),F&&ni(i,F)}else _k(i,b,c,e.s,z,v,d)},_k=function($,T,x,M,X,k,Q){if(Q=Q||Cq,!k||k(M("shape3d.transparent",x.transparent,Q.transparent))){var S=Pr(x,$,T);if(Ac(x)){var L=$.getData3dUI(T);L.dispatchBoundingBoxChanged()}var a=$._26I,U=$._prg,V=$._buffer,J=M("shape3d.color",x.color,Q.color);X||(X=M("shape3d.blend",x.blend,Q.blend));var r,O=x.opacity==f?Q.opacity:x.opacity,g=M("shape3d.opacity");r=g!=f&&O!=f?O*g:O!=f?O:g,_d(a,U,X,M("shape3d.light",x.light,Q.light),r,M("shape3d.reverse.flip",x.reverseFlip,Q.reverseFlip),M("shape3d.reverse.color",x.reverseColor,Q.reverseColor),M("shape3d.reverse.cull",x.reverseCull,Q.reverseCull));var G=M("polygonOffset",x.polygonOffset,Q.polygonOffset);x.vs&&M(zk,x.visible,Q.visible)&&Lg(a,U,V,J,$.getTexture(M("shape3d.image",x.image,Q.image),T),M("shape3d.discard.selectable",x.discardSelectable,Q.discardSelectable),x.vs,x.uv,x.ns,x.is,M("shape3d.uv.offset",x.uvOffset,Q.uvOffset),M("shape3d.uv.scale",x.uvScale,Q.uvScale),M("shape3d.uv.rotation",x.uvRotation,Q.uvRotation),M("shape3d.uv.anchor",x.uvAnchor,Q.uvAnchor),G),x.top_vs&&M(Rd,x.topVisible,Q.topVisible)&&Lg(a,U,V,M("shape3d.top.color",x.topColor,Q.topColor)||J,$.getTexture(M("shape3d.top.image",x.topImage,Q.topImage),T,"top"),M("shape3d.top.discard.selectable",x.topDiscardSelectable,Q.topDiscardSelectable),x.top_vs,x.top_uv,x.top_ns,x.top_is,M("shape3d.top.uv.offset",x.topUvOffset,Q.topUvOffset),M("shape3d.top.uv.scale",x.topUvScale,Q.topUvScale),M("shape3d.top.uv.rotation",x.topUvRotation,Q.topUvRotation),M("shape3d.top.uv.anchor",x.topUvAnchor,Q.topUvAnchor),G),x.bottom_vs&&M(Hk,x.bottomVisible,Q.bottomVisible)&&Lg(a,U,V,M("shape3d.bottom.color",x.bottomColor,Q.bottomColor)||J,$.getTexture(M("shape3d.bottom.image",x.bottomImage,Q.bottomImage),T,"bottom"),M("shape3d.bottom.discard.selectable",x.bottomDiscardSelectable,Q.bottomDiscardSelectable),x.bottom_vs,x.bottom_uv,x.bottom_ns,x.bottom_is,M("shape3d.bottom.uv.offset",x.bottomUvOffset,Q.bottomUvOffset),M("shape3d.bottom.uv.scale",x.bottomUvScale,Q.bottomUvScale),M("shape3d.bottom.uv.rotation",x.bottomUvRotation,Q.bottomUvRotation),M("shape3d.bottom.uv.anchor",x.bottomUvAnchor,Q.bottomUvAnchor),G),x.from_vs&&M(mb,x.fromVisible,Q.fromVisible)&&Lg(a,U,V,M("shape3d.from.color",x.fromColor,Q.fromColor)||J,$.getTexture(M("shape3d.from.image",x.fromImage,Q.fromImage),T,"from"),M("shape3d.from.discard.selectable",x.fromDiscardSelectable,Q.fromDiscardSelectable),x.from_vs,x.from_uv,x.from_ns,x.from_is,M("shape3d.from.uv.offset",x.fromUvOffset,Q.fromUvOffset),M("shape3d.from.uv.scale",x.fromUvScale,Q.fromUvScale),M("shape3d.from.uv.rotation",x.fromUvRotation,Q.fromUvRotation),M("shape3d.from.uv.anchor",x.fromUvAnchor,Q.fromUvAnchor),G),x.to_vs&&M(Tg,x.toVisible,Q.toVisible)&&Lg(a,U,V,M("shape3d.to.color",x.toColor,Q.toColor)||J,$.getTexture(M("shape3d.to.image",x.toImage,Q.toImage),T,"to"),M("shape3d.to.discard.selectable",x.toDiscardSelectable,Q.toDiscardSelectable),x.to_vs,x.to_uv,x.to_ns,x.to_is,M("shape3d.to.uv.offset",x.toUvOffset,Q.toUvOffset),M("shape3d.to.uv.scale",x.toUvScale,Q.toUvScale),M("shape3d.to.uv.rotation",x.toUvRotation,Q.toUvRotation),M("shape3d.to.uv.anchor",x.toUvAnchor,Q.toUvAnchor),G),Yd(a,U),S&&ni($,S)}},Lg=function(D,c,L,I,F,g,r,C,j,y,u,N,$,G,m){if(r){m&&il(D,m);var B=se.for(D),h=B.directUniforms(),z=B.directAttribs();h.uDiffuse=I||W["color.empty"],C?di(D,c,F,g,L.uv,C,u,N,$,G):di(D),z.aPosition=Xi(D,L.vs,r,f),z.aNormal=Xi(D,L.ns,j,f),y?(Wh(D,L.is,y),fe(D,0,y.length,null,y instanceof Uint32Array?D.UNSIGNED_INT:null)):En(D,0,r.length/3),C?Ib(D,c,F):Ib(D),m&&dr(D)}},Kq=function(b,j){var O=b.s;if(j||(j=O(bc)),!j)return f;var G=Cb(j);if(G)return G;if("text"===j){var x={amount:O("shape3d.text.amount"),size:O("shape3d.text.size"),font:O("shape3d.text.font"),style:O("shape3d.text.style"),weight:O("shape3d.text.weight"),fill:O("shape3d.text.fill"),curveSegments:O("shape3d.text.curveSegments"),spacing:O("shape3d.text.spacing"),cube:O("shape3d.text.cube")},v=b.gv.getShape3dText(b.data),R=v;for(var i in x)R+="_"+(x[i]===E?"U":x[i]);return b._cachedTextKey===R?b._cachedTextGeometry:(b._cachedTextKey=R,b._cachedTextGeometry=L.createTextGeometry(v,x))}var i=j;if(Vf[j]){var y=O("shape3d.side"),w=O("shape3d.side.from"),m=O("shape3d.side.to"),e=O(mb),B=O(Tg);3>y?(y=0,w=0,m=0,e=!1,B=!1):((w==f||0>w)&&(w=0),(m==f||m>y)&&(m=y),0===w&&m===y&&(e=!1,B=!1));var n=O("shape3d.smooth");i+="-"+y+"-"+w+"-"+m+"-"+e+"-"+B+(n?1:0)}if(Jk[j]){var V=O(Rd);i+="-"+V}if(Bq[j]){var c=O(Hk);i+="-"+c}if("torus"===j){var l=O("shape3d.torus.radius");0>l?l=0:l>.25&&(l=.25),i+="-"+l}if(Pl[j]){var U=O(cq);i+="-"+U}return G=ld[i],G||("box"===j?G=L.createBoxModel():ps[j]?G=ps[j](V,c):"sphere"===j?G=L.createSphereModel(y,w,m,e,B,U,n):j===Fn?G=L.createCylinderModel(y,w,m,e,B,V,c,n):"cone"===j?G=L.createConeModel(y,w,m,e,B,c,U,n):"torus"===j&&(G=L.createTorusModel(y,w,m,e,B,l,U,n)),ld[i]=G),G},Ac=function(){var U=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],$=["is","top_is","bottom_is","from_is","to_is"];return n=Ih(gp.substr(gp.indexOf("^#")+2)),$p(L[Ql(lh+U[15]+"n"+U[16])]())&&ng()?function(m){return m&&!m._complete_?(m._complete_=!0,m.vs&&jj(m.ns)&&(m.ns=Bk(m.vs,m.is),m.boundingBox=E),m.top_vs&&jj(m.top_ns)&&(m.top_ns=Bk(m.top_vs,m.top_is),m.top_boundingBox=E),m.bottom_vs&&jj(m.bottom_ns)&&(m.bottom_ns=Bk(m.bottom_vs,m.bottom_is),m.bottom_boundingBox=E),m.from_vs&&jj(m.from_ns)&&(m.from_ns=Bk(m.from_vs,m.from_is),m.from_boundingBox=E),m.to_vs&&jj(m.to_ns)&&(m.to_ns=Bk(m.to_vs,m.to_is),m.to_boundingBox=E),U.forEach(function(P){var H=m[P];br(H)&&(m[P]=new Qb(H))}),$.forEach(function(L){var T=m[L];br(T)&&(m[L]=new _q(T))}),!0):!1}:void 0}(),wd=function(H,R){var f=H[R];br(f)&&(H[R]=new Qb(f))};Hi(ti,{_25Q:function(x){var J=new np;x._16O=function(q,C,i,O,I,r,z,G,F){var b=this.info;if(b){var W,K,B,h,Z,E,$=ue();rf[C]?(W=b.p3,K=b.c1,B=b.c2):Mk[C]?(K=b.s1||b.c1,B=b.s2||b.c2):(K=b.t1||b.c1,B=b.t2||b.c2);var o=this.data;if(o instanceof Ab&&this.shapeModel){var s=o.getPointsMatrix3d();W&&(W=J.copy(W).applyMatrix4(s).toArray()),K&&(K=J.copy(K).applyMatrix4(s).toArray()),B&&(B=J.copy(B).applyMatrix4(s).toArray())}var D=0;if(K&&B){var U=ch(B,K);D=Mp(K,B),h=[0,-ts(U[2],U[0]),e(U[1]/D)],Z="zyx",W||(W=[(K[0]+B[0])/2,(K[1]+B[1])/2,(K[2]+B[2])/2])}return E=oq(C,[D,0,0],i,O,G,F),Ah($,E,W,O,I,r,z,q,h,Z)}return ql},x._80o=function(g,A,D){var j=this,l=j.shapeModel;if(l){var C=j.gv;Qi(C),$j(C,j.data,l,j,j.getBodyColor(),D)}},x.createLineModel=function(u,F,r,_,k){var j=this,l=j.s,K=lf(u,F,l(cq)),V=l(_+".color");
if(V){for(var m=[],M=0;M<K.length;M++){var X=K[M],G=X.length;if(G>1){var h=X[0];m.push(h.x,h.y,h.z);for(var s=1;G-1>s;s++)h=X[s],m.push(h.x,h.y,h.z),m.push(h.x,h.y,h.z);h=X[G-1],m.push(h.x,h.y,h.z)}}var i,R,w,x=l(k),L=0;x&&(R=l(k+".color"),i=l(k+".pattern"),L=l(k+".offset"),w=V),Fg(j.gv,j.data,m,R||V,w?f:l(_+".gradient.color"),r,i||l(_+".pattern"),L,w)}return K},x.createTubeModel=function(T,y,O,Q){for(var c=this,A=c.s,o=A("shape3d.side")||bp,k=A("shape3d.start.angle"),e=A("shape3d.sweep.angle"),J=A(Rd)?A("shape3d.top.cap"):f,L=A(Hk)?A("shape3d.bottom.cap"):f,z=A("3d.clip.direction"),Z="flat"===J,C="flat"===L,m=Z&&(Q?Q.uv:A("shape3d.top.image")),K=C&&(Q?Q.uv:A("shape3d.bottom.image")),t=Q?Q.uv:A("shape3d.image")||"uv.left"===z||"uv.right"===z,S=A("shape3d.smooth"),Y={vs:[],uv:t?[]:f,ns:S?[]:f,top_vs:Z?[]:f,top_uv:m?[]:f,bottom_vs:C?[]:f,bottom_uv:K?[]:f},x=lf(T,y,A(cq),O),l=0,H=x.length,p=0,P=A("shape3d.uv.union");H>l;l++)P!==!0&&(p=0),p=ge(Y,x[l],A(lg),O,o,k,e,J,L,p);if(Q){var r=c._matWithExtraction||c.mat;Pj(c.gv,c.data,Y,c,c.getBodyColor(),r?[r]:[],Q)}else c.shapeModel=Y;c.lineShapeModel=Y;var v=c._vsTranslation;if(v)for(var l=0,R=x.length;R>l;l++)for(var I=0,i=x[l].length;i>I;I++)x[l][I]=x[l][I].clone().applyMatrix4(v);return x},x.getCache=function(){var z=this.info;if(z){var D=z.list;if(D){var g=z.cache;return g||(g=z.cache=Rf(D)),g}}return f}}});var Gd=function(k,A){for(var Z,w=0,m=k.length,z=0,O=m-1;O>=z;)if(w=j(z+(O-z)/2),Z=k[w].length-A,0>Z)z=w+1;else{if(!(Z>0)){O=w;break}O=w-1}w=O;var h=k[w],B=h.point;return w===m-1||h.length===A||(B=(new Fb).subVectors(k[w+1].point,B).normalize().multiplyScalar(A-h.length).add(B)),{point:B,tangent:h.tangent}},Rf=function(I){for(var c,n,z=[],R=0,g=0;g<I.length;g++){for(var E=I[g],o=0;o<E.length;o++){c=E[o],n&&(R+=n.distanceTo(c));var S=new Fb,m=E[o+1];m?S.subVectors(m,c):n?S.subVectors(c,n):S.x=1,S.normalize(),z.push({point:c,length:R,tangent:S}),n=c}n=null}return z},lf=function(R,g,l,y){l=l||wo;for(var W=[],H=0,T=R.size();T>H;H++){var J=R.get(H);W.push(new Fb(J.x,J.e||0,J.y))}g&&(Zc(g)&&(g=g._as),g.length||(g=null));for(var p,O,q,e,z,E=[],G=[],s=0,A=0,c=g?g.length:T;c>A;A++){if(z=g?g[A]:0===A?1:2,1===z)E.push(q=[]),q.push(W[s++]);else if(2===z||5===z)if(e=2===z?W[s++]:q[0],y){var M=g?g[A+1]:c>A+1?2:f;if(2===M||5===M){var C=q[q.length-1],v=2===M?W[s]:q[0],B=(new Fb).subVectors(C,e),P=(new Fb).subVectors(v,e),L=B.length(),k=P.length();if(L&&k)if(y>L/2&&y>k/2)q.push(e);else for(B.multiplyScalar(h(y,L/2)/L).add(e),P.multiplyScalar(h(y,k/2)/k).add(e),p=new Gj(B,e,P).getPoints(l),O=0;l>=O;O++)q.push(p[O])}else q.push(e)}else q.push(e);else if(3===z)for(p=new Gj(q[q.length-1],W[s++],W[s++]).getPoints(l),O=1;l>=O;O++)q.push(p[O]);else if(4===z)for(p=new Sn(q[q.length-1],W[s++],W[s++],W[s++]).getPoints(l),O=1;l>=O;O++)q.push(p[O]);G.push(E.length,q.length)}return E.indexMark=G,E},sp=function(K){for(var F,E,N=new Fb,i=[],m=[],H=[],g=0,L=K.length;L>g;g++)F=K[g],E=K[g+1],E?N.subVectors(E,F):N.subVectors(F,K[g-1]),i.push(N.normalize().clone());var q,J=new Fb,d=new Fb,X=new jf,O=1e-4,S=i[0],r=m[0]=new Fb,u=H[0]=new Fb;for(Math.abs(Math.abs(S.y)-1)<O?J.set(1,0,0):J.set(0,1,0),d.crossVectors(S,J).normalize(),r.crossVectors(S,d),u.crossVectors(S,r),g=1;L>g;g++)m[g]=m[g-1].clone(),H[g]=H[g-1].clone(),d.crossVectors(i[g-1],i[g]),d.length()>O&&(d.normalize(),q=Z(Ve(i[g-1].dot(i[g]),-1,1)),m[g].applyMatrix4(X.makeRotationAxis(d,q))),H[g].crossVectors(i[g],m[g]);return{B:H,T:i,N:m}},ge=function(){var x=function(Q){for(var W=1;W<arguments.length;W++){var I=arguments[W];Q.push(I.x,I.y,I.z)}},A=function(A){for(var M=1;M<arguments.length;M++){var i=arguments[M].uv;A.push(i[0],i[1])}},M=function(j){for(var n=1;n<arguments.length;n++){var X=arguments[n].ns;j.push(X[0],X[1],X[2])}},l=function(O,E,j,Y,f){var x=-Y*J(f),q=Y*B(f);return new Fb(O.x+x*j.x+q*E.x,O.y+x*j.y+q*E.y,O.z+x*j.z+q*E.z)},D=function(U,m,L,S,X,Y,a,P,O){a=a||_;for(var h,F=[],W=a/X,h=O?new np:f,H=0;X>=H;H++){var $=l(U,m,L,S,H*W+Y);F.push($),P!=f&&($.uv=[P,1-H/X]),O&&($.ns=h.subVectors($,U).normalize().toArray())}return F},p=function(b,r,o,O,j,v,c,N,Z){Z=Z||_;var G=r?b.top_vs:b.bottom_vs;if(G)for(var y=r?b.top_uv:b.bottom_uv,k=Z/c,U=0;c>U;U++){var M,F;r?(M=U*k+N,F=(U+1)*k+N):(F=U*k+N,M=(U+1)*k+N),x(G,l(o,O,j,v,M),l(o,O,j,v,F),o),y&&y.push(.5-.5*J(M),.5-.5*B(M),.5-.5*J(F),.5-.5*B(F),.5,.5)}};return function(h,Z,_,L,a,R,v,k,O,X){var b=Z.length;if(b>1){var d,K,Y,n,t,w,g,u=sp(Z),W=u.T,T=u.N,$=u.B;"flat"===k&&p(h,!0,Z[0],$[0],T[0],L,a,R,v),"flat"===O&&p(h,!1,Z[b-1],$[b-1],T[b-1],L,a,R,v);var F,J,i=[],C=q(a/2),c="round"===k,j="round"===O,s=Z[0],H=W[0],l=$[0],z=T[0],r=Z[b-1],I=W[b-1],e=$[b-1],Q=T[b-1];if(c){for(Y=1;C>=Y;Y++)T.splice(0,0,z),$.splice(0,0,l),W.splice(0,0,H),J=-Y/C*L,Z.splice(0,0,H.clone().multiplyScalar(J).add(s)),i[C-Y]=G(L*L-J*J);b+=C}if(j){for(Y=1;C>=Y;Y++)T.push(Q),$.push(e),W.push(I),J=Y/C*L,Z.push(I.clone().multiplyScalar(J).add(r)),i[Z.length-1]=G(L*L-J*J);b+=C}if(h.uv){var S=0,U=X,y=[];for(_&&(S=_),t=Z[0],y[0]=0,Y=1;b>Y;Y++)n=Z[Y],y[Y]=t.distanceTo(n),t=n,_||(S+=y[Y]);for(F=[],Y=0;b>Y;Y++)U+=y[Y],F[Y]=S?U/S:0;X=U}var V=h.ns?!0:!1;for(Y=0;b>Y;Y++){if(n=Z[Y],w=$[Y],g=T[Y],d=D(n,w,g,i[Y]===E?L:i[Y],a,R,v,F?F[Y]:f,V),K)for(var o=0;a>o;o++){var N=K[o],B=K[o+1]||K[0],m=d[o],P=d[o+1]||d[0];x(h.vs,B,N,m,m,P,B),h.uv&&A(h.uv,B,N,m,m,P,B),V&&M(h.ns,B,N,m,m,P,B)}K=d}}return X}}();Hi(L,{getLineLength:function(R){return R[R.length-1].length},getLineOffset:function(B,E){return Gd(B,E)},getLineCacheInfo:function(_,W,N,B){return Rf(lf(_,W,N,B))}});var Ti=H.graph3d.RenderLite={},hf=new Array(0),Wl=Ti.Buffer=function(J,E,p,M){this.gl=J,this.buffer=J.createBuffer(),this.type=E||J.ARRAY_BUFFER,this.drawType=M||J.STATIC_DRAW,this.data=hf,p&&this.upload(p)};Wl.prototype.upload=function(N,U,b){b||this.bind();var n=this.gl;N=N||this.data,U=U||0,this.data.byteLength>=N.byteLength?n.bufferSubData(this.type,U,N):n.bufferData(this.type,N,this.drawType),this.data=N},Wl.prototype.bind=function(){var t=this.gl;t.bindBuffer(this.type,this.buffer)},Wl.createVertexBuffer=function(z,x,U){return new Wl(z,z.ARRAY_BUFFER,x,U)},Wl.createIndexBuffer=function(c,K,L){return new Wl(c,c.ELEMENT_ARRAY_BUFFER,K,L)},Wl.create=function(D,Z,L,w){return new Wl(D,Z,w)},Wl.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var pr=Ti.Shader=function(u,A,Y){this.gl=u,this.program=lo(u,A,Y),this.attributes=pi(u,this.program);var Z=Pg(u,this.program);this.uniforms=Zi(u,Z)};pr.prototype.bind=function(){this.gl.useProgram(this.program)},pr.prototype.destroy=function(){this.gl};var lo=function(s,k,v){var O=Hp(s,s.VERTEX_SHADER,k),f=Hp(s,s.FRAGMENT_SHADER,v),c=s.createProgram();return s.attachShader(c,O),s.attachShader(c,f),s.linkProgram(c),s.getProgramParameter(c,s.LINK_STATUS)||(Lh("LINK","LITE",s.getProgramParameter(c,s.VALIDATE_STATUS),s.getError(),s.getProgramInfoLog(c)),s.deleteProgram(c),c=null),s.deleteShader(O),s.deleteShader(f),c},Hp=function(i,p,_){var X=i.createShader(p);return i.shaderSource(X,_),i.compileShader(X),i.getShaderParameter(X,i.COMPILE_STATUS)?X:(Lh("COMPILE","LITE",p,i.getError(),i.getShaderInfoLog(X)),null)},Pg=function(M,F){for(var J={},i=M.getProgramParameter(F,M.ACTIVE_UNIFORMS),S=0;i>S;S++){var K=M.getActiveUniform(F,S),V=K.name.replace(/\[.*?\]/,""),P=Qe(M,K.type);J[V]={type:P,size:K.size,location:M.getUniformLocation(F,V),value:Xr(P,K.size)}}return J},pi=function(f,H){for(var g={},B=f.getProgramParameter(H,f.ACTIVE_ATTRIBUTES),I=0;B>I;I++){var t=f.getActiveAttrib(H,I),C=Qe(f,t.type);g[t.name]={type:C,size:Uj(C),gl:f,location:f.getAttribLocation(H,t.name),pointer:Xj}}return g},Xj=function(o,O,R,Z,h){var H=this.gl;H.enableVertexAttribArray(this.location),o instanceof Ti.Buffer||(o=Ti.Buffer.createVertexBuffer(H,o)),H.bindBuffer(o.type,o.buffer),H.vertexAttribPointer(this.location,this.size,O||H.FLOAT,R||!1,Z||0,h||0)},Uj=function(o){return rh[o]},rh={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},Qe=function(V,B){if(!as){var w=b.keys(Jp);as={};for(var M=0;M<w.length;++M){var W=w[M];as[V[W]]=Jp[W]}}return as[B]},as=null,Jp={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Xr=function(Q,b){switch(Q){case"float":return 0;case"vec2":return new Float32Array(2*b);case"vec3":return new Float32Array(3*b);case"vec4":return new Float32Array(4*b);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*b);case"ivec3":return new Int32Array(3*b);case"ivec4":return new Int32Array(4*b);case"bool":return!1;case"bvec2":return rc(2*b);case"bvec3":return rc(3*b);case"bvec4":return rc(4*b);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},rc=function(m){for(var n=new Array(m),Q=0;Q<n.length;Q++)n[Q]=!1;return n},Zi=function(v,z){var k={data:{}};k.gl=v;for(var r=b.keys(z),T=0;T<r.length;T++){var f=r[T],E=f.split("."),_=E[E.length-1],y=Xm(E,k),c=z[f];y.data[_]=c,y.gl=v,b.defineProperty(y,_,{get:Kb(_),set:Br(_,c)})}return k},Kb=function(i){var p=Ol.replace("%%",i);return new Function(p)},Br=function($,F){var L,x=Vr.replace(/%%/g,$);return L=1===F.size?Lq[F.type]:bq[F.type],L&&(x+="\nthis.gl."+L+";"),new Function("value",x)},Xm=function(n,g){for(var a=g,N=0;N<n.length-1;N++){var h=a[n[N]]||{data:{}};a[n[N]]=h,a=h}return a},Ol=["return this.data.%%.value;"].join("\n"),Vr=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Lq={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},bq={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},As=function(w){function J(n){if("string"!=typeof n)return 0|n;switch(n){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}function C(){P.enable=!L.graph3dViewShadowDisabled,x=L.graph3dViewShadowType,p=L.graph3dViewShadowIntensity,U=L.graph3dViewShadowBias,V=L.graph3dViewShadowQuality,B=L.graph3dViewShadowRadius,M=L.graph3dViewShadowDegreeX,q=L.graph3dViewShadowDegreeZ}var P=this;P.enable=!1;var x,p,U,V,B,M,q;C();var b,F,s,d,N=1,I=J(V),R=!1,c=new H.Math.Matrix4,a=new H.Math.Matrix4,O=P.pvMatrix=new H.Math.Matrix4,n=0;P.contextLost=function(){P.mapForReflector=null,P.map=null;var e=w.getGL();e&&(e._shadowShader=null)},P.render=function(){if(!w._picking&&P.enable){var e=w.getGL();if(e){if(R&&P.setupShadowCamera(),w._glCapabilities&&(I=Math.min(I,w._glCapabilities.maxTextureSize)),d=w.isReflecting(e)){if(n===e._renderInfo.frame)return;n=e._renderInfo.frame}var Z=d?"mapForReflector":"map";if((b=P[Z])?b.setSize(I,I):b=P[Z]=new Ms(w,w.getGL(),0,0,{samples:1,minFilter:os.NEAREST,magFilter:os.NEAREST,width:I,height:I}),!e._shadowShader){var N="#define MAX_BOX_CLIPPER "+w._boxClippers.length;e._shadowShader=new Ti.Shader(e,As.shaderSrc.vs.replace("$DEFINE",N),As.shaderSrc.fs.replace("$DEFINE",N))}var k=w._frameState,V=k.renderState.glState;V.blend.enabled=!1,V.depth.enabled=!0,V.depth.mask=!0;var f=V.color.clear.slice(0);Ej(e,[1,1,1,1]),k.renderState.useProgram(e._shadowShader.program),y(),Ej(e,f)}}},P.deleteShadowProgram=function(){var h=w.getGL();h&&h._shadowShader&&(h.deleteProgram(h._shadowShader.program),h._shadowShader=null)},P.getShadow=function(){var d={degreeX:M,degreeZ:q,intensity:p,quality:V,type:x,radius:B,bias:U};return 1!==N&&(d.boundExtend=N),d},P.setShadow=function(g,i){g=!!g;var c=P.enable!==g;P.enable=g,"object"==typeof i&&(i.intensity!==E&&(p=i.intensity),i.bias!==E&&(U=i.bias),i.radius!==E&&(B=i.radius),i.degreeX!==E&&(M=i.degreeX),i.degreeZ!==E&&(q=i.degreeZ),i.quality!==E&&(V=i.quality),i.type!==E&&x!==i.type&&(x=i.type,c=!0),I=J(V),i.boundExtend!==E&&(N=i.boundExtend)),g&&P.setupShadowCamera(),c&&nc(w),w.iv()};var t=null;P.tryInvalidateLater=function(L,W){"modelLoaded"===W&&(t&&zo(t,!0),t=Un(function(){t=null,P.refresh()},P,E,200))},P.refresh=function(){this.enable&&(this.setupShadowCamera(),w.iv())},P.tryUpdateBounding=function(p){var J=this.boundingSphere;if(J){var F=(new jf).fromArray(ec(p,w.getMat(p))),l=p.getAnchor3d(),U=new np;J.containsPoint(U.set(0-l.x,0-l.y,0-l.z).applyMatrix4(F))&&J.containsPoint(U.set(0-l.x,0-l.y,1-l.z).applyMatrix4(F))&&J.containsPoint(U.set(0-l.x,1-l.y,0-l.z).applyMatrix4(F))&&J.containsPoint(U.set(0-l.x,1-l.y,1-l.z).applyMatrix4(F))&&J.containsPoint(U.set(1-l.x,0-l.y,0-l.z).applyMatrix4(F))&&J.containsPoint(U.set(1-l.x,0-l.y,1-l.z).applyMatrix4(F))&&J.containsPoint(U.set(1-l.x,1-l.y,0-l.z).applyMatrix4(F))&&J.containsPoint(U.set(1-l.x,1-l.y,1-l.z).applyMatrix4(F))||P.setupShadowCamera()}},P.createShadow=function(l){if(l||(l=w._frameState.renderState.directUniforms()),l.shadowMatrix=O.toArray(),w._getFrameRenderOptions("renderShadow")===!1){var D,j=w.getGL();(D=j._emptyShadowTexture)||(D=j._emptyShadowTexture=Ur(j,null,[255,255,255,255])),l.shadowMap=D}else{var x=w._getFrameRenderOptions("useReflectorSelfShadowMap")&&P.mapForReflector;l.shadowMap=x?P.mapForReflector.texture:P.map.texture}l.shadowSize=[b.width,b.height],l.shadowIntensity=p,l.shadowBias=U,l.shadowRadius=B},P.genShaderDefine=function(){var E="#define USE_SHADOWMAP\n";return"hard"===x?E+="#define SHADOWMAP_TYPE_PCF\n":"soft"===x&&(E+=w.isGLTempRegisterLimited()?"#define SHADOWMAP_TYPE_PCF\n":"#define SHADOWMAP_TYPE_PCF_SOFT\n"),E};var v;P.setupShadowCamera=function(){F||(F=P.boundingSphere=new H.Math.Sphere),R=!1;var s,b,V=w.getBoundingBox(w.dm().toDatas(function(x){return x.s("shadow.cast")&&w.isVisible(x)}));V?(s=new np(V.min),b=new np(V.max)):(s=new np(-256,-256,-256),b=new np(256,256,256),R=!0),F.set(s.clone().add(b).multiplyScalar(.5),.5*s.distanceTo(b)*N);var D,y=F.radius,T=w.getBoundingBox(w.dm().toDatas(function(G){return(G.s("shadow.cast")||G.s("shadow.receive"))&&w.isVisible(G)}));if(T){s.copy(T.min),b.copy(T.max);var f=.5*s.distanceTo(b);D=f+Math.min(f,y+F.center.distanceTo(s.add(b).multiplyScalar(.5)))}else D=2*y;v=_j(ue(),-y,y,-y,y,D/1e3,D),O.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),O.multiply(c.fromArray(v));var Q=Math.tan(-M*Math.PI/180),t=Math.tan(-q*Math.PI/180),S=y/Math.sqrt(Q*Q+t*t+1),e=new np(S*Q,S,S*t);P.direction=np.normalizeArray(e.clone().multiplyScalar(-1)),c.lookAt(e,new np(0,0,0),new np(0,1,0)).setPosition(e.add(F.center)),c.getInverse(c),O.multiply(c)},P.getDirection=function(){return P.enable?P.direction:void 0};var y=function(){var x=w.getGL(),d=I,Z=I;b.setSize(x,d,Z),b.bind(x),x.clear(os.COLOR_BUFFER_BIT|os.DEPTH_BUFFER_BIT);var S=w._frameState,l=S.renderState,_=l.directUniforms(),F=l.directAttribs(),j=l.directState();_.projectionMatrix=v,(s=w._boxClippers.length>0)&&(Nk(w,_,Ee),_.uClipperMatrix=w._boxClipperMatrixes,_.uClipperClipInner=w._boxClipperClipInner);var D=w._viewport;w.setViewport(x,0,0,d,Z);var R,C,N,U;for(R=0,C=ho.length;C>R;R++)if(N=ho[R],!ws[N].ignore&&(U=w._40Q.get(N))){var g=U.batchIndexMap;P.renderItems(x,_,F,j,U.opaque,g),P.renderItems(x,_,F,j,U.transparent,g),P.renderBatch(x,_,F,j,U.batchModelMap,g)}b.unbind(x),w.setViewport(x,D[0],D[1],D[2],D[3])};P._renderDirect=function(x,C,V,z){V&&V.length&&(C.position=Xi(x,w._buffer.vs,V,f),z?(Wh(x,w._buffer.is,z),fe(x,0,z.length,null,z instanceof Uint32Array?x.UNSIGNED_INT:null)):En(x,0,V.length/3))},P.renderShapeModel=function(A,k,R,M){var X,B,I;if(br(R))for(B=0,I=R.length;I>B;B++)X=R[B],X&&P.renderShapeModel(A,k,X,M);else Vn(R)?P.renderShapeModel(A,k,Kq(M,R),M):Mr(R)&&(R.shape3d?P.renderShapeModel(A,k,R.shape3d,M):P.renderShapeModelImpl(A,k,R))},P.renderShapeModelImpl=function(R,C,V){Ac(V),P._renderDirect(R,C,V.vs,V.is),P._renderDirect(R,C,V.top_vs,V.top_is),P._renderDirect(R,C,V.bottom_vs,V.bottom_is),P._renderDirect(R,C,V.from_vs,V.from_is),P._renderDirect(R,C,V.to_vs,V.to_is)},P.renderBatch=function(u,D,L,b,l){if(!cc(l)&&!w.drawFilter){D.modelViewMatrix=a.identity().premultiply(c).toArray();var O,X,j;for(O in l)j=w.getBatchInfo(O)||Cq,j.visible!==!1&&j.shadowCast!==!1&&(d&&j.reflectable===!1||(X=l[O],X.invalidate&&uq(X),s&&(D.modelMatrix=ss,Nk(w,D,j.clipboxMask===E?Sd:j.clipboxMask)),P._renderDirect(u,L,X.vs32,X.is)))}},P.renderItems=function(k,G,i,T,n,p){var Q,U,B,R,e,$,t=n.length;for(Q=0;t>Q;Q++)if(U=n[Q],R=U.ui,B=U.data,!(Fh(B)||!B.s("shadow.cast")||B instanceof bh||B.s("effect.flow")||!w.isVisible(B)||p[B._id]||d&&B.s("3d.reflectable")===!1)){var o=R.s("3d.clip.direction");if(o){var v=R.s("3d.clip.percentage");if(0===v)continue;var r=R._formatClipUniforms(o,v,B);G.uClipPercent=r[1],G.uClipDirection=r[0]}else G.uClipDirection=0;e=R.shapeModel||Kq(R),e||(e=B instanceof H.Node&&!(B instanceof H.Shape)?{vs:jd,is:Fl}:[R.left,R.front,R.right,R.back,R.top,R.bottom]),$=R.mat?a.fromArray(R.mat):a.identity();var b=R._vsTranslation;b&&(L.extractShapeTranslation||L.extractPolylineTranslation||L.extractVerticesTranslation)&&$.multiply(b),s&&(G.modelMatrix=$.toArray(),Nk(w,G,B.s("3d.clipbox")?Ee:B.s("3d.clipbox.mask"))),G.modelViewMatrix=$.premultiply(c).toArray(),T.cullFace.enabled=!!B.s("shape3d.reverse.cull"),P.renderShapeModel(k,i,e,R)}},P.resetProperties=C};As.shaderSrc={vs:["$DEFINE","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform mat4 modelMatrix;","varying vec3 vWorld;","\n #endif \n","varying vec3 vPosition;","void main() {","vec3 transformed = vec3( position );","vPosition = vec3(position);","vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );","\n #if MAX_BOX_CLIPPER > 0 \n","vWorld = vec3(modelMatrix * vec4(transformed, 1.0));","\n #endif \n","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["$DEFINE","precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","varying vec3 vPosition;","uniform int uClipDirection;","uniform float uClipPercent;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform int uClipperShape[MAX_BOX_CLIPPER];","uniform bool uClipperClipInner[MAX_BOX_CLIPPER];","uniform mat4 uClipperMatrix[MAX_BOX_CLIPPER];","const vec3 clipMin = vec3(-0.5, -0.5, -0.5);","const vec3 clipMax = vec3(0.5, 0.5, 0.5);","varying vec3 vWorld;","\n #endif \n","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","if (uClipDirection > 0) {","vec3 dir = vec3(0.0, 0.0, 0.0);","if (uClipDirection < 2) { dir.x = 1.0; }","else if (uClipDirection < 3) { dir.x = -1.0; }","else if (uClipDirection < 4) { dir.y = 1.0; }","else if (uClipDirection < 5) { dir.y = -1.0; }","else if (uClipDirection < 6) { dir.z = 1.0; }","else if (uClipDirection < 7) { dir.z = -1.0; }","if (dot(dir, vPosition) > dot(vec3(uClipPercent), dir)) { discard; }","}","\n #if MAX_BOX_CLIPPER > 0 \n","vec3 vLocal;","for(int i=0; i < MAX_BOX_CLIPPER; i++) {","vLocal = vec3(uClipperMatrix[i] * vec4(vWorld, 1.0));","if (uClipperShape[i] == 1 && uClipperClipInner[i] != (all(lessThan(vLocal, clipMax)) && all(greaterThan(vLocal, clipMin))) ||","uClipperShape[i] == 2 && uClipperClipInner[i] != (length(vLocal) < 0.5)) { ","discard; return;","}","}","\n #endif \n","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},As.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z"],ti.ms_shadow=function(p){As.PARAMS.forEach(function(H){var r=H.replace(/(^|\.)[a-z]/g,function(r){return r[r.length-1].toUpperCase()}),h=r.charAt(0).toLowerCase()+r.substr(1);p["getShadow"+r]=function(){return this._getShadowParam(h)},p["setShadow"+r]=function(V){this._setShadowParam(h,V)}}),p.enableShadow=function(I){this.shadowMap.setShadow(!0,I)},p.disableShadow=function(){this.shadowMap.setShadow(!1)},p._getShadowParam=function(q){return this.shadowMap.getShadow()[q]},p._setShadowParam=function(W,B){var N=this._getShadowParam(W),X={};X[W]=B;var _=this.shadowMap;_.setShadow(_.enable,X),this.firePropertyChange("shadow"+W.charAt(0).toUpperCase()+W.substr(1),N,B)}};var Bp=function(s){function M(k,w,W,O,t){var Y=s.getData3dUI(W),j=Y.s("shape3d");if("billboard"===j||"plane"===j){var a;(a=q[w])||(a=q[w]=new Ms(s));var p=W.s("effect.flow.size"),l=W.s("effect.flow.uvshape"),D=W.getFinalScale3d(),Q=D[0],v="billboard"===j?D[1]:D[2];Q>v?(v=v/Q*p,Q=p):(Q=Q/v*p,v=p),Q=Math.max(128,Math.round(Q)),v=Math.max(128,Math.round(v)),a.setSize(k,Q,v),a.bind(k);var S=s.getViewport(k);s.setViewport(k,0,0,Q,v),k.clear(k.COLOR_BUFFER_BIT|k.DEPTH_BUFFER_BIT);var L,Y=s.getData3dUI(W),x=Kq(Y,j);if(!x)return!1;!x.ns&&x.length&&(x=x[0]),Ac(x),L=x.vs;var r,$=W.s("effect.flow.gradient");if($){if(r="Flow3d.Cached."+$,!H.Default.getImageMap()[r]){var Z=100;H.Default.setImage(r,H.Default.toCanvas({width:Z,height:Z,comps:[{type:"rect",background:"rgb(0,0,0)",gradient:$,rect:[0,0,Z,Z]}]},Z,Z))}}else r=W.s("shape3d.image");O.useXZ="plane"===j,O.image=s.getTexture(r,W),O.blend=W.s("effect.flow.blend")||E,O.uvMatrix=zs(Y.s("shape3d.uv.rotation"),Y.s("shape3d.uv.offset"),Y.s("shape3d.uv.scale"),Y.s("shape3d.uv.anchor"),y).toArray9(),O.intensity=W.s("effect.flow.intensity");var U=T.indexOf(l);-1===U&&0===l.indexOf("polygon")&&(U=He(1*l.substring(7),3,1024)-1),O.shape=U,t.position=Xi(k,null,L,f,3),En(k,0,L.length/3),a.unbind(k),s.setViewport(k,S[0],S[1],S[2],S[3]);var A=W.getMatrix4();A.getInverse(A);var e=A.getElements();"plane"===j?e[1]=e[5]=e[9]=e[13]=0:e[2]=e[6]=e[10]=e[14]=0,C[w]={matrix:A,group:W.s("effect.flow.group")}}}var y,I=this,q=this.renderTargetPool=[],C=[],T=["rect","circle","polygon"];I.render=function(){if(!s._picking){var K=s._flowObjects;if(K.length){var B=s.getGL();if(B){var Z;(Z=B._flowShader)||(Z=B._flowShader=new Ti.Shader(B,Bp.shaderSrc.vs,Bp.shaderSrc.fs));var D=s._frameState.renderState,j=D.glState;j.blend.enabled=!1,j.depth.enabled=!1,j.cullFace.enabled=!1;var v=j.color.clear.slice(0);Ej(B,[0,0,0,1]),D.useProgram(Z.program);var m,l,p=D.directUniforms(),R=D.directAttribs();for(m=0,l=K.length;l>m;m++)M(B,m,K[m],p,R);Ej(B,v),q.length!==l&&q.splice(l,q.length-l)}}}},I.contextLost=function(){var p=s.getGL();p&&(p._flowShader=null,q=this.renderTargetPool=[])},I.createFlow=function(x){var h;if(h=q.length){x||(x=s._frameState.renderState.directUniforms());for(var R=[],W=[],Z=[],o=0;h>o;o++)R[o]=C[o].matrix.toArray(),W[o]=q[o].texture,Z[o]=!1;x.flowMatrix=R;for(var o=0;h>o;o++)x["flowTexture"+o]=W[o];x.flowEnabled=Z}},I.disableFlow=function(O){var N;if(N=q.length){O||(O=s._frameState.renderState.directUniforms());for(var C=[],z=0;N>z;z++)C[z]=!1;O.flowEnabled=C}},I.resetDataFlowEnabld=function(F,$){return I.resetFlowUniform(F.s("effect.flow.mask"),$)},I.resetFlowUniform=function(G,j){var P=q.length,o=new Array(P);if(G)for(var l=0;P>l;l++)G&1<<C[l].group&&(o[l]=!0);j.flowEnabled=o};var E="white"};Bp.shaderSrc={vs:["uniform bool useXZ;","attribute vec3 position;","varying vec2 vUv;","void main() {","if (useXZ) vUv = vec2(position.x, position.z);","else vUv = vec2(position.x, position.y);","gl_Position = vec4(vUv * 2.0, 0.0, 1.0);","}"].join("\n"),fs:["precision highp float;","const float pi2 = 6.2831853;","uniform sampler2D image;","uniform mat3 uvMatrix;","uniform int shape;","uniform vec4 blend;","uniform float intensity;","varying vec2 vUv;","void main() {","vec2 uv;","float angle = atan(vUv.y, vUv.x) / pi2 + 0.5;","if (shape == 0) {","uv = vUv + 0.5;","}","else if (shape == 1) {","uv = vec2(length(vUv) * 2.0, angle);","}","else {","float step = 1.0 / float(shape + 1);","float modAngle = mod(angle, step) - step * 0.5;","uv = vec2(length(vUv) * 2.0 * cos(modAngle * pi2) , angle);","}","vec4 color = texture2D(image, vec2((uvMatrix * vec3(uv, 1.0)).xy)) * blend;","gl_FragColor = color * color.a * intensity;","}"].join("\n")};var yh=function(G){this.gv=G,this.onMouseOver=this.onMouseOver.bind(this),this.resetProperties()};yh.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},ti.ms_highlight=function(R){R.setHighlightMode=function(q){var U;U="selection"===q||"selected"===q?yh.Mode.Selection:"mouseover"===q||"hover"===q?yh.Mode.MouseOver:"style"===q?yh.Mode.Style:yh.Mode.Disable;var v=this.getHighlightMode();this._highlightHelper.mode=U,this.firePropertyChange("highlightMode",v,q)},R.getHighlightMode=function(){var g=this._highlightHelper.mode;return g===yh.Mode.Selection?"selected":g===yh.Mode.MouseOver?"hover":g===yh.Mode.Style?"style":"disabled"},["type","color","width","glow","strength"].forEach(function(V){var q=V.replace(/(^|\.)[a-z]/g,function(W){return W[W.length-1].toUpperCase()});R["getHighlight"+q]=function(){return this._highlightHelper[V]},R["setHighlight"+q]=function(H){var Q=this._highlightHelper,b=Q[V];H!==b&&(Q[V]=H,this.firePropertyChange("highlight"+q,b,H))}})},kl(yh,b,{onMouseOver:function($){L.preventDefault($);var J=this.gv;if(!J._48Q){var W=J.getDataAt($);W!==this.mouseOverData&&(this.mouseOverData=W,J.iv())}},setFetchTargetFunc:function(a){this.fetchTargetFunc=a},_42:function(R,r){var H,E,D=this,p=D._mode,d=D.gv;if(!R._renderInfo.reflectDepth&&p!==yh.Mode.Disable){if(p===yh.Mode.Selection?H=d.sm().getSelection().toArray(function(j){return j.s("highlight.visible")}):p===yh.Mode.MouseOver&&D.mouseOverData&&D.mouseOverData.s("highlight.visible")&&(H=[D.mouseOverData]),D.fetchTargetFunc&&(H=D.fetchTargetFunc(H)),p===yh.Mode.Style)H=H||[],E=function(E){if(H.indexOf(E)>=0)return!1;var l=d.getDataHighlightMode(E);return l===!1?!0:l===!0?!1:"selected"===l?d.isSelected(E)?!1:!0:"hover"===l?E===D.mouseOverData?!1:!0:!0};else{if(!H||!H.length)return;E=function(n){return H.indexOf(n)<0?!0:void 0}}var K=d.isVRPresenting(),u=d.getWidth();if(K){var S=d.getWidth;u/=2,d.getWidth=function(){return u};var m=d.getViewport()}var s,e=d.getDevicePixelRatio(),C=Math.floor(u*e),z=Math.floor(d.getHeight()*e);(s=D._renderTarget)?s.setSize(R,C,z):D._renderTarget=s=new nj.RenderTarget(d,R,C,z);var _="soft"===D.type;if(s.bind(R),_){var A=R.getParameter(R.COLOR_CLEAR_VALUE);Ej(R,[1,1,1,1]),R.clear(R.COLOR_BUFFER_BIT),Ej(R,A)}else R.clear(R.COLOR_BUFFER_BIT);d.setViewport(R,0,0,C,z),d.drawFilter=E,fh=function(_,o,n,R,E,q){var D=[n?0:1,1,1,1];return q||(se.for(_).directUniforms().uFixPickReverseColor=D),D},d.renderPickScene(),fh=hk,d.drawFilter=null,s.unbind(R),xf&&Ik(R,r.aPosition),Ik(R,r.aNormal),K&&(d.getWidth=S,d.setViewport(R,m[0],m[1],m[2],m[3]));var B=d.getHighlightColor();if(D._lastHighlightColor!==B){var Z=si(D._lastHighlightColor=B);D._highlightColorData=[Z[0]/255,Z[1]/255,Z[2]/255,Z[3]/255]}return _?D.renderSoftOutline(R,C,z):D.renderHardOutline(R,C,z),R.useProgram(r=d._prg),xf&&cj(R,r.aPosition),!0}},_assureShader:function(M,x){var E=M._compiledShader[x];return E||(E=M._compiledShader[x]=new Ti.Shader(M,yh.CommonShaderVs,yh[x].fs)),E},renderHardOutline:function(z,m,q){var K=this,G=K.gv,t=G._postProcessing,x=se.for(z),B=x.directState();B.blend.enabled=!0,B.depth.enabled=!1,t.blitScreen(null,K._renderTarget.texture,K._assureShader(z,"HighlightHard"),{textureSize:[m,q],edgeWidth:G.getHighlightWidth(),edgeColor:K._highlightColorData},{clear:!1}),B.blend.enabled=!1,B.depth.enabled=!0},renderSoftOutline:function(P,X,l){var x,j,O,b,p,L=this,M=L.gv,v=M._postProcessing,d=Math.floor(X/2),I=Math.floor(l/2),f=Math.floor(X/4),V=Math.floor(l/4),k=L._downSampleRenderTarget;k?(x=L._edgeDetectionRenderTarget,j=L._blurV2,O=L._blurH2,b=L._blurV4,p=L._blurH4,(k.width!==d||k.height!==I)&&(k.setSize(d,I),x.setSize(d,I),j.setSize(d,I),O.setSize(d,I),b.setSize(f,V),p.setSize(f,V))):(k=L._downSampleRenderTarget=new nj.RenderTarget(M,P,d,I),x=L._edgeDetectionRenderTarget=new nj.RenderTarget(M,P,d,I),j=L._blurV2=new nj.RenderTarget(M,P,d,I),O=L._blurH2=new nj.RenderTarget(M,P,d,I),b=L._blurV4=new nj.RenderTarget(M,P,f,V),p=L._blurH4=new nj.RenderTarget(M,P,f,V));var z=P.getParameter(P.COLOR_CLEAR_VALUE),a=M.getViewport(),N=L.width,Q=L.strength,w=L.glow,S=se.for(P).glState,F=S.depth,y=S.blend,K=F.enabled;Ej(P,[1,1,1,1]),F.enabled=!1,y.apply({func:[P.SRC_ALPHA,P.ONE]}),v.blitScreen(k,L._renderTarget.texture),v.blitScreen(x,k.texture,L._assureShader(P,"EdgeDetection"),{texSize:[d,I],color:L._highlightColorData}),v.blitScreen(O,x.texture,L._assureShader(P,"Blur"),{direction:[1,0],texSize:[d,I],radius:N}),v.blitScreen(j,O.texture,L._assureShader(P,"Blur"),{direction:[0,1],texSize:[d,I],radius:N}),v.blitScreen(p,j.texture,L._assureShader(P,"Blur"),{direction:[1,0],texSize:[f,V],radius:N}),v.blitScreen(b,p.texture,L._assureShader(P,"Blur"),{direction:[0,1],texSize:[f,V],radius:N}),y.apply({enabled:!0}),M.setViewport(P,a[0],a[1],a[2],a[3]),v.blitScreen(null,L._renderTarget.texture,L._assureShader(P,"BlendTogether"),{edgeTexture1:j.texture,edgeTexture2:b.texture,edgeStrength:Q*N,edgeGlow:w},{clear:!1}),y.apply({func:[P.SRC_ALPHA,P.ONE_MINUS_SRC_ALPHA,P.ONE,P.ONE_MINUS_SRC_ALPHA]}),F.enabled=K,Ej(P,z)},resetProperties:function(){this.mode=yh.Mode.Style,this.type=W["highlight.type"],this.color=W["highlight.color"],this.width=W["highlight.width"],this.glow=W["highlight.glow"],this.strength=W["highlight.strength"]},contextLost:function(){this._renderTarget=null}}),b.defineProperties(yh.prototype,{mode:{get:function(){return this._mode},set:function(k){var o=this._mode;if(k!==o){this._mode=k;var g=o===yh.Mode.MouseOver||o===yh.Mode.Style,f=k===yh.Mode.MouseOver||k===yh.Mode.Style;f&&g||(g&&x(this.gv.getView(),"mousemove",this.onMouseOver),f&&w(this.gv.getView(),"mousemove",this.onMouseOver))}}}}),yh.CommonShaderVs=["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),yh.HighlightHard={fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},yh.EdgeDetection={fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","uniform vec2 texSize;","uniform vec4 color;","void main() {","vec2 invSize = 1.0 / texSize;","vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);","vec4 c1 = texture2D( image, vUv + uvOffset.xy);","vec4 c2 = texture2D( image, vUv - uvOffset.xy);","vec4 c3 = texture2D( image, vUv + uvOffset.yw);","vec4 c4 = texture2D( image, vUv - uvOffset.yw);","float diff1 = (c1.r - c2.r)*0.5;","float diff2 = (c3.r - c4.r)*0.5;","float d = length( vec2(diff1, diff2) );","gl_FragColor = color * vec4(d);","}"].join("\n")},yh.Blur={fs:["#define MAX_RADIUS 4","precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform vec2 texSize;","uniform vec2 direction;","uniform float radius;","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float weightSum = gaussianPdf(0.0, radius);","vec4 diffuseSum = texture2D( image, vUv) * weightSum;","vec2 delta = direction * invSize * radius/float(MAX_RADIUS);","vec2 uvOffset = delta;","for( int i = 1; i <= MAX_RADIUS; i ++ ) {","float w = gaussianPdf(uvOffset.x, radius);","vec4 sample1 = texture2D( image, vUv + uvOffset);","vec4 sample2 = texture2D( image, vUv - uvOffset);","diffuseSum += ((sample1 + sample2) * w);","weightSum += (2.0 * w);","uvOffset += delta;","}","gl_FragColor = diffuseSum/weightSum;","}"].join("\n")},yh.BlendTogether={fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform sampler2D edgeTexture1;","uniform sampler2D edgeTexture2;","uniform float edgeStrength;","uniform float edgeGlow;","void main() {","vec4 edgeValue1 = texture2D(edgeTexture1, vUv);","vec4 edgeValue2 = texture2D(edgeTexture2, vUv);","vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;","float vv = texture2D(image, vUv).r;","vec4 finalColor = edgeStrength * vv * edgeValue;","gl_FragColor = finalColor;","}"].join("\n")};
var Tl=H.Light=function(){Hm(Tl,this),this.s(Vb,W[Vb]),this.s(bc,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};Ce("Light",jh,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(T,O,W){Tl.superClass.onStyleChanged.apply(this,arguments),T===Vb&&this.s("shape3d.color",W)}});var Ds=nj.FrameState=function(m,n){this.renderState=se.for(n),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=E,this.projectMatrix=E,this.viewMatrix=E,this.view=m,this.defaultProgram=E,this.pickColorMap=E,this._pvStack=[],this._renderStateStack=[]};Ds.prototype.savePV=function(){var t=this.view;this._pvStack.push([Nd(this.projectMatrix),Nd(this.viewMatrix),t._18Q,Nd(t._7O)])},Ds.prototype.restorePV=function(){var w=this._pvStack.pop();if(w){var C=this.view;this.projectMatrix=C._projectMatrix=w[0],this.viewMatrix=C._viewMatrix=w[1],C._18Q=w[2],C._7O=w[3]}},Ds.prototype.setPV=function(F,n){var W=this.view,h=!1;if(F&&(this.projectMatrix=W._projectMatrix=F,h=!0),n&&(this.viewMatrix=W._viewMatrix=n,W._7O=Nd(n),h=!0),h){var X=W.getWidth(),v=W.getHeight(),f=Nd(this.projectMatrix);W._18Q=Tq(f,f,n),W._18Q._wh=X/v}},Ds.prototype.syncEnv=function(W){var R=this,Z=R.view;R.envmapReflectivity=Z._envmapReflectivity||.5,R.cameraPosition=Z.getEye(),R.projectMatrix=Z._projectMatrix,R.viewMatrix=Z._viewMatrix,R.pickColorMap=W,R.picking=Z.getGL()._picking},Ds.prototype.setGLState=function(){var X=[0,0,0,0],a=[!0,!0,!0,!0],C=[-1,1],U=[os.FUNC_ADD,os.FUNC_ADD],Y=[os.SRC_ALPHA,os.ONE_MINUS_SRC_ALPHA,os.ONE,os.ONE_MINUS_SRC_ALPHA];return function(e,W){var k=this,F=k.renderState.gl,h=k.renderState.glState;h.dither=!1,W?h.color.mask=a:h.color.reset(),h.pixelStore.reset(),h.blend.color=X,h.blend.equation=U,h.blend.func=Y,h.cullFace.enabled=!1,h.scissor.enabled=!1,h.depth.enabled=!0,h.depth.clear=1,h.depth.func=F.LEQUAL,h.depth.range=C,h.stencil.enabled=!1,h.polygonOffset.enabled=!1,e?(h.depth.mask=!1,h.blend.enabled=!0):(h.depth.mask=!0,h.blend.enabled=!1)}}(),Ds.prototype.setUniforms=function(h){var A=this,X=A.view,T=A.renderState,$=T.gl,j=T.uniforms;j.uBrightness=1,j.uOpacity=1,j.uPartOpacity=1,j.uPick=A.picking,j.uUseInstance=!1,j.uTexture=!1,j.uBlendTexture=!1,j.uAlphaTest=W.alphaTest,j.uTransparent=!!h,j.uFix=!1,j.uBatchColor=!1,j.uBatchBlend=!1,j.uBatchBrightness=!1,j.uReflectivity=A.envmapReflectivity||.5,j.uCameraPosition=A.cameraPosition,j.uPMatrix=A.projectMatrix,j.uViewMatrix=A.viewMatrix,j.uEnvMap=null,Nk(X,j,Ee),j.uClipperMatrix=X._boxClipperMatrixes,j.uClipperClipInner=X._boxClipperClipInner,j.uEnvmapQuat=X._envmapExtraQuaternion,X._envmapRenderer.resetUniformCache(),A.picking||(Jn(X,$,E),X._fogDisabled||(j.uFogColor=X._fogColor,j.uFogDensity=X._fogDensity,j.uFogNear=X._fogNear,j.uFogFar=X._fogFar))},Ds.prototype.drawLayer=function(b){return this.view.renderLayers(b,!0)},Ds.prototype.drawData=function(Q,R,g){var i=this.view;if(i.isVisible(Q)){var W=this.renderState,h=W.uniforms,j=i.getData3dUI(Q);if(j){var E=W.gl,O=E._picking,d=i._picking,r=j._pickId;g&&(j._pickId=g),h.uPick=E._picking=i._picking=!!g,h.uTransparent=!!R,j._42(W.gl,W.program,R?F:T),h.uPick=E._picking=O,i._picking=d,j._pickId=r}}};var Es=nj.Graph3dView=function(G,q){var b=this;b.resetHeadlightProperties(),b.resetFogProperties(),b._webGLVersion=1,b._attributes=q||L.graph3dViewAttributes,b._25I={},b._view=Cg(1,b);var v;b._attributes&&(v=b._attributes.canvas)||(v=Vq(b._view)),b._canvas=v,w(v,"webglcontextlost",function(K){K.preventDefault(),nc(b),b._26I&&(b._doBufferGC(b._26I,!0),Zq(b._canvas,0,0),["_highlightHelper","shadowMap","flowMap","_envmapRenderer","_postProcessing"].forEach(function(p){b[p].contextLost()}),b.dm().each(function(J){var F=b.getData3dUI(J);F.contextLost()})),b._26I=f,b._1o.onContextLost(),b._35O=!0}),w(v,"webglcontextrestored",function(){b._35O=!1,b.iv()}),b._40Q=new Ls(b),b._43Q={},b._44Q=-1,b._batchIndexMap={},b._batchModelMap={},b._wireframeIndexMap={},b._wireframeModelMap={},b._wireframeIndexMapSwap={},b._wireframeModelMapSwap={},b._polylineIndexMap={},b._polylineIndexMap={},b._polylineIndexMapSwap={},b._polylineIndexMapSwap={},b._8O=[],b._7O=ue(),b._6O=ue(),b._1o=new Vs(b),b._30O=new Ys(b),b._31O=new Ws(b),b._32O=new Xs(b),b._raycaster=new ht(b),b._highlightHelper=new yh(b),b._postProcessing=new rt(b),b._41Q=[],b._42Q=0,b._frameRenderOptionStack=[],nj.VR?(b.vr=new nj.VR(b),b.isVREnabled=function(){return this.vr.enable},b.isVRPresenting=function(){return this.vr.isPresenting()}):(b.vr={enable:!1,isPresenting:t},b.isVREnabled=t,b.isVRPresenting=t),b.shadowMap=new As(b),b.flowMap=new Bp(b),b._33Q=!0,b._eye=ys(L.graph3dViewEye),b._center=ys(L.graph3dViewCenter),b._up=ys(L.graph3dViewUp),b._lightChanged=!1,b._59O=[],b._spots=[],b._dirs=[],b._boxClippers=[],b._flowObjects=[],b._frameId=0,b._picking=!1,b._batchInfoMap={},b.overlappingBox=new rb(b),b.dm(G?G:new Wo),b._coreInteractor=new fp(this),b._envmapRenderer=new nj.EnvmapRenderer(this),b.setInteractors([new Os(b)]),b._initView(),b._genBatchInstancedArrayFunc()},Fs={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchInstancedDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,flowBlendMode:1,uvClipEnabled:1,ortho:1},Gs={box:1,sphere:2},Hs={addRGB:"FLOW_BLEND_MODE_ADD_RGB",addRGBA:"FLOW_BLEND_MODE_ADD_RGBA",overrideRGBA:"FLOW_BLEND_MODE_OVERRIDE_RGBA",overrideRGB:"FLOW_BLEND_MODE_OVERRIDE_RGB",overrideA:"FLOW_BLEND_MODE_OVERRIDE_A",multiplyRGB:"FLOW_BLEND_MODE_MULTIPLY_RGB",multiplyRGBA:"FLOW_BLEND_MODE_MULTIPLY_RGBA"},Is=0;Ri("Graph3dView",b,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_highlight:1,ms_quickVisible:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",Cd,Co,"firstPersonMode",hp,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightDirection","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","headlightGroup","ortho","orthoWidth","syncEyeWithOrthoWidth","fovy","near","far",uh,bb,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","uvClipEnabled","batchColorDisabled","batchInstancedDisabled","batchBlendDisabled","batchBrightnessDisabled","flowBlendMode","hoverDelay","batchInfoMap","rotateMinPhi","rotateMaxPhi","sortable","sortFunc"],_editable:!1,_sortable:L.graph3dViewSortable,_editHelperDisabled:L.graph3dViewEditHelperDisabled,_blockSelectable:L.graph3dViewBlockSelectable,_devicePixelRatio:E,_boundaries:E,_moveStep:L.graph3dViewMoveStep,_rotateStep:L.graph3dViewRotateStep,_rotateMinPhi:L.graph3dViewMinPhi===E?L.graph3dViewRotateMinPhi:L.graph3dViewMinPhi,_rotateMaxPhi:L.graph3dViewMaxPhi===E?L.graph3dViewRotateMaxPhi:L.graph3dViewMaxPhi,_pannable:L.graph3dViewPannable,_rotatable:L.graph3dViewRotatable,_walkable:L.graph3dViewWalkable,_resettable:L.graph3dViewResettable,_zoomable:L.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:L.graph3dViewFirstPersonMode,_mouseRoamable:L.graph3dViewMouseRoamable,_gridVisible:L.graph3dViewGridVisible,_gridSize:L.graph3dViewGridSize,_gridGap:L.graph3dViewGridGap,_gridColor:L.graph3dViewGridColor,_originAxisVisible:L.graph3dViewOriginAxisVisible,_centerAxisVisible:L.graph3dViewCenterAxisVisible,_axisXColor:L.graph3dViewAxisXColor,_axisYColor:L.graph3dViewAxisYColor,_axisZColor:L.graph3dViewAxisZColor,_ortho:L.graph3dViewOrtho,_orthoWidth:L.graph3dViewOrthoWidth,_syncEyeWithOrthoWidth:L.graph3dViewSyncEyeWithOrthoWidth,_fovy:L.graph3dViewFovy,_near:L.graph3dViewNear,_far:L.graph3dViewFar,_rectSelectable:L.graph3dViewRectSelectable,_rectSelectBackground:L.graph3dViewRectSelectBackground,_editSizeColor:L.graph3dViewEditSizeColor,_autoMakeVisible:Po,_pickerResolution:L.graph3dViewPickerResolution,_dashDisabled:L.graph3dViewDashDisabled,_uvClipEnabled:L.graph3dViewUvClipEnabled,_batchColorDisabled:L.graph3dViewBatchColorDisabled,_batchInstancedDisabled:L.graph3dViewBatchInstancedDisabled,_batchBlendDisabled:L.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:L.graph3dViewBatchBrightnessDisabled,_flowBlendMode:L.graph3dViewFlowBlendMode,addCamera:function(S){var I=this,X=b.freeze({id:I._42Q++,priority:S.priority||0,ignoreInPick:!!S.ignoreInPick,render:S.render});S.switch3DStatus&&(I._43Q[X.id]=!0),I._41Q.push(X),I._41Q.sort(function(k,C){return k.priority!==C.priority?k.priority-C.priority:k.id-C.id})},setEye:function(m,W,L){1===arguments.length&&(W=m[1],L=m[2],m=m[0]);var K=this._eye;K[0]=m,K[1]=W,K[2]=L,this.fp(uh,f,K)},setCenter:function(Y,I,J){1===arguments.length&&(I=Y[1],J=Y[2],Y=Y[0]);var G=this._center;G[0]=Y,G[1]=I,G[2]=J,this.fp(bb,f,G)},setUp:function(q,w,a){1===arguments.length&&(w=q[1],a=q[2],q=q[0]);var l=this._up;l[0]=q,l[1]=w,l[2]=a,this.fp("up",f,l)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||od},isTransparentMask:function(e){return e.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var I=this,g=I._aspect;return g?g:(g=I.getWidth()/I.getHeight(),g||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(v){var p=this,R=p._dataModel,m=p._selectionModel;R!==v&&(R&&(R.ump(p.handleDataModelPropertyChange,p),R.umm(p.handleDataModelChange,p),R.umd(p.handleDataPropertyChange,p),m||R.sm().ums(p.handleSelectionChange,p)),p._dataModel=v,v.mp(p.handleDataModelPropertyChange,p),v.mm(p.handleDataModelChange,p),v.md(p.handleDataPropertyChange,p),m?m._21I(v):v.sm().ms(p.handleSelectionChange,p),p._postProcessing.handleDataModleChange(R,v),p._tryInvalidateEnvmap(),p.invalidateAll(!0),p.invalidateLight(),p.invalidateboxClipper(),p.invalidateFlowObjects(),p._49Q(),p.fp(Yk,R,v),p._canvas.style.background=v.getBackground()||"")},handleDataModelPropertyChange:function(t){var x=t.property;if("background"===x){var R=this._canvas.style.background,h=t.newValue||"";this._canvas.style.background=h,this.fp("canvasBackground",R,h)}else if("envmapType"===x)this._tryInvalidateEnvmap();else if("envmap"===x){var R=this._shaderUseEnvmapFlag,h=!(!t.newValue||!t.newValue.length);R!==h&&nc(this),this.iv()}},handleDataPropertyChange:function(J){var S=J.data;this.invalidateData(S);var i=J.property;Fh(S)&&"s:light.type"===i?this.invalidateLight():"s:3d.clipbox"===i?this.invalidateboxClipper(S,!0):"s:effect.flow"===i?this.invalidateFlowObjects(S,!0):"s:shadow.cast"===i?this.shadowMap.tryUpdateBounding(S):"s:3d.visible"===i&&this.invalidateQuickVisible(S)},invalidateboxClipper:function(y,_){var F=this._boxClippers,f=F.length;if(y){var D=!!y.s("3d.clipbox");if(_=!!_,D===_)F.indexOf(y)<0&&F.push(y);else{var E=F.indexOf(y);E>=0&&F.splice(E,1)}}else F=this._boxClippers=[],this.dm().each(function(Y){Y.s("3d.clipbox")&&F.push(Y)});var n=F.length;f!==n&&(nc(this),this.shadowMap.deleteShadowProgram(),this._updateBoxClipperMatrix(),Nk=n?Gp:vi),this.iv()},_updateBoxClipperMatrix:function(){for(var F,d,C=this._boxClippers,c=this._boxClipperMatrixes=[],B=this._boxClipperClipInner=[],o=this._boxClipperGroups=[],E=this._boxClipperShape=[],K=new jf,U=0,n=C.length;n>U;U++)F=C[U],F.appendAnchorMatrix3d(d=ec(F,this.getMat(F))),c.push(K.getInverse(K.fromArray(d)).toArray()),B.push("inner"===F.s("3d.clipbox")),o.push(F.s("3d.clipbox.group")),E.push(Gs[F.s("3d.clipbox.shape")]||1)},_49Q:function(){this._4AQ||this._48Q||this.dm().size()<L.graph3dViewDataNumWarningLine||(this._48Q=!0,console.log("Too many datas so than disable some feature to speed up.\nYou can set global Default.graph3dViewDataNumWarningLine to largeEnoughNum to avoid this, or call graph3dView.quitDataNumWarning() to quit.\n"),this.enableQuickVisibleMode(),this.getHighlightHelper().mouseOverData=null)},quitDataNumWarning:function(){this.disableQuickVisibleMode(),this._48Q=!1,this._4AQ=!0},invalidateFlowObjects:function(w,o){var z=this._flowObjects,P=z.length;if(w){var t=!!w.s("effect.flow");if(o=!!o,t===o)z.indexOf(w)<0&&z.push(w);else{var N=z.indexOf(w);N>=0&&z.splice(N,1)}}else z=this._flowObjects=[],this.dm().each(function(Q){Q.s("effect.flow")&&z.push(Q)});P!==z.length&&nc(this),this.iv()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(Y){var c=this,g=Y.property;if(c.iv(),c._18Q=f,"eye"===g)c._33Q=!0;else if("devicePixelRatio"===g)c._42(c.getDevicePixelRatio());else if(Fs[g]&&(nc(c),"batchInstancedDisabled"===g)){c._genBatchInstancedArrayFunc();var F,i=L.getBatchInfoMap();for(F in i)i[F]&&i[F].instanced&&c.invalidateBatch(F);i=c._batchInfoMap;for(F in i)i[F]&&i[F].instanced&&c.invalidateBatch(F)}},_5O:function(O){var M=O._22Q();return M?new M(this,O):f},getData3dUI:function(C){var n=this._25I[C._id];return n===E&&(n=this._5O(C),this._25I[C._id]=n),n},invalidateAll:function(Q,L){var I=this;if(Q){for(var F in I._25I){var J=I._25I[F];J&&J.dispose()}I._25I={},I.iv(),Ye(I)}else Ye(I),I.dm().each(function(H){I.invalidateData(H)});I.shadowMap.tryInvalidateLater(Q,L)},invalidateSelection:function(){var U=this;U.sm().each(function(e){U.invalidateData(e)})},invalidateData:function(P){var J=this,M=J.getData3dUI(P);M&&(M.iv(),J.iv()),Ye(J,P)},getShape3dText:function(i){return i.getStyle("shape3d.text")||this.getLabel(i)},invalidateBatch:function(h){var F=this,Q=F._40Q;Q.each(function(c){F._invalidateBatch(h,c.batchModelMap,c.batchIndexMap),F._invalidateBatch("T"+h,c.wireframeModelMap,c.wireframeIndexMap),F._invalidateBatch("O"+h,c.wireframeModelMap,c.wireframeIndexMap),c.markBatchInvalid()}),F.iv()},_invalidateBatch:function(j,H,p){var h=this,K=H[j];K&&(K.ds.forEach(function($){var w=h.getData3dUI($);w&&w.iv(),delete p[$._id]}),delete H[j])},handleDataModelChange:function(b){var L=this,z=b.kind,B=b.data;if("add"===z)L.invalidateData(B),Op(B)&&B.getEdgeGroup()&&B.getEdgeGroup().eachSiblingEdge(L.invalidateData,L),Fh(B)&&L.invalidateLight(),B.s("3d.clipbox")&&L.invalidateboxClipper(B,!0),B.s("effect.flow")&&L.invalidateFlowObjects(B,!0),L._49Q();else if(z===xk){var K=B._id,J=L._25I[K];J&&(J.dispose(),delete L._25I[K],L.iv()),B===L._currentSubGraph&&L.setCurrentSubGraph(f),Ye(L,B),Fh(B)&&L.invalidateLight(),B.s("3d.clipbox")&&L.invalidateboxClipper(B,!1),B.s("effect.flow")&&L.invalidateFlowObjects(B,!1)}else z===$n&&(L.invalidateAll(!0),L.setCurrentSubGraph(f),Ye(L),L.invalidateLight(),L.invalidateboxClipper(),L.invalidateFlowObjects())},toCanvas:function(V,q,W){var $=this,w=$.getGL();if($.validate(),V){var s=w.getParameter(w.COLOR_CLEAR_VALUE);Ej(w,V)}$._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var x=$.getWidth()||1,K=$.getHeight()||1,X=new Uint8Array(4*x*K),i=Vq(),P=i.getContext("2d");w.readPixels(0,0,x,K,w.RGBA,w.UNSIGNED_BYTE,X),Zq(i,x,K,1);for(var N=P.getImageData(0,0,x,K),Q=N.data,B=0;B<Q.length;B+=4){var O=B/4,I=j(O/x),z=O-I*x;O=4*((K-1-I)*x+z),Q[O]=X[B],Q[O+1]=X[B+1],Q[O+2]=X[B+2],Q[O+3]=X[B+3]}if(P.putImageData(N,0,0),V&&Ej(w,s),$._42($.getDevicePixelRatio()),q&&W){var M=Vq(),v=M.getContext("2d");return Zq(M,q,W,1),L.drawImage(v,i,0,0,q,W),M}return i},toDataURL:function(M,S){var W=this,R=W.getGL();if(W.validate(),M){var d=R.getParameter(R.COLOR_CLEAR_VALUE);Ej(R,M)}W._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var s=W._canvas.toDataURL(S||"image/png",1);return M&&Ej(R,d),W._42(W.getDevicePixelRatio()),s},isWebGL2:function(){return 2===this._webGLVersion},getGL:function(){var R=this._26I;if(R)return this.acquireProgram(),R;if(!this._35O){var B=this,p=B._canvas,e=B._attributes;if(!e||e.requestWebGL2!==!1)try{R=p.getContext("webgl2",e)||p.getContext("experimental-webgl2",e),R&&(B._webGLVersion=2,B._26I=R)}catch(n){}if(!R)try{R=p.getContext("webgl",e)||p.getContext("experimental-webgl",e)}catch(n){throw new Error("WebGL not supported")}if(!R)throw new Error("WebGL not supported");B._26I=R;var j=B._frameState=new Ds(this,R);B._glExtensions=new l(R),B._glCapabilities=new U(R,B._glExtensions),B._2O={},R._emptyCubeTexture=kd(R),R._compiledShader={},R._emptyTexture=Ur(R),R._emptyBlendTexture=Ur(R),R._bufPool={},R._id=++Is,R._divisorState=[],j.setGLState(),B._buffer={vs:Od(R),ns:Od(R),is:Od(R),uv:Od(R),batchColor:Od(R),batchBlend:Od(R),batchBrightness:Od(R),lineDistance:Od(R)},B._1O=Nm(R);var A=B._cube={vs:Od(R),ns:Od(R),is:Od(R),uv:Od(R)};return zi(R,A.vs,jd),zi(R,A.ns,Eg),zi(R,A.uv,Tp),un(R,A.is,Fl),B.acquireProgram(),B._genBatchInstancedArrayFunc(),R._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,textureCache:{time:0,count:0,pixels:0},frame:0,cacheTimeCost:0,reflectDepth:0},R}},getGLCapabilities:function(){var H=this.getGL();return H?this._glCapabilities:void 0},getGLExtensions:function(){var S=this.getGL();return S?this._glExtensions:void 0},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<L.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},getEnvmapType:function(){var V,r=this.dm();return r&&(V=r.getEnvmapType()),V||"legacy"},setEnvmapExtraQuaternion:function(j){var d=this._envmapExtraQuaternion;this._envmapExtraQuaternion=j instanceof xc.Quaternion?j.clone().inverse().toArray():null,null==d!=(null==j)&&nc(this)},invalidateEnvmap:function(f){return this._envmapRenderer.invalidateEnvmap(f)},_setEnvmapByProbeId:function(K,R){return this._envmapRenderer.setEnvmapByProbeId(K,R)},_tryInvalidateEnvmap:function(){var O=this.getEnvmapType();O!==this._lastProgramEnvmapType&&(nc(this),this.iv())},acquireProgram:function(){var a=this,n=a._26I;if(n&&!a._prg){var h=a._prg=n.createProgram();if(!h)return f;var O=a._dirs.length,G=a._spots.length,T=a._59O.length,W=a._boxClippers.length,J=a._flowObjects.length,y=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uUvMatrix","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];O&&y.push("uDirColor","uDirDirection"),G&&y.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),T&&y.push("uPointColor","uPointRange","uPointPosition"),Qk||(gp=Ih(gp.substring(0,gp.indexOf("^#"))),Hf=Ih(Hf),Qk=!0);var K=a.getEnvmap(),X=K&&K.length,R=a.getEnvmapType(),o=["#define MAX_DIR "+O,"#define MAX_SPOT "+G,"#define MAX_POINT "+T,"#define MAX_BOX_CLIPPER "+W,"#define MAX_FLOW_OBJECT "+J,a._fogDisabled?"":"#define FOG","exp2"===a.getFogMode()?"#define FOG_EXP2":"",a._dashDisabled?"":"#define DASH",a._uvClipEnabled?"#define UV_CLIP":"",null==a._envmapExtraQuaternion?"":"#define ENVMAP_ROTATE",X?"#define USE_ENVMAP":"","legacy"!==R?"#define ENVMAP_TYPE_CUBE_UV":"",a.isOrtho()?"#define ORTHOGRAPHIC":"",a._batchColorDisabled?"":"#define BATCHCOLOR",a._batchInstancedDisabled?"":"#define BATCHINSTANCE",a._batchBlendDisabled?"":"#define BATCHBLEND",a._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS","#define "+(Hs[a.getFlowBlendMode()]||Hs[L.graph3dViewFlowBlendMode]),a.shadowMap.enable?a.shadowMap.genShaderDefine():"",""].join("\n"),x=kf(n,h,n.VERTEX_SHADER,gp.replace("#PREFIX",o));n.getShaderParameter(x,n.COMPILE_STATUS)||Lh("COMPILE",n.VERTEX_SHADER,n.getError(),n.getShaderInfoLog(x));var U=kf(n,h,n.FRAGMENT_SHADER,Hf.replace("#PREFIX",o));if(n.getShaderParameter(U,n.COMPILE_STATUS)||Lh("COMPILE",n.FRAGMENT_SHADER,n.getError(),n.getShaderInfoLog(U)),xf?y.push("aPosition"):(h.aPosition=0,n.bindAttribLocation(h,0,"aPosition")),n.linkProgram(h),!n.getProgramParameter(h,n.LINK_STATUS)){var z=n.getProgramInfoLog(h);return a._prg=f,z.indexOf("maximum temp register")>=0&&!a._glTempRegisterLimited?(a._glTempRegisterLimited=!0,n.deleteProgram(h),a.acquireProgram()):(Lh("LINK",n.getProgramParameter(h,n.VALIDATE_STATUS),n.getError(),z),n.deleteProgram(h),f)}y.forEach(function(Z){h[Z]=/^u/.test(Z)?n.getUniformLocation(h,Z):n.getAttribLocation(h,Z)});var F=a._frameState;F.renderState.program=F.defaultProgram=h,a._envmapRenderer.changeEnvmapType(a._lastProgramEnvmapType=R),a._shaderUseEnvmapFlag=X,n.deleteShader(x),n.deleteShader(U)}},isGLTempRegisterLimited:function(){return this._glTempRegisterLimited},getBrightness:function(t){var O=t.s("brightness"),m=this.isSelected(t)?t.s("select.brightness"):f;return O==f?m:m==f?O:O*m},getDataHighlightMode:function(d){return d.s("highlight.mode")},getWireframe:function(h){var C=h.s("wf.visible"),s=h.s("wf.width");return C===!0||s>0&&"selected"===C&&this.isSelected(h)?{color:h.s("wf.color"),width:s,"short":h.s("wf.short"),mat:h.s("wf.mat")}:void 0},_transformPointToViewSpace:function(B){var h=[B[0],B[1],B[2]];return Vh(h,this._viewMatrix),h},_transformDirectionToViewSpace:function(z,n){var C=z?[z[0],z[1],z[2]]:[0,0,0];Vh(C,this._viewMatrix);var X=n?[n[0],n[1],n[2]]:[0,0,0];Vh(X,this._viewMatrix);var O=X[0]-C[0],E=X[1]-C[1],q=X[2]-C[2],S=Math.sqrt(O*O+E*E+q*q);return S?[O/S,E/S,q/S]:[O,E,q]},getWireframeGeometry:function(j){return j.s("wf.geometry")?{color:j.s("wf.color"),width:j.s("wf.width"),mat:j.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(m){return m.s("body.color")},getMat:function(C){return C.getMat?C.getMat():C.s("mat")},getFaceMat:function(T,n){return T.getFaceMat?T.getFaceMat(n):T.s(n+".mat")},getFaceBlend:function(I,m){return I.s(m+".blend")||I.s("all.blend")},getFaceColor:function(Y,O){return Y.s(O+".color")||Y.s("all.color")},getFaceImage:function(C,M){return C.s(M+".image")||C.s("all.image")},getFaceBlendImage:function(l,A){return l.s(A+".blend.image")||l.s("all.blend.image")},getFaceDiscardSelectable:function(V,x){var F=V.s(x+".discard.selectable");return F==f?V.s("all.discard.selectable"):F},getFaceUv:function(Z,v){return Z.s(v+".uv")||Z.s("all.uv")},getFaceUvOffset:function(R,t){return R.s(t+".uv.offset")||R.s("all.uv.offset")},getFaceUvScale:function(q,c){return q.s(c+".uv.scale")||q.s("all.uv.scale")},getFaceUvRotation:function(w,e){return w.s(e+".uv.rotation")||w.s("all.uv.rotation")},getFaceUvAnchor:function($,r){return $.s(r+".uv.anchor")||$.s("all.uv.anchor")},getFaceLight:function(H,K){var Y=H.s(K+".light");return Y==f?H.s("all.light"):Y},getFaceVisible:function(Y,q){var l=Y.s(q+".visible");return l==f?Y.s("all.visible"):l},getFaceOpacity:function(S,v){var l=S.s(v+".opacity");return l==f?S.s("all.opacity"):l},getFaceTransparent:function(b,O){var v=b.s(O+".transparent");return v==f?b.s("all.transparent"):v},getFaceReverseColor:function(A,y){return A.s(y+".reverse.color")||A.s("all.reverse.color")},getFaceReverseFlip:function(B,I){var V=B.s(I+".reverse.flip");return V==f?B.s("all.reverse.flip"):V},getFaceReverseCull:function(S,Y){var h=S.s(Y+".reverse.cull");return h==f?S.s("all.reverse.cull"):h},getTextureMap:function(){return this._2O},_2Oi:function(r,b,h){h=h||"";var J;(J=this._2O[r])||(J=this._2O[r]={}),J[h]=b},deleteTexture:function(P){var o=this;if(o._2O){var n=o._2O[P];if(n){delete o._2O[P];var y=o.getGL();for(var E in n)y.deleteTexture(n[E])}}},renderPickScene:function(){var t=this.getGL();this.syncRenderState(),this._picking=t._picking=!0,this.renderScene(),this._picking=t._picking=!1},invalidateCachedTexture:function(z){var y=this.getData3dUI(z);y.invalidateCachedTexture(this.getGL()),this.invalidateData(z)},invalidateShape3dCachedImage:function(X){this.invalidateCachedTexture(X)},invalidateCachedGeometry:function(P){var S=this.getData3dUI(P);S.invalidateCachedGeometry(),this.invalidateData(P)},isInteractive:function(s){return s.s("interactive")},getTexture:function(M,S,j,_){if(!M)return f;var J,$,v=this,B=v.getGL(),y=v._2O[M];if(y&&(S&&($=S.s("texture.mipmap.max")),J=y[$||""]||y.default),!J){var p=mr(M);if(_||(_={}),!p)return B._emptyTexture;if(S){_.mipmapMaxLevel=$=S.s("texture.mipmap.max");var h=S.s("texture.wrap");_.clampToEdge="clampToEdge"===h?!0:"repeat"===h?!1:E}if(p.uuid||(p.uuid=H.Math.generateUUID()),p.tagName){if(p.dynamic)return Nm(B,p,v._1O,_);J=Nm(B,p,E,_),v._2Oi(M,J,$)}else{var Q,u=S&&(S.s("texture.cache")||S.s("shape3d.image.cache")||p.textureCache),T=v.isVRPresenting();if(T&&(S._textureUpdateFrame===B._renderInfo.frame?u=!0:S._textureUpdateFrame=B._renderInfo.frame),u&&(Q=v.getData3dUI(S),J=Q.getCachedTexture(j),J&&Q.interactiveInfo&&J.interactiveInfo&&(Q.interactiveInfo[J.interactiveInfo.key]=J.interactiveInfo.info)),!J){var k=B._renderInfo.textureCache;if(u){if(k.time>L.graph3dMaxVectorCacheTime)return v.redraw(),B._emptyTexture;if(!fk(p,S))return B._emptyTexture}var b;S&&(1!==S.s("texture.scale")?b=S.s("texture.scale"):1!==S.s("shape3d.texture.scale")&&(b=S.s("shape3d.texture.scale"))),b||(b=1);var t=S&&(S.s("fixSizeOnScreen")||S.s("shape3d.fixSizeOnScreen")),U=t?B.NEAREST:B.LINEAR;t?"number"==typeof t&&(b*=0>t?1:t):S&&(S.s("vector.dynamic")||S.s("shape3d.vector.dynamic"))&&(Q||(Q=v.getData3dUI(S)),t=Q.getVectorDynamicSize());var s,P,o,d=S&&S.s("shape3d");"billboard"===d?o=S.getTall()/S.getWidth():"plane"===d&&(o=S.getHeight()/S.getWidth());var m=Bb(p,S);if(t){var n;n=u?v._devicePixelRatio||od:v.getDevicePixelRatio(),s=t[0]>0?t[0]*n:b*m*n,P=t[1]>0?t[1]*n:b*(o?qh(p,S,v,Math.min(4096,m*o)):qh(p,S))*n}else s=b*m,P=b*(o?qh(p,S,v,Math.min(4096,m*o)):qh(p,S));if(s>=1&&P>=1){var Y=0;(u||T)&&(Y=Date.now());var W=v._glCapabilities.maxTextureSize;s=Math.min(s,W),P=Math.min(P,W);var R=Mn(s,P);if(!Q&&S&&(Q=v.getData3dUI(S)),Q&&Q.interactiveInfo){var N=M;"object"==typeof N&&(N=N.uuid||(N.uuid=H.Math.generateUUID()));var A=Q.interactiveInfo[N]={};R.interactiveInfo=A.bodyInfo={compInfos:[],matrix:new Uo,rect:{x:0,y:0,width:s,height:P}}}Pi(R,p,0,0,s,P,S,v),R.interactiveInfo&&(R.interactiveInfo=null),R.restore(),k.count++,k.pixels+=s*P,S?(_.minFilter=Rr(S.s("texture.filter.min")||S.s("texture.filter"))||U,_.magFilter=Rr(S.s("texture.filter.mag")||S.s("texture.filter"))||U):_.minFilter=_.magFilter=U,u||T?(J=Nm(B,gr,null,_),Q.setCachedTexture(J,j),k.time+=Date.now()-Y,A&&(J.interactiveInfo={key:N,info:A}),gr=null):J=Nm(B,gr,v._1O,_)}}}}return J},redraw:function(){this.iv()},validateImpl:function(){var G=this;if(G._lightChanged){G._lightChanged=!1;var K=[],A=[],B=[];G.dm().each(function(v){if(Fh(v)){var n=v.s("light.type");n===Dn?K.push(v):n===ur?A.push(v):n===Cm&&B.push(v)}}),(K.length!==G._59O.length||A.length!==G._spots.length||B.length!==G._dirs.length)&&nc(G),G._59O=K,G._spots=A,G._dirs=B}var p=G.getAspect();p!==G.__cachedAspect__&&(G._updateSkybox({property:"asceptChanged"}),G.__cachedAspect__=p),G._42(),G._1o.iv()},getRenderInfo:function(){var I=this.getGL();return I?I._renderInfo:void 0},getDebugTip:function(){var d=this,E=d.getRenderInfo();if(E){var m=d.getGL()._validBufCount||0,L="Draw Calls: "+E.calls+"<br/>"+"Vertices: "+E.vertices+"<br/>"+"Faces: "+E.faces+"<br/>"+"Lines: "+E.lines+"<br/>"+(E.points?"Points: "+E.points+"<br/>":"")+"Buffers: "+m+"<br/>"+"Cache Models: "+b.keys(ld).length+"<br/>"+"Shape3d Models: "+b.keys(Xo).length;if(d.isVRPresenting()&&(L+="<br/>VR fps: "+d.vr.getFps()),E.textureCache){var U=E.textureCache.count;if(L+="<br/>2D Dynamic Textures: "+E.textureCache.count,U>0){var V,o=E.textureCache.pixels;V=o>1e6?Math.round(o/1e6)+"M":o>1e3?Math.round(o/1e3)+"K":Math.round(o),L+="<br/>2D Dynamic pixels: "+V}}return L}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var n=new H.Math.Box3,Z=new H.Math.Matrix4;return function(T){var f=T;if(f instanceof H.Data&&(f=this.getData3dUI(f)),!f.mat)return!0;var D=f.getBoundingBox();n.copy(D).applyMatrix4(Z.fromArray(f.mat));var h=this.getFrustum();return h.intersectsBox(n)}}(),updateScene:function(){var o=this;o._81O=f,o.overlappingBox.clear();var T=o._40Q;T.init();var p=o.getGL(),G=o.dm();if(G.isHierarchicalRendering())G.eachByHierarchical(function(d){var U=o.getData3dUI(d);U&&U.update(o,p,T)});else{var V,k,$,D=G.getDatas().getArray(),Z=D.length;for(V=0;Z>V;V++)k=D[V],$=o.getData3dUI(k),$&&$.update(o,p,T)}this._updateBoxClipperMatrix(),T.onUpdated()},_pushFrameRenderOptions:function(a){this._frameRenderOptionStack.push(this._currentFrameRenderOptions),this._currentFrameRenderOptions=a},_popFrameRenderOptions:function(){this._currentFrameRenderOptions=this._frameRenderOptionStack.pop()},_getFrameRenderOptions:function(b){var d=this._currentFrameRenderOptions;return d&&d[b]},getRenderLists:function(){return this._40Q},renderScene:function(H){function d(v,a){K.setGLState(v,a),K.setUniforms(v),K.renderState.attribs.disable(),j=s.directUniforms(),m=s.directAttribs(),m.disable()}function c(x){for(var o=!1;W>I;I++){var f=T[I];if(!p||!f.ignoreInPick){if(f.priority>=x)break;(!i._43Q[i._44Q=f.id]||Cj[cb.length])&&(f.render(b,i,K),d(),o=!0)}}return o}var i=this;i._pushFrameRenderOptions(H),i._getFrameRenderOptions("createShadowMap")!==!1&&i.shadowMap.render(),i.flowMap.render();var b=i.getGL();i._envmapRenderer.onBeforeRender(b),i._44Q=-1;var j,m,K=i._frameState,s=K.renderState,S=s.glState,M=i._prg;i._projectMatrix=So(i),Fp(i,i._7O),i._viewMatrix=Nd(i._7O),i.isReflecting(b)||Tq(i._projScreenMatrix=ue(),i._projectMatrix,i._viewMatrix),K.syncEnv(this._picking?this.pickColorMap:E),s.useProgram(M),d(!1,!0),b.clear(b.DEPTH_BUFFER_BIT);var p=i._picking,T=this._41Q,I=0,W=T.length;if(c(L.cameraPriority.skybox),p){var G=S.color.clear.slice(0);Ej(b,[0,0,0,0])}else Ej(b,[0,0,0,0]),S.blend.enabled=!1,S.depth.enabled=!1,S.depth.mask=!1,i._camera&&i._camera.s("camera.renderSky")===!1||i.drawSky(b,M),i._getFrameRenderOptions("renderReflector")!==!1&&i.drawReflectors(b)&&(i._projectMatrix=So(i),Fp(i,i._7O),i._viewMatrix=Nd(i._7O),K.syncEnv(),d()),S.blend.enabled=!1,S.depth.enabled=!0,S.depth.mask=!0,j.uTransparent=!1,i._getFrameRenderOptions("renderGrid")!==!1&&i._31O._42(b,M);if(!b.textureBatch||Cj[(ONE_FRAME_TIME-6)/2]){p||(i.shadowMap.enable&&i.shadowMap.createShadow(j),i.flowMap.createFlow(j));for(var N=0,R=ho.length;R>N;N++){var $=ho[N],t=ws[$];if(!(!i._camera&&t.ignore||i._camera&&!i._camera.isLayerVisible($))){var e=t.priority;c(e)&&(p||(i.shadowMap.enable&&i.shadowMap.createShadow(j),i.flowMap.createFlow(j))),this.renderLayer($)}}c(L.cameraPriority.infinity),p||i.flowMap.disableFlow(j),Nf(i,j,0,L.graph3dViewHeadlightAmbientIntensity),j.uHeadlightColor=[1,1,1,0],j.uUseEnvMap=!1,j.uHeadlightDirection=[0,0,0],j.uHeadlightRange=0,S.depth.enabled=!1,j.uTransparent=!1,j.shadowReceive=!1,Nk(i,j,Ee),p?i.drawFilter||i._30O._42(b,M):(i._highlightHelper._42(b,M),this._renderAxisAndEditHelper(i._getFrameRenderOptions("renderAxis")!==!1,i._getFrameRenderOptions("renderEdit")!==!1),S.blend.enabled=!1,S.depth.mask=!0),S.depth.enabled=!0,p&&Ej(b,G),zi(b,f),un(b,f),i._44Q=-1,i._popFrameRenderOptions(null)}},_renderAxisAndEditHelper:function(P,n){if(P||n){var o=this,D=o.getGL(),i=o._prg,I=o._frameState,K=I.renderState,z=K.glState,G=K.directUniforms();I.renderState.attribs.disable(),z.depth.enabled=!1,G.uTransparent=!1,G.shadowReceive=!1,z.blend.enabled=!1,z.depth.mask=!0,G.uPick=o._picking;var L=!o._fogDisabled;L&&(G.uFog=!1),P&&o._32O._42(D,i),n&&o._30O._42(D,i),L&&(G.uFog=!0),zi(D,f),un(D,f)}},renderLayers:function(R,W){W&&(R=Ud(R));for(var X=0,V=R.length;V>X;X++)this.renderLayer(R[X])},renderSky:function(){var P=this,n=P._frameState,m=n.renderState,I=m.glState,O=P.getGL(),Y=P._prg;P._projectMatrix=So(P),Fp(P,P._7O),P._viewMatrix=Nd(P._7O),Tq(P._projScreenMatrix=ue(),P._projectMatrix,P._viewMatrix),n.syncEnv(),m.useProgram(Y),n.setGLState(!1,!0),n.setUniforms(!1),n.renderState.attribs.disable(),O.clear(O.DEPTH_BUFFER_BIT),Ej(O,[0,0,0,0]),I.blend.enabled=!1,I.depth.enabled=!1,I.depth.mask=!1,P.drawSky(O,Y),I.depth.mask=!0,I.depth.enabled=!0,zi(O,f),un(O,f)
},addRenderLayerListener:function(R,p,c){var Z=this;Z._renderLayerNotifier||(Z._renderLayerNotifier=new Ef),Z._renderLayerNotifier.add(R,p,c)},removeRenderLayerListener:function(C,B){this._renderLayerNotifier&&this._renderLayerNotifier.remove(C,B)},fireRenderLayerEvent:function(S,j){var h=this._renderLayerNotifier;h&&h.fire({layer:S,phase:j})},renderLayer:function(L){var c=this,R=c._picking,G=c._40Q.get(L);if(G){c.fireRenderLayerEvent(L,"prepare");var d=c.getGL(),k=ws[L],r=c._frameState,H=r.renderState,Q=H.glState,S=H.directUniforms();!R&&c.isSortable()&&G.sort(c._sortFunc,c._projScreenMatrix);var K,I,U,O=G.opaque,D=G.transparent,s=G.batchModelMap,o=G.polylineModelMap,p=G.wireframeModelMap,d=c.getGL(),_=c._prg;R||(Q.blend.enabled=!1,Q.depth.enabled=!0,Q.depth.mask=!0),S.uTransparent=!1,k.clearDepth!==!1&&d.clear(d.DEPTH_BUFFER_BIT);var P=this.drawFilter;if(P)for(U=O,K=0,I=U.length;I>K;K++)P(U[K].data)!==!0&&U[K].ui._42(d,_,T);else{for(U=O,K=0,I=U.length;I>K;K++)U[K].ui._42(d,_,T);if(R)for(U=D,K=0,I=U.length;I>K;K++)U[K].ui._46Q(d);Qh(c,s),ki(c,o),ki(c,p)}if(R||(Q.blend.enabled=!0,Q.depth.mask=!1),c._45Q=S.uTransparent=!0,P)for(U=D,K=0,I=U.length;I>K;K++)P(U[K].data)!==!0&&U[K].ui._42(d,_,F);else{for(U=D,K=0,I=U.length;I>K;K++)U[K].ui._42(d,_,F);Qh(c,s,null,!0),ki(c,o,null,!0),ki(c,p,null,!0)}c._45Q=null,c.fireRenderLayerEvent(L,"post")}},_42:function(L,S){var y=this;if(!y._35O&&(!sc||Cj(sc))){var h=y.getWidth(),U=y.getHeight();if(h&&U){var q=y.getGL();if(q){var $,x=y._canvas;if(L?$=!0:L=y.getDevicePixelRatio(),!y._picking&&($||h!==x.clientWidth||U!==x.clientHeight)){Zq(x,h,U,L);var _=L;h&&Math.abs(q.drawingBufferWidth-h*L)>1&&(_=Math.min(_,q.drawingBufferWidth/h)),U&&Math.abs(q.drawingBufferHeight-U*L)>1&&(_=Math.min(_,q.drawingBufferHeight/U)),_!==L&&(y.setDevicePixelRatio(L=_),Zq(x,h,U,L)),y._18Q=null}q.clear(q.COLOR_BUFFER_BIT);var A=q._renderInfo;A.calls=0,A.vertices=0,A.faces=0,A.lines=0,A.points=0,A.textureCache={time:0,count:0,pixels:0},A.frame=++y._frameId,A.cacheTimeCost=0,A.reflectDepth=0,h*=L,U*=L,this.syncRenderState();do{if(y.isVREnabled()&&y.vr.render(q,h,U,S))break;if(y.updateScene(),y._postProcessing.render(q,h,U,S))break;y.setViewport(q,0,0,h,U),y.renderScene(S)}while(!1);y._33Q=!1,y.countFrame(),y._doBufferGC(q)}}}},syncRenderState:function(){var J,R;(J=this._frameState)&&(R=J.renderState)&&R.syncLoss()},drawReflectors:function(Y){Y._renderInfo.reflectDepth++;var G,y,O,E=this,B=E._dataModel.getReflectors(),_=!1;for(G in B)y=B[G],E.isVisible(y)&&(O=E.getData3dUI(y),O&&O.drawReflector&&O.drawReflector(Y)&&(_=!0));return Y._renderInfo.reflectDepth--,_},isReflecting:function(D){return D._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(e,G){return this._postProcessing.enableModule(e,G)},getPostProcessingModule:function(e){return this._postProcessing.getModule(e)},getPostProcessingValue:function(k,s){var z=this._postProcessing.getModule(k);return z?z[s]:E},setPostProcessingValue:function(Y,q,a){var y=this.getPostProcessingValue(Y,q),w=this._postProcessing.getModule(Y);w&&y!==a&&("enable"===q?this.enablePostProcessing(Y,a):w[q]=a,this.firePropertyChange("postProcessing."+Y+"."+q,y,a))},setDofImageFromGraphView:function(Q,u,W){return this._postProcessing.getModule("Dof").setImageFromGraphView(Q,u,W)},setViewport:function(_,c,Q,p,z){this._viewport=[c,Q,p,z],se.for(_).directState().viewport=this._viewport},getRenderState:function(){return se.for(this._26I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(f){this._bufferGCInterval=f},_doBufferGC:function(Y,P){var t,W,g=Y._bufPool,k=0,j=0,o=Y._renderInfo.frame,c=this._bufferGCInterval||10;for(t in g)k++,W=g[t],W&&(P||o-W._fid>c?(Y.deleteBuffer(W._buf),W._buf=null,g[t]=null):j++);if(k/2>j&&k>128){var X={};for(t in g)g[t]&&(X[t]=g[t]);Y._bufPool=X}Y._validBufCount=j},_swapLineMap:function(){var Y=this;em=Y._polylineModelMap,Y._polylineModelMap=Y._polylineModelMapSwap,Y._polylineModelMapSwap=em,em=Y._wireframeModelMap,Y._wireframeModelMap=Y._wireframeModelMapSwap,Y._wireframeModelMapSwap=em,em=Y._polylineIndexMap,Y._polylineIndexMap=Y._polylineIndexMapSwap,Y._polylineIndexMapSwap=em,em=Y._wireframeIndexMap,Y._wireframeIndexMap=Y._wireframeIndexMapSwap,Y._wireframeIndexMapSwap=em},_updateSkybox:function(L){if(this._skybox&&L){var w=L.property,S=!1,j=this._skybox;if("eye"===w||"forceUpdate"===w){var g=this._eye;j.p3(g[0],g[1],g[2]),S=!0}if("near"===w||"far"===w||"forceUpdate"===w||"asceptChanged"===w){var v=j.__cachedS3__;v||(v=j.__cachedS3__=j.getFinalScale3d());var b=Math.sqrt(3),K=1/0,u=-1/0;v.forEach(function(X){X/=2,K=h(X,K),u=p(X,u)}),u*=b;var s=this._near,X=this._far,y=Math.tan(this.getFovy()/2)*s,t=this.getAspect()*y,G=1.1*Math.sqrt(t*t+y*y+s*s),q=1;if(G>K)q=G/K;else if(u>=X){var T=X*X/(s+X);q=T/u}if(1!==q){j.__updatingSkybox__=!0;var z=v.map(function(Q){return q*Q});j.s3(z),j.setScale3d(1,1,1),S=!0,delete j.__updatingSkybox__}}S&&this.invalidateData(j)}},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(K){return this.setSkybox(K)},getSkybox:function(){return this._skybox},setSkybox:function(C){var M=this._skybox;if(M===C)return C&&this._updateSkybox({property:"forceUpdate"}),void 0;if(M&&(this._skyboxStyleMap&&M.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&M.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&M.p3(this._skyboxP3),this._skyboxP3=null,this.handleDataModelChange({kind:xk,data:M})),this._skybox=C,this.ump(this._updateSkybox,this),C){C.dm()&&C.dm().remove(C),this._skyboxStyleMap=H.Default.clone(C.getStyleMap()),this._skyboxAnchor3d=C.getAnchor3d(),C.setAnchor3d(.5,.5,.5),this._skyboxP3=C.p3().slice(0),C.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1});var v=C.onPropertyChanged;C.onPropertyChanged=function(h){v.call(C,h),!C.__updatingSkybox__&&["width","height","tall","scale","scaleTall"].indexOf(h.property)>=0&&(C.__cachedS3__=E)},this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})}this.fp("skybox",M,C)},drawSky:function(g,q){var K=this,O=K._skybox;if(O){var E=se.for(g).directUniforms(),W=K._headlightIntensity,m=$r(K._headlightColor),q=K._prg;1!==W&&(m=[m[0]*W,m[1]*W,m[2]*W]),E.uHeadlightColor=[m[0],m[1],m[2],1];var d=K.getData3dUI(O);if(d){var v=K.isOrtho(),u=v||this._computedProjectMatrix;if(u){var C=K._projectMatrix;v&&(K._ortho=!1),E.uPMatrix=K._projectMatrix=So(K,!0)}var y=O.p3(),V=this.getEye();(y[0]!==V[0]||y[1]!==V[1]||y[2]!==V[2])&&(O._position.x=V[0],O._54O=V[1],O._position.y=V[2]),d.validate(),d._42(g,q,X),u&&(v&&(K._ortho=!0),E.uPMatrix=K._projectMatrix=C)}g.clear(g.DEPTH_BUFFER_BIT),E.uHeadlightColor=[m[0],m[1],m[2],K._headlightDisabled?1:0]}},getLogicalPoint:function(v){return Gm(v,this._canvas)},isRectOverlapping:function($){var o=this.getData3dUI($);return o._rectOverlapping},getHitFaceInfo:function(X){X.target&&(X=this.lp(X));var O=this.getDataInfoAt(X);if(O){var G=this.intersectObject(X,O.data);if(G)return{data:O.data,face:G.part}}return f},unproject:function(O,c){var p=this,x=p.getWidth(),A=p.getHeight(),G=O.target?p.lp(O):O,a=G.x-x/2,J=G.y-A/2,q=2*(a/x),L=2*(-1*J/A);c=c||0;var M=ue(),X=So(p),I=Fp(p);Tq(M,X,I),tj(M);var l=zm([q,L,c,1],M);return[l[0]/l[3],l[1]/l[3],l[2]/l[3]]},getDataAt:function(P){var e=this.getDataInfoAt(P);return e?e.data:f},getDataInfoAt:function(j,U,h){return j.target&&(j=this.lp(j)),this._1o.get(Yh(j.x,j.y,U),!0,h)},getDatasInRect:function(l,B){return this._1o.get(l,!1,B)},setEditable:function(O){var D=this,g=D._editable;D._editable=O,this.fp(Gh,g,O)},isEditable:function(D){var v=this;return D?v._editable?mq(D)?D.s("3d.editable")?v._editableFunc?v._editableFunc(D):!0:!1:!1:!1:v._editable},isSelectable:function($){return $.s("3d.selectable")&&this.sm().isSelectable($)},isMovable:function(U){var t=this;return Op(U)&&U.getStyle(uo)!==we?!1:U.s("3d.movable")?t._movableFunc?t._movableFunc(U):!0:!1},isSizeEditable:function(A){return mq(A)?this._sizeEditableFunc?this._sizeEditableFunc(A):!0:!1},isRotationEditable:function(u){return mq(u)&&u.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(u):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(p){this.setZoom(Yj,p)},zoomOut:function(Q){this.setZoom(1/Yj,Q)},setZoom:function(){var g=new np,p=new np,F=new np,O=new np;return function(k,X){if(1!==k){var S=this;S._14o&&S._14o.stop(!0);var t,A=1/k;g.copy(S.getCenter()),p.copy(S.getEye());var C=S._ortho;if(C){if(t=S._orthoWidth,t<S._moveStep&&k>1)return}else if(g.distanceTo(p)<S._moveStep&&1>A)return;var P=!1;return S._zoomToCenter===!1&&S._lastZoomLP&&(F.copy(p).sub(g).normalize(),S._81O=null,O.copy(S.getHitPosition(S._lastZoomLP,g.toArray(),F.toArray())),P=!0,S._lastZoomHit=O),(X=Oj(X))?(X.action=function(Z){S.fi({kind:S._zooming?"betweenZoom":"beginZoom"}),S._zooming=1;var K=(A-1)*Z+1;C&&S.setOrthoWidth(t*K),P?(S.setEye(F.lerpVectors(O,p,K).toArray()),S.setCenter(F.lerpVectors(O,g,K).toArray())):C||S.setEye(F.lerpVectors(g,p,K).toArray())},X._37o=function(){delete S._14o,delete S._zooming,S.fi({kind:"endZoom"}),S.onZoomEnded()},S._14o=xo(X)):(C&&S.setOrthoWidth(t*A),P?(S.setEye(F.lerpVectors(O,p,A).toArray()),S.setCenter(F.lerpVectors(O,g,A).toArray())):C||S.setEye(F.lerpVectors(g,p,A).toArray()),void 0)}}}(),setOrthoZoom:function(w,m){return this.setZoom(w,m)},getPositionInfo:function(D){var i=this,Z=i._eye,q=i._center,w=i.getAspect(),$=D?Cl(ch(q,Z,!0),ch(D,Z)):Mp(Z,q);if(i._ortho){var s=i._orthoWidth;return{length:$,height:s/w,width:s}}var y=2*Kc(i._fovy/2)*$;return{length:$,height:y,width:y*w}},getCenterInfo:function(){var K=this;return K._81O||(K._81O=K.getPositionInfo()),ys(K._81O)},rotate:function(l,S,i,Z){var A=this;if(l||S){Z==f&&(Z=A._firstPersonMode),A._88O&&A._88O.stop(!0);var F=A._center,T=A._eye,E=A.getCenterInfo().length,w=Z?F:T,V=Z?T:F,o=ch(w,V),U=ts(o[0],o[2]),N=ts(G(o[0]*o[0]+o[2]*o[2]),o[1]),x=Z?bb:uh;return Z&&(S=-S),(i=Oj(i))?(i.action=function(e){A.fi({kind:A._rotating?"betweenRotate":"beginRotate"}),A._rotating=1;var p=U+l*e,P=N+S*e;P=Z?O-po(A,O-P):po(A,P),o[0]=E*B(P)*B(p),o[1]=E*J(P),o[2]=E*B(P)*J(p),w[0]=V[0]+o[0],w[1]=V[1]+o[1],w[2]=V[2]+o[2],A.fp(x,f,w)},i._37o=function(){delete A._88O,delete A._rotating,A.fi({kind:"endRotate"}),A.onRotateEnded()},A._88O=xo(i)):(U+=l,N+=S,N=Z?O-po(A,O-N):po(A,N),o[0]=E*B(N)*B(U),o[1]=E*J(N),o[2]=E*B(N)*J(U),w[0]=V[0]+o[0],w[1]=V[1]+o[1],w[2]=V[2]+o[2],A.fp(x,f,w),void 0)}},pan:function(E,p,u,V){if(E||p){var m=this;V==f&&(V=m._firstPersonMode),m._89O&&m._89O.stop(!0);var N=Fp(m),D=[N[0]*E,N[4]*E,N[8]*E],K=[N[1]*p,N[5]*p,N[9]*p],z=D[0]+K[0],v=D[1]+K[1],y=D[2]+K[2],o=m._center,A=m._eye;if(V){var J=Li(m.getBoundaries(),A[0],A[2],A[0]+z,A[2]+y,G(z*z+y*y));z=J[0],y=J[1]}if(u=Oj(u)){var Z=ys(A),q=ys(o);return u.action=function(J){m.fi({kind:m._panning?"betweenPan":"beginPan"}),m._panning=1,o[0]=q[0]+z*J,o[1]=q[1]+v*J,o[2]=q[2]+y*J,A[0]=Z[0]+z*J,A[1]=Z[1]+v*J,A[2]=Z[2]+y*J,m.fp(uh,f,A),m.fp(bb,f,o)},u._37o=function(){delete m._89O,delete m._panning,m.fi({kind:"endPan"}),m.onPanEnded()},m._89O=xo(u)}o[0]+=z,o[1]+=v,o[2]+=y,A[0]+=z,A[1]+=v,A[2]+=y,m.fp(uh,f,A),m.fp(bb,f,o)}},walk:function(u,v,y){if(u){var c=this;y==f&&(y=c._firstPersonMode),c._90O&&c._90O.stop(!0);var E=c._center,L=c._eye,R=ch(E,L,!0);if(y){var o=Li(c.getBoundaries(),L[0],L[2],L[0]+R[0]*u,L[2]+R[2]*u,a(u));if(u=Mp(o),!u)return;R=[o[0]/u,0,o[1]/u]}if(v=Oj(v)){var t=ys(L),X=ys(E);return v.action=function(U){c.fi({kind:c._walking?"betweenWalk":"beginWalk"}),c._walking=1;var $=u*U;L[0]=t[0]+R[0]*$,L[1]=t[1]+R[1]*$,L[2]=t[2]+R[2]*$,E[0]=X[0]+R[0]*$,E[1]=X[1]+R[1]*$,E[2]=X[2]+R[2]*$,c.fp(uh,f,L),c.fp(bb,f,E)},v._37o=function(){delete c._90O,delete c._walking,c.fi({kind:"endWalk"}),c.onWalkEnded()},c._90O=xo(v)}L[0]+=R[0]*u,L[1]+=R[1]*u,L[2]+=R[2]*u,E[0]+=R[0]*u,E[1]+=R[1]*u,E[2]+=R[2]*u,c.fp(uh,f,L),c.fp(bb,f,E)}},handleScroll:function(k,d){Lk(k);var h=this,j=h._moveStep,Y=h.getDataInfoAt(k);if(Y){var $=Y.data;if($&&h.isInteractive($)){var c=h.intersectObject(k,$);if(c){var U=c.part,N=mr($.s(U+".image")||$.s("shape3d."+U+".image")||$.s("all.image")||$.s("shape3d.image"));if(N&&kh(N.scrollable,$,h))return}}}return h.isFirstPersonMode()?(h.isPannable()&&h.pan(0,d>0?j:-j),void 0):(h.isZoomable()&&(h._lastZoomLP=h.lp(k),h.setZoom(0>d?1/Jb:Jb),h._lastZoomLP=h._lastZoomHit=null),void 0)},handlePinch:function(I,N){if(this.isZoomable()){if(Math.abs(I-N)<L.pinchZoomThreshold)return;this.setZoom(N>I?1/vl:vl)}},reset:function(Q){this.setUp(L.graph3dViewUp),this.moveCamera(L.graph3dViewEye,L.graph3dViewCenter,Q)},moveSelection:function(A,u,l){var t=this;t.dm().beginTransaction(),Lp(this.sm().toSelection(this.isMovable,this),A,u,l),t.dm().endTransaction()},getMoveMode:function(F,r){var i=r.s("3d.move.mode");if(i)return i;var N="88",l="89",E="90";return An(F)||Go[N]&&Go[l]&&Go[E]?"xyz":Go[N]&&Go[l]?"xy":Go[N]&&Go[E]?"xz":Go[l]&&Go[E]?"yz":Go[N]?"x":Go[l]?"y":Go[E]?"z":"xz"},handleTick:function(){var i=this,Q=!1,J=i._moveStep,p=J,u=!1,$=!0,M=i._rotateStep*($?-1:1);if(i.isWalkable()||(p=0),i.isPannable()||(J=0),i.isRotatable()||(M=0),i._32Q){var N=(ek()-i._32Q)/50;p*=N,J*=N,M*=N}i._31Q&&(zo(i._31Q),delete i._31Q,delete i._32Q),wl()&&(Q=!0,i.pan(-J,0,u,$)),Pe()&&(Q=!0,i.pan(J,0,u,$)),Nl()&&(Q=!0,An()?i.pan(0,J,u,$):i.walk(p,u,$)),dl()&&(Q=!0,An()?i.pan(0,-J,u,$):i.walk(-p,u,$)),Ff()&&(Q=!0,i.rotate(-M,0,u,$)),Te()&&(Q=!0,i.rotate(M,0,u,$)),Tf()&&(Q=!0,i.rotate(0,-M/2,u,$)),rl()&&(Q=!0,i.rotate(0,M/2,u,$)),Q&&(i._32Q=ek(),i._31Q=Un(i.handleTick,i))},handleKeyDown:function(H){var Y=this;!vf(H)&&of[H.keyCode]?Y.handleTick():Qq(H)?Y.selectAll():xh(H)?Y.handleDelete(H):Xc(H)&&this.isResettable()&&Y.reset()},checkDoubleClickOnNote:function(M,E,T){var y=this;if(T===Ap){if(E.s("note.toggleable"))return E.s(lb,!E.s(lb)),y.fi({kind:"toggleNote",event:M,data:E,part:T}),!0}else if(T===uj&&E.s("note2.toggleable"))return E.s(pe,!E.s(pe)),y.fi({kind:"toggleNote2",event:M,data:E,part:T}),!0;return!1},checkDoubleClickOnRotation:function(q,o,x){return x===at?(o.setRotationX(0),!0):x===bt?(o.setRotationY(0),!0):x===ct?(o.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(t){var e=this;if(e.isOrtho())return e.getWidth()/e.getOrthoWidth();var s=e.getCenter(),N=e.getHeight(),n=e.getEye(),l=[s[0]-n[0],s[1]-n[1],s[2]-n[2]],i=[t[0]-n[0],t[1]-n[1],t[2]-n[2]],K=Math.sqrt(l[0]*l[0]+l[1]*l[1]+l[2]*l[2]),d=1/Math.tan(e.getFovy()/2);return N*K*d/(i[0]*l[0]+i[1]*l[1]+i[2]*l[2])},inViewSpace:function(F){var O,h=this,o=h._transformPointToViewSpace(F),s=h.getAspect(),R=h.getNear(),w=h.getFar();return-o[2]<R||-o[2]>w?!1:h.isOrtho()?(O=h.getOrthoWidth()/2,Math.abs(o[0])<=O&&Math.abs(o[1]*s)<=O):(O=Math.sqrt(o[0]*o[0]+o[1]*o[1]+o[2]*o[2])*Math.tan(h.getFovy()/2),Math.abs(o[1]<=O)&&Math.abs(o[0])<=O*s)},getPVMatrix:function(){var J,e=this;return(J=e._18Q)||(J=So(e),e._18Q=Tq(J,J,Fp(e)),e._18Q._wh=e.getWidth()/2/e.getHeight()),J},getFrustum:function(){var d=new jf,s=new lc,K=new Array(16);return function(){for(var Z=this.getPVMatrix(),h=!1,C=0;16>C;C++)Z[C]!==K[C]&&(h=!0,K[C]=Z[C]);return h&&s.setFromMatrix(d.fromArray(Z)),s}}(),toViewPosition:function(S){var $=this,L=$.getWidth()/2,p=$.getHeight()/2,X=$.getPVMatrix();return S=zm([S[0],S[1],S[2],1],X),{x:L+L*S[0]/S[3],y:p-p*S[1]/S[3],z:S[2]/S[3]}},getHitPosition:function($,S,F){var H=this,n=H.getWidth(),h=H.getHeight(),s=$.target?H.lp($):$,V=s.x-n/2,q=s.y-h/2,i=H.getCenterInfo(),Q=Fp(H);S=S?S:[0,0,0],F=F?F:[0,1,0],V=V/n*i.width,q=-1*q/h*i.height;var O=[Q[0]*V,Q[4]*V,Q[8]*V],p=[Q[1]*q,Q[5]*q,Q[9]*q],U=[O[0]+p[0],O[1]+p[1],O[2]+p[2]],d=H.getCenter(),C=Lm(H,S,F,[U[0]+d[0],U[1]+d[1],U[2]+d[2]]);return C?C:[0,0,0]},intersectObject:function(L,y){return this._raycaster.intersectObject(L,y)},intersectObjects:function(i,n,U){return this._raycaster.intersectObjects(i,n,U)},getLineLength:function($){this.validate();var j=this.getData3dUI($);if(j&&j.getCache){var G=j.getCache();if(G)return G[G.length-1].length}return 0},getLineOffset:function(H,n){var b=this.getData3dUI(H);if(b&&b.getCache){var L=b.getCache();if(L){var E=Gd(L,n);if(H.s("shape3d")!==Fn)return E;var y,Y;if(H.getScale3d&&(y=H.getScale3d(),1===y[0]&&1===y[1]&&1===y[2]&&(y=null)),H.r3&&(Y=H.r3(),0===Y[0]&&0===Y[1]&&0===Y[2]&&(Y=null)),!Y&&!y)return E;var k=new np(H.p3()),v=new np(E.point).sub(k),N=new np(E.tangent).add(v);if(y&&(y=new np(y),v.multiply(y),N.multiply(y)),Y){var X=(new _n).setFromEuler(new Fk(Y,H.getRotationMode(),!0));v.applyQuaternion(X),N.applyQuaternion(X)}return{point:v.clone().add(k),tangent:N.sub(v).normalize()}}}return f},_genBatchInstancedArrayFunc:function(){var R=this._glCapabilities&&this._glCapabilities.instancedArray&&!this._batchInstancedDisabled,z=R?Mm:Pj;this.batchInstancedModel=function(I,j,y,r,C,n,m){z(this,I,j,y,r,C,n,m)};var n=R?Hn:Sg;this.batchInstancedShapeFace=function(S,r,Y){n(S,r,Y)};var B=R?df:Ch;this.batchInstancedFace=function(W,T,v,C,E){B(this,W,T,v,C,E)}},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(X,c,V){var q=this,D=q.getEye();D=[D[0],D[1],D[2]];var C=q.getCenter();if(C=[C[0],C[1],C[2]],X||(X=D),c||(c=C),q._flyAnim&&q._flyAnim.stop(!0),V=Oj(V),!V)return q.setEye(X[0],X[1],X[2]),q.setCenter(c[0],c[1],c[2]),delete q._flyAnim,!0;var t=[X[0]-D[0],X[1]-D[1],X[2]-D[2]],S=[c[0]-C[0],c[1]-C[1],c[2]-C[2]];return V.action=function(l){q.setCenter(C[0]+S[0]*l,C[1]+S[1]*l,C[2]+S[2]*l),q.setEye(D[0]+t[0]*l,D[1]+t[1]*l,D[2]+t[2]*l)},V._37o=function(){delete q._flyAnim},q._flyAnim=xo(V)},flyTo:function(){function Y(d,M,k){if(k instanceof H.Node){Q.fromArray(ec(k,M.getMat(k)));var w=k.getAnchor3d();d.push((new np).set(0-w.x,0-w.y,0-w.z).applyMatrix4(Q)),d.push((new np).set(0-w.x,0-w.y,1-w.z).applyMatrix4(Q)),d.push((new np).set(0-w.x,1-w.y,0-w.z).applyMatrix4(Q)),d.push((new np).set(0-w.x,1-w.y,1-w.z).applyMatrix4(Q)),d.push((new np).set(1-w.x,0-w.y,0-w.z).applyMatrix4(Q)),d.push((new np).set(1-w.x,0-w.y,1-w.z).applyMatrix4(Q)),d.push((new np).set(1-w.x,1-w.y,0-w.z).applyMatrix4(Q)),d.push((new np).set(1-w.x,1-w.y,1-w.z).applyMatrix4(Q))}}var h=new np,R=new np,M=new np,w=new np,u=new np,Q=new jf,F=new H.Math.Quaternion,a=new Fk,z=new us;return function(N,I,g){var b=this;"boolean"==typeof I&&(I={animation:I}),I=I||{};var C=I.center,i=I.distance,x=I.direction,v=I.worldDirection,y=g||I.ratio||.8,S=I.xRatio||y,l=I.yRatio||y;(g!==E||I.duration||I.frames)&&(I={animation:I});var X,s,m=[],K=i===E;if(C&&M.fromArray(C),!C||K)if(N||(N=b.dm().getDatas()),1===N.length&&(N=Zc(N)?N.get(0):N[0]),N instanceof H.Node)C||M.fromArray(N.p3()),K&&(Y(m,b,N),X=m.length);else{if(!N.length)return;if((K||!C)&&(m=[],N.forEach(function(g){Y(m,b,g)}),X=m.length,!X))return;C||(z.setFromPoints(m),M.copy(z.min).add(z.max).multiplyScalar(.5))}if(b._flyAnim&&b._flyAnim.stop(!0),h.fromArray(b.getEye()),R.fromArray(b.getCenter()),b.setCenter(M.x,M.y,M.z),w.subVectors(h,R),x||v){!v&&N instanceof H.Node?F.setFromEuler(a.set(N.r3(),N.getRotationMode(),!0)):F.set(0,0,0,1);var k=w.length();w.fromArray(v||x).applyQuaternion(F).setLength(k)}var q=new np(b.getUp()),p=xc.fequal(q.x,0,1e-5)&&xc.fequal(q.z,0,1e-5);if(p&&0===w.x&&0===w.z){var f=.001,j=w.y;w.y=j*(1-f),w.z=Math.sign(j)*f}var U=0;if(K){var e,J,G,W=S,O=l;if(u.copy(w),b.isOrtho()){var d=-1/0;for(b._eye[0]=w.x+M.x,b._eye[1]=w.y+M.y,b._eye[2]=w.z+M.z,e=So(b),Tq(e,e,Fp(b)),s=0;X>s;s++)G=m[s],J=zm([G.x,G.y,G.z,1],e),d=Math.max(d,Math.max(Math.abs(J[0])/W,Math.abs(J[1])/O));U=b.getOrthoWidth()*d}else{for(var r,V,c=b.getNear(),D=10;D--;){for(b._eye[0]=w.x+M.x,b._eye[1]=w.y+M.y,b._eye[2]=w.z+M.z,e=So(b),Tq(e,e,Fp(b)),r=!0,V=-1/0,s=0;X>s;s++){if(G=m[s],J=zm([G.x,G.y,G.z,1],e),J[3]<c&&D){w.multiplyScalar(2),r=!1;break}V=Math.max(V,Math.max(Math.abs(J[0])/W,Math.abs(J[1])/O)-J[3])}if(r)break}w.setLength(V+w.length())}w.manhattanLength()<1e-6&&w.copy(u)}else w.setLength(i);var T=w.add(M),o=Oj(I.animation);if(o){b.setEye(h.x,h.y,h.z),b.setCenter(R.x,R.y,R.z);var Q=T.clone().sub(M),$=Q.length();$&&Q.multiplyScalar(1/$);var B=h.clone().sub(R),n=B.length();n&&B.multiplyScalar(1/n);var P=(new jf).lookAtDirection(B,q),Z=(new jf).lookAtDirection(Q,q),A=(new _n).setFromRotationMatrix(P),_=(new _n).setFromRotationMatrix(Z),t=(new np).subVectors(M,R);if(U)var Bo=b.getOrthoWidth();var ac=new np,xd=new np,lp=new np,eh=o.action,ys=o._37o,js=R.clone();return o.action=function(p,f){xd.copy(js).addScaledVector(t,p);var h=A.clone().slerp(_,p);ac.set(0,0,1).applyQuaternion(h).setLength(n+($-n)*p).add(xd),lp.set(0,1,0).applyQuaternion(h),b.setCenter(xd.x,xd.y,xd.z),b.setEye(ac.x,ac.y,ac.z),b.setUp(lp.x,lp.y,lp.z),U&&b.setOrthoWidth((U-Bo)*p+Bo),eh&&eh(p,f)},o._37o=function(){delete b._flyAnim;var A=b.getUp(),c=p?L.graph3dViewUp:q.toArray();(A[0]!==c[0]||A[1]!==c[1]||A[2]!==c[2])&&b.setUp(c),ys&&ys()},{lastEye:h,lastCenter:R,eye:T,center:M,orthoWidth:U,animation:b._flyAnim=xo(o)}}return b.setEye(T.x,T.y,T.z),b.setCenter(M.x,M.y,M.z),U&&b.setOrthoWidth(U),delete b._flyAnim,{lastEye:h,lastCenter:R,eye:T,center:M,orthoWidth:U}}}(),getBoundingBox:function(){function I(J,Q,T){d.fromArray(ec(T,Q.getMat(T)));var p=T.getAnchor3d();J.push((new np).set(0-p.x,0-p.y,0-p.z).applyMatrix4(d)),J.push((new np).set(0-p.x,0-p.y,1-p.z).applyMatrix4(d)),J.push((new np).set(0-p.x,1-p.y,0-p.z).applyMatrix4(d)),J.push((new np).set(0-p.x,1-p.y,1-p.z).applyMatrix4(d)),J.push((new np).set(1-p.x,0-p.y,0-p.z).applyMatrix4(d)),J.push((new np).set(1-p.x,0-p.y,1-p.z).applyMatrix4(d)),J.push((new np).set(1-p.x,1-p.y,0-p.z).applyMatrix4(d)),J.push((new np).set(1-p.x,1-p.y,1-p.z).applyMatrix4(d))}var d=new jf;return function(t){if(t=t||this.sm().getSelection(),t instanceof H.Node&&(t=[t]),0===t.length)return f;var P=[];t.forEach(function(O){mq(O)&&I(P,this,O)},this);var O=[1/0,1/0,1/0],G=[-1/0,-1/0,-1/0];return P.forEach(function(s){O[0]=Math.min(s.x,O[0]),O[1]=Math.min(s.y,O[1]),O[2]=Math.min(s.z,O[2]),G[0]=Math.max(s.x,G[0]),G[1]=Math.max(s.y,G[1]),G[2]=Math.max(s.z,G[2])}),{min:O,max:G}}}(),setBatchInfo:function(G,U){var N=this._batchInfoMap[G];this._batchInfoMap[G]=U,this.fp("batchInfo",N,U)},getBatchInfo:function(n){return this._batchInfoMap[n]||gb[n]},setOrthoWidth:function(M){var d=this._orthoWidth;if(this._orthoWidth=M,this._syncEyeWithOrthoWidth){var b=M/this.getAspect(),i=b/2/Kc(this.getFovy()/2),s=(new np).fromArray(this.getEye()),C=(new np).fromArray(this.getCenter());s.sub(C).setLength(i).add(C),this.setEye(s.toArray())}this.fp("orthoWidth",d,M)},getCamera:function(N){var X=this;N||(N=X._mainCamera,N||(N=X._mainCamera=new H.Camera)),N.s({"camera.type":X.isOrtho()?"ortho":"perspective","camera.aspect":X.getAspect(),"camera.fovy":X.getFovy(),"camera.ortho.width":X.getOrthoWidth(),"camera.near":X.getNear(),"camera.far":X.getFar()});var l=X.getEye();return N.p3(l.slice()),N.lookAt(X.getCenter(),X.getUp()),N},resetHeadlightProperties:function(){this._headlightColor=L.graph3dViewHeadlightColor,this._headlightIntensity=L.graph3dViewHeadlightIntensity,this._headlightRange=L.graph3dViewHeadlightRange,this._headlightDirection=L.graph3dViewHeadlightDirection,this._headlightGroup=L.graph3dViewHeadlightGroup,this._headlightAmbientIntensity=L.graph3dViewHeadlightAmbientIntensity,this._headlightDisabled=L.graph3dViewHeadlightDisabled},resetFogProperties:function(){this._fogDisabled=L.graph3dViewFogDisabled,this._fogMode=L.graph3dViewFogMode,this._fogDensity=L.graph3dViewFogDensity,this._fogColor=L.graph3dViewFogColor,this._fogNear=L.graph3dViewFogNear,this._fogFar=L.graph3dViewFogFar}}),function(){function m(U,s,$){var Y=U[s];Y&&Y.releaseTexture(),U[s]=$}function $(){return["\n #ifdef ENVMAP_TYPE_CUBE_UV \n","#define cubeUV_maxMipLevel 8.0 \n","#define cubeUV_minMipLevel 4.0 \n","#define cubeUV_maxTileSize 256.0 \n","#define cubeUV_minTileSize 16.0 \n","float getFace(vec3 direction) {","vec3 absDirection = abs(direction);","float face = - 1.0;","if (absDirection.x > absDirection.z) {","if (absDirection.x > absDirection.y)","face = direction.x > 0.0 ? 0.0 : 3.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","} else {","if (absDirection.z > absDirection.y) ","face = direction.z > 0.0 ? 2.0 : 5.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","}","return face;","} ","vec2 getUV(vec3 direction, float face) {","vec2 uv;","if (face == 0.0) {","uv = vec2(direction.z, direction.y) / abs(direction.x);","} else if (face == 1.0) {","uv = vec2(- direction.x, - direction.z) / abs(direction.y);","} else if (face == 2.0) {","uv = vec2(- direction.x, direction.y) / abs(direction.z);","} else if (face == 3.0) {","uv = vec2(- direction.z, direction.y) / abs(direction.x);","} else if (face == 4.0) {","uv = vec2(- direction.x, direction.z) / abs(direction.y);","} else {","uv = vec2(direction.x, direction.y) / abs(direction.z);","}","return 0.5 * (uv + 1.0);","} ","vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {","float face = getFace(direction);","float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);","mipInt = max(mipInt, cubeUV_minMipLevel);","float faceSize = exp2(mipInt);","float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);","vec2 uv = getUV(direction, face) * (faceSize - 1.0);","vec2 f = fract(uv);","uv += 0.5 - f;","if (face > 2.0) {","uv.y += faceSize;","face -= 3.0;","}","uv.x += face * faceSize;","if (mipInt < cubeUV_maxMipLevel) {","uv.y += 2.0 * cubeUV_maxTileSize;","}","uv.y += filterInt * 2.0 * cubeUV_minTileSize;","uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);","uv *= texelSize;","vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x += texelSize;","vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.y += texelSize;","vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x -= texelSize;","vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","vec3 tm = mix(tl, tr, f.x);","vec3 bm = mix(bl, br, f.x);","return mix(tm, bm, f.y);","}","\n #define r0 1.0 \n","#define v0 0.339 \n","#define m0 - 2.0 \n","#define r1 0.8 \n","#define v1 0.276 \n","#define m1 - 1.0 \n","#define r4 0.4 \n","#define v4 0.046 \n","#define m4 2.0 \n","#define r5 0.305 \n","#define v5 0.016 \n","#define m5 3.0 \n","#define r6 0.21 \n","#define v6 0.0038 \n","#define m6 4.0 \n","float roughnessToMip(float roughness) {","float mip = 0.0;","if (roughness >= r1) {","mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;","} else if (roughness >= r4) {","mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;","} else if (roughness >= r5) {","mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;","} else if (roughness >= r6) {","mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;","} else {","mip = - 2.0 * log2(1.16 * roughness);","}","return mip;","} ","vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {","float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);","float mipF = fract(mip);","float mipInt = floor(mip);","vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);","if (mipF == 0.0) {","return vec4(color0, 1.0);","} else {","vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);","return vec4(mix(color0, color1, mipF), 1.0);","}","} ","\n #endif \n"].join("")}function R(){return["vec4 sRGBToLinear( in vec4 value ) {","return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );","}","vec4 LinearTosRGB( in vec4 value ) {","return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );","}","vec4 inputTexelToLinear( vec4 value ) { return sRGBToLinear( value ); }","vec4 linearToOutputTexel( vec4 value ) { return LinearTosRGB( value ); }","vec4 envMapTexelToLinear( vec4 color ) { return inputTexelToLinear( color ); }"].join("")}function B(){return["precision mediump float;\n","precision mediump int;\n","attribute vec3 position;","attribute vec2 uv;","attribute float faceIndex;","varying vec3 vOutputDirection;","vec3 getDirection( vec2 uv, float face ) {","uv = 2.0 * uv - 1.0;","vec3 direction = vec3( uv, 1.0 );","if ( face == 0.0 ) { direction = direction.zyx; } ","else if ( face == 1.0 ) { direction = direction.xzy; direction.xz *= -1.0; } ","else if ( face == 2.0 ) { direction.x *= -1.0; }","else if ( face == 3.0 ) { direction = direction.zyx; direction.xz *= -1.0; } ","else if ( face == 4.0 ) { direction = direction.xzy; direction.xy *= -1.0; } ","else if ( face == 5.0 ) { direction.z *= -1.0; }","return direction;","}","void main() {","vOutputDirection = getDirection( uv, faceIndex );","gl_Position = vec4( position, 1.0 );","}"].join("")}function z(){return{vs:B(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform samplerCube envMap;\n",R(),"\n void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3(- vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function O(){return{vs:B(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform vec2 texelSize;\n",R(),"\n #define RECIPROCAL_PI 0.3183098861837907 \n","\n #define RECIPROCAL_PI2 0.15915494309189535 \n","vec2 equirectUv( in vec3 dir ) {","float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;","float v = 0.5 - asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI;","return vec2( u, v );","}","void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","vec3 outputDirection = normalize( vOutputDirection );","vec2 uv = equirectUv( outputDirection );","vec2 f = fract( uv / texelSize - 0.5 );","uv -= f * texelSize;","vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x += texelSize.x;","vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.y += texelSize.y;","vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x -= texelSize.x;","vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","vec3 tm = mix( tl, tr, f.x );","vec3 bm = mix( bl, br, f.x );","gl_FragColor.rgb = mix( tm, bm, f.y );","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function q(P){return{vs:B(),fs:["precision mediump float;\n","precision mediump int;\n","#define n "+P+"\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform int samples;","uniform float weights[ n ];","uniform bool latitudinal;","uniform float dTheta;","uniform float mipInt;","uniform vec3 poleAxis; \n",R(),"\n #define ENVMAP_TYPE_CUBE_UV \n",$(),"\n vec3 getSample( float theta, vec3 axis ) {","float cosTheta = cos( theta );","vec3 sampleDirection = vOutputDirection * cosTheta + cross(axis, vOutputDirection) * sin(theta) + axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);","return bilinearCubeUV( envMap, sampleDirection, mipInt );","}","void main() {","vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );","if ( all( equal( axis, vec3( 0.0 ) ) ) ) {","axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );","}","axis = normalize( axis );","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );","for ( int i = 1; i < n; i++ ) {","if ( i >= samples ) { break; }","float theta = dTheta * float( i );","gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );","gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );","}","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}var X=nj.EnvmapRenderer=function(O){this.gv=O,this._envmaps={},this._envmapHash={},this._probeCaptureTime={},this._pingPongRenderTarget=null,this._equirectShader=null,this._cubemapShader=null,this._blurMaterial=null,this._lastCaptureFrame=0
};X.prototype={},X.prototype.constructor=X,X.prototype.changeEnvmapType=function(S){"legacy"===S?(this.setEnvmapByProbeId=this.setEnvmapLegacy,this.onBeforeRender=this.onBeforeRenderLegacy):(this.setEnvmapByProbeId=this.setEnvmap,this.onBeforeRender=this.onBeforeRenderNew)},X.prototype.invalidateEnvmap=function(m){var C=this.gv;if("legacy"!==C.getEnvmapType()){var i=C.getGL();i&&(m?(delete this._envmapHash[m],delete this._probeCaptureTime[m]):(this._envmapHash={},this._probeCaptureTime={}),C.iv())}},X.prototype.contextLost=function(){var R=this;R._envmaps={},R._envmapHash={},R._pingPongRenderTarget=null,R._equirectShader=R._cubemapShader=R._blurMaterial=null,R._envmapLegacy=null,R._lastLegacyImage=null},X.prototype.onBeforeRenderLegacy=function(f){this.assureTextureLegacy(f)},X.prototype.assureTextureLegacy=function(e){var u=this,d=u.gv,j=d.getEnvmap();if(j!==u._lastLegacyImage){if(u._envmapLegacy&&(e.deleteTexture(u._envmapLegacy),u._envmapLegacy=null),!j)return u._lastLegacyImage=j,void 0;var z=L.getImage(j);if(z&&z.tagName){z=L.resizeImagePOT(z,!0);var A=u._envmapLegacy=e.createTexture();e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_CUBE_MAP,A),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,z),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,z),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,z),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,z),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,z),e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,z),e.bindTexture(e.TEXTURE_CUBE_MAP,e._emptyCubeTexture),u._lastLegacyImage=j}}},X.prototype.setEnvmapLegacy=function(T){T.uEnvMap=this._envmapLegacy},X.prototype.onBeforeRenderNew=function(T){this.assureTextureNew(T),this.resetUniformCache()},X.prototype.assureTextureNew=function(G){var l=this,X=l.gv,h=X.getEnvmap(),U=l._envmapHash,Y=l._envmaps,V=G._renderInfo.frame;if(!(this._lastCaptureFrame>=V||X._picking))for(var a in h){var Z,w=h[a],W=w.type;switch(W){case"sphere":Z=w.image,Z!==U[a]&&(Kp=L.getImage(Z),Kp&&(U[a]=Z,m(Y,a,l.fromEquirectangular(Z))));break;case"cube":var S=w.images;if(S&&6===S.length&&(Z=S.join(","),Z!==U[a])){for(var P=!0,s=0;6>s;s++)if(!L.getImage(S[s])){P=!1;break}P&&(U[a]=Z,m(Y,a,l.fromCubemap(S)))}break;case"skybox":var b=X.getSkybox();if(b){var H=b.s("shape3d");if(Z="sphere"===H?b._id+"_"+b.s("shape3d.image"):b._id+"_"+b.s("front.image"),Z!==U[a]){var P;if("sphere"===H)P=L.getImage(b.s("shape3d.image"));else{P=!0;for(var t=["front","back","left","right","top","bottom"],s=0;6>s;s++)if(!L.getImage(b.s(t[s]+".image"))){P=!1;break}}P&&(U[a]=Z,m(Y,a,l.fromSkybox()))}}break;case"probe":var O=w.pos,$=w.size;if(Z=O[0]+"_"+O[1]+"_"+O[2]+"_"+$,Z!==U[a]){var J=this._probeCaptureTime[Z],K=Date.now();J||(this._probeCaptureTime[Z]=J=K),K-J>L.envmapProbeMinWaitTime&&!cl&&!Ae||K-J>L.envmapProbeMaxWaitTime?(delete this._probeCaptureTime[Z],U[a]=Z,m(Y,a,l.fromSceneProbe(O,$,w.filter))):X.iv()}}}},X.prototype.resetUniformCache=function(){this._frameUniformCache={}},X.prototype.setEnvmap=function(J,b){var M=J.uuid,K=this._frameUniformCache,I=this._envmaps[b];I&&(I=I.texture),K[M]!==I&&(K[M]=I,J.uEnvMap=I)},X.prototype.fromEquirectangular=function(T){var I=H.Default.getImage(T);return this.rectSize=[1/I.width,1/I.height],T=this.gv.getTexture(T),this.fromTexture(T)},X.prototype.fromCubemap=function(B){var h=this.gv.getGL(),g=h.createTexture();h.activeTexture(h.TEXTURE0),h.bindTexture(h.TEXTURE_CUBE_MAP,g),h.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_MAG_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_MIN_FILTER,h.LINEAR);for(var P=[],s=F/3,V=0;6>V;V++)P[V]=L.resizeImage(H.Default.getImage(B[V]),s);return h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,P[0]),h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,P[1]),h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,P[2]),h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,P[3]),h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,P[4]),h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,P[5]),h.bindTexture(h.TEXTURE_CUBE_MAP,h._emptyCubeTexture),this.fromTexture(g,!0)},X.prototype.fromTexture=function(W,i){var G=this._allocateTargets();this._pingPongRenderTarget||(this._pingPongRenderTarget=this._allocateTargets());var S=this.gv,y=S.getGL(),A=se.for(y).directState(),j=A.depth.enabled;A.scissor.enabled=!0,A.depth.enabled=!1;var l=S.getViewport(y);return this._textureToCubeUV(W,G,i),this._applyPMREM(G),G.unbind(y),S.setViewport(y,l[0],l[1],l[2],l[3]),A.depth.enabled=j,A.scissor.enabled=!1,G},X.prototype.fromSkybox=function(){return this._fromCamera(function(w){w.s({"camera.onlySky":!0})})},X.prototype.fromScene=function(y){return this._fromCamera(function(k){k.s({"camera.onlySky":!1}),y&&y(k)})},X.prototype.fromNode=function(q){var r=this.gv.getData3dUI(q),m=r._42;r._42=vi;var e=this.gv.getSkybox(),D=q.p3();if(e){var v=e.p3();e.p3(D)}var b=this.fromScene(function(r){r.p3(D)});return r._42=m,e&&e.p3(v),b},X.prototype.fromSceneProbe=function(n,B,l){var K=this.gv,f=K.getSkybox();if(f){var S=f.p3();f.p3(n)}if(l){var C=K.isVisible;K.isVisible=function(s){var P=l(s);return P!==E?P:C.call(K,s)}}var W=this.fromScene(function(Z){Z.p3(n),Z.s("camera.near",B)});return l&&(K.isVisible=C),f&&f.p3(S),W},X.prototype._fromCamera=function(u){var J=this.gv,S=J.getCamera();u&&u(S);var Q=new Ms(J,F,F,{cube:!0}),M=J.getGL(),N=J.getViewport(M),o=this.setEnvmapByProbeId,r=this.onBeforeRender;this.setEnvmapByProbeId=function(H){H.envMap=M._emptyTexture},this.onBeforeRender=vi,S.attachRenderTarget(Q),S.render(J),S.detachRenderTarget(),this.setEnvmapByProbeId=o,this.onBeforeRender=r,J.setViewport(M,N[0],N[1],N[2],N[3]);var s=this.fromTexture(Q.texture,!0);return Q.releaseTexture(),s},X.prototype._allocateTargets=function(){return new Ms(this.gv,3*D,3*D,{magFilter:os.NEAREST,minFilter:os.NEAREST})},X.prototype._textureToCubeUV=function(r,u,I){var s,p=this.gv;I?null==(s=this._cubemapShader)&&(this._cubemapShader=s=this.createShader(z())):null==(s=this._equirectShader)&&(this._equirectShader=s=this.createShader(O()));var v=p.getGL();u.bind(v),this._setViewport(u,0,0,3*D,2*D);var K=p.getRenderState();K.useProgram(s);var a=K.directUniforms(),m=K.directAttribs();a.envMap=r,I||(a.texelSize=this.rectSize);var o=n[0];m.position=Xi(v,null,o.vs,f,3),m.uv=Xi(v,null,o.uv,f,2),m.faceIndex=Xi(v,null,o.faceIs,f,1),En(v,0,o.vs.length/3)},X.prototype._applyPMREM=function(k){for(var z,I,M,z=1;i>z;z++)I=Math.sqrt(u[z]*u[z]-u[z-1]*u[z-1]),M=K[(z-1)%K.length],this._blur(k,z-1,z,I,M)},X.prototype._setViewport=function(H,D,$,p,E){var R=this.gv;R.setViewport(R.getGL(),D,$,p,E),R.getRenderState().directState().scissor.box=[D,$,p,E]},X.prototype._blur=function(B,p,h,W,b){var Y=this._pingPongRenderTarget;this._halfBlur(B,Y,p,h,W,"latitudinal",b),this._halfBlur(Y,B,h,h,W,"longitudinal",b)},X.prototype.createShader=function(F){var U=this.gv;return U.getPostProcessing().createShader(U.getGL(),F).program},X.prototype._halfBlur=function(E,F,W,J,C,S,m){var d=this.gv,b=this._blurMaterial;if("latitudinal"===S||"longitudinal"===S){b||(this._blurMaterial=b=this.createShader(q(M)));var Q=d.getGL();F.bind(Q);var e=3,I=d.getRenderState();I.useProgram(b);var l,B,T,p=I.directUniforms(),z=I.directAttribs(),A=t[W]-1,Y=isFinite(C)?Math.PI/(2*A):2*Math.PI/(2*M-1),x=C/Y,R=isFinite(C)?1+Math.floor(e*x):M,K=[],O=0;for(l=0;M>l;++l)B=l/x,T=Math.exp(-B*B/2),K.push(T),0==l?O+=T:R>l&&(O+=2*T);for(l=0;l<K.length;l++)K[l]=K[l]/O;p.envMap=E.texture,p.samples=R,p.weights=K,p.latitudinal="latitudinal"===S,m&&(p.poleAxis=m),p.dTheta=Y,p.mipInt=v-W;var P=t[J],B=3*Math.max(0,D-2*P),u=(0===J?0:2*D)+2*P*(J>v-k?J-v+k:0);this._setViewport(F,B,u,3*P,2*P);var G=n[J];z.position=Xi(Q,null,G.vs,f,3),z.uv=Xi(Q,null,G.uv,f,2),z.faceIndex=Xi(Q,null,G.faceIs,f,1),En(Q,0,G.vs.length/3),F.unbind(Q)}};var k=4,v=8,D=Math.pow(2,v),x=[.125,.215,.35,.446,.526,.582],i=v-k+1+x.length,M=20,Q=(1+Math.sqrt(5))/2,A=1/Q,K=[new np(1,1,1),new np(-1,1,1),new np(1,1,-1),new np(-1,1,-1),new np(0,Q,A),new np(0,Q,-A),new np(A,0,Q),new np(-A,0,Q),new np(Q,A,0),new np(-Q,A,0)],W=function(){for(var l=[],U=[],h=[],s=v,J=0;i>J;J++){var V=Math.pow(2,s);U.push(V);var T=1/V;J>v-k?T=x[J-v+k-1]:0==J&&(T=0),h.push(T);for(var B=1/(V-1),j=-B/2,H=1+B/2,K=6,S=[],$=[],R=[],Z=0;K>Z;Z++){var t=2*(Z%3)/3-1,o=Z>2?0:-1;S.push(t,o,0,t+2/3,o,0,t+2/3,o+1,0,t,o,0,t+2/3,o+1,0,t,o+1,0),$.push(j,j,H,j,H,H,j,j,H,H,j,H),R.push(Z,Z,Z,Z,Z,Z)}l.push({vs:new Qb(S),uv:new Qb($),faceIs:new Qb(R)}),s>k&&s--}return{_lodPlanes:l,_sizeLods:U,_sigmas:h}}(),n=W._lodPlanes,t=W._sizeLods,u=W._sigmas,F=L.EnvmapTextureSize}();var Js=["left","front","right","back","top","bottom"],Ks=nj._RenderList=function(b){function I(){n.length=0,P.length=0,i={}}function F(G){var k,K,c,t,e=G.gv,o=G.data,x=G.shapeModel;if(x){var W,T,Z,L=o.s("shape3d.transparent")||o.s("points.transparent");for(br(x)||(W=kh(x.transparent,o,e),x=[x]),c=0,t=x.length;t>c;c++)Z=x[c],T=kh(Z.transparent,o,e),T===E&&(T=W),T===E&&(T=L),T?K=!0:k=!0}for(c=0,t=Js.length;t>c;c++){var X=G[Js[c]];X&&(X.transparent?K=!0:k=!0)}e.isLabelVisible(o)&&(G.labelInfo&&(o.s(oc+".transparent")?K=!0:k=!0),G.label2Info&&(o.s(jr+".transparent")?K=!0:k=!0)),e.isNoteVisible(o)&&(G.noteInfo&&(o.s(Ap+".transparent")?K=!0:k=!0),G.note2Info&&(o.s(uj+".transparent")?K=!0:k=!0)),G._38o&&(K=k=!0),K||(k=!0),G._renderParams={opaque:k,transparent:K}}function t(s,R){R&&F(s);var p=s.data,w=p._id;if(!i[w]){i[w]=!0;var e=s._renderParams;e&&e.visible!==!1&&(s={ui:s,data:p,z:0,id:w},e.opaque&&n.push(s),e.transparent&&P.push(s))}}function z(a,d){if(P.length>1){for(var O,S,w=[0,0,0,0],T=0,Z=P.length;Z>T;T++)O=P[T].data,(S=O._position)?(w[0]=S.x,w[1]=O._54O,w[2]=S.y,w[3]=1,zm(w,d),P[T].z=w[2]/w[3]):P[T].z=0;P.sort(a||Q)}}function O(T){T?(Kr(H,d,T,b),Kr(N,L,T,b),Kr(r,f,T,b)):(H=this.batchModelMap={},d=this.batchIndexMap={},N=this.polylineModelMap={},L=this.polylineIndexMap={},r=this.wireframeModelMap={},f=this.wireframeIndexMap={}),this.markBatchInvalid()}function A(g){g?Kr(H,d,g,b):(H=this.batchModelMap={},d=this.batchIndexMap={}),this.markBatchInvalid()}function _(v){v?Kr(N,L,v,b):(N=this.polylineModelMap={},L=this.polylineIndexMap={}),this.markBatchInvalid()}function k(H){H?Kr(r,f,H,b):(r=this.wireframeModelMap={},f=this.wireframeIndexMap={}),this.markBatchInvalid()}function m(){return this._batchInvalid}function v(){this._batchInvalid=!0}function G(){this._batchInvalid=null}var n=[],P=[],H={},d={},N={},L={},r={},f={},i={};return{opaque:n,transparent:P,init:I,push:t,batchModelMap:H,batchIndexMap:d,polylineModelMap:N,polylineIndexMap:L,wireframeModelMap:r,wireframeIndexMap:f,ivBatch:O,ivModelBatch:A,ivPolylineBatch:_,ivWireframeBatch:k,markBatchInvalid:v,isBatchInvalid:m,onUpdated:G,sort:z}},Ls=nj._RenderLists=function(M){function X(){for(var Q in P)P[Q].init()}function h(){for(var J in P)P[J].onUpdated()}function b(B,k){B=B||"main";var D=P[B];return!D&&k&&(D=P[B]=new Ks(M)),D}function A(V,j){var N=V.data.getRenderLayer(),c=b(N,!0);c.push(V,j)}function x(b){for(var x in P)b(P[x])}var P={};return{init:X,onUpdated:h,get:b,push:A,each:x,lists:P}},Ms=nj.RenderTarget=function(q,z,o,Q){var U,W=this;null!=z&&z.canvas?(U=z,z=o,o=Q,Q=arguments[4]):U=q.getGL(),Q=Q||{},Q.cube===!!Q.cube,Q.samples=Q.cube?0:Math.min(q._glCapabilities.maxSamples,Q.samples&&Q.samples>1&&2===q._webGLVersion?Q.samples:0),W.options=Q,W.uuid=H.Math.generateUUID(),W.gv=q,W.init(q,U,Q),W.format=Q.format||os.RGBA,W.generateMipmaps=!!Q.generateMipmaps,Q.samples&&!q._glCapabilities._maxSamplesChecked?W.setSize(U,z||1,o||1):W.setSize(U,z,o)};b.assign(nj.RenderTarget.prototype,{bind:function(G,W){var d=this.options;if(d.autoSize){var Z=this.gv,z=Z.getDevicePixelRatio(),F=Z.getWidth()*z,x=Z.getHeight()*z;this.setSize(G,F,x)}d.cube?Kj(G,this.frame[W]):Kj(G,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(v){li(v),this.options.samples&&(v.bindFramebuffer(v.READ_FRAMEBUFFER,this._MSAAFbo),v.bindFramebuffer(v.DRAW_FRAMEBUFFER,this.frame),v.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,v.COLOR_BUFFER_BIT,v.NEAREST),v.bindFramebuffer(v.READ_FRAMEBUFFER,null),v.bindFramebuffer(v.DRAW_FRAMEBUFFER,null))},isCube:function(){return this.options.cube},init:function(U,C,K){var H=this,D=K.samples,n=K.cube,y=H.texture=C.createTexture(),Q=n?os.TEXTURE_CUBE_MAP:os.TEXTURE_2D;C.activeTexture(C.TEXTURE0),C.bindTexture(Q,y),C.texParameteri(Q,C.TEXTURE_WRAP_S,K.wrapS||C.CLAMP_TO_EDGE),C.texParameteri(Q,C.TEXTURE_WRAP_T,K.wrapT||C.CLAMP_TO_EDGE);var R=D?C.NEAREST:C.LINEAR;if(C.texParameteri(Q,C.TEXTURE_MIN_FILTER,K.minFilter||R),C.texParameteri(Q,C.TEXTURE_MAG_FILTER,K.magFilter||R),C.bindTexture(Q,null),n){H.depth=[],H.frame=[];for(var p=0;6>p;p++)H.depth[p]=C.createRenderbuffer(),H.frame[p]=C.createFramebuffer()}else H.depth=C.createRenderbuffer(),H.frame=C.createFramebuffer();H.assureTexture()},assureTexture:function(){var E=this;E.gv._2Oi(E.uuid,E.texture,"default"),H.Default.setImage(E.uuid,null)},releaseTexture:function(){this.gv.deleteTexture(this.uuid)},setSize:function(h,M,e){var W=this;if(M=Math.round(M),e=Math.round(e),M&&e&&(W.width!==M||W.height!==e)){W.width=M,W.height=e;var x=h.RENDERBUFFER,B=h.FRAMEBUFFER,o=W.options.samples,t=W.options.cube,T=t?os.TEXTURE_CUBE_MAP:os.TEXTURE_2D;if(o){var l=W.gv._glCapabilities;if(!l._maxSamplesChecked){for(h.bindRenderbuffer(x,W.depth),h.getError();o>1&&(h.renderbufferStorageMultisample(x,o,h.DEPTH_COMPONENT16,M,e),h.getError());)o=Math.floor(o>>1);1>=o&&(o=0,h.texParameteri(T,h.TEXTURE_MIN_FILTER,W.options.minFilter||h.LINEAR),h.texParameteri(T,h.TEXTURE_MAG_FILTER,W.options.magFilter||h.LINEAR),h.renderbufferStorage(x,h.DEPTH_COMPONENT16,M,e)),l._maxSamplesChecked=!0,l.maxSamples=W.options.samples=o,h.bindRenderbuffer(x,f)}}if(o&&(W._MSAAFbo||(W._MSAAFbo=h.createFramebuffer(),W._MSAARbO=h.createRenderbuffer()),h.bindRenderbuffer(x,W._MSAARbO),h.renderbufferStorageMultisample(h.RENDERBUFFER,o,h.RGBA8,M,e),h.bindFramebuffer(B,W._MSAAFbo),h.framebufferRenderbuffer(B,h.COLOR_ATTACHMENT0,x,W._MSAARbO),h.framebufferRenderbuffer(B,h.DEPTH_ATTACHMENT,x,W.depth),h.bindFramebuffer(B,null),h.bindRenderbuffer(x,null)),h.activeTexture(h.TEXTURE0),h.bindTexture(T,W.texture),t)for(var w=h.TEXTURE_CUBE_MAP_POSITIVE_X,J=0;6>J;J++)W.setupFrameBufferTextureAndDepth(h,W.frame[J],W.depth[J],w+J);else W.setupFrameBufferTextureAndDepth(h,W.frame,W.depth,h.TEXTURE_2D);if(W.generateMipmaps&&(2===gv._webGLVersion||xc.isPOT(M)&&xc.isPOT(e))){h.generateMipmap(T);var I=W.options.minFilter||(o?h.NEAREST:h.LINEAR);h.texParameteri(T,h.TEXTURE_MIN_FILTER,I===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_LINEAR)}h.bindTexture(T,null)}},setupFrameBufferTextureAndDepth:function(i,g,N,X){var q=this,n=q.format;i.texImage2D(X,0,n,this.width,this.height,0,n,i.UNSIGNED_BYTE,null),i.bindFramebuffer(i.FRAMEBUFFER,g),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,X,q.texture,0),this.setupRenderBufferStorage(i,N),i.bindFramebuffer(i.FRAMEBUFFER,null)},setupRenderBufferStorage:function(z,m){var u=this,V=z.RENDERBUFFER;z.bindRenderbuffer(V,m);var $=u.options.samples;$?z.renderbufferStorageMultisample(V,$,z.DEPTH_COMPONENT16,u.width,u.height):(z.renderbufferStorage(V,z.DEPTH_COMPONENT16,u.width,u.height),z.framebufferRenderbuffer(z.FRAMEBUFFER,z.DEPTH_ATTACHMENT,V,m)),z.bindRenderbuffer(z.RENDERBUFFER,null)},toCanvas:function(){var Z=this,m=Z.gv.getGL();Kj(m,Z.frame);var I=Z.width,X=Z.height,N=new Uint8Array(4*I*X);m.readPixels(0,0,I,X,Z.format,m.UNSIGNED_BYTE,N),li(m);var C=Y.createElement("canvas");C.width=I,C.height=X;var R=C.getContext("2d"),v=R.createImageData(I,X);return v.data.set(N),R.putImageData(v,0,0),C}});var Ns=nj.Interactor=function(S){this.gv=this.g3d=S};Ri("Interactor",b,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(a){this.gv.fi(a)},startDragging:function(A){bg(this,A)}});var Os=nj.DefaultInteractor=function(K){Hm(Os,this,[K])};Ri("DefaultInteractor",Ns,{getState:function(){return this._62O},setState:function(q){this._62O=q},getDataInfoAt:function(h,x){var Z=this.gv,f=Z.getDataInfoAt(h);if(!Z.isBlockSelectable()||!f||!f.data)return f;if(!x&&Z.isSelected(f.data))return f;for(var S=f.data;(S=S.getParent())&&S instanceof H.Block&&Z.isSelectable(S);){var J=Z.isSelected(S);if(J&&x)break;if(f={data:S,part:f.part},J&&!x)break}return f},handle_contextmenu:function(D){Lk(D)},handle_mousewheel:function(c){this.gv.handleScroll(c,c.wheelDelta/40)},handle_DOMMouseScroll:function(O){2===O.axis&&this.gv.handleScroll(O,-O.detail)},handle_keydown:function(D){this.gv.handleKeyDown(D)},handle_mousedown:function(P){this.handle_touchstart(P)},handle_touchstart:function(G){Lk(G);var k=this,U=k.gv,I=zj(G),$=k.getDataInfoAt(G),l=$?$.data:f,r=$?$.part:f,T=U.sm(),j=Tr(G),M=Ai(G);U.setFocus(G)&&(k._62O=f,k._57I=f,k.pendingClickThrough=f,k.__lastClientPoint__=dg(G),l?vf(G)?T.co(l)?T.rs(l):T.as(l):T.co(l)?l instanceof If&&l.isClickThroughEnabled()&&zj(G)&&(k.pendingClickThrough=dg(G)):T.ss(l):I&&(vf(G)?U.isRectSelectable()&&(k._62O=xp):k._57I=dg(G)),k._31Q&&(zo(k._31Q),delete k._31Q,delete k._32Q),k._62O||(U.isFirstPersonMode()&&(An(G)||Jl(G)||M>2?k._62O="pan":U.isMouseRoamable()||bj(G)?(k._62O="roaming",k.foward=j&&zj(G),k._32Q=ek(),k._31Q=Un(k.tick,k)):I||(k._62O="roaming")),k._62O||(I&&j&&gt[r]?(k._62O=r,k.p3=l.p3()):I&&j&&mq(l)&&U.isSelected(l)?U.isMovable(l)?(k._62O="move",k.p3=l.p3(),k.movedata=l):U._39Q(l)&&(k._62O="none"):bj(G)&&(M>2?k._62O="pan":2===M&&(k.dist=Zb(G),k._62O="pinch")))),k.point=U.lp(G),bg(k,G),Md(G)?U.handleDoubleClick(G,l,r):U.handleClick(G,l,r))},tick:function(){var o=this,Q=o.gv,Z=Q._moveStep;o.point&&Q.isWalkable()&&(o._32Q&&(Z*=(ek()-o._32Q)/50),Q.walk(o.foward?Z:-Z),o._32Q=ek(),o._31Q=Un(o.tick,o))},handle_mouseup:function(u){this.handle_touchend(u)},handle_touchend:function(p){var Y=this._57I;if(Y&&(Mp(Y,dg(p))<=1&&this.gv.sm().cs(),this._57I=f),Y=this.pendingClickThrough){if(Mp(Y,dg(p))<=1){var z=this.getDataInfoAt(p);z&&z.data instanceof If&&z.data.isClickThroughEnabled()&&(z=this.getDataInfoAt(p,!0),z&&(p.clickThrough=!0,this.gv.sm().ss(z.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(Z){this.handleWindowTouchMove(Z)},handleWindowTouchMove:function(Q){var C,Z,p=this,k=p.gv,x=p._62O,n=p.point,N=k.dm(),J=k.lp(Q),M=J.x-n.x,r=J.y-n.y,z=k.getWidth(),h=k.getHeight();if(z&&h){var U=dg(Q),m=dc(k,U,p.__lastClientPoint__),b=Mp({x:0,y:0},m),i=-_*M/z,f=-_*r/h;if("roaming"===x)p.rotate(Q,i/2,f/2);else if(x===at||x===bt||x===ct)k._86O||N.beginTransaction(),k.fi({kind:k._86O?"betweenEditRotation":"beginEditRotation",event:Q}),k._86O=1,k.sm().each(function(H){if(mq(H)&&k.isRotationEditable(H)){var S=a(i)>a(f)?i:f;x===at?H.setRotationX(H.getRotationX()+S):x===bt?H.setRotationY(H.getRotationY()+S):x===ct&&H.setRotationZ(H.getRotationZ()+S)}});else if("move"===x||gt[x]){if(x===dt||x===et||x===ft)k._87O||N.beginTransaction(),k.fi({kind:k._87O?"betweenEditScale":"beginEditScale",event:Q}),k._87O=1;else{if(!k._moving){if(b<L.touchMoveThreshold)return;N.beginTransaction()}k.fi({kind:k._moving?"betweenMove":"beginMove",event:Q}),k._moving=1}var q,K=p.p3,T=k.getPositionInfo(K),w=Fp(k);q=x===Zs?"x":x===$s?"y":x===_s?"z":x===dt?"sx":x===et?"sy":x===ft?"sz":k.getMoveMode(Q,p.movedata),M=M/z*T.width,r=-1*r/h*T.height;var E,O,F=[w[0]*M,w[4]*M,w[8]*M],s=[w[1]*r,w[5]*r,w[9]*r],d=F[0]+s[0],t=F[1]+s[1],P=F[2]+s[2],S=[K[0]+d,K[1]+t,K[2]+P],V=ch(k.getEye(),S,!0);if("xyz"===q?(E=S,k.moveSelection(d,t,P)):"xz"===q?(E=Lm(k,K,[0,1,0],S),E&&k.moveSelection(E[0]-K[0],0,E[2]-K[2])):"xy"===q?(E=Lm(k,K,[0,0,1],S),E&&k.moveSelection(E[0]-K[0],E[1]-K[1],0)):"yz"===q?(E=Lm(k,K,[1,0,0],S),E&&k.moveSelection(0,E[1]-K[1],E[2]-K[2])):"x"===q||"sx"===q?(V[0]=0,E=Lm(k,K,V,S),E&&(O=E[0]-K[0],"x"===q?k.moveSelection(O,0,0):k.sm().each(function(H){mq(H)&&k.isSizeEditable(H)&&(C=H.getScaleX()+O/100,Z=C/H.getScaleX(),H.setScaleX(C),An(Q)&&(H.setScaleY(H.getScaleY()*Z),H.setScaleTall(H.getScaleTall()*Z)))}))):"y"===q||"sy"===q?(V[1]=0,E=Lm(k,K,V,S),E&&(O=E[1]-K[1],"y"===q?k.moveSelection(0,O,0):k.sm().each(function(A){mq(A)&&k.isSizeEditable(A)&&(C=A.getScaleTall()+O/100,Z=C/A.getScaleTall(),A.setScaleTall(C),An(Q)&&(A.setScaleY(A.getScaleY()*Z),A.setScaleX(A.getScaleX()*Z)))}))):("z"===q||"sz"===q)&&(V[2]=0,E=Lm(k,K,V,S),E&&(O=E[2]-K[2],"z"===q?k.moveSelection(0,0,O):k.sm().each(function(v){mq(v)&&k.isSizeEditable(v)&&(C=v.getScaleY()+O/100,Z=C/v.getScaleY(),v.setScaleY(C),An(Q)&&(v.setScaleX(v.getScaleX()*Z),v.setScaleTall(v.getScaleTall()*Z)))}))),!E)return;p.p3=E}else if(x===xp){var y=p.div;y||(y=p.div=Rq(),Zg(p.getView(),y),y.op=n,y.style.background=k.getRectSelectBackground()),k.fi({kind:k._rectSelecting?"betweenRectSelect":"beginRectSelect",event:Q}),k._rectSelecting=1,y.rect=Db(y.op,J),kq(y,y.rect)}else if("pinch"===x&&2===Ai(Q)){k.fi({kind:k._pinching?"betweenPinch":"beginPinch",event:Q}),k._pinching=1;var O=Zb(Q);k._lastZoomLP||(k._lastZoomLP=fq(Q)),k.handlePinch(O,p.dist),p.dist=O}else"pan"===x||An(Q)||Jl(Q)?p.pan(Q,M,r):"none"===x||k.isFirstPersonMode()||p.rotate(Q,i,f);p.point=J}},pan:function(z,D,O){var l=this.gv;if(l.isPannable()){var p=l.getWidth(),a=l.getHeight();if(!p||!a)return;var F=l.getCenterInfo(),C=D/p*F.width,n=-1*O/a*F.height;l.fi({kind:l._panning?"betweenPan":"beginPan",event:z}),l._panning=1,l.pan(-C,-n)}},rotate:function(Z,w,n){var t=this.gv;t.isRotatable()&&(t.fi({kind:t._rotating?"betweenRotate":"beginRotate",event:Z}),t._rotating=1,t.rotate(w,n))},handleWindowMouseUp:function(h){this.handleWindowTouchEnd(h)},handleWindowTouchEnd:function(H){var D=this,X=D.gv,z=X.dm(),o=D.div;if(o){var s=X.getDatasInRect(o.rect);if(!s.isEmpty()){var c=X.sm(),k=c.toSelection(),P=An(H),g=H.altKey;s.each(function(M){c.co(M)?(!P||P&&g)&&k.remove(M):(!g||P&&g)&&k.add(M)}),c.ss(k)}bn(o)}X._moving&&(delete X._moving,X.fi({kind:"endMove",event:H}),X.onMoveEnded(),z.endTransaction()),X._panning&&(delete X._panning,X.fi({kind:"endPan",event:H}),X.onPanEnded()),X._rotating&&(delete X._rotating,X.fi({kind:"endRotate",event:H}),X.onRotateEnded()),X._86O&&(delete X._86O,X.fi({kind:"endEditRotation",event:H}),z.endTransaction()),X._87O&&(delete X._87O,X.fi({kind:"endEditScale",event:H}),z.endTransaction()),X._pinching&&(delete X._pinching,X.fi({kind:"endPinch",event:H}),X.onPinchEnded()),X._rectSelecting&&(delete X._rectSelecting,X.fi({kind:"endRectSelect",event:H}),X.onRectSelectEnded()),X._walking&&(delete X._walking,X.fi({kind:"endWalk",event:H}),X.onWalkEnded()),X._lastZoomLP=X._lastZoomHit=null,D.dist=D.point=D._62O=D.p3=D.movedata=D.div=D._57I=D.pendingClickThrough=D._32Q=D._31Q=D.foward=f,D.__lastClientPoint__=f}});var Ps=nj.MapInteractor=function(I){Hm(Ps,this,[I]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this._minPhi=0,this._maxPhi=5*Math.PI/12};Ri("MapInteractor",Ns,{setUp:function(){Ps.superClass.setUp.call(this);var y=this.gv;this.__oldMinPhi__=y.getRotateMinPhi(),this.__oldMaxPhi__=y.getRotateMaxPhi(),y.setRotateMinPhi(this._minPhi),y.setRotateMaxPhi(this._maxPhi)},tearDown:function(){Ps.superClass.tearDown.call(this);var X=this.gv;X.setRotateMinPhi(this.__oldMinPhi__),X.setRotateMaxPhi(this.__oldMaxPhi__),delete this.__oldMinPhi__,delete this.__oldMaxPhi__},handle_contextmenu:function(s){Lk(s)},handle_mousewheel:function(c){this.gv.handleScroll(c,c.wheelDelta/40)},handle_DOMMouseScroll:function(r){2===r.axis&&this.gv.handleScroll(r,-r.detail)},handle_keydown:function(n){this.gv.handleKeyDown(n)},handle_mousedown:function(q){this.handle_touchstart(q)},handle_touchstart:function(M){Lk(M);var S=this,q=S.gv;if(q.setFocus(M)){var n=q.getDataInfoAt(M),j=n?n.data:f,C=n?n.part:f;S.__lastClientPoint__=dg(M);var V=S.editing={point:q.lp(M),data:j,part:C};bj(M)?V.touch=!0:(V.touch=!1,V.clickLeft=zj(M),V.pan=Jl(M)?!0:"left"===this.panButton===V.clickLeft),j&&q._39Q(j)&&(V.preventDefault=!0),bg(S,M),Md(M)?q.handleDoubleClick(M,j,C):q.handleClick(M,j,C)}},handle_mouseup:function(B){this.handle_touchend(B)},handle_touchend:function(){},handleWindowMouseMove:function(x){this.handleWindowTouchMove(x)},handleWindowTouchMove:function(c){var R=this,H=R.gv,u=R.editing;if(u){var V=H.lp(c),z=u.point,X=V.x-z.x,e=V.y-z.y;if(!u.moved){if(Math.abs(X)<R.threshold&&Math.abs(e)<R.threshold&&!(c.touches&&c.touches.length>1))return;u.moved=!0}if(!u.preventDefault){u.point=V;var D=u.part;if(gt[D]){var h=u.data,x=H.dm(),K=H.getWidth(),s=H.getHeight(),j=-_*X/K,E=-_*e/s;if(D===at||D===bt||D===ct){H._86O||x.beginTransaction(),H.fi({kind:H._86O?"betweenEditRotation":"beginEditRotation",event:c}),H._86O=1;var F=a(j)>a(E)?j:E;H.sm().each(function(h){mq(h)&&H.isRotationEditable(h)&&(D===at?h.setRotationX(h.getRotationX()+F):D===bt?h.setRotationY(h.getRotationY()+F):D===ct&&h.setRotationZ(h.getRotationZ()+F))})}else{var J=h.p3(),W=H.getPositionInfo(J);X=X/K*W.width,e=-1*e/s*W.height;var I,d=Fp(H),Y=[d[0]*X,d[4]*X,d[8]*X],k=[d[1]*e,d[5]*e,d[9]*e],T=Y[0]+k[0],w=Y[1]+k[1],A=Y[2]+k[2],C=[J[0]+T,J[1]+w,J[2]+A],M=ch(H.getEye(),C,!0);if(D===dt||D===et||D===ft){if(H._87O||x.beginTransaction(),H.fi({kind:H._87O?"betweenEditScale":"beginEditScale",event:c}),H._87O=1,I=Lm(H,J,M,C)){var n,P=0,y=["X","Y","Tall"];D===dt?n="X":D===et?(n="Tall",P=1):D===ft&&(n="Y",P=2),y.splice(y.indexOf(n),1);var m=An(c),t=(I[P]-J[P])/100;H.sm().each(function(Z){if(mq(Z)&&H.isSizeEditable(Z)){var $=Z["getScale"+n](),v=$+t;if(Z["setScale"+n](v),m){var J=v/$;y.forEach(function(H){Z["setScale"+H](Z["getScale"+H]()*J)})}}})}}else if(D===Zs||D===$s||D===_s){if(!H._moving){var U=dg(c),p=dc(H,U,R.__lastClientPoint__),l=Mp({x:0,y:0},p);if(l<L.touchMoveThreshold)return;x.beginTransaction()}H.fi({kind:H._moving?"betweenMove":"beginMove",event:c}),H._moving=1;var P=0;if(D===Zs?P=0:D===$s?P=1:D===_s&&(P=2),M[P]=0,I=Lm(H,J,M,C)){var t=I[P]-J[P],v=[0,0,0];v[P]=t,H.moveSelection.apply(H,v)}}}}else if(u.touch){var Z=c.touches.length;if(2!==Z)R.pan(c,X,e);else{if(1>=Z)return;var N=c.touches,G={x:N[0].clientX,y:N[0].clientY},o={x:N[1].clientX,y:N[1].clientY},$={x:o.x-G.x,y:o.y-G.y},g=u.lastCenter,Q=Math.atan2($.y,$.x),S=u.theta,b=0;S==f?S=u.theta=Q:(b=Q-S,u.thetaStarted||Math.abs(b)>R.touchRotateThreshold?(u.thetaStarted=!0,u.theta=Q):b=0);var i=O*(G.y+o.y)/2/H.getHeight(),B=u.phi,r=0;B==f?B=u.phi=i:(r=i-B,u.phiStarted||Math.abs(r)>R.touchRotateThreshold?(u.phiStarted=!0,u.phi=i):r=0);var q,ne=Math.sqrt($.x*$.x+$.y*$.y),zg=u.vlen;if(zg){var ts=G.x-g.x,Lg=G.y-g.y,xs=o.x-g.x,rp=o.y-g.y,sl=Math.sqrt(ts*ts+Lg*Lg),pp=Math.sqrt(xs*xs+rp*rp),Cp=zg/2,Rl=R._sign2(sl-Cp),bd=R._sign2(pp-Cp);0>Rl*bd||0===Rl&&0===bd?(q=1,u.vlen=ne):(q||(q=ne/zg),u.scaleStarted||Math.abs(q-1)>R.touchScaleThreshold?(u.vlen=ne,u.scaleStarted=!0):q=1)}else zg=u.vlen=ne,q=1;1!==q&&H.setZoom(q),(r||b)&&R.rotate(c,b,-r),u.lastCenter={x:(o.x+G.x)/2,y:(o.y+G.y)/2}}}else if(u.pan)R.pan(c,X,e);else{var K=H.getWidth(),s=H.getHeight();if(!K||!s)return;var j=-_*X/K,E=-_*e/s;R.rotate(c,j,E)}}}},_sign2:function(O){return Math.abs(O)<this._touchScaleCheckAccuracy?0:O>0?1:-1},handleWindowMouseUp:function(M){this.handleWindowTouchEnd(M)},getDataInfoAt:function(F,q){var M=this.gv,Q=M.getDataInfoAt(F);if(!M.isBlockSelectable()||!Q||!Q.data)return Q;if(!q&&M.isSelected(Q.data))return Q;for(var f=Q.data,m=Q.part;(f=f.getParent())&&f instanceof H.Block&&M.isSelectable(f);){var d=M.isSelected(f);if(d&&q)break;if(Q={data:f,part:m},d&&!q)break}return Q},handleWindowTouchEnd:function(E){var g=this,D=g.editing;if(g.editing=null,D){var m=g.gv;if(D.moved||!D.clickLeft&&!D.touch)m._panning=null,m._rotating=null,m.fi({kind:D.pan?"endPan":"endRotate",event:E});else{var h=g.getDataInfoAt(E),U=h&&h.data;U instanceof If&&U.isClickThroughEnabled()&&(h=g.getDataInfoAt(E,!0),h&&(U=h.data)),U?m.sm().setSelection([U]):m.sm().clearSelection()}var A=m.dm();m._moving&&(delete m._moving,m.fi({kind:"endMove",event:E}),m.onMoveEnded(),A.endTransaction()),m._86O&&(delete m._86O,m.fi({kind:"endEditRotation",event:E}),A.endTransaction()),m._87O&&(delete m._87O,m.fi({kind:"endEditScale",event:E}),A.endTransaction())}},pan:function(H,x,R){var r=this,u=r.gv;if(u.isPannable()){var J=u.getWidth(),b=u.getHeight();if(J&&b){var p=u.getCenterInfo(),v=-x/J*p.width,s=1*R/b*p.height;u.fi({kind:u._panning?"betweenPan":"beginPan",event:H}),u._panning=1;var d=r.keepHorizon,P=r.editing.touch;if((P&&H.touches&&H.touches.length>1||!P&&An(H))&&(d=!d),!d)return u.pan(v,s);if(v||s){var q=Fp(u),z=[q[0]*v,q[4]*v,q[8]*v],M=[q[1],0,q[9]],K=Math.sqrt(M[0]*M[0]+M[2]*M[2]);K&&(M=[M[0]/K*s,0,M[2]/K*s]);var Z=z[0]+M[0],D=z[1]+M[1],T=z[2]+M[2],A=u._center,B=u._eye;A[0]+=Z,A[1]+=D,A[2]+=T,B[0]+=Z,B[1]+=D,B[2]+=T,u.fp(uh,f,B),u.fp(bb,f,A)}}}},rotate:function(R,B,P){var C=this,q=C.gv;if(q.isRotatable()){var O=q._center,_=q._eye,N=ch(_,O),D=ts(G(N[0]*N[0]+N[2]*N[2]),N[1]),E=po(q,D+P);P=E-D,q.fi({kind:q._rotating?"betweenRotate":"beginRotate",event:R}),q._rotating=1,q.rotate(B,P)}}}),b.defineProperties(Ps.prototype,{panButton:{get:function(){return this._panButton},set:function(p){this._panButton=p}},minPhi:{get:function(){return this._minPhi},set:function(m){this.gv.setRotateMinPhi(this._minPhi=m)}},maxPhi:{get:function(){return this._maxPhi},set:function(S){this.gv.setRotateMaxPhi(this._maxPhi=S)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(G){this._keepHorizon=G}},threshold:{get:function(){return this._threshold},set:function(M){this._threshold=M}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(X){this._touchScaleThreshold=X}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(f){this._touchRotateThreshold=f}}});var Qs,Rs="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",Ss=32,Ts=nj.GlobeInteractor=function(H,g){Hm(Ts,this,[H]);var A,R=g.radius||6378137,Z=this,j=null;Qs||(Qs=Rq(),Qs.style.border="",Qs.style.backgroundImage="url("+Rs+")");
var S=new _n,n=new np,Q=new np,v=new np,O=new ci,J="number"==typeof R?{x:R,y:R,z:R}:R,m={center:new np(0,0,0),radius:J},h=function(u){H._81O=null;var j=H.getHitPosition(u,H.getCenter(),n.copy(H.getEye()).sub(Q.copy(H.getCenter())).toArray());return O.origin.copy(H.getEye()),O.direction.copy(j).sub(O.origin).normalize(),O.intersectEllipsoid(m)},T=function(k,o){H._81O=null,O.origin.copy(H.getEye());for(var F,i,W=H.getCenter(),T=n.copy(H.getEye()).sub(Q.copy(H.getCenter())).toArray(),_=1,P=16,V=0,A=1,d={x:0,y:0};P--;){if(d.x=o.x+(k.x-o.x)*_,d.y=o.y+(k.y-o.y)*_,F=H.getHitPosition(d,W,T),O.direction.copy(F).sub(O.origin).normalize(),i=O.intersectEllipsoid(m),i&&1===_)return{hit:i};i?V=_:A=_,_=(V+A)/2}return{hit:i,out:1>_}},d=function(m,$){if(j){var e=Date.now();j.deltaTime=j.lastTime?e-j.lastTime:1e3,j.lastTime=e,j.lastAxis=m,j.lastAngle=$}$&&(S.setFromAxisAngle(m,$),H.setEye(n.copy(H.getEye()).applyQuaternion(S).toArray()),H.setCenter(n.copy(H.getCenter()).applyQuaternion(S).toArray()),H.setUp(n.copy(H.getUp()).applyQuaternion(S).toArray()))};Z._showCrossIcon=function(F){Zg(Z.getView(),Qs),kq(Qs,{x:F.clientX-Ss/2,y:F.clientY-Ss/2,width:Ss,height:Ss})},Z._hideCrossIcon=function(){bn(Qs)},Z._scrollImpl=function(D,E){j={point:H.lp(D),screen:dg(D),hit:h(D),type:"right"},j.hitNormalize=j.hit?j.hit.clone().normalize():new np;var f={clientX:j.screen.x,clientY:j.screen.y+10*E};Z._handleMoveImpl(f),Z._endMoveImpl(f)},Z._startMoveImpl=function(M){A&&(A.stop(!0),A=null),j={point:H.lp(M),screen:dg(M),hit:h(M)},j.hitNormalize=j.hit?j.hit.clone().normalize():new np,bj(M)?1===M.touches.length?j.hit&&(j.type="left"):2===M.touches.length&&(j.type="touch2"):(zj(M)?j.hit&&(j.type="left"):er(M)?j.type="right":Jl(M)&&j.hit&&(j.type="middle"),!j.hit||"right"!==j.type&&"middle"!==j.type||Z._showCrossIcon(M)),j.type&&bg(Z,M)},Z._handleMoveImpl=function(o){if(j)switch(j.type){case"left":return Z._handleLeft(o);case"right":return Z._handleRight(o);case"middle":return Z._handleMiddle(o);case"touch2":return Z._handleTouch2(o)}},Z._endMoveImpl=function(){if(j){if(this._hideCrossIcon(),"left"===j.type||"middle"===j.type){var o=1e3*(j.lastAngle/(j.deltaTime||30)),_=j.lastAxis,v=j.lastTime,p=function(){var l=Date.now(),J=(l-v)/1e3;return v=l,o*=Math.pow(Math.abs(Z.decelerationRate),3*J),Math.abs(o)<.01?(o=0,A&&A.stop(),void 0):(d(_,o*J),void 0)};A=xo({action:function(){p(arguments)},duration:5e3})}j=null}},Z._handleLeft=function(C){if(!j.finished){var A=dg(C),k=T(A,j.lastScreen||j.screen);if(j.lastScreen=A,!k.hit)return j.finished=!0,Z._endMoveImpl(C),void 0;var I=k.hit;I.normalize();var K=j.hitNormalize,M=Math.acos(I.dot(K)),$=I.cross(K).normalize();d($,M),k.out&&(j.finished=!0,Z._endMoveImpl(C))}},Z._handleRight=function(F){var P=j.lastScreen||j.screen,M=P.y;P=j.lastScreen=dg(F);var Y=P.y,I=Y-M;if(I){var r=Math.min(.5,I*Z.scaleSpeed);n.copy(H.getEye());var T=j.hit;T||(T=n.clone().divide(J).normalize().multiply(J)),Q.copy(n).lerp(T,r),H.setEye(Q.toArray()),n.copy(H.getUp()),Q.normalize();var t=n.clone().cross(Q).normalize();if(v.copy(H.getCenter()),v.sub(t.multiplyScalar(v.dot(t))),H.setCenter(v.toArray()),j.hit){var G=h(j.screen),A=j.hitNormalize;if(G){G.normalize();var z=Math.acos(G.dot(A)),g=G.cross(A).normalize();z&&d(g,z)}}}};var P=function(C){return Math.abs(C)<.01?0:C>0?1:-1};Z._handleTouch2=function(Y){var l=Y.touches.length;if(2===l){var W=Y.touches,v={x:W[0].clientX,y:W[0].clientY},n={x:W[1].clientX,y:W[1].clientY},t={x:n.x-v.x,y:n.y-v.y},u=j.lastCenter,N=Math.atan2(t.y,t.x),h=j.theta,y=0;h==f?h=j.theta=N:(y=N-h,j.thetaStarted||Math.abs(y)>.03?(j.thetaStarted=!0,j.theta=N):y=0);var B,F=Math.sqrt(t.x*t.x+t.y*t.y),g=j.vlen;if(g){var z=v.x-u.x,x=v.y-u.y,O=n.x-u.x,X=n.y-u.y,U=Math.sqrt(z*z+x*x),$=Math.sqrt(O*O+X*X),o=g/2,L=P(U-o),b=P($-o);0>L*b||0===L&&0===b?(B=1,j.vlen=F):(B||(B=F/g),j.scaleStarted||Math.abs(B-1)>.05?(j.vlen=F,j.scaleStarted=!0):B=1)}else g=j.vlen=F,B=1;var t=Q.copy(H.getEye()).clone();1!==B&&H.setEye(t.setLength((t.length()-R)/B+R).toArray()),y&&d(t.normalize(),y),j.lastCenter={x:(n.x+v.x)/2,y:(n.y+v.y)/2}}},Z._handleMiddle=function(F){var r=dg(F),V=j.screen;j.screen=r;var g=(r.y-V.y)/180*Math.PI*Z.rollSpeed;Q.copy(H.getCenter()).sub(n.copy(H.getEye())).normalize(),n.copy(H.getUp()).cross(Q).normalize(),Q.copy(H.getEye()).sub(j.hit).applyAxisAngle(n,g).add(j.hit);var i=Q.clone();Q.copy(H.getCenter()).sub(j.hit).applyAxisAngle(n,g).add(j.hit);var B=Q.clone(),M=Q.copy(H.getUp()).applyAxisAngle(n,g).clone(),p=!1;g>0&&(v.copy(M),Q.copy(B).sub(i).normalize(),n.copy(i).multiplyScalar(-1).normalize(),n.dot(v)-Q.dot(v)>0&&(p=!0)),p||v.copy(j.hit).sub(i).dot(j.hitNormalize)>=0&&(p=!0),p||(H.setEye(i.toArray()),H.setCenter(B.toArray()),H.setUp(M.toArray()));var I=-(r.x-V.x)/180*Math.PI*Z.rotateSpeed;d(j.hitNormalize,I)}};Ri("GlobeInteractor",Ns,{handle_contextmenu:function(T){Lk(T)},handle_mousewheel:function(M){this._scrollImpl(M,M.wheelDelta/40)},handle_DOMMouseScroll:function(w){2===w.axis&&this._scrollImpl(w,-w.detail)},handle_keydown:function(e){this.gv.handleKeyDown(e)},handle_mousedown:function(O){this.handle_touchstart(O)},handle_touchstart:function(d){Lk(d);var e=this.gv;if(e.setFocus(d)){var s=e.getDataInfoAt(d),c=s?s.data:f;c&&e.isInteractive(c)||this._startMoveImpl(d);var t=s?s.part:f;Md(d)?e.handleDoubleClick(d,c,t):e.handleClick(d,c,t)}},handle_mouseup:function(E){this.handle_touchend(E)},handle_touchend:function(){},handleWindowMouseMove:function(y){this.handleWindowTouchMove(y)},handleWindowTouchMove:function(g){this._handleMoveImpl(g)},handleWindowMouseUp:function(T){this.handleWindowTouchEnd(T)},handleWindowTouchEnd:function(t){this._endMoveImpl(t)}}),b.defineProperties(Ts.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(t){this._rotateSpeed=t}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(g){this._rollSpeed=g}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(z){this._scaleSpeed=z}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(R){this._decelerationRate=R}}});var Us=function(G){var z=2147483648|G;return[(255&z>>16)/255,(255&z>>8)/255,(255&z)/255,(255&z>>24)/255]},Vs=function(l){this.gv=l,this.gv.pickColorMap={_pickIdUsed:2e3}};kl(Vs,b,{_iv:!0,iv:function(){this._iv=!0},get:function(k,K,F){this.validate();var W=this,$=W.gv.getGL();if(!$)return f;var p,l,E=W._resolution,a=Math.round(k.x*E),u=Math.ceil(k.width*E),N=Math.ceil(k.height*E),b=W.height-Math.round(k.y*E)-N,e=j(u/2),_=new Uint8Array(4*u*N),S=0,D=_.length,V=K?f:new zp,B=K?f:{};if(Kj($,W.frame),$.readPixels(a,b,u,N,$.RGBA,$.UNSIGNED_BYTE,_),li($),K){for(;e>=S;S++)for(var i=e-S,Q=e+S,h=i;Q>=h;h++)for(var M=i;Q>=M;M++)if((h===i||h===Q||M===i||M===Q)&&(p=W.info(_,4*(h*u+M)))){if(F&&F(p)===!1)continue;return p}}else for(;D>S;S+=4)if(p=W.info(_,S)){if(F&&F(p)===!1)continue;l=p.data,B[l._id]||(V.add(l),B[l._id]=l)}return V},info:function(Y,U){return this.gv.pickColorMap[(Y[U]<<16)+(Y[U+1]<<8)+Y[U+2]+((127&Y[U+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(){var m=this,E=m.gv,K=E.getGL();if(K){var j=m._resolution=E._pickerResolution*E.getDevicePixelRatio(),x=Math.round(j*E.getWidth()),s=Math.round(j*E.getHeight()),B=K.RGBA,T=K.TEXTURE_2D,C=K.RENDERBUFFER,o=K.FRAMEBUFFER;if(m.texture||(m.texture=Nm(K),m.render=K.createRenderbuffer(),m.frame=K.createFramebuffer()),(m.width!==x||m.height!==s)&&(K.activeTexture(K.TEXTURE0),or(K,m.texture),K.texImage2D(T,0,B,x,s,0,B,K.UNSIGNED_BYTE,f),xn(K,K.TEXTURE_MIN_FILTER,K.LINEAR),K.bindRenderbuffer(C,m.render),K.renderbufferStorage(C,K.DEPTH_COMPONENT16,x,s),Kj(K,m.frame),K.framebufferTexture2D(o,K.COLOR_ATTACHMENT0,T,m.texture,0),K.framebufferRenderbuffer(o,K.DEPTH_ATTACHMENT,C,m.render),or(K,f),K.bindRenderbuffer(C,f),li(K),m.width=x,m.height=s),m._iv){m._iv=!1;var t=!1;E._40Q.each(function(M){!t&&M.isBatchInvalid()&&(t=!0)}),t&&E.updateScene(),Kj(K,m.frame),K.clear(K.COLOR_BUFFER_BIT),E.overlappingBox.clear(),E.setViewport(K,0,0,x,s),E.renderPickScene(),li(K)}}}});var Ws=function(s){this.gv=s};kl(Ws,b,{gap:0,size:0,_42:function(l,i){var q=this,T=q.gv,B=T._gridGap,r=T._gridSize;if(T._gridVisible){if(q.gap!==B||q.size!==r){for(var H=[],e=T._gridSize/2,E=B*e,J=0;2*e+1>J;J++){var R=6*J,K=6*(2*e+1)+R;H[R]=-E,H[R+1]=0,H[R+2]=-E+J*B,H[R+3]=E,H[R+4]=0,H[R+5]=-E+J*B,H[K]=-E+J*B,H[K+1]=0,H[K+2]=-E,H[K+3]=-E+J*B,H[K+4]=0,H[K+5]=E}q.vs=new Qb(H),q.gap=B,q.size=r}Qi(T),mh(l),di(l);var N=!T._fogDisabled;if(N){var g=se.for(l).directUniforms();g.uFog=!1}gi(l,i,1,T._gridColor,T._buffer.vs,q.vs),En(l,0,q.vs.length/3,l.LINES),N&&(g.uFog=!0),Ib(l),ug(l)}else q.vs=q.gap=q.size=f}});var Xs=function(a){this.gv=a};kl(Xs,b,{_42:function(c,W){var I=this.gv,g=I._buffer.vs,r=I._axisXColor,v=I._axisYColor,x=I._axisZColor,w=I._originAxisVisible,k=I._centerAxisVisible;if(w||k){var M=xf?c.TRIANGLES:c.TRIANGLE_FAN,j=c.LINES;if(Qi(I),mh(c),di(c),w){var q=I.getCenterInfo(),n=h(q.width,q.height)/5,u=.8*n,$=.05*n;gi(c,W,1.5,r,g,new Qb([0,0,0,n,0,0,u,$,0,u,0,$,u,-$,0,u,0,-$,u,$,0,0,0,0,0,n,0,$,u,0,0,u,$,-$,u,0,0,u,-$,$,u,0,0,0,0,0,0,n,$,0,u,0,$,u,-$,0,u,0,-$,u,$,0,u])),En(c,0,2,j),En(c,1,6,M),gi(c,W,f,v),En(c,7,2,j),En(c,8,6,M),gi(c,W,f,x),En(c,14,2,j),En(c,15,6,M)}if(k){var N=I._center,o=N[0],O=N[1],T=N[2],q=I.getPositionInfo(N);n=h(q.width,q.height)/20,gi(c,W,1.5,r,g,new Qb([o,O,T,o+n,O,T,o,O,T,o,O+n,T,o,O,T,o,O,T+n])),En(c,0,2,j),gi(c,W,f,v),En(c,2,2,j),gi(c,W,f,x),En(c,4,2,j)}Ib(c),ug(c)}}});var Ys=function(R){this.gv=R},Zs="edit_tx",$s="edit_ty",_s="edit_tz",at="edit_rx",bt="edit_ry",ct="edit_rz",dt="edit_sx",et="edit_sy",ft="edit_sz",gt={};gt[Zs]=101,gt[$s]=102,gt[_s]=103,gt[at]=104,gt[bt]=105,gt[ct]=106,gt[dt]=107,gt[et]=108,gt[ft]=109,kl(Ys,b,{_42:function(U,D,s){var e=this,Q=e.gv,p=Q.sm().ld();if(p&&Q.isEditable(p)&&!Q.isEditHelperDisabled()&&mq(p)&&(!Q.isFirstPersonMode()||!Q.isMouseRoamable()&&!dn)){Qi(Q);var $,S=Q.isMovable(p),f=Q.isRotationEditable(p),N=Q.isSizeEditable(p),H=Q._axisXColor,n=Q._axisYColor,K=Q._axisZColor,F=Q._editSizeColor,t=p.p3();if(Q.isOrtho()){var m=Q.getCenterInfo();$=h(m.width,m.height)/8}else $=Mp(Q.getEye(),t)/10;var c,l,k=$/(s?5:10),j=.7*$,T=.4*j,R=t[0],A=t[1],M=t[2];c=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],S&&e._17O(U,D,p,s,Zs,H,c,[R,A-k,M,R+j,A-k,M,R+j,A,M,R+j,A,M,R,A,M,R,A-k,M,R,A-k,M+k,R+j,A-k,M+k,R+j,A-k,M,R+j,A-k,M,R,A-k,M,R,A-k,M+k]),l=R+j,N&&e._17O(U,D,p,s,dt,F,c,[l,A-k,M,l+T,A-k,M,l+T,A,M,l+T,A,M,l,A,M,l,A-k,M,l,A-k,M+k,l+T,A-k,M+k,l+T,A-k,M,l+T,A-k,M,l,A-k,M,l,A-k,M+k]),l+=T,f&&e._17O(U,D,p,s,at,H,c,[l,A-k,M,l+T,A-k,M,l+T,A,M,l+T,A,M,l,A,M,l,A-k,M,l,A-k,M+k,l+T,A-k,M+k,l+T,A-k,M,l+T,A-k,M,l,A-k,M,l,A-k,M+k]),c=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],S&&e._17O(U,D,p,s,$s,n,c,[R,A,M,R,A+j,M,R-k,A+j,M,R-k,A+j,M,R-k,A,M,R,A,M,R,A,M,R,A,M-k,R,A+j,M-k,R,A+j,M-k,R,A+j,M,R,A,M]),l=A+j,N&&e._17O(U,D,p,s,et,F,c,[R,l,M,R,l+T,M,R-k,l+T,M,R-k,l+T,M,R-k,l,M,R,l,M,R,l,M,R,l,M-k,R,l+T,M-k,R,l+T,M-k,R,l+T,M,R,l,M]),l+=T,f&&e._17O(U,D,p,s,bt,n,c,[R,l,M,R,l+T,M,R-k,l+T,M,R-k,l+T,M,R-k,l,M,R,l,M,R,l,M,R,l,M-k,R,l+T,M-k,R,l+T,M-k,R,l+T,M,R,l,M]),c=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],S&&e._17O(U,D,p,s,_s,K,c,[R,A,M,R,A,M+j,R,A-k,M+j,R,A-k,M+j,R,A-k,M,R,A,M,R,A-k,M,R-k,A-k,M,R-k,A-k,M+j,R-k,A-k,M+j,R,A-k,M+j,R,A-k,M]),l=M+j,N&&e._17O(U,D,p,s,ft,F,c,[R,A,l,R,A,l+T,R,A-k,l+T,R,A-k,l+T,R,A-k,l,R,A,l,R,A-k,l,R-k,A-k,l,R-k,A-k,l+T,R-k,A-k,l+T,R,A-k,l+T,R,A-k,l]),l+=T,f&&e._17O(U,D,p,s,ct,K,c,[R,A,l,R,A,l+T,R,A-k,l+T,R,A-k,l+T,R,A-k,l,R,A,l,R,A-k,l,R-k,A-k,l,R-k,A-k,l+T,R-k,A-k,l+T,R,A-k,l+T,R,A-k,l])}},_17O:function(T,t,i,R,K,b,J,r){var _=this.gv,d=_._buffer,D=se.for(T),A=D.directUniforms(),x=D.directAttribs();if(_._picking){R=_.pickColorMap;var W=gt[K];R[W]={data:i,part:K},A.uFixPickReverseColor=Us(W)}_d(T,t,f,!0,f,!0,f,!1),A.uDiffuse=b,x.aPosition=zi(T,d.vs,new Qb(r),f),x.aNormal=zi(T,d.ns,new Qb(J),f),di(T),En(T,0,12),Ib(T),Yd(T,t)}});var ht=H.Raycaster=function(G){this.gv=G,this.maxTriangleTest=1/0,this.backfaceCulling=!0};Ce("Raycaster",b,{intersect:function(w){var v=this,D=v.gv,x=D.getDataAt(w);return x?v.intersectObject(w,x):null},intersectObjects:function(g,f,t){var k,J,V,o,Y=this,Q=1/0,j=g.origin||(new np).fromArray(Y.gv.getEye()),P=Y.maxTriangleTest,B=[];f.forEach(function(i){t&&t(i)===!1||i.s("intersect")!==!1&&B.push(i)});var T=j.distanceToSquared2([0,0,0]);return B.sort(function(G,J){return(G.p3?j.distanceToSquared2(G.p3()):T)-(J.p3?j.distanceToSquared2(J.p3()):T)}),Y.countTriangles=0,B.forEach(function(Z){Y.countTriangles>P||(k=Y.intersectObject(g,Z),k&&(J=j.distanceToSquared(k.world),Q>J&&(V=Z,o=k,Q=J)))}),Y.countTriangles=0,{data:V,intersect:o}},intersectObjectAndRecordTriangle:function(r,P){this._4GQ=!0;var M=this.intersectObject(r,P);return this._4GQ=!1,M},intersectLastTriangle:function(u,V){var a=this.getRay(u);a.applyMatrix4(V.inverseMatrix);var D=a.intersectPlane(V.plane);if(!D)return null;var w=No.uvIntersection(D,V.p1,V.p2,V.p3,V.uv1.clone(),V.uv2.clone(),V.uv3.clone());return{world:D.clone().applyMatrix4(V.matrixWorld),local:D.clone(),uv:w}},getRay:function(S){if(S instanceof ci)return S;var p=this,e=p.gv,h=e.unproject(S),$=new np,_=e.getEye(),Z=new np;if(e.isOrtho()){var q=new np(_);Z.copy(e.getCenter()).sub(q).normalize();var N=$.copy(h).sub(q).dot(Z);$.copy(Z).setLength(-N).add(q.copy(h))}else $.copy(_),Z.copy(h).sub($).normalize();return new H.Math.Ray($,Z)},intersectObject:function(F,S){return this._intersectObjectImpl(this.getRay(F),S)},_intersectObjectImpl:function(){function E(){var I=new np;return I.subVectors(p,c),G.subVectors(Q,c),I.cross(G).normalize(),I}var J=new jf,u=new jf,Z=new ci,n=new np,O=new np,S=new np,j=new np,v=new np,Q=new np,c=new np,p=new np,l=new pb,P=new pb,W=new pb,G=new np,N={vs:jd,is:Fl,uv:Tp},Y=ad.slice(0);return Y.push("csg"),function(f,R){var G=this.gv.getData3dUI(R),M=R.mat||G.mat;M?J.fromArray(M):J.identity(),u.getInverse(J),Z.copy(f).applyMatrix4(u);var U,k,K,I="body",T=G.shapeModel;if(!T&&(R instanceof H.Polyline||R instanceof H.Edge)&&G.lineShapeModel&&(T=G.lineShapeModel),T||(T=Kq(G)),T||(H.CSGNode&&R instanceof H.CSGNode||H.CSGShape&&R instanceof H.CSGShape?(K=!0,T=[G.left,G.front,G.right,G.back,G.top,G.bottom,G.csg]):R instanceof H.Node&&!(R instanceof H.Shape)?(U=!0,T=N):(k=!0,T=[G.left,G.front,G.right,G.back,G.top,G.bottom])),!T)return console.log("Can not find shape model."),null;br(T)||(T=[T]);var o,x,m,g,r,$,z,X,q,y,b,L,d,a,F,e,C=1/0,B=["","top_","bottom_"],i=!1,A=this.backfaceCulling,V=[];for(mm(T,G,V),o=0,x=V.length;x>o;o++)if(d=V[o])for(m=0,g=B.length;g>m;m++)if(a=B[m],z=d[a+"vs"],X=d[a+"is"],q=d[a+"uv"]||d[a+"tuv"],z){if(F=d[a+"boundingBox"]){var b=Z.intersectBox(F);if(!b)continue;if(Z.origin.distanceTo(b)>C)continue;e=!1}else d[a+"boundingBox"]=F=new H.Math.Box3,e=!0;for(r=0,$=X?X.length:z.length/3;$>r;r+=3)this.countTriangles++,X?(O.fromArray(z,3*X[r]),S.fromArray(z,3*X[r+1]),j.fromArray(z,3*X[r+2])):(O.fromArray(z,3*r),S.fromArray(z,3*(r+1)),j.fromArray(z,3*(r+2))),e&&(F.expandByPoint(O),F.expandByPoint(S),F.expandByPoint(j)),y=Z.intersectTriangle(O,S,j,A,n),y&&(L=Z.origin.distanceTo(y),C>L&&(C=L,v.copy(y),Q.copy(O),c.copy(S),p.copy(j),""!==a?I=a.slice(0,-1):U?I=ad[Math.floor(r/6)]:k?I=ad[o]:K&&(I=Y[o]),q&&(i=!0,X?(l.fromArray(q,2*X[r]),P.fromArray(q,2*X[r+1]),W.fromArray(q,2*X[r+2])):(l.fromArray(q,2*r),P.fromArray(q,2*(r+1)),W.fromArray(q,2*(r+2))))))}if(!isFinite(C))return null;var D,t,s=v.clone().applyMatrix4(J),h=this._4GQ;i&&(h&&(t={inverseMatrix:u.clone(),matrixWorld:J.clone(),p1:Q.clone(),p2:c.clone(),p3:p.clone(),uv1:l.clone(),uv2:P.clone(),uv3:W.clone(),plane:(new H.Math.Plane).setFromCoplanarPoints(Q,c,p)}),D=No.uvIntersection(v,Q,c,p,l,P,W));var w=E(Q,c,p),_=E(Q.applyMatrix4(J),c.applyMatrix4(J),p.applyMatrix4(J)),Gb=Z.direction.dot(w);Gb>0&&(w.multiplyScalar(-1),_.multiplyScalar(-1));var aq={world:s,local:v.clone(),worldNormal:_,normal:w,uv:D,part:I};return t&&(aq.triangleInfo=t),aq}}()});var it=function(j,I){this.gv=j,this.s=function(Q,W,b){return W==f&&(W=b),W==f?I.getStyle(Q):kh(W,I,j)},this.data=I};kl(it,b,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:E,iv:function(){this._iv=!0},update:function(o,J,r){var q=this,v=q.data;if(o||(o=q.gv,J=o.getGL(),r=o._40Q),!q.needValidate(J)||!o.isVisible(v))return r.push(this,!1),void 0;var R,$,i,c,Y,Q=v._id,H=v._47Q?null:q.s("batch"),t=v.getRenderLayer(),F=r.get(t,!0),G=F.batchIndexMap,L=F.batchModelMap,m=o.getBrightness(v),B=m!=f&&1!==m;R=zd(G,L,v,H,o);var I=H?o.getBatchInfo(H)||Cq:f,C=q.validate(R,I);if(R&&(!I.ms||!I.ms.length)&&($=G[Q],i=$.size=R.vs.length/3-$.begin,Y=R.rs))for(m=B?m:1,c=0;i>c;c++)Y.push(m);var O=o.getWireframeGeometry(v);if(O)dd(o,v,O);else if(mq(v)){var E=o.getWireframe(v);E&&dd(o,v,E)}q.labelInfo=q.label2Info=q.noteInfo=q.note2Info=q._38o=f,q._24O(oc,"getLabel"),q._24O(jr,"getLabel2"),q._26O(Ap,"getNote"),q._26O(uj,"getNote2"),q._15O(),q.interactiveInfo=o.isInteractive(v)?{}:f,F.push(this,!0),C!==!1&&(q._iv=!1)},clearWireframeGeometryCache:function(){var U=this;gf(U),U.data.iv()},_46Q:function(J){var H=this,u=H.data,j=H.gv;if(j.isVisible(u)){var K=u._id,h=j._40Q.get(u._renderLayer,!0),R=h.batchIndexMap[K],$=h.polylineIndexMap[K],c=h.wireframeIndexMap[K];if(R||$||c){var v=fh(J,j.pickColorMap,j.isSelectable(u),H,Rn,!0);v&&(Jg(v,R,h.batchModelMap,j),Jg(v,$,h.polylineModelMap,j),Jg(v,c,h.wireframeModelMap,j))}}},_42:function(I,t,P){function J(v,Z,x){var D=Z.getBrightness(x),a=x.s("alphaTest"),T=x.s("envmap"),P=se.for(v),Q=P.directUniforms();D!=f&&1!==D&&(Q.uBrightness=D),Q.uAlphaTest=a,Q.uUseEnvMap=T?!0:!1,Q.uReflectivity=T||.01,Q.roughness=x.s("roughness"),Z._setEnvmapByProbeId(Q,x.s("envmap.probe")),Q.shadowReceive=!A&&x.s("shadow.receive"),Q.shadowCull=!A&&!!x.s("shadow.cull"),Nk(Z,Q,x.s("3d.clipbox")?Ee:x.s("3d.clipbox.mask"));var O=c.s("3d.clip.direction");if(O){var z=c.s("3d.clip.percentage");0===z&&($=!1);var _=c._formatClipUniforms(O,z,x);Q.uClipPercent=_[1],Q.uClipDirection=_[0]}else Q.uClipDirection=0;v._blooming&&!x.s("bloom")&&(Q.blackout=!0),A||(Z._flowObjects.length&&Z.flowMap.resetDataFlowEnabld(x,Q),Nf(Z,Q,x.s("light.mask"),x.s("headlight.ambientIntensity")))}var c=this,T=c.data,V=c.gv;if(V.isVisible(T)){var N,A=V._picking;if(A)N=V.pickColorMap;else{if(V.isTransparentMask(T)||V.isReflecting(I)&&T.s("3d.reflectable")===!1)return;N=E}if(it.getTitle===E){it.getTitle=0;for(var B in L)if(B.length===jr.length+1&&B[jr.length]===Ho[4].toUpperCase()&&B[jr.length-1]===Ho[jr.length+1].toUpperCase()){it.getTitle=Wp;break}}if(!it.getTitle||Cj[jr.length+2]){if(it.getHead===E){it.getHead=0;for(var B in k){var p="box-sizing";6===B.length&&B[0]===Ho[4]&&B[3]===p[0]&&B[4]===p[1]&&B[5]===p[2]&&(it.getHead=km)}}if(!it.getHead||Cj[jr.length]){if(it.getTitle2===E){it.getTitle2=0;for(var B in k){var F="uv";6===B.length&&B[0]===Eh[1].toUpperCase()&&B[1]===F[0]&&(it.getTitle2=jb)}}if(!it.getTitle2||Cj[gq.length]){var D,Z,Y=T._id,O=V._40Q.get(T._renderLayer,!0),i=O.batchIndexMap,v=O.batchModelMap,h=V.isSelectable(T),W=!1,$=!0,q=i[Y];if(A&&(Z=fh(I,N,h,c,Rn,q),Z&&!V._45Q&&(Jg(Z,q,v,V),Jg(Z,O.polylineIndexMap[Y],O.polylineModelMap,V),Jg(Z,O.wireframeIndexMap[Y],O.wireframeModelMap,V))),q||(W||(W=!0,J(I,V,T)),$&&c._80o(I,t,P)),V.isLabelVisible(T)&&((D=c.labelInfo)&&(A&&fh(I,N,h,c,oc),W||(W=!0,J(I,V,T)),c._28O(D,oc,P)),(D=c.label2Info)&&(A&&fh(I,N,h,c,jr),W||(W=!0,J(I,V,T)),c._28O(D,jr,P))),V.isNoteVisible(T)&&((D=c.noteInfo)&&(A&&fh(I,N,h,c,Ap),W||(W=!0,J(I,V,T)),c._29O(D,Ap,P)),(D=c.note2Info)&&(A&&fh(I,N,h,c,uj),W||(W=!0,J(I,V,T)),c._29O(D,uj,P))),(D=c._38o)&&(W||(W=!0,J(I,V,T)),c._99O(I,t,D,N,h,P)),W){var s=se.for(I).directUniforms();s.uBrightness=1,s.uClipDirection=0,I._blooming&&(s.blackout=!1)}}}}}},_formatClipUniforms:function(f,R,o){switch(f){case"uv.right":f=7;break;case"uv.left":f=8;break;case"left":f=2;break;case"top":f=3;break;case"bottom":f=4;break;case"front":f=5;break;case"back":f=6;break;case"right":default:f=1}if(0===f%2&&(R=1-R),7!==f&&8!==f)if(o instanceof H.Shape){var P=o.s3(),K=o.p3(),N=o.getAnchor3d();R=3>f?(R-N.x)*P[0]+K[0]:5>f?(R-N.y)*P[1]+K[1]:(R-N.z)*P[2]+K[2]}else R-=.5;return[f,R]},prepare:function(){var L=this,n=L.data;if(!(n instanceof If)){var v,D,x,t,N,c=L.gv,A=c.getGL(),M=n._id,k=L.s("batch"),h=c._batchIndexMap,o=c._batchModelMap,Q=c.getBrightness(n),a=Q!=f&&1!==Q;if(L.needValidate(A)){v=zd(h,o,n,k,c);var r=k?c.getBatchInfo(k)||Cq:f;if(L.validate(v,r),v&&(!r.ms||!r.ms.length)&&(D=h[M],x=D.size=v.vs.length/3-D.begin,N=v.rs))for(Q=a?Q:1,t=0;x>t;t++)N.push(Q);if(mq(n)){var K=c.getWireframeGeometry(n);if(K)dd(c,n,K);else{var S=c.getWireframe(n);S&&dd(c,n,S)}}L.labelInfo=L.label2Info=L.noteInfo=L.note2Info=L._38o=f,L._24O(oc,"getLabel"),L._24O(jr,"getLabel2"),L._26O(Ap,"getNote"),L._26O(uj,"getNote2"),L._15O(),L.interactiveInfo=c.isInteractive(n)?{}:f,L._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=E},getBoundingBox:function(){var i,m,f,Y,l,R;return function(){if(this._cacheBoundingBox)return this._cacheBoundingBox;i||(i={vs:jd,is:Fl,uv:Tp},m=new np,f=new np,Y=new np,l=new np,R=new np);var g=this,a=g.data,M=g.shapeModel;if(!M&&(a instanceof H.Polyline||a instanceof H.Edge)&&g.lineShapeModel&&(M=g.lineShapeModel),M||(M=Kq(g)),M||(H.CSGNode&&a instanceof H.CSGNode||H.CSGShape&&a instanceof H.CSGShape?(isCSG=!0,M=[g.left,g.front,g.right,g.back,g.top,g.bottom,g.csg]):a instanceof H.Node&&!(a instanceof H.Shape)?M=i:(g.left||g.front||g.right||g.back||g.top||g.bottom)&&(M=[g.left,g.front,g.right,g.back,g.top,g.bottom])),!M)return E;br(M)||(M=[M]);var S,O,P,p,h,j,D,o,L,d,k,s,q=["","top_","bottom_"],$=new H.Math.Box3,G=!1;if(g._needRecoverPosition){l.set.apply(l,a.p3());var n=a.s3();R.set(1/(n[0]||1),1/(n[1]||1),1/(n[2]||1))}else l.set(0,0,0),R.set(1,1,1);var K=[];for(mm(M,g,K),S=0,O=K.length;O>S;S++)if(L=K[S])for(P=0,p=q.length;p>P;P++)if(d=q[P],D=L[d+"vs"],o=L[d+"is"],D){if(s=d+"boundingBox",k=L[s],!k)for(L[s]=k=new H.Math.Box3,h=0,j=o?o.length:D.length/3;j>h;h+=3)o?(m.fromArray(D,3*o[h]).sub(l).multiply(R),f.fromArray(D,3*o[h+1]).sub(l).multiply(R),Y.fromArray(D,3*o[h+2]).sub(l).multiply(R)):(m.fromArray(D,3*h).sub(l).multiply(R),f.fromArray(D,3*(h+1)).sub(l).multiply(R),Y.fromArray(D,3*(h+2)).sub(l).multiply(R)),!m.isNaN()&&k.expandByPoint(m),!f.isNaN()&&k.expandByPoint(f),!Y.isNaN()&&k.expandByPoint(Y);$.expandByBox(k),G=!0}return G?(this._cacheBoundingBox=$,b.freeze($),b.freeze($.min),b.freeze($.max),Ye(g.gv,a),$):E}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return ql},_80o:function(){},dispose:function(){var j=this,l=j._pickId;if(l){var K=j.gv.pickColorMap;K[l]&&delete K[l]}},getBodyColor:function(l){var $=this.data,w=this.gv.getBodyColor($);return w?w:l?$.getStyle(l):f},contextLost:function(){this._cachedTextures&&this.gv.invalidateCachedTexture(this.data)},getCachedTexture:function(n){var y=this._cachedTextures;return y?y[n||"main"]:null},setCachedTexture:function(y,X){var C=this._cachedTextures;return C||(C=this._cachedTextures={}),C[X||"main"]=y,y},invalidateCachedTexture:function(b){var O=this._cachedTextures;if(O){for(var T in O)b.deleteTexture(O[T]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(p,e){var O=this,T=O.data,F=O.gv,z=O.s,n=F[e](T);if(n!=f){var g=z(p+".scale"),I=z(p+".max"),S=O[p+"Info"]={label:n,textureScale:z(p+".texture.scale"),color:F[e+"Color"](T),font:z(p+".font"),align:z(p+".align"),background:F[e+"Background"](T)},d=S.rect=je(S,n);I>0&&I<d.width&&(S.labelWidth=d.width,d.width=I),d.x=d.y=0,d.width*=g,d.height*=g,S.mat=O._16O(z(p+".autorotate"),z(p+".position"),d,z(p+".face"),z(p+".t3"),z(p+".r3"),z(p+".rotationMode"));var J=d.width/2,H=d.height/2;S.vs=new Qb([-J,H,0,-J,-H,0,J,-H,0,J,H,0]),d.width/=g,d.height/=g}},_26O:function(Y,z){var u=this,N=u.data,e=u.gv,D=u.s,I=e[z](N);if(I!=f){var t=D(Y+".scale"),v=this[Y+"Info"]={note:I,textureScale:D(Y+".texture.scale"),expanded:D(Y+".expanded"),font:D(Y+".font"),color:D(Y+".color"),align:D(Y+".align"),borderWidth:D(Y+".border.width"),borderColor:D(Y+".border.color"),background:e[z+"Background"](N)};if(v.expanded){var L=D(Y+".max"),A=je(v,I);A.width+=6,A.height+=2,L>0&&L<A.width&&(v.labelWidth=A.width,A.width=L);var k={x:-A.width/2,y:-8-A.height,width:A.width,height:A.height+8}}else k={x:-6,y:-18,width:12,height:18};v.mat=u._16O(D(Y+".autorotate"),D(Y+".position"),f,D(Y+".face"),D(Y+".t3"),D(Y+".r3"),D(Y+".rotationMode")),v.rect=k,1!==t&&(k=ys(k),k.x*=t,k.height*=t,k.y=-k.height,k.width*=t);var q=k.x,S=k.y,$=k.width,M=k.height;v.vs=new Qb([q,-S,0,q,-S-M,0,q+$,-S-M,0,q+$,-S,0])}},eachShapeModel:function(h,D){function L(V){Ac(V),V.vs&&h(V.vs,V.is,V.ns,V.uv),V.top_vs&&h(V.top_vs,V.top_is,V.top_ns,V.top_uv),V.bottom_vs&&h(V.bottom_vs,V.bottom_is,V.bottom_ns,V.bottom_uv),V.from_vs&&h(V.from_vs,V.from_is,V.from_ns,V.from_uv),V.to_vs&&h(V.to_vs,V.to_is,V.to_ns,V.to_uv)}function b(T){var o,N,n;if(br(T))for(N=0,n=T.length;n>N;N++)o=T[N],o&&b(o);else Vn(T)?b(Kq(t,T),t):Mr(T)&&(T.shape3d?b(T.shape3d):L(T))}var t=this,n=t.data,D=D||t.shapeModel||Kq(t);D||(D=n instanceof H.Node&&!(n instanceof H.Shape)?{vs:jd,is:Fl}:[t.left,t.front,t.right,t.back,t.top,t.bottom]),b(D)},_28O:function(k,r,I){if(I(this.s(r+".transparent"))){var u=k.rect,f=k.textureScale,U=u.width*f,N=u.height*f;if(U>=1&&N>=1){var C=Mn(U,N);1!==f&&(C.translate(u.x,u.y),C.scale(f,f),C.translate(-u.x,-u.y)),mi(C,k),C.restore(),Gi(this,r,k.mat,k.vs,!0)}}},_29O:function(w,v,t){if(t(this.s(v+".transparent"))){var H=w.rect,u=w.textureScale,d=H.x,q=H.y,U=H.width*u,n=H.height*u;if(U>=1&&n>=1){H.x=H.y=0;var h=Mn(U,n);1!==u&&h.scale(u,u),fo(h,w),h.restore(),H.x=d,H.y=q,Gi(this,v,w.mat,w.vs,!1)}}},_99O:function(r,G,S,n,T,g){if(S){var K=this,X=K.gv,m=K.data,H=X._buffer,j=X._1O,E=S.icons,Z=se.for(r),M=Z.directAttribs();for(var q in E){var U=E[q],$=S.rects[q];if($&&g(kh(U.transparent,m,X))){X._picking&&fh(r,n,T,K,q);var d=kh(U.shape3d,m,X),R=d?[d]:kh(U.names,m,X),D=R?R.length:0,L=kh(U.textureScale,m,X)||1,w=kh(U.light,m,X);w==f&&(w=d?!0:!1),_d(r,G,kh(U.blend,m,X),w,kh(U.opacity,m,X),kh(U.reverseFlip,m,X),kh(U.reverseColor,m,X),kh(U.reverseCull,m,X));for(var Q=0;D>Q;Q++){var z=R[Q],F=$[Q];if(Wc(K,F.mat),d)$j(X,m,Kq(K,d),K);else{var I=mr(z);if(I){var v=F.width*L,A=F.height*L;if(v>=1&&A>=1){var o=Mn(v,A);Tc(o,I,kh(U.stretch,m,X),0,0,v,A,m,X),o.restore(),Nm(r,gr,j),di(r,G,j,kh(U.discardSelectable,m,X),H.uv,Yr),M.aPosition=zi(r,H.vs,F.vs,f),M.aNormal=Xi(r,H.ns,xb,f),Wh(r,H.is,Dc),fe(r,0,Dc.length),Ib(r,G,j)}}}ni(X)}Yd(r,G)}}}}});var jt=function(l,e){Hm(jt,this,[l,e])};kl(jt,it,{_16O:function(Q,l,u,r,W,a,t,T,U){var _=this.data,x=_.getFinalScale3d(),w=oq(l,x,u,r,T,U);if(_.hasOwnProperty("_anchor")||_.hasOwnProperty("_anchorElevation")){var V=_.getAnchor3d();w[0]-=(V.x-.5)*x[0],w[1]-=(V.y-.5)*x[1],w[2]-=(V.z-.5)*x[2]}return Ah(ue(),w,_.p3(),r,W,a,t,Q,_.getFinalRotation3d(),_.getRotationMode())},clear:function(){var M=this;M.faceMat=M.mat=M.shapeModel=M.left=M.right=M.front=M.back=M.top=M.bottom=M.csg=f},needValidate:function(n){if(this._iv)return this._validateFrameId=n._renderInfo.frame,!0;if(this.data._47Q){var a=n._renderInfo.frame;if(this._validateFrameId!==a)return this._validateFrameId=a,!0}return!1},validate:function(Y,K){var j=this,o=j.gv,C=j.data,O=j.shapeName=j.s(bc),I=Kq(j,O);if(j._updateAutoRotation(),j._updateFixSize2d(),j._updateOverlapping(),j.dispatchBoundingBoxChanged(),C._47Q){var H=C.getRenderLayer(),X=o._40Q.get(H);X&&X.ivWireframeBatch(C)}var t=ec(C,o.getMat(C),I?j.s("shape3d.scaleable"):!0);if(C.appendAnchorMatrix3d(t),j.clear(),j.mat=C.mat=t,I||!O)if(j.shapeModel=I,Y)if(I)K.instanced?o.batchInstancedModel(C,I,j,j.getBodyColor(),[t],Y):Pj(o,C,I,j,j.getBodyColor(),[t],Y);else{var i=_g(t);K.instanced?o.batchInstancedFace(C,Y,K,t,i):Ch(o,C,Y,K,t,i)}else I||(j._cubeUvs=null,j.vf(re,0),j.vf(ln,16),j.vf(Bc,8),j.vf(qo,24),j.vf(Fc,32),j.vf(ab,40))},_updateAutoRotation:function(){var x=new Fk,X=new jf,g=new np,Q=new np,$=new np;return function(){var O=this,u=O.data,I=O.s("autorotate")||O.s("shape3d.autorotate");if(!I)return u._dynamicRotation&&delete u._dynamicRotation,void 0;var w=O.gv;$.copy(O.s("shape3d.autorotate.up")||w._up);var G;G="string"==typeof I?[I.indexOf("x")<0?w._eye[0]:w._center[0],I.indexOf("y")<0?w._eye[1]:w._center[1],I.indexOf("z")<0?w._eye[2]:w._center[2]]:w._eye;var h=w._center,H=u.p3();g.copy(H),Q.set(G[0]-h[0],G[1]-h[1],G[2]-h[2]).add(g),X.lookAt(Q,g,$),x.set(0,0,0,u.getRotationMode(),!0).setFromRotationMatrix(X);var f=u._dynamicRotation;f&&Math.abs(f[0]-x.x)<1e-5&&Math.abs(f[1]-x.y)<1e-5&&Math.abs(f[2]-x.z)<1e-5||(u._dynamicRotation=[x.x,x.y,x.z])}}(),_updateFixSize2d:function(){var l=this,J=l.data,S=l.s("fixSizeOnScreen")||l.s("shape3d.fixSizeOnScreen");if(!S)return J._dynamicScale3d&&delete J._dynamicScale3d,void 0;var i=l.gv,t=ec(J,i.getMat(J)),p=Vh([0,0,0],t),b=i.toViewPosition(p);if(!isNaN(b.x)&&!isNaN(b.y)){var E=Vh([1,0,0],t),M=i.toViewPosition(E),C=Vh([0,1,0],t),L=i.toViewPosition(C),D=M.x-b.x,y=L.y-b.y;if(D&&y){var z,Q,k=J._dynamicScale3d||[1,1,1],K=mr(J.s("shape3d.image"));if(S[0]>0&&(z=S[0]),S[1]>0&&(Q=S[1]),!z||!Q){var m=S>0?S:1;z||(z=(Bb(K,J)||J.getWidth())*m),Q||(Q=(qh(K,J)||J.getTall())*m)}var c=Math.abs(D/z),X=Math.abs(y/Q);Math.abs(c-1)<.001&&Math.abs(X-1)<.001||(J._dynamicScale3d=[k[0]/c,k[1]/X,k[2]])}}},_updateOverlapping:function(){var q=this,J=q.s("hide.overlapping.group");if(!J)return q._rectOverlapping&&(q._rectOverlapping=E),void 0;var Z,K,R,F=q.gv,d=q.data,t=ec(d,F.getMat(d)),c=1/0,P=1/0,X=-1/0,_=-1/0,O=d.getAnchor3d(),g=O.x,s=O.y,y=O.z;for(Z=0;8>Z;Z++){if(K=Vh([(Z>>2)-g,(1&Z>>1)-s,(1&Z)-y],t),R=F.toViewPosition(K),isNaN(R.x)||isNaN(R.y))return;c=Math.min(c,R.x),X=Math.max(X,R.x),P=Math.min(P,R.y),_=Math.max(_,R.y)}var i={x:c,y:P,w:X-c,h:_-P};q._rectOverlapping=F.overlappingBox.isOverlapping(J,i)},getVectorDynamicSize:function(){var x,T=this,C=T.s("shape3d"),U=T.data;if("billboard"===C||"plane"===C||(x=U._currentCubeElementId)!=f){var Y,d,E=T.gv,R=ec(U,E.getMat(U)),g=U.getAnchor3d(),i=.5-g.x,s=.5-g.y,X=.5-g.z,y=Math.min(T.s("vector.dynamic.maxsize"),E._glCapabilities.maxTextureSize)/E.getDevicePixelRatio(),H=function(o,z){o[0]+=i,o[1]+=s,o[2]+=X,z[0]+=i,z[1]+=s,z[2]+=X;var G=E.toViewPosition(Vh(o,R)),m=E.toViewPosition(Vh(z,R)),V=G.x-m.x,M=G.y-m.y;return Math.min(y,Math.sqrt(V*V+M*M))};if("billboard"===C)Y=H([-.5,0,0],[.5,0,0]),d=H([0,-.5,0],[0,.5,0]);else if("plane"===C)Y=H([-.5,0,0],[.5,0,0]),d=H([0,0,-.5],[0,0,.5]);else if(U._currentCubeElementId!=f){var K=3*Fl[x+1],c=3*Fl[x],e=3*Fl[x+2];Y=H([jd[K],jd[K+1],jd[K+2]],[jd[e],jd[e+1],jd[e+2]]),d=H([jd[K],jd[K+1],jd[K+2]],[jd[c],jd[c+1],jd[c+2]])}return[Y,d]}},vf:function(s,k){var P=this;if(P.gv.getFaceVisible(P.data,s)){var J=rj(P,s);J.mat&&(P.faceMat=!0);var j=J.uv;if(j){var M=P._cubeUvs;M||(M=P._cubeUvs=new Qb([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var _=0;8>_;_++)M[k+_]=j[_]}return J}},_billboardInView:function(){var P=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],Y=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],G=new us,D=new np,K=new jf;return function(s){var n=this;if(!n.mat)return!0;var i=n.gv.getFrustum(),W="billboard"===s?P:Y;G.makeEmpty(),K.fromArray(n.mat);for(var b=0,q=W.length;q>b;b+=3)G.expandByPoint(D.fromArray(W,b).applyMatrix4(K));return i.intersectsBox(G)}}(),_80o:function(E,I,t){var l=this;if(l._rectOverlapping)return!0;var u=l.shapeModel;if(u||!l.shapeName){var W=l.s("shape3d");if(("billboard"===W||"plane"===W)&&!l._billboardInView(W))return!0;var M=l.gv,d=l.data,o=M._cube,$=se.for(E),N=$.directAttribs();if(vj&&!ol){var v=l.mat;if(v)for(var k=0;k<v.length;k++)l.mat[k]=v[v.length-k-1]}Qi(M,l.mat),!E._picking&&l.s("shape3d.reflector")||l.s("effect.flow")||(u?$j(M,d,u,l,l.getBodyColor(),t):(N.aPosition=zi(E,o.vs,f,f),N.aNormal=zi(E,o.ns,f,f),un(E,o.is),l._18O(E,I,"left",0,t),l._18O(E,I,"front",6,t),l._18O(E,I,"right",12,t),l._18O(E,I,"back",18,t),l._18O(E,I,"top",24,t),l._18O(E,I,"bottom",30,t))),ni(M),l.faceMat&&(l._18O(E,I,"left",0,t,!0),l._18O(E,I,"front",6,t,!0),l._18O(E,I,"right",12,t,!0),l._18O(E,I,"back",18,t,!0),l._18O(E,I,"top",24,t,!0),l._18O(E,I,"bottom",30,t,!0))
}},_18O:function(A,S,w,r,t,b){var U=this[w];if(U){if(!t(U.transparent))return;if(b&&!U.mat||!b&&U.mat)return;var o=this.data.s("polygonOffset");o&&il(A,o),b&&Qi(this.gv,U.mat);var g=this,M=g.data,H=se.for(A),k=H.directUniforms();M._currentCubeElementId=r;var e=g.gv,a=e.getTexture(U.texture,M,w),z=U.uv,n=U.uvScale,d=U.uvOffset,I=U.uvRotation,m=U.uvAnchor,h=U.discardSelectable;a?z?di(A,S,a,h,e._buffer.uv,g._cubeUvs,d,n,I,m):di(A,S,a,h,e._cube.uv,f,d,n,I,m):di(A),_d(A,S,U.blend,U.light,U.opacity,U.reverseFlip,U.reverseColor,U.reverseCull),k.uDiffuse=U.color||W["color.empty"],fe(A,r,6),Yd(A,S),Ib(A,S,a),b&&ni(e),o&&dr(A),M._currentCubeElementId=null}},contextLost:function(){jt.superClass.contextLost.apply(this,arguments),this.data.s("shape3d.reflector")&&(this._reflectorRenderTarget=null,this._reflectNormal=null)},drawReflector:function(){var q=new np,s=new np,S=new Fk,g=new jf,u=new np,Y=new np,w=new np,y=new np,Z=new jf,n=new jf,p=new ze,m=new Wg,J=new Wg,G=function(A,B,o){A[o]=B[0],A[o+1]=B[1],A[o+2]=B[2]},N=function(U,g,P){P=P||0,U[0]=g[P],U[1]=g[P+1],U[2]=g[P+2]},B=function(W,l){G(W,l.getEye(),0),G(W,l.getCenter(),3),G(W,l.getUp(),6)},i=function(o,e){N(e._eye,o,0),N(e._center,o,3),N(e._up,o,6),e._18Q=f;var H=e._skybox;H&&(H.p3([o[0],o[1],o[2]]),e.getData3dUI(H).iv())};return function(e){var K=this;K._reflectorInfo=null;var P=K.data;if(P._reflecting)return!1;var V=K.gv;if(V._picking)return!1;var F=P instanceof vg,M=K._reflectorRenderTarget,O=V._canvas.width,$=V._canvas.height;if(M?M.setSize(e,O,$):M=K._reflectorRenderTarget=new nj.RenderTarget(V,e,O,$),F){var t=P.getPointsMatrix3d().getElements(),r=P.p3();r[1]+=(1-P.getAnchorElevation())*P.getTall(),q.copy(Vh(r,t))}else q.copy(P.p3());if(s.copy(V.getEye()),g.makeRotationFromEuler(S.set(P.r3(),P.getRotationMode(),!0)),!K._reflectNormal){var R;if(F&&P.getThickness()<0){if(!K.shapeModel||!K.shapeModel.top_vs)return!1;R={vs:K.shapeModel.top_vs,ns:K.shapeModel.top_ns}}else{if(R=Kq(K,K.s("shape3d")),!R)return!1;!R.ns&&R.length&&(R=R[0])}if(!R.ns||!R.vs)return!1;K._reflectNormal=[R.ns[0],R.ns[1],R.ns[2]],K._reflectorVbuffer=Ti.Buffer.createVertexBuffer(e,new Float32Array(R.vs))}if(u.copy(K._reflectNormal),u.applyMatrix4(g),Y.subVectors(q,s),Y.dot(u)>0)return!1;Y.reflect(u).negate(),Y.add(q),w.copy(V.getCenter()).negate().add(q),w.reflect(u).negate(),w.add(q),y.copy(V.getUp()),y.reflect(u);var o=[0,0,0,0,0,0,0,0,0];B(o,V),N(V._eye,Y.toArray()),N(V._center,w.toArray()),N(V._up,y.toArray()),V._18Q=f;var h=V._skybox;h&&(h.p3(V._eye),V.getData3dUI(h).iv()),Kj(e,M.frame),V.setViewport(e,0,0,M.width,M.height);var X=P.s("shape3d.reflector.background");if(X){var j=e.getParameter(e.COLOR_CLEAR_VALUE);Ej(e,X)}else Ej(e,[0,0,0,1]);se.for(e).glState.depth.mask=!0,e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);var T=P.s("shape3d.reflector.clip"),I=T===E?.003:T,Q=So(V),b=Fp(V);p.setFromNormalAndCoplanarPoint(u,q.add(u.clone().multiplyScalar(I))),p.applyMatrix4(n.fromArray(b)),m.set(p.normal.x,p.normal.y,p.normal.z,p.constant),n.fromArray(Q).getInverse(n),J.set(Math.sign(m.x),Math.sign(m.y),1,1).applyMatrix4(n),m.multiplyScalar(2/m.dot(J)),Q[2]=m.x-Q[3],Q[6]=m.y-Q[7],Q[10]=m.z-Q[11],Q[14]=m.w-Q[15];var d=V._computedProjectMatrix;V._computedProjectMatrix=Q,P._reflecting=!0;var W=P.s("shape3d.reflector.shadow"),C={renderAxis:!1,renderEdit:!1,renderGrid:!1};"disabled"===W?(C.createShadowMap=!1,C.renderShadow=!1):"scene"===W?C.createShadowMap=!1:C.useReflectorSelfShadowMap=!0,V.renderScene(C),V._computedProjectMatrix=d,Z.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),Z.multiply(n.fromArray(V._projectMatrix)),Z.multiply(n.fromArray(V._viewMatrix)),X&&Ej(e,j),li(e),i(o,V);var D=P.s("shape3d.reflector.blur");if(D){var v=V.getPostProcessingModule("Blur");v&&v.drawImpl(e,M,D,D>=3,P.s("shape3d.reflector.blur.iterations"))}var l=V.getPostProcessingModule("Glitch");l&&l.enable&&l.onlyReflector&&(M=l._42(e,M));var A=e._compiledShader.reflector;A||(A=e._compiledShader.reflector=new Ti.Shader(e,Sm.Reflector.vs,Sm.Reflector.fs)),A.bind(),e.activeTexture(e.TEXTURE0),or(e,M.texture),A.uniforms.tDiffuse=0,A.uniforms.color=$r(P.s("shape3d.reflector.color")||"rgb(128,128,128)"),A.uniforms.textureMatrix=Z.toArray(),A.uniforms.modelMatrix=F?t:ec(P),A.uniforms.viewMatrix=Fp(V),A.uniforms.projectionMatrix=So(V);var z=K._reflectorVbuffer;z.upload(),A.attributes.pos.pointer(z);var H=this.s("shape3d.transparent");if(H){var x=se.for(e).glState,c=x.depth.mask;x.depth.mask=!1}return e.drawArrays(e.TRIANGLES,0,z.data.length/3),H&&(x.depth.mask=c),P._reflecting=!1,e.useProgram(V._prg),or(e,f),!0}}()}),Sm.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};var kt=function(M,Y){Hm(kt,this,[M,Y])};kl(kt,jt,{_80o:function(){}});var lt=function(q,p){Hm(lt,this,[q,p])};kl(lt,it,{_25Q:1,validate:function(j){var a=this;if(!a.s("geometry.cache")||!a.info){var U=a.gv,H=a.data,M=a.s,N=M("edge.width"),B=H._40I,X=H._41I;if(a.shapeModel=a.info=a.lineShapeModel=f,B&&X){var p,b,i,A,Y,J,O,t,l,u,W=H.isLooped(),r=M(uo),d=L.getEdgeType(r);if(d){var x=d(H,Kl(a,U,H,W,r),U,a._19Q);if(!x.points||x.points.isEmpty())return;J=a.info={},O=x.segments,Y=x.points,t=Y.size();for(var $=B.getElevation(),n=X.getElevation(),e=0;t>e;e++){var z=Y.get(e);z.e==f&&(z.e=$+(n-$)*e/(t-1))}l=Xl(Y.get(0)),u=Xl(Y.get(t-1));var v=t%2,S=(t-v)/2;J.c1=Xl(Y.get(S-1)),J.c2=Xl(Y.get(S)),0!==v&&(J.p3=J.c2),J.s1=l,J.s2=Xl(Y.get(1)),J.t1=Xl(Y.get(t-2)),J.t2=u}else{Y=new zp,J=a.info={};var T=M("edge.offset"),C=M("edge.center"),k=M("edge.source.t3"),o=M("edge.target.t3"),D=qr(U,H,"source"),K=qr(U,H,"target");if(!D||!K)return U.invalidateData(H),delete a.info,!1;if(k&&(D[0]+=k[0],D[1]+=k[1],D[2]+=k[2]),o&&(K[0]+=o[0],K[1]+=o[1],K[2]+=o[2]),r===we){O=M("edge.segments");var V=J.points=M(Ji)||Qp;if(t=V.size()){if(l=Xl(V.get(0)),u=Xl(V.get(t-1)),!C&&T){var F=T;i=ch(l,D,!0),T=h(F,Mp(D,l)),D=[D[0]+i[0]*T,D[1]+i[1]*T,D[2]+i[2]*T],i=ch(K,u,!0),T=h(F,Mp(u,K)),K=[K[0]-i[0]*T,K[1]-i[1]*T,K[2]-i[2]*T]}if(1===t)J.p3=l;else{var v=t%2,S=(t-v)/2;p=Xl(V.get(S-1)),b=Xl(V.get(S)),0!==v&&(J.p3=b),J.s1=D,J.s2=l,J.t1=u,J.t2=K}}else!C&&T&&(i=ch(K,D,!0),A=Mp(D,K),T=ac(T,A),D=[D[0]+i[0]*T,D[1]+i[1]*T,D[2]+i[2]*T],K=[K[0]-i[0]*T,K[1]-i[1]*T,K[2]-i[2]*T]),p=D,b=K;Y.add({x:D[0],y:D[2],e:D[1]}),Y.addAll(V),Y.add({x:K[0],y:K[2],e:K[1]})}else{var g=Kl(a,U,H,W,r);if(a._19Q||(g=-g),W){var s=D[0],G=D[1],w=D[2],q=B.getTall()/2+g;p=[s-g,G+q,w],b=[s+g,G+q,w],Y.add({x:s-g,y:w,e:G}),Y.add({x:s-g,y:w,e:G+q}),Y.add({x:s+g,y:w,e:G+q}),Y.add({x:s+g,y:w,e:G})}else{i=ch(K,D,!0),A=Mp(D,K);var m={x:D[0],y:D[2]},y={x:K[0],y:K[2]},I=Ng(f,m,y,g),Z=I.x-m.x,Q=I.y-m.y;T=ac(T,A),i[0]*=T,i[1]*=T,i[2]*=T,p=[D[0]+i[0]+Z,D[1]+i[1],D[2]+i[2]+Q],b=[K[0]-i[0]+Z,K[1]-i[1],K[2]-i[2]+Q],C?(Y.add({x:D[0],y:D[2],e:D[1]}),Y.add({x:p[0],y:p[2],e:p[1]}),Y.add({x:b[0],y:b[2],e:b[1]}),Y.add({x:K[0],y:K[2],e:K[1]})):(Y.add({x:p[0],y:p[2],e:p[1]}),Y.add({x:b[0],y:b[2],e:b[1]}))}}J.c1=p,J.c2=b}J._lastPointsSegments={points:Y,segments:O},J.list=M(bc)===Fn?a.createTubeModel(Y,O,N/2,j):a.createLineModel(Y,O,N,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=f}});var mt=function(A,L){Hm(mt,this,[A,L]),this._needRecoverPosition=!0};kl(mt,jt,{_80o:function(E,Y,L){var K=this,R=K._matWithExtraction||K.mat;if(R&&(!K.s("shape3d.reflector")||E._picking)){var o=K.gv,w=K.shapeModel;Qi(o,R),w?$j(o,K.data,w,K,K.getBodyColor(),L):(Um(K,E,Y,"left",L),Um(K,E,Y,"front",L),Um(K,E,Y,"right",L),Um(K,E,Y,"back",L),Um(K,E,Y,"top",L),Um(K,E,Y,"bottom",L)),ni(o)}},validate:function(r,G){var P,m,R=this,X=R.s,A=R.data,T=A._thickness/2,t=A.isClosePath(),e=A.getPoints(),M=A.getSegments(),S=X(cq),l=r&&r.uv;if(R.clear(),R.dispatchBoundingBoxChanged(),L.extractShapeTranslation||L.extractVerticesTranslation){var c=new xc.Vector3(A.p3());e=ys(e),e.forEach(function(w){w.x-=c.x,w.y-=c.z}),R._vsTranslation=(new xc.Matrix4).setPosition(c);var C=A.getShapeElevation;A.getShapeElevation=function(){return-(this.getTall()||0)*(this._anchorElevation-.5)}}else R._vsTranslation=null;if(0>T){R.s("shape3d.reflector")&&(R._reflectNormal=null);try{var h=X("shape3d.image.projection");if(h&&h[4]){var D=A.p3(),K=D[0],j=D[2];h=[K+h[0],h[1]+j,K+h[2],h[3]+j]}m=R.shapeModel=Rg(e,M,X(Rd),X(Hk),S,X(lg),A.getTall(),A.getShapeElevation(),t,h)}catch(Z){m=R.shapeModel={}}X(zk)?X("shape3d.image")||delete m.uv:(delete m.vs,delete m.ns,delete m.uv),X("shape3d.top.image")||delete m.top_uv,X("shape3d.bottom.image")||delete m.bottom_uv}else if(X(bc)===Fn)P=Hc(e,M,S,t),m=R.shapeModel={vs:[]},X("shape3d.image")&&(m.uv=[],m.sum=X(lg)||Gn(P)||1,m.len=0),X(Rd)&&!t&&(m.top_vs=[],X("shape3d.top.image")&&(m.top_uv=[])),X(Hk)&&!t&&(m.bottom_vs=[],X("shape3d.bottom.image")&&(m.bottom_uv=[])),R._12O(P,T);else{var w,v,F,x,i,d,$,B,E,J;if(P=Hc(e,M,S,t),i=R.vf(Bc,l,!1,G),T&&(d=R.vf(qo,l,!1,G),$=t?f:R.vf(re,l,!1,G),B=t?f:R.vf(ln,l,!1,G),E=R.vf(Fc,l,!1,G),J=R.vf(ab,l,!1,G)),T){for(var Q=0,V=P.length;V>Q;Q++)P[Q]=R._tryRemoveBezierPoints(P[Q],T);R._12O(P,T)}else i&&P.forEach(function(L){if(x=L.length,x>0)for(w=L[0],F=1;x>F;F++)v=L[F],R.addV(i.vs,w,v),w=v});R._20Q(P),r||(i&&(i.ns=Bk(i.vs),wd(i,"vs"),wd(i,ei)),T&&(d&&(d.ns=Bk(d.vs),wd(d,"vs"),wd(d,ei)),$&&($.ns=Bk($.vs),wd($,"vs"),wd($,ei)),B&&(B.ns=Bk(B.vs),wd(B,"vs"),wd(B,ei)),E&&(E.ns=Bk(E.vs),wd(E,"vs"),wd(E,ei)),J&&(J.ns=Bk(J.vs),wd(J,"vs"),wd(J,ei))))}var k=R.mat=A.getPointsMatrix3d().getElements();R._vsTranslation?k=R._matWithExtraction=(new xc.Matrix4).fromArray(k).multiply(R._vsTranslation).toArray():R._matWithExtraction=null,r&&(hl(R,k,r,m,G),R.clear()),C!=f&&(A.getShapeElevation=C)},_20Q:function(U){var z,a,N,H,r,E,J,F,$,S,L,T,B,c=this,X=c.front,Q=c.back,s=c.top,I=c.bottom,D=X?X.tuv:f,e=Q?Q.tuv:f,n=s?s.tuv:f,O=I?I.tuv:f,v=0,d={front:0,back:0,top:0,bottom:0};(D||e||n||O)&&(B=c.s(lg),z=B||Gn(U)||1,L=c.s("all.uv.union"),U.forEach(function(l){if(a=l.length,a>0){for(S in d)T=c.s(S+".uv.union"),(T===!1||T==f&&L===!1)&&(d[S]=0,B||(z=Gn([l])));for(E=l[0],N=1;a>N;N++){J=l[N],F=Mp(E,J);for(S in d)v=d[S],H=v/z,d[S]=v+=F,r=v/z,"back"===S&&($=H,H=1-r,r=1-$),c._14O(c[S],H,r);E=J}}}))},_14O:function(t,v,y){if(t){var l=t.uv,B=t.tuv;if(B){if(l)var f=l[0]+(l[6]-l[0])*v,p=l[1]+(l[7]-l[1])*v,I=l[2]+(l[4]-l[2])*v,Q=l[3]+(l[5]-l[3])*v,b=l[2]+(l[4]-l[2])*y,O=l[3]+(l[5]-l[3])*y,d=l[0]+(l[6]-l[0])*y,M=l[1]+(l[7]-l[1])*y;else f=v,p=0,I=v,Q=1,b=y,O=1,d=y,M=0;B.push(I,Q,b,O,d,M,d,M,f,p,I,Q)}}},_13O:function(n){var l=n.uv,$=n.tuv;$&&(l?$.push(l[2],l[3],l[4],l[5],l[6],l[7],l[6],l[7],l[0],l[1],l[2],l[3]):$.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(Y,g){var k=Y.length;if(4>k)return Y;var G,X,e,W,s,m,L=!1,r=function(n){return Y[n]},n=function(l){return Y[k-1-l]};for(s=0;1>=s;s++)for(m=s?n:r,X=m(0),e=m(1),G=2;k-1>G;G++)if(W=m(G),!W.remove)if(W.b){var Z=Ng(X,e,W,g);Z.adjust?(W.remove=!0,L=!0):(X=e,e=W)}else X=e,e=W;if(!L)return Y;var Q=[];for(G=0;k>G;G++)Y[G].remove||Q.push(Y[G]);return Q},_12O:function(K,c){var G,k,D,A,N,o=this.s("shape3d.point.epsilon"),J=this;K.forEach(function(T){if(N=T.length,N>0)for(G={p:T[0],n:!0},A=1;N>A;A++)k=T[A],D=N-1>A?T[A+1]:f,D&&Math.abs(k.x-D.x)<o&&Math.abs(k.y-D.y)<o||J.addPoint(G,k,D,c,T)})},addPoint:function(J,j,C,c,u){var Q,s,B,Y,T,q,K,y,$,_=this,N=J.p,v=J.f,W=J.b,U=_.s("shape3d.side")||bp,l=_.s("shape3d.start.angle"),g=_.s("shape3d.sweep.angle"),n=_.shapeModel,e=_.data.isClosePath();if(J.n&&(J.n=!1,v=e&&u.length>2?Ng(u[u.length-2],N,j,c):Ng(f,N,j,c),W=zr(N,v),n?n.top_vs&&_._10O(W,v,U,l,g,n.top_vs,n.top_uv):(Q=_.left)&&(_.addV(Q.vs,W,v),_._13O(Q))),s=C?Ng(N,j,C,c):e&&u.length>2?Ng(N,j,u[1],c):Ng(N,j,f,c),B=zr(j,s),n){var t,I,P=n.vs,V=n.uv,F=n.sum;for(V&&(t=n.len/F,n.len+=Mp(N,j),I=n.len/F),q=_._9O(W,v,U,l,g),K=_._9O(B,s,U,l,g),y=0;U>y;y++)$=y+1,eq(P,q[$]),eq(P,K[y]),eq(P,q[y]),eq(P,K[y]),eq(P,q[$]),eq(P,K[$]),V&&(Y=y/U,T=$/U,V.push(t,T,I,Y,t,Y,I,Y,t,T,I,T));!C&&n.bottom_vs&&_._10O(B,s,U,l,g,n.bottom_vs,n.bottom_uv,!0)}else!C&&(Q=_.right)&&(_.addV(Q.vs,s,B),_._13O(Q)),(Q=_.front)&&_.addV(Q.vs,v,s),(Q=_.back)&&_.addV(Q.vs,B,W),(Q=_.top)&&_.addH(Q.vs,v,s,B,W,!0),(Q=_.bottom)&&_.addH(Q.vs,W,B,s,v);J.p=j,J.f=s,J.b=B},_10O:function(T,p,C,D,S,M,d,R){var $,i,j=this,m=j.data,X=j._9O(T,p,C,D,S),r=(T.x+p.x)/2,h=(T.y+p.y)/2,W=m.getShapeElevation(),f=0;for(f=0;C>f;f++)R?(eq(M,X[f]),eq(M,X[f+1])):(eq(M,X[f+1]),eq(M,X[f])),eq(M,[r,W,h]),d&&(R?($=_*(f+1)/C+D,i=_*f/C+D):($=_*f/C+D,i=_*(f+1)/C+D),d.push(.5-.5*J(i),.5-.5*B(i),.5-.5*J($),.5-.5*B($),.5,.5))},_9O:function(h,d,W,$,T){var j,R,y=this,U=y.data,V=[],r=(h.x+d.x)/2,t=(h.y+d.y)/2,n=U.getTall()/2,O=U.getShapeElevation(),I=0;for(T==f&&(T=_);W>=I;I++)j=T*I/W+$,R=J(j),V.push([r+(h.x-r)*R,O+n*B(j),t+(h.y-t)*R]);return V},addV:function(x,h,F){var H=h.x,u=h.y,J=F.x,P=F.y,c=this.data,E=c.getShapeElevation(),O=c.getTall()/2;x.push(H,E-O,u,J,E-O,P,J,E+O,P,J,E+O,P,H,E+O,u,H,E-O,u)},addH:function(n,A,L,c,r,O){var F=this.data,p=F.getTall()/2,Y=F.getShapeElevation()+(O?p:-p);n.push(A.x,Y,A.y,L.x,Y,L.y,c.x,Y,c.y,c.x,Y,c.y,r.x,Y,r.y,A.x,Y,A.y)},vf:function(A,P,R,O){var p,s=this,Q=s.gv.getFaceVisible(s.data,A);return(R||Q)&&(p=rj(s,A,O),p.vs=[],p.tuv=Q&&(p.texture||P)?[]:f,p.visible=Q),p}});var nt=function(z,I){Hm(nt,this,[z,I])},ot={},pt=function(R){return/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(R)};kl(nt,jt,{validate:function(){var x=this,R=x.gv,K=x.data,i=x.s,p=$r(i("points.color")),a=i("points.size"),B=i("points.uv.offset"),V=i("points.image");!V||pt(V)||Cs.test(V)||(ot[V]||(ot[V]=x._createCachedImage(V)),V=ot[V]);var A,N,_=K._modelDirty,e=i("points.model");if(e){if(x._lastShapeModel!==e||!x.shapeModel){var U=Kq(x,e);if(!U)return;var y=[],O={};x.eachShapeModel(function(i){for(var k=0,X=i.length;X>k;k+=3){var Q=i[k],F=i[k+1],D=i[k+2],x=""+Q+"_"+F+"_"+D;O[x]||(O[x]=!0,y.push(Q,F,D))}},U),x._setShapeModelPoints(new Qb(y)),x._lastShapeModel=e,_=!0}A=x.shapeModel.vs.length,N=A/3}else{var n=K.getPoints();if(N=A=n.length,_||K._pointsDirty||!x.shapeModel){for(var u=[],F=0;N>F;F++){var J=n[F];J&&u.push(J.x,J.e,J.y)}x._setShapeModelPoints(new Qb(u)),K._pointsDirty=!1,x._lastShapeModel=null,_=!0}}if(x.info={mat:ec(K),size:a,diffuse:p,opacity:i("points.opacity"),texture:V,alphaTest:i("points.transparent")?0:i("alphaTest"),uvScale:i("points.uv.scale"),uvOffset:B,discardSelectable:i("points.discard.selectable")},_||K._colorsDirty){var M=!1,v=K.getColors();if(v&&v.length>0)for(var G=[],F=0;N>F;F++)for(var k=v[F],z=k?(M=!0,$r(k)):p,o=4*F,C=0;4>C;C++)G[o+C]=z[C];x.shapeModel.cs=M?new Qb(G):null,K._colorsDirty=!1}if(_||K._sizesDirty){var Q=!1,H=K.getSizes();if(H&&H.length>0)for(var T,d=[],F=0;N>F;F++)T=H[F],T>=0?(d.push(T),Q=!0):d.push(a);x.shapeModel.ss=Q?new Qb(d):null,K._sizesDirty=!1}if(_||K._offsetsDirty){var l=!1,s=K.getUvoffsets();if(s&&s.length>0)for(var b,D,Z,q=[],F=0;N>F;F++)b=2*F,D=s[b],Z=s[b+1],D!=E&&Z!=E?(q.push(D,Z),l=!0):q.push(B[0],B[1]);x.shapeModel.os=l?new Qb(q):null,K._offsetsDirty=!1}if(_||x._lastPointNumber!==N){this.dispose();var P=R.pickColorMap,m=x._startPickId=P._pickIdUsed;P._pickIdUsed=m+N;for(var u=[],F=0;N>F;F++){var $=m+F,j=Us($);u.push(j[0],j[1],j[2],j[3]),P[$]||(P[$]={data:K,part:F})}x.shapeModel.ps=new Qb(u),x._lastPointNumber=N}K._modelDirty=!1,this.dispatchBoundingBoxChanged()},_setShapeModelPoints:function(V){var P=this,j=P.shapeModel,D=P.shapeModel={vs:V};if(!j)return D;var R=V.length,Z=Math.round(R/3);return j.cs&&j.cs.length==4*Z&&(D.cs=j.cs),j.ss&&j.ss.length==Z&&(D.ss=j.ss),j.os&&j.os.length==2*Z&&(D.os=j.os),j.ps&&j.ps.length==4*Z&&(D.ps=j.ps),D},_createCachedImage:function(U){var x=128,Y=Vq(),L=Y.getContext("2d");Zq(Y,x,x,1),Pi(L,{width:x,height:x,comps:[{type:U,background:"white",borderWidth:0,rect:[0,0,x,x]}]},0,0,x,x);var w=H.Math.generateUUID();return ih[w]=Y,w},_80o:function(T,V){var g=this,I=g.gv,R=I._picking;if(!R||I.isSelectable(g.data)){var X=g.shapeModel,N=g.info;if(X&&X.vs&&X.vs.length){var U=se.for(T);U.useProgram(g._asureProgram(T));var E=U.directUniforms(),L=U.directAttribs();E.modelMatrix=N.mat,E.modelViewMatrix=Tq([],I._viewMatrix,N.mat),E.projectionMatrix=I._projectMatrix,E.viewMatrix=I._viewMatrix,E.scale=I.getHeight()/2,E.size=N.size,E.diffuse=N.diffuse,E.opacity=N.opacity,E.map=I.getTexture(N.texture,g.data),E.alphaTest=N.alphaTest,E.resolution=I.getDevicePixelRatio(),E.discardSelectable=N.discardSelectable,E.uvScale=N.uvScale,L.uvOffset=!R&&X.os?Xi(T,I._buffer.os,X.os,f):N.uvOffset,E.blackout=T._blooming&&!g.data.s("bloom"),L.position=Xi(T,I._buffer.vs,X.vs,f),R?(E.picking=!0,L.pickColor=Xi(T,I._buffer.ps,X.ps,f),E.useColor=!1,L.color=null):(E.picking=!1,L.pickColor=null,X.cs?(E.useColor=!0,L.color=Xi(T,I._buffer.cs,X.cs,f)):(E.useColor=!1,L.color=null)),X.ss?(E.useSizeArray=!0,L.sizeArray=Xi(T,I._buffer.ss,X.ss,f)):(E.useSizeArray=!1,L.sizeArray=null),En(T,0,X.vs.length/3,T.POINTS),U.useProgram(V),L.disable(),I.shadowMap.enable&&I.shadowMap.createShadow(),I.flowMap.createFlow(E)}}},_asureProgram:function(w){return w._pointsShader||(w._pointsShader=this.gv._postProcessing.createShader(w,nt.shaderSrc)),w._pointsShader.program},dispose:function(){nt.superClass.dispose.call(this);var w=this._startPickId,I=this._lastPointNumber;if(w&&I){for(var B=this.gv.pickColorMap,F=0;I>F;F++){var x=w+F;B[x]&&delete B[x]}delete this._startPickId,delete this._lastPointNumber}}}),nt.shaderSrc="!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj5t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vb)u!ugsjj!cv<uofp!jwufjdt3p!QvwwnP!g+g!tyfjus<ub!Nwobpsjzujdofhk!pwsfqd!3>!!woPpgjgutjftup<Q`m!hv!oj<goppsjnu!jctpppQmw!nq!j+d!lyjjoshu<bN!xbfujuWsmjfcevpunf!!>w!fodp5j!uqjjtdplQDwpnm!ps<<*!1!/v2o!j-gepfsnns!pggmtpobbus!ut!j){5fd<fw!!v>o!jogppjsunj!tgpmQpwbnu!!5sdfftwp!mv<u*j!poop<ju!jvtopjqg!p)s4nd!fcwp!p>m!!evftnfsTpjg{tfoBbsssub!z4<df!wb!uu<s*jucfvtugfg!Pgwmvp)b3ud!ftwj!{>f!Busfstbgzg<Pw!!c~p!pm<!sjptmQpfds!t>q!fsdpumjpwDfwN!bu|s!j*ys)p!mnpbDuf5t!vn)!!*g!j|!f!tsmffu!vs~o!!n<]s!p3m!p^D]l!d4j!q^!!>>!>s!p.m!p2D/w1!<|!!~*ho!jwlpdjjeq!)n!bgjjo!)*|!^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!5>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*jwdvl!j-oqhb<n!!)vEo3jfgspvsuny!fcup!p>m+!!esjptmdpbDsfetTvfgmgfjdeu!bc<muff<tgg!Pvwo!j>g,p!swnv!!cp<pfmm!bcdmTbwdvl!p+v!ue<spp!DvuoojjgppQs`nm!hw!f>d!3w!vv!w3Tddfbwm!f<|!!*wfbmsczbjuodhf!mwffTde3s!bwdPtgjgetaf!u}<}!h$ojjgl!dejfqgaj)o!fgej)!!V*T!FQ`BNNB`QF!T*V!!)veofjogjpgsfne!!tgbjn$q!mf~s!3E<!*n!bzqu<jd$bfqope!j+g!b/wfptjveg!gnjbej!o-){*z!y|/f!tjvgg!g)jcem!b)d5ldpfvwu!*>!!|s!phmmp`DGfstbvhgDgpjmep!s!|>!!fwtfmdf5!)~1!/1<-*!!1z/u1j-d!b1q/p1!-+!!2b//1s*p<m!psDfwu!v-s{oz<y!/~spm!pwDfwd!5)!5edjfgwg!v>t!fsDppmmppDsf<tv!gjggj!e)!aq|j!d*lsjpomhp!D%f%t!v";var qt=function(N,s){Hm(qt,this,[N,s]),this._needRecoverPosition=!0};kl(qt,it,{_25Q:1,validate:function(h){var u=this,r=u.data,T=u.s,b=r.getPoints(),E=b.size();u.dispatchBoundingBoxChanged();var V=r.p3(),n=u.mat=ue();tf(n,V),qe(n,r.getFinalRotation3d(),r.getRotationMode());var G=r.getScale3d(),H=r._dynamicScale3d;if(H&&(G[0]*=H[0],G[1]*=H[1],G[2]*=H[2]),Hr(n,G),tf(n,eh(V)),(!u.s("geometry.cache")||!u.shapeModel)&&(u.shapeModel=u.info=u.lineShapeModel=f,E>1)){var y=u.info={},e=r.getSegments(),c=r.getThickness(),Q=Xl(b.get(0)),x=Xl(b.get(E-1)),s=E%2,l=(E-s)/2;if(y.c1=Xl(b.get(l-1)),y.c2=Xl(b.get(l)),0!==s&&(y.p3=y.c2),y.s1=Q,y.s2=Xl(b.get(1)),y.t1=Xl(b.get(E-2)),y.t2=x,T(bc)===Fn){if(L.extractPolylineTranslation||L.extractVerticesTranslation){var V=new xc.Vector3(r.p3());b=ys(b),b.forEach(function(h){h.x-=V.x,h.e-=V.y,h.y-=V.z}),u._vsTranslation=(new xc.Matrix4).setPosition(V),u._matWithExtraction=(new xc.Matrix4).fromArray(n).multiply(u._vsTranslation).toArray()}else u._vsTranslation=null,u._matWithExtraction=null;y.list=u.createTubeModel(b,e,c/2,h)}else y.list=u.createLineModel(b,e,c,"shape.border","shape.dash")}},invalidateCachedGeometry:function(){this.shapeModel=this.info=this.lineShapeModel=f},_80o:function(U,z,e){var b=this,N=b.shapeModel;if(N){var q=b.mat;(L.extractPolylineTranslation||L.extractVerticesTranslation)&&b._matWithExtraction&&(q=b._matWithExtraction);var A=b.gv;Qi(A,q);var s,t=b.s("3d.clip.direction");if(A._uvClipEnabled&&("uv.left"===t||"uv.right"===t)&&(s=b.s("3d.clip.percentage"))<1){var $=!0,X=!0;Ac(N);var g=N.top_vs,y=N.bottom_vs,S=N.vs,c=se.for(U),w=c.directUniforms(),T=c.directAttribs();"uv.left"==t?(1>s&&($=!1),0>=s&&(X=!1)):(1>s&&(X=!1),0>=s&&($=!1)),N.top_vs=N.bottom_vs=E,T.aUv=Xi(U,A._buffer.uv,N.uv,f,2),$j(A,b.data,N,b,b.getBodyColor(),e),T.aUv=!1,w.uClipDirection=0,N.vs=E,$&&(N.top_vs=g),X&&(N.bottom_vs=y),$j(A,b.data,N,b,b.getBodyColor(),e),N.vs=S,N.top_vs=g,N.bottom_vs=y}else $j(A,b.data,N,b,b.getBodyColor(),e);ni(A)}}});var rt=H.graph3d.PostProcessing=function(C){var T,g,f,h,I=this,L={},k=!1,l=!1;!function(){b.keys(rt).forEach(function(s){L[s]=new rt[s](C)})}(),I.getModule=function(c){return c?L[c]:I},I.getModuleList=function(){return b.keys(L)},I._serializable=!0,I.handleDataModleChange=function(G,d){G&&(I._serializable&&G.setPostProcessingData(I.serialize()),G.removeSerializeListener(I.onDataModelSerialize,I)),d&&(d.addSerializeListener(I.onDataModelSerialize,I),I.deserialize(d))},I.onDataModelSerialize=function(m){"serialize"===m.type?I._serializable&&(C.dm()._postProcessingData=I.serialize()):"deserialize"===m.type&&I.deserialize(C.dm())},I.isDeserializeDisabled=function(U){return!I._serializable||U.a("sceneBloom")!==E},I.isSerializable=function(){return I._serializable},I.setSerializable=function(B){I._serializable=B,B||C.dm().setPostProcessingData(E)},I.serialize=function(){var c,z,e,i,R={};for(z in L)if(e=L[z],i=e.serializeProperties){c={},e.enable&&(c.enable=!0);for(var S in i){var G=e[S];G!=i[S]&&(c[S]=G)}b.keys(c).length&&(R[z.toLowerCase()]=c)}return R},I.deserialize=function(Q){var M,g,G,m,h,z={},e={};for(M in L){G=L[M],m=G.serializeProperties;var J={},A="scene"+M,d=Q.a(A);d!==E&&(J.enable=d);for(var h in m)d=Q.a(A+h[0].toUpperCase()+h.slice(1)),d!==E&&d!==m[h]&&(J[h]=d);cc(J)||(e[M[0].toLowerCase()+M.slice(1)]=J)}if(cc(e)&&(e=Q.getPostProcessingData()),e)for(g in e)if(g&&(M=g[0].toUpperCase()+g.slice(1),G=L[M])){z[M]=!0,m=e[g];var Y=!!m.enable;I.enableModule(M,Y),M="scene"+M,Q.a(M,Y),G.resetProperties&&G.resetProperties();for(h in m)if("enable"!==h){var d=m[h];G[h]=d,Q.a(M+h[0].toUpperCase()+h.slice(1),d)}}for(M in L)z[M]||(G=L[M],G.enable=!1,G.resetProperties&&G.resetProperties())},I.getRenderTarget=function(){return T},I.blitScreen=function(n,U,B,I,V){var m=C.getGL();if(m&&(l||u())){n&&(n.bind(m),C.setViewport(m,0,0,n.width,n.height)),V&&V.clear===!1||m.clear(m.COLOR_BUFFER_BIT|m.DEPTH_BUFFER_BIT),B||(B=g),B.bind(),m.activeTexture(m.TEXTURE0+0),or(m,U||m._emptyTexture);var W=B.uniforms;W.image=0;var L=1;if(I)for(var Y in I){var F=I[Y];F instanceof WebGLTexture&&(m.activeTexture(m.TEXTURE0+L),or(m,F),F=L,L++),W[Y]=F}if(f.upload(),h.upload(),B.attributes.pos.pointer(h),m.drawElements(m.TRIANGLES,6,m.UNSIGNED_SHORT,0),L>1)for(;--L>=0;)m.activeTexture(m.TEXTURE0+L),or(m,null);else or(m,null);n&&n.unbind(m)}},I.decodeShader=function(t){var W,N,w,j="",d="";for(w=0;w<t.length;w++)W=t[w],"%"===W?W="'":"a"===W?W='"':"]"===W&&(W="\\"),N=String.fromCharCode(W.charCodeAt(0)-1),w%2?d+=N:j=N+j;return d+j},I.createShader=function(T,X,k){var l,$;if("string"==typeof X){var f=X.indexOf("^#");l=I.decodeShader(X.substr(0,f)),$=I.decodeShader(X.substr(f+2))}else l=X.vs,$=X.fs;if(k){var m=k(l,$);m&&m.vs&&(l=m.vs),m&&m.fs&&($=m.fs)}return new Ti.Shader(T,l,$)},I.enableModule=function(l,R){var $,t,K,y=l.split(",");for($=0,t=y.length;t>$;$++)K=y[$].trim(),L[K]&&(L[K].enable=R);k=!1;for(K in L)if(L[K].enable){k=!0;break}};var u=function(){if(l)return!1;var R=C.getGL();return R?(T=new nj.RenderTarget(C,R,null,null,{samples:W.renderTextureSamples||1,minFilter:R.LINEAR,magFilter:R.LINEAR}),g=new Ti.Shader(R,w.vs,w.fs),f=Ti.Buffer.createIndexBuffer(R,new Uint16Array([0,2,1,1,2,3])),h=Ti.Buffer.createVertexBuffer(R,new Float32Array([0,0,1,0,0,1,1,1])),l=!0):!1},w=I.blitScreenShaderSrc={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};I.contextLost=function(){l=!1;for(var I in L)L[I].contextLost&&L[I].contextLost()},I.render=function(Y,h,Z,e){if(k&&(l||u())){T.setSize(Y,h,Z),T.bind(Y);var Q=Y.getParameter(Y.COLOR_CLEAR_VALUE);Q&&0===Q[0]&&0===Q[1]&&0===Q[2]&&0===Q[3]?Q=null:Ej(Y,[0,0,0,0]),Y.clear(Y.COLOR_BUFFER_BIT|Y.DEPTH_BUFFER_BIT),C.setViewport(Y,0,0,h,Z),e=e||{};var B=e.renderAxis!==!1,z=e.renderEdit!==!1;e.renderAxis=e.renderEdit=!1,C.renderScene(e),T.unbind(Y);for(var M=0,w=C._glCapabilities.maxAttributes;w>M;M++)Y.disableVertexAttribArray(M);var R,$=T;for(R in L)$=L[R]._42(Y,$)||$;C.setViewport(Y,0,0,h,Z),Q&&Ej(Y,Q);var q=I.getModule("Fxaa");return q&&q.enable?I.blitScreen(null,$.texture,q.getShader(Y),{resolution:[1/h,1/Z]}):I.blitScreen(null,$.texture),Y.useProgram(C._prg),C._renderAxisAndEditHelper(B,z),!0}}},st=H.graph3d.PostProcessing.HueSaturation=function(x){function Y(){var l=x.getGL();return l?($=new nj.RenderTarget(x,l),E=x._postProcessing.createShader(l,st.hueSaturationShader),T=Ti.Buffer.createIndexBuffer(l,new Uint16Array([0,2,1,1,2,3])),S=Ti.Buffer.createVertexBuffer(l,new Float32Array([0,0,1,0,0,1,1,1])),X=!0):!1}var T,S,E,$,D=this,m=!1,X=!1,H=[],h=[],B=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var f=this.serializeProperties;for(var o in f)this[o]=f[o]},this.resetProperties(),b.defineProperties(D,{enable:{get:function(){return m},set:function(h){!!m!=!!h&&(m=h,x.iv())}},hue:{get:function(){return H.map(function(d){return j(180*d)})},set:function(G){if(H!==G&&7===G.length){for(var q=0;7>q;q++)H[q]=G[q]/180;x.iv()}}},saturation:{get:function(){return h.map(function(O){return j(100*O)})},set:function(N){if(h!==N&&7===N.length){for(var L=0;7>L;L++)h[L]=N[L]/100;x.iv()}}},lightness:{get:function(){return B.map(function(g){return j(100*g)})},set:function(n){if(B!==n&&7===n.length){for(var a=0;7>a;a++)B[a]=n[a]/100;x.iv()}}}}),D.contextLost=function(){X=!1},D._42=function(r,D){if(m&&(X||Y())){var u=D.width,t=D.height;if(u&&t){$.setSize(r,u,t),Kj(r,$.frame),x.setViewport(r,0,0,$.width,$.height),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),E.bind(),r.activeTexture(r.TEXTURE0+0),or(r,D.texture);var w=E.uniforms;return w.image=0,w.hue=H,w.saturation=h,w.lightness=B,T.upload(),S.upload(),E.attributes.pos.pointer(S),r.drawElements(r.TRIANGLES,6,r.UNSIGNED_SHORT,0),or(r,null),li(r),$}}}};st.hueSaturationShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";var tt=H.graph3d.PostProcessing.Bloom=function(M){function t(){var o=M.getGL();if(o)for(var r=M._postProcessing,h=0;A>h;h++)m[h]=r.createShader(o,tt._35Q,function(z,b){return{fs:b.replace(/DEFINE_VALUE/g,F[h]).replace("%OVERRIDE_ALPHA_DEFINE%",u?"#define OVERRIDE_ALPHA":"")}})}function e(){var T=M.getWidth(),u=M.getHeight();if(!T||!u)return!1;var L=M.getGL();if(!L)return!1;Z=[T,u];var O,s=Math.round(Z[0]/2),p=Math.round(Z[1]/2);for(_=new nj.RenderTarget(M,L,s,p),c=[],E=[],O=0;A>O;O++)c.push(new nj.RenderTarget(M,L,s,p)),E.push(new nj.RenderTarget(M,L,s,p)),s=Math.round(s/2),p=Math.round(p/2);var X=M._postProcessing;return w=X.createShader(L,tt._34Q),t(),W=X.createShader(L,tt._36Q,function(b,Q){return{fs:Q.replace(/NUM_MIPS/g,A)}
}),h=X.createShader(L,tt.finalShader),y=Ti.Buffer.createIndexBuffer(L,new Uint16Array([0,2,1,1,2,3])),o=Ti.Buffer.createVertexBuffer(L,new Float32Array([0,0,1,0,0,1,1,1])),f=!0}var S,z,U,u,p,y,o,O,s=this,j=!1,f=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var E=this.serializeProperties;for(var F in E)this[F]=E[F]},b.defineProperties(s,{enable:{get:function(){return j},set:function(E){!!j!=!!E&&(j=E,M.iv())}},strength:{get:function(){return S},set:function(e){S!==e&&(S=e,M.iv())}},threshold:{get:function(){return z},set:function(Q){z!==Q&&(z=Q,M.iv())}},radius:{get:function(){return U},set:function(E){U!==E&&(U=E,M.iv())}},overrideAlpha:{get:function(){return u},set:function(v){!!u!=!!v&&(u=v,f&&t(),M.iv())}},selective:{get:function(){return p},set:function(K){!!p!=!!K&&(p=!!K,M.iv())}}}),this.resetProperties();var _,w,W,h,Z=[256,256],c=[],E=[],A=5,F=[3,5,7,9,11],m=[];s.contextLost=function(){f=!1,O=null},s._42=function(B,q){function s(x,q,K,m){Kj(B,q.frame),M.setViewport(B,0,0,q.width,q.height),m?m(B):B.clear(B.COLOR_BUFFER_BIT|B.DEPTH_BUFFER_BIT),G!==x&&x.bind();var j=0;for(var Z in K){var e=K[Z];e instanceof WebGLTexture&&(B.activeTexture(B.TEXTURE0+j),or(B,e),e=j,j++),x.uniforms[Z]=e}for(G!==x&&(y.upload(),o.upload(),x.attributes.pos.pointer(o),G=x),B.drawElements(B.TRIANGLES,6,B.UNSIGNED_SHORT,0);j--;)B.activeTexture(B.TEXTURE0+j),or(B,null);li(B)}if(j&&(f||e())){var G;if(p){O||(O=new nj.RenderTarget(M,B)),O.setSize(B,q.width,q.height),O.bind(B);var i=B.getParameter(B.COLOR_CLEAR_VALUE);i&&0===i[0]&&0===i[1]&&0===i[2]&&1===i[3]?i=null:Ej(B,[0,0,0,1]),B.clear(B.COLOR_BUFFER_BIT|B.DEPTH_BUFFER_BIT),M.setViewport(B,0,0,q.width,q.height),B._blooming=!0,M.syncRenderState(),M.renderScene({renderAxis:!1,renderGrid:!1,renderEdit:!1}),B._blooming=!1,i&&Ej(B,i),O.unbind(B)}s(w,_,{smoothWidth:.01,luminosityThreshold:z,tDiffuse:p?O.texture:q.texture});var X,T=_,P=Math.round(Z[0]/2),u=Math.round(Z[1]/2);for(X=0;A>X;X++)s(m[X],c[X],{colorTexture:T.texture,direction:[1,0],texSize:[P,u]}),s(m[X],E[X],{colorTexture:c[X].texture,direction:[0,1],texSize:[P,u]}),P=Math.round(P/2),u=Math.round(u/2),T=E[X];return s(W,c[0],{blurTexture1:E[0].texture,blurTexture2:E[1].texture,blurTexture3:E[2].texture,blurTexture4:E[3].texture,blurTexture5:E[4].texture,bloomStrength:S,bloomRadius:U,bloomTintColor:[1,1,1]}),s(h,q,{image:c[0].texture},function(m){se.for(m).glState.blend.apply({enabled:!0,equation:m.FUNC_ADD,func:[m.SRC_ALPHA,m.ONE]})}),se.for(B).glState.blend.apply({equation:B.FUNC_ADD,func:[B.SRC_ALPHA,B.ONE_MINUS_SRC_ALPHA,B.ONE,B.ONE_MINUS_SRC_ALPHA]}),q}}};tt._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",tt._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",tt._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",tt.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var ut=H.graph3d.PostProcessing.Dof=function(o){function h(){var T=o.getGL();return T?(c=new nj.RenderTarget(o,T),s=o._postProcessing.createShader(T,ut._38Q),p=Ti.Buffer.createIndexBuffer(T,new Uint16Array([0,2,1,1,2,3])),B=Ti.Buffer.createVertexBuffer(T,new Float32Array([0,0,1,0,0,1,1,1])),V=!0):!1}function U(h,$,K,N){D=null;var R=h.getCanvas(),H=R.width,w=R.height;if(K=K||1024,H>K||w>K){var C=K/Math.max(H,w);H=Math.round(H*C),w=Math.round(w*C),t||(t=Vq()),R=L.resizeImage(R,H,w,t)}var y=o.getGL();if(O||(O=y.createTexture()),r=Nm(y,R,O),P=$||.01,i=!0,o.iv(),N--){if(D)return;D=L.callLater(function(){U(h,$,K,N)})}}var c,s,p,B,r,q,Q,e,t,O,D,I=this,g=!1,V=!1,P=0,i=!1,u=xc.generateUUID();this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var e=this.serializeProperties;for(var G in e)this[G]=e[G]},b.defineProperties(I,{enable:{get:function(){return g},set:function(W){!!g!=!!W&&(g=W,W||(i=!1),o.iv())}},image:{get:function(){return q},set:function(P){q!==P&&(q=P,i=!1,r&&(o.deleteTexture(u),r=null),o.iv())}},maxblur:{get:function(){return Q},set:function(q){Q!==q&&(Q=q,o.iv())}},aperture:{get:function(){return e},set:function(b){e!==b&&(e=b,o.iv())}}}),this.resetProperties(),I.contextLost=function(){V=!1,r&&(o.deleteTexture(u),r=null)},I.setImageFromGraphView=function(x,N,D){this.image=null,U(x,N,D,2)},I._42=function(n,d){function L(V,q,I,M){Kj(n,q.frame),o.setViewport(n,0,0,q.width,q.height),M?M(n):n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),D!==V&&V.bind();var Y=0;for(var e in I){var F=I[e];F instanceof WebGLTexture&&(n.activeTexture(n.TEXTURE0+Y),or(n,F),F=Y,Y++),V.uniforms[e]=F}for(D!==V&&(p.upload(),B.upload(),V.attributes.pos.pointer(B),D=V),n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0);Y--;)n.activeTexture(n.TEXTURE0+Y),or(n,null);li(n)}if(g&&(V||h())){var D;if(!r){var t=mr(this.image);if(!t||!t.comps&&!t.tagName)return d;H.Default.setImage(u,t),r=o.getTexture(u)}var C=d.width,Q=d.height;if(C&&Q)return c.setSize(n,C,Q),L(s,c,{tColor:d.texture,tDepth:r,aspect:C/Q,aperture:this.aperture,maxblur:this.maxblur,useG2d:i,threshold:P}),c}}};ut._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vcupypfmu!!v>t,f!Hm3ped<<v*o!j5gspvsmnc!ggpmep!b+u!!*u!iusdfftsisppmdeu<dfvqotjbg!p+s!n*!!g:m3p/b1u.!!n-b:y3c/m1v.s!<)3vdofjwg!p)s!n,!!gzmyp/bwuV!wb!q-fsspumvpsDfu<!)vEo3jfgspvsuny!fgum!p>b,u!!mopfdbs<D*m!j5qs<vmvcogjpgep!s+n!!*g!mupdbfus!sgpbdsuDdmfjqqt<b!v+o!j*g!p1s/n1!!g-m5p/b1u.!!g)p3ddvftw<!)v!o,j!gzpys/nw!Vgwm!p-bsup!mbptDquf!d)uE<3fdspvoutyuf!ug!m>p,b!um!pVdoq<b*d!l5Espvxmoctgdpbem!f+!!>*!!3u6d6f/s!s0p!d3u6d7f/q<t!b0!0+!!1*/!/:23!/.1?!!-g:s3b/d1u.j!p)o3!d)ffwy!d)m!v,e!jzoyh/!w2V*w!d-psoptmup!Dwuf!d)4E!3QfbsdvluGybfduu!p>s,t!!m>p!dwf<d*4!)5!s3v6m7c/g!p+e!!3+6!7*/!!u+d!f3s6s7p/d-u!d3f6q7t/b!!++!!3*6!75//-1!.3!6-71//!1*!<)3ddpfowt!u)!!w,f!dz5y!/VwoVqwb!d-lsGpbmdpuDpus!t)!E>3!fVsovqubydfluE!p>x,o!tmdpbdmf<!*0!!5wsfvdm5c)g!pQeb!d+l!G*b!duudpfssts-p!d2u/d!f*q<tbg!m+p!b*u!!:v3o/q1b.d!l-S:H3C/B1U!p)E3fdqfuwi!))!!d,p!oztyu/!wjVow!!w-fsdp5m!pwD!u*!!)|E3!fssfvuuvysfou!!e>p,u!)m!pwd-!<V*o!q5bsdvlmGcbgdpuep!s+t!!**!<ud~fsgsmppdbuud!fhqftubE!f+q!u*i!)1!/d1p!o-t5u/!1j!o)!3wdffdw3!!)t!d,s!fzfyo/QwpVtwj!u-jsppom!p*D!u|!)\nEs3ffusvvsuoy!fvuo!q>b,d!lmSpHdCB<U*p!E5fsqvumic)g!puef!y+u!v*s!fu3dEf)s!supEdfuqdufiq-t!bt!d+s!f*f!o:Q3p/t1j!u-j:p3o/!1*!!)*3<df~w!g)m!p,b!uz!yq/fwsVtwq!f-dsupjmwpfDEuf!q)uEi3UfpsWvjufyxf[u)!!>d,p!omtpud!j<o*!!g8mspvbmuc!gjpoew!D+m!j*q![u-d!fdspsoptduu!djfoq!tgbm!p+b!u*!!o5f/b1s!--!1d/p1o!t)u3!djfow!!g)m!p,b!uz!yg/bwsV!w*!!-|sp!mspfDuuv!s)oE!3)f!sovfubysf!u+!!>g,b!sm!p*d!0<!*)!!8)s!vgmbcsg!p.e!!o+f!b*s!!u*d!f+s!sjpodwuDdmfjqqt[b!!.+!!g*b!s:!3*/<1.~!-g:m3p/b1u.!!h)f3udWfjwf!x)[!),!!dzpyo/twuV!wj!o-!sgpmmppbDuu!!e)fEq3ufis!v*u!y|fu\n!s>f,u!vmspod!q<f*s!t8qsfvdmucjgwpfeE!f+q!u*i!UupdWfjsfsxp[d)u!deffqqtubi!-+!!o*f!b1s/D1m!j-q5-/!1g.b!s)D3mdjfqw!!*)<!,~!zwyp/jweV!wn!b-jsop)m*p!D|u!w)fEd33f!sevpugycfmuv!s><,!wmfpdd3!<b*t!q8fsdvumdcpgspsef!d+u!!*>!!uwdffds3s)p!d2u/d1f-q!tbbt!q+f!d*u!!:*3</1j!g-!:)3v/t1f.E!f)q3udif*w!!|)!!,g!mzpyb/uw!Vwwj!f-xs[p!m>p!Dhuf!u)WEj3ffxs[v)u!yhffuu!E>f,q!umip)d!w<V*w!!8*s!v*m<cg!pgem!p+b!u*!!gubddfuspssp!d>u!d)f!qgtpbd!v+t!!*,!!5w/j1f.x![-!1*/<1!!)e3pdgfcwm!v)s!!,>!!zwyf/dw3V!w)!!-dsmpbmnpqD)u!!g)bEd3ufpssv!u+y!fbuq!f>s,u!vmspfd-!<.*n!b8yscvmmvcsg-p!en!b+y!c*m!vusd!f*s!s*p<du~dffqmttbf!!+|!*w!f:d35/!1u.f!y-f:m3!/>1!!u)f3ydufvws!f)3!E,)!!zuyE/fwqVuwi!--!swpfmdp3D)uw!V)wE/3yf-s!v2u/y1f!u.!!>w,V!wm/pzd*!<**<!8gsmvpmbcug!pbem!q+i!b*<!ujdgf!s)svptdfuHd3feq*t!b|!+b!m*q!i1b/!1>!!-t1n5p/p1u!i)t3udffqw)!!)u!i,s!fztyi/pwmVew-!!-usipsmfptDiup!m)eE!3,f!s1v/u1y2f-u!!u>f,y!fmmp/db!<**<!8~s!vfmmctgfp!e|!!+b!m*q!iubd!f>s!supfdyufdmf/qbt<b!!~+!!*e!p:g3c/m1v!s-!:>3!/w1f!d)33!d)f!wd!m)b!n,q!)z!yb/mwqViwb!!-+s!pbmqpfDsuu!v)sEf3-f!s.vnubyyfcum!v>s,-!!mnpbdyc<m*v!s:!s*v!m*c<gp~e!w+f!d*3!!uedpfgscsmpvdsu:d!f>q!tebp!g+c!m*v!s8!4+/!11./!:-<62w/f1d!3)!3edpfgwc!m)v!s,8!!z>y!/ewpVgwc!m-vssp!m+p!D1u/!8)<E3wffsdv3u!yefpug!c>m,v!sm5p!d>!<e*p!g:csmvvmsc!g+p!e1!/+5!<*!wufddf5s!sdppdmu!d>f!qwtfbd!5+)!!*1!/612!/*1<.!d-p8m4!/,1>.!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!16/25/!1*!!-+8!4b/t1q!f)d3uddfpws!s)f!d,u!!z*y!/+w!Vewp!g-csmpvmsp!D*u<!)dEp3mf!s,v>u!yuffuy!u>v,s!fm3pEd)!<u*D!p:mspvsm-c!gwpVew!/+y!z*!!,u!d)f!swsfpdd3u)d!f1q/t2b6!-+!!1*/!4884!/*1!!+-!6b2t/q1f.d!u)d3pdsfswf!d)u!!,*!!z+y!/ewpVgwc!m-vssp!m*p<Dud!p)mE!3,f>s!vuufyyfuuv!s>f,3!Em)p!duD<p*m!p:ss-v!mwcVgwp/ey!z+!!,*!!)u!dwffsds3p)d!u1d/f3q:t-b!!1+/!3*:!!8*4!/+1!.b!t-q6f2d/u1d.p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!6+2!/b1t.q!f-d8u4d/p1s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b6t2q/f1d!u-d8p4s/s1f.d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/:yszv!m,c!g)p!ew!f+d!3*)!!u1d/f4s8s-p!d.u1d/f2q6t!b*!!++!!*b!t8q4f/d1u!d-p6s2s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d1f/s3s:p-d!u.d1f/q3t:b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d.f1s/s2p6d-u!d.f1q/t4b8!!+*!!*+!!:b3t/q1f.d!u-d:p3s/s1f.d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d1f/s1s-p!d.u1d/f5q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!s,v!m)c!gwpfed!3+)!!*.!1u/d2f6s-s!p1d/u4d8f!q*t!b+!!+b!t*q!f1d/u1d!p-s5s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!yszv!m,c!g)p!ew!f+d!3*)!!u.d1f/s3s:p-d!u1d/f3q:t!b*!!++!!*b!t6q2f/d1u!d-p8s4s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfs";var vt=H.graph3d.PostProcessing.Blur=function(_){function V(){var u=_.getGL();return u?(M=new nj.RenderTarget(_,u),W=_._postProcessing.createShader(u,vt.hBlurShader),d=_._postProcessing.createShader(u,vt.vBlurShader),p=!0):!1}var W,d,M,z,o,L,a,c,h,A=this,E=!1,p=!1;this.serializeProperties={value:0,downSample:!1,iterations:1,layer:"main"},this.resetProperties=function(){var f=this.serializeProperties;for(var n in f)this[n]=f[n]},b.defineProperties(A,{enable:{get:function(){return E},set:function(C){!!E!=!!C&&(E=C,C?_.addRenderLayerListener(g,this):_.removeRenderLayerListener(g,this),_.iv())}},downSample:{get:function(){return a},set:function(f){a!==f&&(a=f,_.iv)}},value:{get:function(){return L},set:function(A){L!==A&&(L=A,_.iv())}},iterations:{get:function(){return c},set:function(R){c!==R&&(c=R,_.iv())}},layer:{get:function(){return h},set:function(k){h!==k&&(h=k,_.iv())}}}),this.resetProperties();var g=function(F){if(E&&F.layer===h&&"post"===F.phase){var P=_.getGL();if(!_._picking&&!_.isReflecting(P)){var y=_._postProcessing.getRenderTarget();y.unbind(P);for(var C=0,k=_._glCapabilities.maxAttributes;k>C;C++)P.disableVertexAttribArray(C);A.drawImpl(P,y),y.bind(P),P.useProgram(_._prg)}}};A._42=function(){},A.contextLost=function(){p=!1,z=null},A.drawImpl=function(Y,j,g,x,S){if(p||V()){var D,J;if(j?(D=j.width,J=j.height):(D=_._viewport[2],J=_._viewport[3]),D&&J){var N=_._postProcessing;"boolean"!=typeof x&&(x=a),g==f&&(g=L),S==f&&(S=c),S=Math.max(1,Math.round(S));var m=se.for(Y).glState.depth,h=m.enabled;if(m.enabled=!1,x){g/=2;var b=[D,J];D/=2,J/=2,z||(z=new nj.RenderTarget(_,Y),o=N.createShader(Y,vt.downSampleShader)),z.setSize(Y,D,J),N.blitScreen(z,j.texture,o,{texelSize:[1/b[0],1/b[1]]}),j.setSize(Y,D,J)}else z&&z.setSize(0,0);M.setSize(Y,D,J);for(var P=[],n=0;S>n;n++)P.push(g),g=Math.max(1,Math.floor(g/2));for(var n=0;S>n;n++){var q=P[S-n-1],l=x&&0===n?z.texture:j.texture;N.blitScreen(M,l,W,{value:q/D}),x&&n===S-1&&j.setSize(Y,b[0],b[1]),N.blitScreen(j,M.texture,d,{value:q/J})}return m.enabled=h,j}}}};vt.hBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",vt.vBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",vt.downSampleShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j1t/j5p!o0!!i*j*h*i1q/!2g!m-p1b/u1<)3!dvfowj!g+p!sfn{!jtTbmnfqymffus!3,E!!wjVnwb!h-ff<hb!nwjb)sEz3jfoshv!uwyffdu3!!w,V!w*<*1!/v2o.j!g-p1s/n1!)w3fddf3w!!u+f!yff{mjTTjm{ffy<fu!!,w!pwjVew!!n-bfjhob)n*j)!E|3f!shvmu`yGfsub!hD,p!m*p*s1!/>1!!)-u1f/y2u.v)s3fd3fEw)!j+n!bfh{fj-T!mwfVywf!u,!!,u!fwyVfwm!T-jf{hfb!n+j!)wEf3df3s)v2u/y1f-u!!1/,1!**";var wt=H.graph3d.PostProcessing.Glitch=function(m){function w(){if(v&&t){J=Date.now(),s=0,B=1e3*O(t[0],t[1]),M=[];for(var C=1,g=v.length;g>C;C+=2)M.push((C>1?M[M.length-1]:0)+B*v[C]/a)}}function A(){m.redraw()}function $(){var M=m.getGL();if(!M)return!1;L=new nj.RenderTarget(m,M),g=m._postProcessing.createShader(M,wt.Shader);for(var X=d*d,q=Mn(d,d),N=q.getImageData(0,0,d,d),F=N.data,o=0;X>o;o++)F[3*o+0]=Z(256),F[3*o+1]=Z(256),F[3*o+2]=Z(256),F[3*o+3]=Z(256);return q.putImageData(N,0,0),r=Nm(M,gr),z=!0}var L,g,B,J,s,M,r,K,t,v,o=this,F=!1,z=!1,O=xc.randomFloat,Z=xc.randomInt,a=0,d=64;this.serializeProperties={onlyReflector:!1,period:[2,3],intensity:[3,.3,1,.1,0,.4]},this.resetProperties=function(){var v=this.serializeProperties;for(var u in v)this[u]=v[u]},b.defineProperties(o,{enable:{get:function(){return F},set:function(g){!!F!=!!g&&(F=g,g&&w(),m.iv())}},onlyReflector:{get:function(){return K},set:function(b){!!K!=!!b&&(K=b,m.iv())}},period:{get:function(){return t},set:function(g){t=g,w(),m.iv()}},intensity:{get:function(){return v},set:function(Y){Y||(Y=[1,1]),v=Y,a=0;for(var f=1,K=Y.length;K>f;f+=2)a+=Y[f];w(),m.iv()}}}),this.resetProperties(),o.contextLost=function(){z=!1},o._42=function(Q,q){if(F&&(z||$())){var e=!!m.isReflecting(Q);if(e===!!K){var T=q.width,N=q.height;if(T&&N){var Z=m._postProcessing,b=se.for(Q).glState.depth,h=b.enabled;b.enabled=!1,L.setSize(Q,T,N);var d,f=Date.now();f-J>M[s]&&(s++,s>=M.length&&w()),d=v[2*s];var U={seed:Math.random(),byp:d?0:1,tDisp:r};return d&&(U.angle=O(-Math.PI,Math.PI),U.distortion_x=O(0,1),U.distortion_y=O(0,1),U.amount=Math.random()/30*d,U.seed_x=O(-1,1)*d,U.seed_y=O(-1,1)*d),Z.blitScreen(L,q.texture,g,U),b.enabled=h,requestAnimationFrame(A),L}}}}};wt.Shader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd~j!tj<p*ow!Viwj!h-ifqh!bgnmjp)b!uE<3f!svvoujygfpus>ns!pjmopuD!hcbzsqG<`m!hv!oj|g!pfstnm!ft!bn~q!mf<sx3pEo!tj!n,bshpfm<pD!hvbosjGg`pmshn!!>t!bsnpqmmpfDsh3bEs!Gu`Emjht!q<<*3!/v1o+j*g*p/s1n6!+gemfpfbtu!!+b!ntpzv-oeuf<ft!!v+o!jtgyp)s3nd!fgwm)peboub!sb)o5hdmffw<+u!ovvopjngbp+s/n1!1g3m!p>b!ux!ptoftf!e5<df!wv!ojfgtpjspno!!gemepbb0u0!!tf<f*eb`/yb<hd!!v-ocj/gcpds!n-!hg/mbphbdu!!-tsf/fsed`)z5<df!wv!o>j!gsppsmnp!DghmbpsbGu`!mehj!tu<p*suufjtpgog`py!<.!!qv!o-jfghpbsnnj!)gEm3pfbsuv!ueyjftuu!p>s!ucjdp!o5`dzf<w!!v<o*jqg!p-sfnh!bgnmjp)bEu3!fdspvmu`ytf<u!>!!wbbhsdz!j5odhf!ww!fd<3*!uwfVtwg<gp!!,d!pqo!t-uf!hgbmnpjb)uE!3VfosqvbudylfEup!x>o!tsddb!m5fd!f>w!!36<6*/*!f0m!h3o6b7)/o<jt!!d-p*oftmuh!owbf)dt4p!dQ)b3ddlfGwb!d+u!pusotv!p>n!bw!f>d!4u)f!t3g6g7p/!!3+d!f3w6!7/s!f+e!b3i6t7!/u-g!j3i6t7!/C!H+S!!3n6p7s/g-!!f3t6b7c/0!0*!<<!*d/p6o0teuf!fwtf)d+5z!`Veofqfbtd+lmGbbndsuppos>t,!z>/!qV!oq<b*d/l6E0pexfofttd)b+myf`!e0f!fwtf+dm5b)n!sQpbod>l,Gyb/dqu!ps~t!-!~2!/!<**<y`!ogpmjpubsup!uvtojqeb!d,l!SyH/CqB)U!p.E!f/q2u!i>)!!yd/pqo!tu|!!jfot!mwff!d5~!!w!<*y!`|op!jsufsupvustoj!ee>pyu/)q!!w-|!*V/o1q?bzd`leGfbfdtu)pgsjt!!*|<!*!e~fft!+gtm`pmbpud!.szb`ooep)jwufsdp3u!tdjpe*?|y/!qs!f%u%v!sto`!mgpsdb,dzu`)otpjjou)seppuut)jdep=/yy/zq!)-gwjf!d3~)!23~/!:9<:z9`-o8p9j/u3s4p4u*t*j*e!!+>!!5z4/8q6!9/|6!5f6t4m*f<!!~~!<!*wzp`joep!jnubsjpou)t*j!e|!,!!jzg/)qc)z!q.=!2/*2!!|>!!zw/fqd!3!|q*!/>1!?wyV`we<ff!tg)mgpjb!u!|y!t*!e>f!fgtm+ptp`sm)phdm.`yG`sobphjDupsppsuet/jye!?0z!/1q/!6%*%<!t!`gmmppdb,uy!`zotp!j>u!sgpmuptpjse)=hzm/`qG)sgbjh!Dp<p*s*ee/fzf!t0+!e1f/f6t*+<q!!-gqmtpjbEuu!)o!pEs3nfbsmv!u>y!fvuo)qibudqlfSEHpCUB";var xt=H.graph3d.PostProcessing.Fxaa=function(_){var z,m=this,x=!1;b.defineProperties(m,{enable:{get:function(){return x},set:function(z){!!x!=!!z&&(x=z,_.iv())}}}),m.contextLost=function(){z=null},m.getShader=function(p){if(z)return z;var C=_.getPostProcessingModule();return z=C.createShader(p,{vs:C.blitScreenShaderSrc.vs,fs:C.decodeShader(xt.ShaderSourceFs)})},m._42=function(){}};xt.ShaderSourceFs="~!!q<sbf/d*jwtVjwp!o-!fihjbhnijq)!Eg3mfpsbvuu<yf!uv>obj/gsppsmnp!DthbbnsqGm`fmsh3!E!<j*n!bh*f1</1!)v5odjfgwp!sn-!1w/f1d!3!-s1f/t1p!mv-u1j/p1o!<-!4w4b9s1z/j1o!h!-w7f7d23/!1w!Vw-<68/!1$!ef-g*j1o/f1!)G5YdBfBw`!RV-B*M1J/U1Z)`5Qd1f!w2!/1-*!1$/e1f)g5jdoffw!!GY-BoBp`jRuVvBmMpJtUfZs`!Q2-!f2h/b6nj!!$e-ffghjbonfj!!GY-BfBh`bRnVjB!MJ-U*Z1`/Q13)!53d/f1w!!$-ewfVgwj!of)!sGfYeBbBi`TRmVfByMjJQUbZb`yQG4>!s5p/m1pD!h$besfGg`jmohf!!G|Y!B*B)`oRjVbBnM!JeUjZp`wQ!5!~2!3/<1*N!b$nevfmg!j-o{fz!yG/y*bNbtCppqp!m-!ycfpup)mqpU!y$feUfbgbjyoGf)!5GuybbpbmGGmbpbbyuG!!gomspvbuufs!!$e<foghjjoTfi!uGhyobfbmG!m+p!byuj3q!cwvfTdu3ft!g$gePfmgfjyojfq!>G,yzb/bNGtmppqb!u*4o!bwqfTd{4sp!i$!e)fggjj!of<!oGhyjbTbiGumhpobfum5!!+w!fydj5qcv!T$uefftggjgoPfm!fGyyjbqb>T,byu/)Nyt*p!qd!m*bonbqq)Ty{-s!p1i/a1)-g!j2!/1<**I!y$jeqfcgvjto!f-!eGpypbHbuUfftyg!gtPbmnfqymjfqs)3yEbn!>$yejfqgcjvoTfu!fGtygbgbPUmffyyUjpqq!)uub-p!mqG*b!buyfGy!uv<s1f/31E!);u!-u!fqt-g!g1P/m1f*yj!q$!e@f!gojboqfT!eGpypbhb>UefpypPHgugf)tug-g!Pqm-f!ypj-q!!su*b!pumfGybubvysGf!3E<)yuj-q!cqv,T)zpu!j+m!bsv*R-b!b1y/g1!*+!!HGyyjbqbcGvmtp>bIuy!jGqycbvbtM!vunbbp)mGGybbbbyGGm!pb<u65/!1s,h*c*bq*d!S|i!ushfoufvMsoob!qsth.c)b!/+z!<u!t~e)!>GuyfbtbgGgmPpmbfuy5j!qG!yubbbpQmjGybfbmyTGi!be<fGsy)jq!cGvytb!b+G!mGpybjuq3c!vqtp>tH-yj!qGcyvbtb!GumbppbmuG5b!bgyyGb!bD<pQootbpqmTfeQpppthQ!p;t!-Oo!bGqyTbebpUpfhy!!@u!fOyo-pj!uGdyfbsbjUef>yo!bgqyTbebpDppho!tmppmpfC4b7b1yUGf!yF<y*qQCujtbet!O-fOhuPtoef)-oj!nG>yubtbeU!fuyb!pgmyGbbbbDypGo!tp<mQfu4t7e1!U=f!yOFuytqeC>jObotpOjfuhdUfxspj-e!!mGpypbCbbGbmypGb!u3<!iguyhbobfRMvobbmqjtu0z1S/d2q>GqsdbSnifu-ho!fGMyobbbqGtm!pubbup5m!GgbybbybGD!po<tppsmff[SUdMqNGbsnbvnmf!P>qau!-*1!/G1y!b=b!GQmepobFub5n!vgmy)b>bQDopboqtTpempfpShd!qmGpspbCnbfbPyqGu!3-<*!OGuytbeb,GQmuptbeu)5>!iguyhbobfDMpoobtqptm!fu4b7p1mSGdbqbGysGb!nf<Ppqsuf3[-UM!NGbynbvbmG!m>pab!u*!1g/y1b!b=R!vObemojFubznTvvmc)q>jOyo-bq!TGeypbpbhG!mmppbpuC!bgbyybGb!Rv<bzm/jNutzpFqe.hzf/UQitspfqt>iQpumtee-!*!oGbyqbTb{Gsmppibau)!ggjy!bb<Rzv/bOmtjpuqz.Fze/hNftUpiqs>fOtuitpem!e*Nojboq-T{!sGpyibab)Ggmjp!bu<!yg/yNbtbpDqp.oyt/pQmtfpFqe>hQfuTtieb!suqbopfmtGtb-by!GG!yb<byG/mOptbpuq!.gyy/bNbtDppqo>tOpumtfeF!euhbfpUmiGsbfbtyiGp!me~-!!~G!yb~b!Gm<p5bQu`!ZgUyJbMbBDVpRo`tBpBmYfGF!e+h!fzU/iQsOfgtgipp>m,ezN/jQot-pq!!G*yQbfboGpmepab)ug5j!!gy<b5bQD`pZoUtJpMmBfV4R7`1BDBpYoGt!u+E!jys/Q!O*g!g|p>!,Gyy/bQbtGpmqp!b*uQ3f!oqppetaN)<gj!!qp<t*NQ/fyo>pqepat)/!y}<}!!*qOpftoNp/eza>)q>pQtO/fzo<pe!!Gy<b5bQG`mZpUbJuM5B!VsRh`cBzBNY>GG!y+b!bzU/fQyOUgpgqp)>u.fzy/-O!tqppqt!N**O<fo!p$eeaf)ggjjo!f!<m5vQn`bZNU!JsMhBcVzRN`/BzBY!GG!y+b!byG/mQpObgug!pm>v.nyb/TO>tGpyqb!b*MOvfnobp)eGay)bgbjU!fy<Pegfgm)budfTyu-o!fqjpetbNs-h!!G>y?b!b*GQmepobFub3n)v!m1)/t1c-b!>2Q/f1o*p-e!!gy<bebfRmvbbdmTjuuozfSjdeqbGsshb!n>f?/!y*zO*e*o<Fb!nGvymb)btGcmbp>bOuf!ompven!bF<>6G/y1b!b+M!vOnObb)nGvymb.bQUefoyFPbgngv)mu>fQye-o!FqbpntvNm-!!*GQyfbobpGemap)bguj3!)!<26//11-!!+1!/O1O*b-n!vgmy.bObeRovFbbmnjvumz>SOdeqoGFsbbnnvfm/!y*zO*f*o<pe!aG)ygbjb!Gm<p*b*uz!ym/vQntbpOq>!G-yybfbuM)vqnpbU)yGfyUbbbbUyfGy)Pbgngv)Mubfbyy-G!>qQpetoNF-b!nGvymb!b*GQmfpobpue3a))!g1j/!1-<.*2*/z1y*/-O!tgpyqb!b-Ryvfbum)jqupzUSydfqUGbsbbynGf)/bynzv*M*b<by!GG>yObeboGFmbpnbvum!!m*vOnfboXp>eGay)bgbjM!vn|b!)*GQyObfboUpfey)Pggjg!)u<f4yQ-`!ZqUpJtMNB-V!RG`yBbBbYGGm!p+b!uz3/)Q.O2g/g1p->!,1z//1Q*t-p!qg!y*bQbfRovpbemaj)ugzjS!dq<G4sQb`nZfU/JyMzB*V*R<`B!BGYyGb!b+G!myp/bQuO!gngbpy>T,Ny>/nQbtyp)qm!v*nQbfTo-p!emav)ngbjN!*<<*!QGfyobpbeGam)p!b}u}!!n*jOofToNp>enaj)o>)QmOvfnobpTe-!!m<v4nQb`NZ*U<JM!BGVyRb`bBGBmYpGb!u+!!nzb/yQFOTgNg>pn>b.yz)/mOvtnpbqF!-*!OnfboypTeNa*)<gj!!Gy<b4bQG`mZpUbJuM!BnVjRo`FBTBNY>Gn!j+o!)ym/vQnObgFg-p!>n.jyo/TONt*p<q!!*GOyfbobpGemap)bguj!!nb<yeXfOm>bndbTyu)omfvjnebbOs-h!!m>v?n!b*XQ*e<oF!bGnyvbmb)Gtmcpbb>uQ!fnojpoeX!O><nejfom)bmdvTnuboOf-j!embvsnhb!X>*?<!*!OGeyobFbbGnmvpmb)ut!csbb>oOhffoNpbey!>n<b6y/)1n!b+y!XOOO-b!nnvbmy.FQTeNo*F<bn!vGmy>bQbeGomFpbbnuv!ms!b*oQhffoNpjeoa>)ngjjo!)n<j6o/X1O!-+!!nOjOobFnTvNm*.<Oe!oGFybbnbvGmm>pObeuo!Fsbbnovhmf!N*bOyfTodpbemaf)eg>js!bo<h*f*Nzbyy/!Q+t!pgqy!b-byRfvub)mqjpuUzyFfeUhbfbUyiGs)fbtnivpMmbeb<yG!>GQyebobFGbmnpvbmu!!*sQbfoohpfe>as)bgojh!fN<b*y*.zsyb/oOhtfpNqj!o-<yf!uG)yqbpbUGymfpUbbub!ysGb)obhnfvNMbbybDymGb>nOqefoeF>bnnbvym)!g*yObfboRpvebam)jgujz!Fe|h!f*UQiOsffotpiep)mgejN!jo<-3!Qs`bZoUhJfMNBbVyRT`dBbBmYfGe!*+<!z!/GQyObgbgCpp>p,mz!/fQbtspmqz!F*yQjfuo>psebao)hgfj!!=!<s3bQo`hZfUNJbMyBDVmRb`nBqBfYeG<!+!!jyg/)QfObgsgmpz>F,yyj/uQ*tp!qs!f*uQvfsoop!esah)cgzjN!<<!*GQyfbobpGemap)b!u}!}m!v*nObfOoXp>eGay)b>bQMOvfnobp)eG!yb<b3UQf`yZPUgJgM)BuVfRy`-B!BqYpGt!N+-!!zG/yQbObgGgmpp>b.uz3/)O.t2p/q1!-*.O2f/o1p*e-a!)ggyjb!bR<v3bQm`jZuUzJSMdBqVGRs`bBnBfY/Gy!z+*!*y</Q!OGgygbpb>G.myp/bOut!pmqv!n*bOTfFo>pGeyab)bgMjv!nb<)eGfymbbbdUTfuyoPfgjge)busfhy!->!?q!p*tQNe-o!FGbynbvbmG)mtpcbbu>3Q)f!o2p/e1!-!<2e/f1m*b-d!TguyobfbjRevbbsmhj!u>z?S!d*qOGesobFnbfn/vymz)*t*c<b>!OGfyobpbeG!mp<b6u/!1m!v+n!bOOOFb>nGvymb.bQMevonFbb)nGvymb>bQUefoyFPbgngv)mu!f*yQ-f!oqppetaN)-g!jG!yb<b6G/m1p!b+u!3O)O!b2n/v1m-..O2e/o1F*b-n!vgmy>bObeRovFbbmnjvumz!S*dOqfGospbenaf)/gyjz!**<<**!zGyy/bQbtGpmqp!b-uy!fmuv)nqbpTUXy>fGUybbbbyMGv)nbbn)vGMybbbbyUGf>yQPegogF)bunfvym-!!*qQpftoNp-e!aG)ygbjb!Gm<p*b*uz3y)/.O2t/p1q-!!-2y/f1u*)-q!pgUyybfbURbvbbymGj)ubznSvdMqbGbsybGn>fO/eyozF*b*n<vm!!G*yObfboGpmepab)ug!jm!vn|b!O*TQ>OmfvonpbeO),gmjv!nb<T2<Q`!ZGUyJbMbBGVmRp`bBuB!YmGv!n+b!XzF/>QmOvgngbpX>,,mzv/nQbtFp<q!!*GQyfbobpGemap)bguj!!tv<c2qQj`yZSUdJqMSBbVoRh`fB>B2Y/G1!0+s!byo/hQfO<gg!pG>y,byb/GQmtppbqu!!*tQvfcoqpjeyaO)TgXjF!>m<v*nQbfOoTp,emav)n!b}X}F!<*O!fGoypbebaG)m>pQbOuf!ofpeeh!fmIpppsC{b2b>y)G.!3/<12!Q+`!ZmUvJnMbBNV*R,`mBvBnYbGO!T+<!z!/GQyObgbgGpm>p.bzu/!Oftephqf!W*fOsfuo2p>e)a.)3g/j1!!+<!2mQv`nZbUNJ*M,BmVvRn`bBXBFY<G!!+G!yyb/bQGOmgpgbpu>!.myv/nObtOpFqT!F*>OmfvonpbeOaF),gmjv!nb<TeFf<mb!dGTyubobfGjmepbbsuh!!m>v?n!b*OQXeOoFF>bmnvvnmb)OtXc,bm>vQnfboOpFe<!m!pGpyCbbbbGymGp!bu<!effemhbfdITpuso{f3j>e)b.s3h/!1>!?+!!*mOvenobFFb*n,vmmv)ntbcObF>TOFf<op!eG!ymbpbpGCmbpbbyuG!!fe<h6f/W1f!s+u!3O>O)b.n3v/m1>!.+Q!emovFnbbnOv*m,!mv<n6b/O1X!O+F!<OO!bGnyvbmb>G.mOpebouF!bmnvvnmb!OX<T1X/>1m!v=n!bNONXb,nmvvmn>bpTsXf<[U!MGNybbnbvGmm!pmbpup!CmbvbnybGT!XT<FF>ymjvqncbvTtX!,+m!vEnybjTqFc<vt!>GGyybjbqGcmvptb!uu!bfpemhGfbIbpysG{!5><)6b/c1t!)+f!eOhOfbInpvsm{.2N*b!n+v!m3>/N1N*b,nbvcmt!)ufbephmfGIbpbsy{G3!*<<1!/G5y0b1b/G2m!p+b!uu!offejhefbWsfhs>ue5f>m)bbdcTtu)offejhefbWsfhs!uu2b*p!m+G!b3b/y1G*!,b<cTtT)bfnevhmf>WOfOsbun3v*m<!*!OGsyjbbbqGam)pgbju!!f<e*h*fQItppsq{!4->y)f.u3)/q1p!U+y!fmUvbnbbyXG*),bmnvvnMbbObXyTGX><Qe!oGFybbnbvGmm!pubbup!mfGebhbfyWGf!su<4D>y)j.q3c/v1t!!++!!mDvynjbqTc*v,tm>vFnybjTqXcTvFt<!u!bGpymbGbbGbmypGb!u!<f*e*hOftIppqs!{->ybfcut))qfpeUhyffIUpbsb{y4G*),bfnevhMfbIbpysG{>5O<eo!FGbynbvbmG!mupbbpum!GfbebhyfGW!fs<u1>/b4c,t*)DfyejhqfcWvfts+u*41*/,3f.e)h)f>WEfysjuq5c<vt!!GuybbpbmGGmbpbbyuG!!tv<c1qQj`yZOUXJTMXBOVFRT`FB>BmYvGn!b+O!XzT/XQ,Omgvgnpb,OzF/TCFt<pq!>Gzy/bQbtGpmqp!bu<!1mQf`oZhUuJiMTBjVhRo`>BgByYbGb!R+v!bym/jQuOzgSgdpq,Gys/bCntfp/qy><y/!QGtypbqb!Cp<pQmt!piqp!s3{uTbqpbmoG>bfbeyhGf!Ip<s1{Q!`?Z>U!JfMeBhVfRW`fBsBuY<G!!+G!yzb/bQGOmgpgbpu.!zt/vCctqpjqy>Bz>/tOvtcpqqj!yO<T1XQF`!Z+U!J3M/B1V,Rt`vBcBqYjGy!O+X!TyX/OQFOTgFg<p.!yj/gC)tapiqp>sy{/TOqtbpoq*!!m<vOntbpOq>!m3vunbbpXm<Gb!bjygG)!ai<p6s/{1T!q+b!oo*h!jmTvinubhTo>fmmv>n,bzF/<Ct!pjqg!)*iopbsq{TT{qsbpoi*!!)mgfjo!hu<i6T/j1h!o+>!goyhbjbTRivubhmojfumz>S,dyq/GCstbpnqf!/*zo<bq!TG{ysbpbiGam)pgbju!!t<vzc/qfjnybCs>G)qtdvSczqujjymBb!v+R!b)b2y/g1!0;2!31//11*!*@.!m*vonbbqNT<{s!pGiy!b)b>Gzm/pQbOug!ghps!be<jyf/ofunOb>smGvqndbSOz.umjvmnbbvNR<bb!yGgy!b;b!G1m/p1b!u@!!h*sobbeqjTf{osupTi>am)v>nyb/TQ.Omgvgnpb!N<<Q!OGgygbpb!G3mupbbpum!GmbvbnybGO!O><mzv/nNbtOp,qm>vzn/bCNt<pq!!Gy<byb/GNmtppbqu>!ym/vCntbpTqT!>m<vCntbpTq,!m3vunbbpNm<Gb!bGyyGb!bC<p*pfmh!oqbbSjqsdOS>ybjcqtc)vhts!b+e!j*fCoyujOq*c!v?t>)!tbccbt))uhbsTbbebjyfGo>uDTy*j<qc!vGty!bubbGpmmpGbbub!yhGs!be<jofhojuT>inubhyo)fbmc.t>)ohhsjbTeijufhooufOm*!-*!Obscjtb)qh)sgbje!jf<o*u*T",Hi(L,{accordionViewExpandIcon:km(hn),accordionViewCollapseIcon:km(hn,!0),accordionViewLabelColor:th,accordionViewLabelFont:Bh,accordionViewTitleBackground:md,accordionViewSelectBackground:to,accordionViewSelectWidth:3,accordionViewSeparatorColor:E,splitViewDividerSize:1,splitViewDividerBackground:md,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:so,rect:[2,2,12,12],background:hn}]},propertyViewLabelColor:Tk,propertyViewLabelSelectColor:th,propertyViewLabelFont:Bh,propertyViewExpandIcon:km(kg),propertyViewCollapseIcon:km(kg,!0),propertyViewBackground:ff,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Zr,propertyViewColumnLineColor:Zr,propertyViewSelectBackground:to,listViewLabelColor:Tk,listViewLabelSelectColor:th,listViewLabelFont:Bh,listViewRowLineVisible:!1,listViewRowLineColor:Zr,listViewSelectBackground:to,treeViewLabelColor:Tk,treeViewLabelSelectColor:th,treeViewLabelFont:Bh,treeViewExpandIcon:km(De),treeViewCollapseIcon:km(De,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Zr,treeViewSelectBackground:to,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Tk,tableViewLabelSelectColor:th,tableViewLabelFont:Bh,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Zr,tableViewColumnLineColor:Zr,tableViewSelectBackground:to,treeTableViewLabelColor:Tk,treeTableViewLabelSelectColor:th,treeTableViewLabelFont:Bh,treeTableViewExpandIcon:km(De),treeTableViewCollapseIcon:km(De,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Zr,treeTableViewColumnLineColor:Zr,treeTableViewSelectBackground:to,tableHeaderLabelColor:Tk,tableHeaderLabelFont:Bh,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Pn,tableHeaderBackground:ff,tableHeaderMoveBackground:Jh,tableHeaderInsertColor:to,tableHeaderSortDescIcon:xd(kg,!0),tableHeaderSortAscIcon:xd(kg),tabViewTabGap:1,tabViewLabelColor:th,tabViewLabelFont:Bh,tabViewTabBackground:md,tabViewSelectWidth:3,tabViewSelectBackground:to,tabViewMoveBackground:Jh,tabViewInsertColor:to,toolbarLabelColor:Tk,toolbarLabelSelectColor:th,toolbarLabelFont:Bh,toolbarBackground:ff,toolbarSelectBackground:to,toolbarItemGap:8,toolbarSeparatorColor:fd},!0);var yt={translateX:1,sortColumn:1},zt={sortable:1,sortOrder:1,sortFunc:1},At={focusData:1},Bt={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Ct={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Dt=function(D,X){X.add(D),D.hasChildren()&&D.eachChild(function(j){Dt(j,X)
})},Et=function(n,Q,v,z,T,j,J,I,e,W,q){var c,x=v.getValueType(W),H=v.getAlign(W);if(v.getEnumValues(W)){var C=v.toEnumLabel(Q,W),Z=hj||0,h=0,X=j,w=L.getTextSize(z,C).width;return c=mr(v.toEnumIcon(Q,W)),c&&(h=j+hj/2,"center"===H?h+=(I-(Z+w))/2:"right"===H&&(h=h+I-(Z+w)),Vj(n,c,h,J+e/2,W,q),X=h+hj/2),C!=f&&(c?rq(n,C,z,T,X,J,I-(X-j),e):rq(n,C,z,T,j,J,I,e,H)),void 0}return Q=v.formatValue(Q),Q!=f?x===lr?(Nj(n,j,J,I,e,Q),void 0):x===uk||!x&&dk(Q)?(c=mr(Q?eb:Mo),Vj(n,c,j+I/2,J+e/2,W,q),void 0):(rq(n,Q,z,T,j,J,I,e,H),void 0):void 0},Ft=function(K,w){var Q=w.view,s=kn(K),t=w.column||w.property;Q.getDataModel().beginTransaction(),w.editor=K,K.info=w,Q.setCurrentEditor(K),Q.getView().insertBefore(s,Q._79O),kq(K,w.editorRect),K.setFocus?K.setFocus():xg(K),K.commitValue=function(J,P){K._17Q&&(K=K._17Q),P||Q.setValue(w.data,t,K.getValue?K.getValue():K.value),K.close&&K.close(),bn(s)},t.onEditorCreated&&t.onEditorCreated(w)},Gt=function(C,b,Z,m,B){var Q=$e(C,Z),R=b.value,k=b.view,l=B.getValueType(b.data);return Q.onblur=Q.onchange=function(){k.endEditing()},"input"===C?(R=B.formatValue(R),R!=f&&(Q.value=R),Q.onkeydown=function(s){Ll(s)?k.endEditing():le(s)&&k.endEditing(!0)},(l===lh||l===Bl)&&w(Q,Sr,L.numberListener)):C===xp&&m.forEach(function(k){var l=Y.createElement("option");l.innerHTML=B.toEnumLabel(k),l.value=k,B.isEnumEqual(R,k)&&(l.selected=!0),Zg(Q,l)}),Ft(Q,b),Q},Ht=H.widget={},It=function(b,Z,V){kl(K+".widget."+b,Z,V)};Hi(ti,{ms_value:function(L){L.getValue=function(t){var q=this.getItemById(t),P=q.element;return Vn(P)?P:P?P.getValue?P.getValue():P.value:q.selected},L.setValue=function(S,X){var h=this.getItemById(S);if(h){var A=h.element;A&&!Vn(A)?A.setValue?A.setValue(X):A.value=X:dk(X)?(h.selected=X,this.iv()):(h.element=X,this.iv())}},L.v=function(X,U){var K=this;if(2===arguments.length)K.setValue(X,U);else{if(!Mr(X))return K.getValue(X);for(var l in X)K.setValue(l,X[l])}return K}},_46o:function(k){k._icon=f,k._accessType=f,k._valueType=f,k._editable=!1,k._batchEditable=!0,k._align=re,k._nullable=!0,k._emptiable=!1,k.setParent=pm,k.formatValue=function(R){var i=this,I=i._valueType;return i.getEnumValues()?i.toEnumLabel(R):I===uk?!!R:R!=f&&I===lh?P(R):R},k.setEnum=function(w,i,Z,m,X,u,_){var V=this;w&&!br(w)&&w.values&&(m=w.editable,Z=w.icons,i=w.labels,X=w.strict,u=w.maxHeight,_=w.dropDownWidth,w=w.values),Zc(w)&&(w=w._as),Zc(i)&&(i=i._as),Zc(Z)&&(Z=Z._as),V._enumValues=w,V._enumLabels=i,V._enumIcons=Z,V._enumEditable=m,V._enumStrict=X==f?!0:X,V._enumMaxHeight=u,V._enumDropDownWidth=_,w&&w.length&&$c(w[0])&&(V._valueType=Bl),V.fp("enum",!1,!0)},k.getEnumDropDownWidth=function(){return this._enumDropDownWidth},k.getEnumMaxHeight=function(){return this._enumMaxHeight},k.isEnumEditable=function(){return this._enumEditable},k.getEnumValues=function(){return this._enumValues},k.getEnumLabels=function(){return this._enumLabels},k.getEnumIcons=function(){return this._enumIcons},k.isEnumStrict=function(){return this._enumStrict},k.isEnumEqual=function(V,s){return this._enumStrict?V===s:V==s},k.toEnumLabel=function(y,j){var U=this,W=U.getEnumValues(j),S=U.getEnumLabels(j);if(W&&S)for(var C=0;C<W.length;C++)if(U.isEnumEqual(y,W[C]))return S[C];return y},k.toEnumIcon=function(m,T){var e=this,K=e.getEnumValues(T),D=e.getEnumIcons(T);if(K&&D)for(var X=0;X<K.length;X++)if(e.isEnumEqual(m,K[X]))return D[X];return E}},_45o:function(d){d._87o=function(O,x,Y,o,v,F){if(O){var L=this,S=L._90I,r=Rq(1);L._columnLineVisible&&(v-=1),L._rowLineVisible&&(F-=1),0>=v||0>=F||(L._90I||(S=L._90I={}),S[x]||(S[x]=new zp),kq(r,L.tx()+Y,L.ty()+o,v,F),Zg(r,O),L._view.insertBefore(r,L._79O),O.onParentAdded&&O.onParentAdded(r),S[x].add(r))}},d._76o=function(){var $=this,e=$._90I;if(e){for(var Y in e)e[Y].each(function(C){bn(C)});delete $._90I}},d._77o=function(T){var N=this;if(N._90I){var B=N._90I[T];B&&(B.each(function(c){bn(c)}),delete N._90I[T])}}},_47o:function(t){t.getValue=function(L,B){return B.getValue?B.getValue(L,B,this):Wp(L,B.getAccessType(),B.getName())},t.setValue=function(Q,T,O){if(T.isEmptiable(Q)||""!==O||(O=E),T.isNullable(Q)||O!=f){var p=this,D=T.getName(Q),N=T.getAccessType(Q),U=T.getValueType(Q);U===lh&&Vn(O)?O=cm(O):U===Bl&&Vn(O)?O=parseFloat(O):U===uk&&Vn(O)&&(O="true"===O),p._batchEditable&&T._batchEditable&&p.isSelected(Q)?p.sm().each(function(s){T.setValue?T.setValue(s,T,O,p):Pq(s,N,D,O)}):T.setValue?T.setValue(Q,T,O,p):Pq(Q,N,D,O)}},t.setCurrentEditor=function(w){this.endEditing(),this._currentEditor=w,this.redraw()},t.isEditing=function(S,$){var g=this,i=g._currentEditor;if(!i)return!1;if($){var q=i.info;return q?(q.column||q.property)===$&&q.data===S:!1}return!0},t.endEditing=function(y){var I=this,C=I._currentEditor;C&&(delete I._currentEditor,C.commitValue&&C.commitValue(C.info,y),I.redraw(),I.getDataModel().endTransaction())},t.beginEditing=function(d){this.endEditing();var k=this,b=d.column||d.property;if(b.beginEditing)b.beginEditing(d);else{var Z=d.data,G=d.value,h=k.getSelectBackground(Z),M=b.getEnumValues(Z),c=b.getSlider(Z),m=b.getColorPicker(Z);if(c){var n=dq(Ht.Slider,c);return n.setValue(G),n.getView().onblur=function(){k.endEditing()},n.isInstant()&&(n.onValueChanged=function(){k.setValue(Z,b,n.getValue())}),Ft(n,d),void 0}if(m||b.getValueType(Z)===lr){var E=dq(Ht.ColorPicker,m);return E.setValue(G),E.onClosed=function(){k.endEditing()},E.isInstant()&&(E.onValueChanged=function($,y){k.setValue(Z,b,y)}),Ft(E,d),E.open(),void 0}if(M){if(Ht.ComboBox){var B=new Ht.ComboBox;B.setValue(G),B.setValues(M),B.setLabels(b.getEnumLabels(Z)),B.setIcons(b.getEnumIcons(Z)),B.setEditable(b.isEnumEditable(Z)),B.setStrict(b.isEnumStrict(Z)),B.setMaxHeight(b.getEnumMaxHeight(Z)),B.setDropDownWidth(b.getEnumDropDownWidth(Z)),B.onClosed=function(){k.endEditing()},Ft(B,d),B.open()}else Gt(xp,d,h,M,b);return}var $=b.getValueType(Z);if($===uk||dk(G))return k.setValue(Z,b,!G),void 0;if(b.getItemEditor(Z)){var N=jk(b.getItemEditor(Z)),P=new N(Z,b,k,d),J=P.getView();return J._17Q=P,P.setValue(G),Eq(J),Ft(J,d),P.editBeginning&&P.editBeginning(),void 0}Gt("input",d,h,f,b)}}},_44o:function(a){a.init=function(w){var q=this,U=q.th=new Xt(w),r=q._view=Cg(1,q);q.tv=q._tableView=w,Zg(r,U.getView()),Zg(r,w.getView()),U.mp(function(v){v.property===_p&&q.iv()}),q.iv()},a.getTableView=function(){return this.tv},a.getTableHeader=function(){return this.th},a.getDataModel=function(){return this.tv.dm()},a.getColumnModel=function(){return this.tv.getColumnModel()},a.setColumns=function(f){this.tv.setColumns(f)},a.addColumns=function(y){this.tv.addColumns(y)},a.endEditing=function(){this.tv.endEditing()},a.validateImpl=function(){var i=this,P=i.th,g=yg(P),M={x:0,y:0,width:i.getWidth(),height:g};kq(P,M),M.y=g,M.height=p(0,i.getHeight()-g),kq(i.tv,M)}},ms_vs:function(f){f._41o=function(){return this._29I.height<this._59I},f._43o=function(){var I=this;I._41o()&&(I._58I||(On(function(){I._94O()},jq),I.iv()),I._58I=new Date)},f._94O=function(){var T=this;if(T._58I){var Q=new Date;Q.getTime()-T._58I.getTime()>=jq?(delete T._58I,T.iv()):On(function(){T._94O()},jq)}},f._93I=function(){var A=this,g=A._27I;if(A._58I||!A._autoHideScrollBar){g||Zg(A._79O,g=A._27I=Rq());var I=A._29I,j=I.height,W=A._59I,b=A.getScrollBarSize(),t=I.width-b-2,$=j*(-A.ty()/W),X=j*(j/W),Q=g.style;W>j?(pn>X&&($=$+X/2-pn/2,0>$&&($=0),$+pn>j&&($=j-pn),X=pn),Q.visibility=Xh,Q.background=A.getScrollBarColor(),Q.borderRadius=b/2+qf,kq(g,t,$,b,X)):Q.visibility=jc}else g&&(g.style.visibility=jc)}},ms_hs:function(g){g._40o=function(){return this._29I.width<this._91I},g._42o=function(){var t=this;t._40o()&&(t._95O||(On(function(){t._94I()},jq),t.iv()),t._95O=new Date)},g._94I=function(){var B=this;if(B._95O){var U=new Date;U.getTime()-B._95O.getTime()>=jq?(delete B._95O,B.iv()):On(function(){B._94I()},jq)}},g._92I=function(){var c=this,q=c._28I;if(c._95O||!c._autoHideScrollBar){q||Zg(c._79O,q=c._28I=Rq());var L=c._29I,O=L.width,Z=c._91I,G=c.getScrollBarSize(),W=L.height-G-2,r=O*(-c.tx()/Z),a=O*(O/Z),F=q.style;Z>O?(pn>a&&(r=r+a/2-pn/2,0>r&&(r=0),r+pn>O&&(r=O-pn),a=pn),F.visibility=Xh,F.background=c.getScrollBarColor(),F.borderRadius=G/2+qf,kq(q,r,W,a,G)):F.visibility=jc}else q&&(q.style.visibility=jc)}}}),eo(eb,Rb(16,16,[{type:Bj,rect:[1,1,14,14],background:to},{type:_f,rect:[1,1,14,14],width:1,color:kj},{type:pc,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),eo(Mo,Rb(16,16,{type:_f,rect:[1,1,14,14],width:1,color:kj})),eo(fg,Rb(16,16,[{type:Jq,rect:[2,2,12,12],borderWidth:1,borderColor:kj,background:"#FFF"},{type:Jq,rect:[4,4,8,8],background:to}])),eo(Ym,Rb(16,16,{type:Jq,rect:[2,2,12,12],borderWidth:1,borderColor:kj})),ti._15Q=function(k){k._29I=hq,k._59I=0,k._91I=0,k._5o=function(V){var i=this;i._30I=new zp,i._rows=new zp,i._rowMap={},i._31I=0,i._14I=0,i._view=Cg(1,i),i._canvas=Vq(i._view),Zg(i._view,i._79O=Rq()),i.dm(V?V:new Wo)},k.getCheckIcon=function(R){var H=this.sm(),G=H.co(R);return H.sg()?mr(G?fg:Ym):mr(G?eb:Mo)},k.checkData=function(M){var _=this.sm(),o=_.co(M);_.sg()&&o||(this._32o=1,o?_.rs(M):_.as(M),delete this._32o)},k.getDataAt=function(S){S.target&&(S=this.lp(S));var u=j(S.y/this._rowHeight),t=this._rows;return 0>u||u>=t.size()?f:t.get(u)},k.onDataDoubleClicked=function(){},k.onDataClicked=function(){},k.adjustTranslateX=function(){return 0},k.adjustTranslateY=function(C){var q=this.getHeight()-this._59I;return q>C&&(C=q),C>0?0:P(C)},k.onPropertyChanged=function(b){var s=this,l=b.property;Bt[l]?s.ivm():At[l]||s.redraw(),l===Ml?s._42o():l===Gq&&s._43o()},k.getLabel=function(S){return S.toLabel()},k.getLabelFont=function(){return this._labelFont},k.getLabelColor=function(u){var Y=this;if(Y.isCheckMode()){if(Y._focusData===u)return Y._labelSelectColor}else if(Y.isSelected(u))return Y._labelSelectColor;return Y._labelColor},k.getStartRowIndex=function(){return this._31I},k.getEndRowIndex=function(){return this._14I},k.getRowDatas=function(){return this._rows},k.getRowIndex=function(i){return this._rowMap[i._id]},k.getRowSize=function(){return this._rows.size()},k.getViewRect=function(){return ys(this._29I)},k.isVisible=function(D){return this._visibleFunc?this._visibleFunc(D):!0},k.getCurrentSortFunc=function(){return this._sortFunc},k.setDataModel=function(Q){var M=this,g=M._dataModel,p=M._selectionModel;g!==Q&&(g&&(g.umm(M.handleDataModelChange,M),g.umd(M.handleDataPropertyChange,M),g.umh(M.handleHierarchyChange,M),p||g.sm().ums(M.handleSelectionChange,M)),M._dataModel=Q,Q.mm(M.handleDataModelChange,M),Q.md(M.handleDataPropertyChange,M),Q.mh(M.handleHierarchyChange,M),p?p._21I(Q):Q.sm().ms(M.handleSelectionChange,M),M.fp("dataModel",g,Q))},k.validateModel=function(){var b=this;b._rows.clear(),b._rowMap={},b.buildChildren(b._dataModel._roots);var Y=b._rows=b._rows.toList(b.isVisible,b),A=0,c=b.getCurrentSortFunc(),S=Y.size();for(c&&Y.sort(c);S>A;A++)b._rowMap[Y.get(A)._id]=A},k.buildChildren=function(z){var p=this;z.each(function(Q){p._rows.add(Q),p.buildChildren(Q._children)})},k.handleDataModelChange=function(){this.ivm()},k.handleDataPropertyChange=function(Z){"parent"===Z.property?this.ivm():this.invalidateData(Z.data)},k.handleHierarchyChange=function(){this.ivm()},k.handleSelectionChange=function(R){R.datas.each(this.invalidateData,this),this.onSelectionChanged(R)},k.onSelectionChanged=function(K){var I=this,w=I.sm();!I.isAutoMakeVisible()||1!==w.size()||"set"!==K.kind&&"append"!==K.kind||I._32o||I.makeVisible(w.ld())},k.handleBackgroundClick=function(r){zj(r)&&!this.isCheckMode()&&this.sm().cs()},k.makeVisible=function(U){U&&(this._23I=U,this.iv())},k.scrollToIndex=function(O){var Z=this,T=Z._29I,A=T.height,y=Z._rowHeight,V=y*O;O>=0&&O<Z._rows.size()&&A>0&&(V+y>T.y+A?Z.ty(-V+A-y):V<T.y&&Z.ty(-V))},k.autoScroll=function(d,P){var E=this,r=E._rowHeight,t=r,L=r/4,z=E._29I,K=E.lp(d),A={x:E.tx(),y:E.ty()};return r>0&&z&&(K.x-z.x<t?E.translate(L,0):z.x+z.width-K.x<t&&E.translate(-L,0),K.y-z.y<t?E.translate(0,L):z.y+z.height-K.y<t&&E.translate(0,-L)),A.x=E.tx()-A.x,A.y=E.ty()-A.y,P&&(P.x+=A.x,P.y+=A.y),A},k.getTopRowOrderSelection=function(){var b=this.sm().getTopSelection(),E={},l=new zp;return b.each(function(g){E[g._id]=g}),this._rows.each(function(B){E[B._id]&&l.add(B)}),l},k.getRowOrderSelection=function(){var Q=new zp;return this._rows.each(function(d){this.isSelected(d)&&Q.add(d)},this),Q},k.ivm=function(){this.invalidateModel()},k.invalidateModel=function(){var $=this;$._96I||($._96I=1,$._32I=1,delete $._24I),$.iv()},k.redraw=function(){var s=this;s._32I||(s._32I=1,delete s._24I,s.iv())},k.invalidateData=function(b){var j=this;Tn?j.redraw():j._32I||(j._24I||(j._24I={}),j._24I[b._id]=b,j.iv())},k.getFocusData=function(){return this._focusData},k.setFocusDataById=function(I){this.setFocusData(this.dm().getDataById(I))},k.setFocusData=function(G){var d=this,M=d._focusData;M!==G&&(d._focusData=G,d.fp("focusData",M,G),M&&d.invalidateData(M),G&&(d.invalidateData(G),d.isAutoMakeVisible()&&d.makeVisible(G)))},k.drawRowBackground=function(y,V,Z,i,k,n,J){var $=this,A=$.isCheckMode();(V===$._focusData&&A||Z&&!A)&&Nj(y,i,k,n,J,$.getSelectBackground(V))},k.drawData=function(o,L,D){var e=this,Y=e._rowHeight,n=Y*D,m=e._29I,x=m.x,U=m.width;o.save(),o.beginPath(),o.rect(x,n,U,Y),o.clip(),e._87o(e.drawRow(o,L,e.isSelected(L),x,n,U,Y),D,x,n,U,Y),o.restore(),e._rowLineVisible&&Nj(o,x,n+Y-1,U,1,e._rowLineColor)},k._12I=function(f){var G=this,j=G._31I,Z=G._29I,e=Z.x,z=Z.y,l=Z.width,C=Z.height;for(f.beginPath(),f.rect(e,z,l,C),f.clip(),f.clearRect(e,z,l,C),G._76o(),G._93db(f);j<G._14I;j++)G.drawData(f,G._rows.get(j),j);G._92db(f)},k._13I=function(G){for(var N,C=this,c=C._rowHeight,r=C._29I,K=r.x,o=r.width,R=C._31I,j=C._30I;R<C._14I;R++)N=C._rows.get(R),C._24I[N._id]&&j.add({data:N,index:R});j.isEmpty()||(G.beginPath(),j.each(function(R){G.rect(K,R.index*c,o,c)}),G.clip(),j.each(function(H){G.clearRect(K,H.index*c,o,c)}),j.each(function(Z){C._77o(Z.index)}),C._93db(G),j.each(function(f){C.drawData(G,f.data,f.index)}),C._92db(G),j.clear())},k.preValidateModel=function(){this.endEditing&&this.endEditing()},k.validateImpl=function(){var g=this,U=g._canvas,t=g.getWidth(),w=g.getHeight(),o=g._rowHeight,x=g._32I;(t!==U.clientWidth||w!==U.clientHeight)&&(Zq(U,t,w),x=1),g._96I&&(g.preValidateModel(),g.validateModel());var C=g._29I,Q={x:-g.tx(),y:-g.ty(),width:t,height:w},z=g._rows.size(),p=Xn(U),b=g._23I;x||nk(Q,C)||(x=1),g._29I=Q,g._59I=z*o,g._31I=j(Q.y/o),g._14I=q((Q.y+Q.height)/o),g._31I<0&&(g._31I=0),g._14I>z&&(g._14I=z),g._99I&&x&&g._99I();var _=g.tx(),L=g.ty();(g._40o()||g._41o())&&(g._59I+=g.getScrollBarSize(),g._99I&&x&&(g._91I+=g.getScrollBarSize())),vj&&!ol&&(p.save(),ji(p,t/Fn.length,w/Fn.length,1)),ji(p,_,L,1),x?g._12I(p):g._24I&&g._13I(p),g._93I(),g._92I(),p.restore(),g._32I=g._24I=g._96I=f,b&&(g.scrollToIndex(g.getRowIndex(b)),delete g._23I),g.tx(g.tx()),g.ty(g.ty())},k.canHandleSelectMode=function(){return!0}},ti._48o=function(J){J._rootVisible=!0,J._rootData=f,J._35o=function(){this._expandMap={},this._levelMap={}},J.validateModel=function(){var T=this,B=T._rootData;T._rows.clear(),T._levelMap={},T._rowMap={},T._currentLevel=0,B?T._rootVisible?T.isVisible(B)&&T.buildData(B):T.buildChildren(B):T.buildChildren(),delete T._currentLevel},J.buildData=function(A){var f=this,y=A._id,p=f._rows;f._rowMap[y]=p.size(),p.add(A),f._levelMap[y]=f._currentLevel,f.isExpanded(A)&&(f._currentLevel++,f.buildChildren(A),f._currentLevel--)},J.buildChildren=function(k){var J=this,C=k?k._children:J._dataModel._roots,Q=J.getCurrentSortFunc();Q&&J.isChildrenSortable(k)?C.toList(J.isVisible,J).sort(Q).each(J.buildData,J):C.each(function($){J.isVisible($)&&J.buildData($)})},J.getLevel=function(c){return this._levelMap[c._id]},J.getToggleIcon=function(i){var e=this,G=e._loader,m=e._collapseIcon;return G&&!G.isLoaded(i)?m:i.hasChildren()?e.isExpanded(i)?e._expandIcon:m:f},J.isCheckMode=function(){return this._checkMode!=f},J.isChildrenSortable=function(){return!0},J.handleDataModelChange=function(d){var i=this;d.kind===xk?delete i._expandMap[d.data._id]:d.kind===$n&&(i._expandMap={}),i.ivm()},J.toggle=function(z){var Y=this;Y.isExpanded(z)?Y.collapse(z):Y.expand(z)},J.isExpanded=function(o){return 1===this._expandMap[o._id]},J.expand=function(x){var X=this,a=X._loader;X.isExpanded(x)||(a&&!a.isLoaded(x)&&a.load(x),X._expandMap[x._id]=1,X.ivm(),X.onExpanded(x))},J.onExpanded=function(){},J.collapse=function(M){var g=this;g.isExpanded(M)&&(delete g._expandMap[M._id],g.ivm(),g.onCollapsed(M))},J.onCollapsed=function(){},J.expandAll=function(l){if(l)this.expand(l),l.eachChild(function(w){this.expandAll(w)},this);else{var Q=this;Q._dataModel.each(function(R){R.hasChildren()&&(Q._expandMap[R._id]=1)}),Q.ivm()}},J.collapseAll=function(){this._expandMap={},this.ivm()},J.makeVisible=function(m){if(m){var L=this;if(!L._rootData||m.isDescendantOf(L._rootData)){for(var l=m._parent;l;)L.expand(l),l=l._parent;L._23I=m,L.iv()}}},J.checkData=function(H){var L,U=this,_=U._checkMode,m=U.sm(),$=m.co(H);if(!m.sg()||!$){if(U._32o=1,_===yd)$?m.rs(H):m.as(H);else if(_===Dh)L=new zp(H),L.addAll(H._children);else if("descendant"===_)L=new zp,Dt(H,L);else if("all"===_&&(L=new zp,Dt(H,L),!$))for(var K=H._parent;K;)L.add(K),K=K._parent;L&&($?m.rs(L):m.as(L)),delete U._32o}},J.drawTree=function(i,Q,F,z,h,A,f){var q=this,T=q._indent,C=q._levelMap[Q._id],V=q.getIconWidth(Q),o=mr(q.getToggleIcon(Q));o?(z+=T*C,Vj(i,o,z+T/2,h+f/2,Q,q),z+=T):z+=T*(C+1),q._checkMode&&(Vj(i,q.getCheckIcon(Q),z+T/2,h+f/2,Q,q),z+=T),q.drawIcon(i,Q,z,h,V,f),q.drawLabel(i,Q,z+V,h,f)}},ti._14Q=function(B){B.getIcon=function(I){return I.getIcon()},B.getIconWidth=function(X){return this.getIcon(X)?this._indent:0},B.drawIcon=function(Q,q,n,I,H,v){if(H){var e=this,i=e.getBodyColor(q),S=mr(e.getIcon(q),i);S&&(v-=e.isRowLineVisible()?1:0,Tc(Q,S,kp,n,I,H,v,q,e,i),Df(Q,e.getBorderColor(q),n,I,H,v))}},B.drawLabel=function(B,H,D,V,R){var p=this;rq(B,p.getLabel(H),p.getLabelFont(H),p.getLabelColor(H),D,V,0,R)}},ti._50o=function($){$._98I=function(){var c=this,_=c._39o=new Wo;c._60I=new zp,_.mm(c._17o,c),_.md(c._18o,c),_.mh(c._19o,c)},$.setColumns=function(E){this._39o.clear(),this.addColumns(E)},$.addColumns=function($){var l=this._39o;$.forEach(function(A){if(!(A instanceof Kt)){var k=jk(A.className);A=dq(k?k:Kt,A)}l.add(A)})},$.onColumnClicked=function(){},$.onCheckColumnClicked=function(){},$._3Q=function(k){for(var n,g=0,p=this._60I,Z=p.size();Z>g;g++)if(n=p.get(g),n.column===k)return n;return f},$.getColumnAt=function($){var p=this._4Q($);return p?p.column:f},$._4Q=function(r){for(var D=this,B=r.target?D.lp(r).x:r.x,l=D._60I,$=0;$<l.size();$++){var Y=l.get($),z=Y.startX;if(B>=z&&B<z+Y.column.getWidth())return Y}return f},$.getToolTip=function(J){var P=this,u=P.getDataAt(J),v=P.getColumnAt(J);return u&&v?v.getToolTip(u,P):f},$.adjustTranslateX=function(Q){var C=this.getWidth()-this._91I;return C>Q&&(Q=C),Q>0?0:P(Q)},$._99I=function(){var $=this,h=$._29I,n=$._60I;n.clear(),$._91I=0,$._39o._roots.each(function(Q){if(Q.isVisible()){var _=$._91I+Q.getWidth();$._91I<=h.x+h.width&&_>=h.x&&n.add({column:Q,startX:$._91I}),$._91I=_}})},$.drawData=function(i,N,V){var A=this,m=A._rowHeight,X=m*V,D=A.isSelected(N),H=A._29I,Y=H.x,x=H.width;A.drawRowBackground(i,N,D,Y,X,x,m),A._60I.each(function(j){var Y=j.column,T=j.startX,Z=Y.getWidth();Z>0&&!A.isEditing(N,Y)&&(i.save(),i.beginPath(),i.rect(T,X,Z,m),i.clip(),A._87o(A.drawCell(i,N,D,Y,T,X,Z,m),V,T,X,Z,m),A._columnLineVisible&&Nj(i,T+Z-1,X,1,m,A._columnLineColor),i.restore())}),A._rowLineVisible&&Nj(i,Y,X+m-1,x,1,A._rowLineColor)},$.drawCell=function(n,L,J,d,V,p,$,W){var Q=this;if(d.drawCell)return d.drawCell(n,L,J,d,V,p,$,W,Q);var k=Q.getValue(L,d);Et(n,k,d,Q.getLabelFont(L,d,k),Q.getLabelColor(L,d,k),V,p,$,W,L,Q)},$.getColumnModel=function(){return this._39o},$._17o=function(){this.redraw()},$._18o=function(o){var w=this;o.data===w._sortColumn&&zt[o.property]?w.ivm():(w._42o(),w.redraw())},$._19o=function(){this.redraw()},$.getCurrentSortFunc=function(){var P=this,X=P._sortColumn;if(X&&X.isSortable()){var y=X.getSortFunc(),d=Gk===X.getSortOrder()?1:-1;return y||(y=Ln),function(G,k){return y.call(P,P.getValue(G,X),P.getValue(k,X),G,k)*d}}return P._sortFunc},$.isCellEditable=function(k,Q,M){return Q.isEditable()&&this.isEditable()?Q.isCellEditable?Q.isCellEditable(k,Q,M,this):!0:!1},$._37O=function(s,c){if(zj(c))for(var G=this,r=G.lp(c),D=G._60I,q=G._rowHeight,x=G._29I,o=x.x,F=x.y,C=x.width,M=x.height,L=0;L<D.size();L++){var e=D.get(L),w=e.startX,J=e.column,H=J.getWidth();if(J!==G._31o&&J!==G._4o&&r.x>=w&&r.x<w+H&&G.isCellEditable(s,J,c)){var T={x:w,y:G.getRowIndex(s)*q,width:H,height:q},Z={x:T.x+G.tx(),y:T.y+G.ty(),width:T.width,height:T.height},Y=0,j=0;return T.x<o?Y=T.x-o:T.x+T.width>o+C&&(Y=T.x+T.width-o-C),Y&&(G.tx(G.tx()-Y),Z.x-=Y),T.y<F?j=T.y-F:T.y+q>F+M&&(j=T.y+q-F-M),j&&(G.ty(G.ty()-j),Z.y-=j),G.beginEditing({data:s,column:J,value:G.getValue(s,J),event:c,rect:T,editorRect:Z,view:G}),void 0}}}},Ht.BaseItemEditor=function(U,J,s,$){this._data=U,this._column=J,this._master=s,this._editInfo=$},It("BaseItemEditor",b,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Jt=H.Tab=function(){Hm(Jt,this)};Ce("Tab",rd,{ms_ac:["view","closable","disabled","visible"],_icon:f,_closable:!1,_disabled:!1,_visible:!0,setParent:pm});var Kt=H.Column=function(){Hm(Kt,this)};Ce("Column",rd,{_46o:1,ms_ac:["accessType","valueType",Xh,Gh,ir,Mj,"align",lr,"sortOrder",ib,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Gk,_sortFunc:f,_sortable:!0,_clickable:!0,setWidth:function(I){16>I&&(I=16);var X=this._width;this._width=I,this.fp(Mj,X,I)},getToolTip:function(z,k){return this.formatValue(k.getValue(z,this))}});var Lt=H.Property=function(){Hm(Lt,this)};Ce("Property",rd,{_46o:1,ms_ac:["accessType","valueType",Gh,ir,"categoryName",lr,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:f,getToolTip:function(W,S,y){var j=this;return S?j.formatValue(y.getValue(W,j)):y.getPropertyName(j)}}),Ht.AccordionView=function(){var A=this;A._20o={},A._21o=new zp,A._10o=f,A._9o=f,A._11o=f,A._view=Cg(0,A),A.iv()},It("AccordionView",b,{ms_v:1,ms_fire:1,ms_ac:[wg,dj,"titleHeight",Cr,vh,"titleBackground","selectWidth",$m,"orientation","separatorColor"],_expandIcon:L.accordionViewExpandIcon,_collapseIcon:L.accordionViewCollapseIcon,_titleHeight:Ic,_labelColor:L.accordionViewLabelColor,_labelFont:L.accordionViewLabelFont,_titleBackground:L.accordionViewTitleBackground,_selectBackground:L.accordionViewSelectBackground,_selectWidth:L.accordionViewSelectWidth,_orientation:"v",_separatorColor:L.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(m,t,L,g){var R=this,f=Rq(),x={content:t,div:f,canvas:Vq(f),icon:g};if(R._20o[m])throw m+" already exists";var $=x.downEventFunc=function(D){Lk(D)},Z=x.upEventFunc=function(Z){Lk(Z),zj(Z)&&(R._10o===m?R.collapse():R.expand(m))};[Sk,Lb].forEach(function(u){w(f,u,$)}),[Wn,gh].forEach(function(z){w(f,z,Z)}),f.style.cursor=ig,Zg(R._view,f),R._20o[m]=x,R._21o.add(m),L&&R.expand(m),R.iv()},remove:function(N){var M=this,s=M._20o[N];if(s){var t=s.div;bn(t),[Sk,Lb].forEach(function(z){x(t,z,s.downEventFunc)}),[Wn,gh].forEach(function(L){x(t,L,s.upEventFunc)}),delete M._20o[N],M._21o.remove(N),M.iv()}},clear:function(){var D=this;D._21o.toArray().forEach(D.remove,D),D._20o={},D._21o.clear(),D.iv()},isExpanded:function(d){return this._10o===d},expand:function(m){var t=this;t._20o[m]&&t._10o!==m&&(t._10o=m,t.onExpanded(m),t.iv())},onExpanded:function(){},collapse:function(){var U=this;U._10o&&(U.onCollapsed(U._10o),delete U._10o,U.iv())},onCollapsed:function(){},initCanvas:function(K,S,l){Zq(K,S,l);var v=Xn(K);return ji(v,0,0,1),v.clearRect(0,0,S,l),v},drawTitle:function(p,z,o,h,m){var v=this,T=mr(m.icon),C=v.isExpanded(z),R=v._titleHeight,H=v._titleBackground,n=v._selectWidth,r=v._separatorColor,_=mr(C?v._expandIcon:v._collapseIcon),L=n+4;Nj(p,0,0,o,h,H),C&&n&&Nj(p,0,0,n,h,v._selectBackground),(C||v._21o.get(v._21o.size()-1)!==z)&&Nj(p,0,h-1,o,1,r?r:Zk(H)),T&&(Vj(p,T,L+Bb(T)/2,R/2),L+=Bb(T)+2),rq(p,z,v.getLabelFont(z),v.getLabelColor(z),L,0,0,R),_&&Vj(p,_,o-Bb(_)/2-4,R/2)},validateImpl:function(){var b=this,R=b._view,s=0,l=0,k=b.getWidth(),j=b.getHeight(),D=b._titleHeight,H=b._21o.size()*D,i=b._11o,W=b._9o;delete b._11o,delete b._9o,b._21o.each(function(i){var q,N,I=b._20o[i],z=I.content,S=b._10o===i;yl(b)?(kq(I.div,s,0,D,j),q=b.initCanvas(I.canvas,D,j),rn(q,0,j),bo(q,-qq),b.drawTitle(q,i,j,D,I),q.restore(),S?(N=p(0,k-H),z&&(b._11o=z,b._9o=kn(z),kq(z,s+D,0,N,j)),s+=D+N):s+=D):(kq(I.div,0,l,k,D),q=b.initCanvas(I.canvas,k,D),b.drawTitle(q,i,k,D,I),q.restore(),S?(N=p(0,j-H),z&&(b._11o=z,b._9o=kn(z),kq(z,0,l+D,k,N)),l+=D+N):l+=D)});var U=b._9o;i&&i!==b._11o&&i.endEditing&&i.endEditing(),U&&U!==W&&Zg(R,U),W&&W!==U&&bn(W)}}),Ht.SplitView=function(o,d,M,x){var k=this,i=k._dividerDiv=Rq(),K=k._60O=Vq(),h=k._61O=Vq(),Q=K.style,a=h.style;k._view=Cg(1,k),Zg(k._view,i),Q.msTouchAction=mk,Q.pointerEvents=mk,Q.cursor=ig,a.msTouchAction=mk,a.pointerEvents=mk,a.cursor=ig,o&&k.setLeftView(o),d&&k.setRightView(d),M&&k.setOrientation(M),x!=f&&k.setPosition(x),k.setStatus(Hh),new Mt(k)},It("SplitView",b,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:L.splitViewDividerSize,_dividerBackground:L.splitViewDividerBackground,_dragOpacity:L.splitViewDragOpacity,_toggleIcon:L.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(E,J){var N=this,l=N._position;isNaN(E)||(J||(N._82O=0>E?-1:E>1?1:0),N._position=E,N.fp(Cp,l,E))},getLeftView:function(){return this._leftView},setLeftView:function(R){var x=this,m=x._leftView,U=x._view;if(x._leftView!==R){if(m&&m!==x._rightView){var K=kn(m);K.parentNode===U&&bn(K)}if(x._leftView=R,R){var b=kn(R);b.parentNode!==U&&U.insertBefore(b,x._dividerDiv)}x.fp("leftView",m,R)}},getRightView:function(){return this._rightView},setRightView:function(t){var O=this,b=O._rightView,R=O._view;if(O._rightView!==t){if(b&&b!==O._leftView){var J=kn(b);J.parentNode===R&&bn(J)}if(O._rightView=t,t){var C=kn(t);C.parentNode!==R&&R.insertBefore(C,O._dividerDiv)}O.fp("rightView",b,t)}},validateImpl:function(){var f=this,X=f._draggable,a=f._position,t=f.getWidth(),w=f.getHeight(),B=f._dividerSize,E=f._dividerBackground,U=dn?18:8,Y=f._dividerDiv,y=f._82O,K=f._60O,k=f._61O,r=f._toggleIcon,_=f._status,L=Y.style,D=null,j=dn?20:4,T=r.comps[0];B>=U||0===B?f._coverDiv&&(bn(f._coverDiv),delete f._coverDiv):f._coverDiv||(f._coverDiv=Rq(),xf&&(f._coverDiv.style.background=Wm),Zg(Y,f._coverDiv)),f._togglable?K.parentNode||(Zg(Y,K),Zg(Y,k)):(bn(K),bn(k));var s=f._coverDiv,z=f._leftView,S=f._rightView;if(yl(f)){if(B>t&&(B=t),_===Hh)if(1===y)var Z=h(a,t),c=p(0,t-B-Z);else-1===y?(c=h(-a,t),Z=p(0,t-B-c)):(Z=P((t-B)*a),c=p(0,t-B-Z));else"cl"===_?(Z=0,c=p(0,t-B)):"cr"===_&&(c=0,Z=p(0,t-B));z&&kq(z,0,0,Z,w),S&&kq(S,Z+B,0,c,w),kq(Y,Z,0,B,w),f._22o=Z,s&&(kq(s,B/2-U/2,0,U,w),s.style.cursor=X?Ek:""),Y.style.cursor=X?Ek:"";var n=Y.clientHeight/2,l=Y.clientWidth;Zq(K,l,l),kq(K,0,n-l-j,l,l),D=Xn(K),ji(D,0,0,1),T.rotation=-qq,Pi(D,r,0,0,l,l),D.restore(),Zq(k,l,l),kq(k,0,n+j,l,l),D=Xn(k),ji(D,0,0,1),T.rotation=qq,Pi(D,r,0,0,l,l),D.restore()}else{if(B>w&&(B=w),_===Hh)if(1===y)var u=h(a,w),g=p(0,w-B-u);else-1===y?(g=h(-a,w),u=p(0,w-B-g)):(u=P((w-B)*a),g=p(0,w-B-u));else"cl"===_?(u=0,g=p(0,w-B)):"cr"===_&&(g=0,u=p(0,w-B));z&&kq(z,0,0,t,u),S&&kq(S,0,u+B,t,g),kq(Y,0,u,t,B),f._22o=u,s&&(kq(s,0,B/2-U/2,t,U),s.style.cursor=X?Er:""),L.cursor=X?Er:"";var i=Y.clientWidth/2,l=Y.clientHeight;Zq(K,l,l),kq(K,i-l-j,0,l,l),D=Xn(K),ji(D,0,0,1),T.rotation=0,Pi(D,r,0,0,l,l),D.restore(),Zq(k,l,l),kq(k,i+j,0,l,l),D=Xn(k),ji(D,0,0,1),T.rotation=O,Pi(D,r,0,0,l,l),D.restore()}L.background=E}});var Mt=function(W){this.sv=W,this.addListeners()};kl(Mt,b,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(N){var z=this,W=z.sv,r=W._dividerDiv,O=W._60O,b=W._61O,d=W._status,_=N.target;if(_===O)d===Hh?W.setStatus("cl"):"cr"===d&&W.setStatus(Hh);else if(_===b)d===Hh?W.setStatus("cr"):"cl"===d&&W.setStatus(Hh);else if(Tr(N)&&(_===r||_===W._coverDiv)&&(Lk(N),W.isDraggable())){W.getLeftView(),W.getRightView();var g=z.maskDiv=Rq();if(g.style.left=0,g.style.top=0,g.style.width=W.getWidth()+"px",g.style.height=W.getHeight()+"px",W.getView().appendChild(g),!W.isContinuousLayout()){var m=z.resizeDiv=Rq();m.style.left=r.style.left,m.style.top=r.style.top,m.style.width=r.style.width,m.style.height=r.style.height,m.style.opacity=W.getDragOpacity(),m.style.background=W.getDividerBackground(),Zg(z.getView(),m)}z._lastAbsPosition=W._22o,z._86o=yl(W)?dg(N).x:dg(N).y,bg(z,N)}},handleWindowTouchMove:function(K){Tr(K)&&this.update(K,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(u){var p=this;p.update(u,!0),p.sv.setStatus(Hh),p.maskDiv&&bn(p.maskDiv),p.resizeDiv&&bn(p.resizeDiv),p.maskDiv=p.resizeDiv=f},handle_mousedown:function(m){zj(m)&&this.handle_touchstart(m)},handleWindowMouseMove:function(F){this.handleWindowTouchMove(F)},handleWindowMouseUp:function(M){this.handleWindowTouchEnd(M)},update:function(Z,J){var z=this,l=z.sv,h=yl(l)?l.getWidth():l.getHeight(),s=l._dividerSize,q=z._lastAbsPosition-z._86o;yl(l)?(q+=dg(Z).x,q>h-s&&(q=h-s),0>q&&(q=0),z.resizeDiv&&(z.resizeDiv.style.left=q+qf)):(q+=dg(Z).y,q>h-s&&(q=h-s),0>q&&(q=0),z.resizeDiv&&(z.resizeDiv.style.top=q+qf)),J&&h!==s&&(1===l._82O?l.setPosition(q,1):-1===l._82O?l.setPosition(q-h+s,1):l.setPosition(q/(h-s),1))}}),Ht.TabView=function(){var f=this,n=f._view=Cg(1,f),W=f._91O=Rq(1),q=f._tabModel=new Wo,A=q.sm(),O=f.invalidate;f._7o=new zp,f._canvas=Vq(W),Zg(n,W),Zg(n,f._92O=Rq(1)),A.setSelectionMode(To),A.ms(f.handleSelectionChange,f),q.mm(O,f),q.mh(O,f),q.md(O,f),f._interactor=new Nt(f),f.iv()},It("TabView",b,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Cr,vh,"tabHPadding","tabBackground","selectWidth",$m,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:Fc,_tabHeight:Ic,_tabGap:L.tabViewTabGap,_labelColor:L.tabViewLabelColor,_labelFont:L.tabViewLabelFont,_tabBackground:L.tabViewTabBackground,_selectWidth:L.tabViewSelectWidth,_selectBackground:L.tabViewSelectBackground,_moveBackground:L.tabViewMoveBackground,_insertColor:L.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(H,_,U){var b,L=this._tabModel;return H instanceof Jt?(b=H,_&&b.setView(_)):(b=new Jt,b.setName(H),b.setView(_)),L.add(b),U&&L.sm().ss(b),b},getLabel:function(j){return j.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(v){this._23o=v,this.iv()},get:function(r){var L=this,g=L._tabModel;if($c(r))return g._roots.get(r);if(Vn(r)){var I;return g.each(function(e){r===L.getLabel(e)&&(I=e)}),I}return r instanceof Jt?r:f},select:function(K){this._tabModel.sm().ss(this.get(K))},remove:function(g){var i=this;if(g=i.get(g)){var c=i._tabModel,U=c._roots.indexOf(g);i._tabModel.remove(g),i.selectByIndex(--U)}},getCurrentTab:function(){return this._8o},hideTabView:function(j,$){$.parentNode===this._92O&&(ce($)?($.style.display=ae,$._tab_=j):bn($),Dq())},showTabView:function(e,A){ce(A)&&(A.style.display="block",A._tab_=e),A.parentNode!==this._92O&&(Zg(this._92O,A),Dq())},_24o:function(){var W,h=this,y=h._8o,H=h._9o,T=h._tabModel.sm().ld();T&&(W=kn(T.getView())),W!==H&&(H&&(y.getView()&&y.getView().endEditing&&y.getView().endEditing(),h.hideTabView(y,H)),W&&h.showTabView(T,W)),h._8o=T,h._9o=W,y!==T&&h.onTabChanged(y,T)
},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(C,q){this.selectByIndex(--q)},selectByIndex:function(p){var x=this,A=x._tabModel,Z=A.size();if(Z&&!A.sm().ld()){p==f&&(p=0),p>=Z&&(p=Z-1),0>p&&(p=0);for(var O=p;O>=0;O--){var F=x.get(O);if(!F.isDisabled())return x.select(F),F}for(O=p+1;Z>O;O++)if(F=x.get(O),!F.isDisabled())return x.select(F),F}},getTabWidth:function(o){var H=this.getTabHPadding(),s=4+2*H,w=mr(o.getIcon());w&&(s+=Bb(w,o)+4);var K=this.getLabel(o);return K&&(s+=vm(this.getLabelFont(o),K).width+4),o.isClosable()&&(s+=10),s},drawTab:function(T,L,G,F,b,H,$){var C,V=this,l=V._tabPosition,q=this.getTabHPadding(),h=G+4+q,p=V._selectWidth,N=mr(L.getIcon()),r=L.isDisabled(),Y=V.getLabelColor(L),Q=V.getLabelFont(L),i=V.getLabel(L),e=V._selectBackground,_=l===re+"-vertical",g=l===ln+"-vertical";(_||g)&&(h=F+4+q),r&&(T.globalAlpha=Zm),Nj(T,G,F,b,H,$),L===V._8o&&p&&(l===Fc?Nj(T,G,F+H-p,b,p,e):l===re?Nj(T,G+b-p,F,p,H,e):l===ln?Nj(T,G,F,p,H,e):_?Nj(T,G+b-p,F,p,H,e):g?Nj(T,G,F,p,H,e):Nj(T,G,F,b,p,e));var f=b/2;if(_&&(rn(T,f,F+H/2),bo(T,O),rn(T,-f,-F-H/2)),N){var x=qh(N,L),u=Bb(N,L);if(_||g){var D=G+b/2,K=h+x/2;rn(T,D,K),bo(T,qq),rn(T,-D,-K),Vj(T,N,G+b/2,h+x/2,L,V),rn(T,D,K),bo(T,-qq),rn(T,-D,-K),h+=x+4}else Vj(T,N,h+u/2,F+H/2,L,V),h+=u+4}return _||g?(rn(T,b/2,h+b/2),bo(T,qq),rn(T,-b/2,-h-b/2),rq(T,i,Q,Y,G,h,H,b),rn(T,b/2,h+b/2),bo(T,-qq),rn(T,-b/2,-h-b/2)):rq(T,i,Q,Y,h,F,b,H),_&&(rn(T,f,F+H/2),bo(T,-O),rn(T,-f,-F-H/2)),L.isClosable()&&(C=g?{x:G+b-12,y:F+H-12,width:12,height:12}:{x:G+b-12,y:F+2,width:12,height:12},this.drawCloseIcon(L,T,Y,C)),r&&(T.globalAlpha=1),C},drawCloseIcon:function(o,A,J,y){var M=y.x,B=y.y;A.strokeStyle=J,A.lineWidth=1,A.beginPath(),A.moveTo(M+2,B+8),A.lineTo(M+8,B+2),A.moveTo(M+8,B+8),A.lineTo(M+2,B+2),A.stroke()},getTabAt:function(g){var P=this._interactor._8Q(g);return P?P.tab:null},validateImpl:function(){var n=this;n._24o();var m,Z=n._canvas,$=n._tabPosition,o=n._91O,M=n._92O,v=n._tabModel,C=n.getWidth(),R=n.getHeight(),Y=n._tabHeight,H=n._7o,e=n._tabGap,c=$===Fc,i=$===re,L=$===ln,l=$===re+"-vertical",y=$===ln+"-vertical",k=n._23o,O=0;if((i||L)&&v._roots.each(function(D){O=p(n.getTabWidth(D),O)}),c?(kq(o,0,0,C,Y),m={x:0,y:Y,width:C,height:p(0,R-Y)}):i?(kq(o,0,0,O,R),m={x:O,y:0,width:p(0,C-O),height:R}):L?(kq(o,C-O,0,O,R),m={x:0,y:0,width:p(0,C-O),height:R}):l?(kq(o,0,0,Y,R),m={x:Y,y:0,width:p(0,C-Y),height:R}):y?(kq(o,C-Y,0,Y,R),m={x:0,y:0,width:p(0,C-Y),height:R}):(kq(o,0,R-Y,C,Y),m={x:0,y:0,width:C,height:p(0,R-Y)}),kq(M,m),l||y){n._9o&&(m.x=0,kq(n._8o.getView(),m)),Zq(Z,Y,R);var V=Xn(Z),f=0;if(ji(V,0,n.ty(),1),V.clearRect(0,0,Y,R),H.clear(),v._roots.each(function(K){if(K.isVisible()){var M,F=n.getTabWidth(K);if(!k||k.tab!==K){var p=n.getTabBackground(K);M=n.drawTab(V,K,0,f,Y,F,p)}H.add({_75o:M,tab:K,startY:f,endY:f+F,height:F}),f+=F+e}}),n._23Q=p(0,f-e),k){var A=k.position;n.drawTab(V,k.tab,0,k.startY,Y,k.height,n._moveBackground),Nj(V,0,A,Y,1,n._insertColor)}if(V.restore(),n._selectionChanged){n._selectionChanged=!1;for(var B=n.ty(),S=0;S<H.size();S++){var t=H.get(S);if(t.tab===n._8o){if(t.endY+B<0){n.ty(-t.startY);break}if(t.startY+B>R){n.ty(R-t.endY);break}}}}n.ty(n.ty())}else if(i||L){n._9o&&(m.x=0,kq(n._8o.getView(),m)),Zq(Z,O,R);var V=Xn(Z),f=0;if(ji(V,0,n.ty(),1),V.clearRect(0,0,O,R),H.clear(),v._roots.each(function(b){if(b.isVisible()){var N;if(!k||k.tab!==b){var B=n.getTabBackground(b);N=n.drawTab(V,b,0,f,O,Y,B)}H.add({_75o:N,tab:b,startY:f,endY:f+Y,height:Y}),f+=Y+e}}),n._23Q=p(0,f-e),k){var A=k.position;n.drawTab(V,k.tab,0,k.startY,O,k.height,n._moveBackground),Nj(V,0,A,O,1,n._insertColor)}if(V.restore(),n._selectionChanged){n._selectionChanged=!1;for(var B=n.ty(),S=0;S<H.size();S++){var t=H.get(S);if(t.tab===n._8o){if(t.endY+B<0){n.ty(-t.startY);break}if(t.startY+B>R){n.ty(R-t.endY);break}}}}n.ty(n.ty())}else{n._9o&&(m.y=0,kq(n._8o.getView(),m)),Zq(Z,C,Y);var V=Xn(Z),b=0;if(ji(V,n.tx(),0,1),V.clearRect(0,0,C,Y),H.clear(),v._roots.each(function(t){if(t.isVisible()){var s,T=n.getTabWidth(t);if(!k||k.tab!==t){var S=n.getTabBackground(t);s=n.drawTab(V,t,b,0,T,Y,S)}H.add({_75o:s,tab:t,startX:b,endX:b+T,width:T}),b+=T+e}}),n._64I=p(0,b-e),k){var A=k.position;n.drawTab(V,k.tab,k.startX,0,k.width,Y,n._moveBackground),tq(V,n._insertColor,A,0,Y)}if(V.restore(),n._selectionChanged){n._selectionChanged=!1;for(var P=n.tx(),S=0;S<H.size();S++){var t=H.get(S);if(t.tab===n._8o){if(t.endX+P<0){n.tx(-t.startX);break}if(t.startX+P>C){n.tx(C-t.endX);break}}}}n.tx(n.tx())}for(var F=[],X=M.children,S=0;S<X.length;S++){var q=X[S],d=q._tab_;d&&!v.contains(d)&&F.push(q)}F.forEach(function(F){M.removeChild(F)})}});var Nt=function(N){this.tv=N,this.addListeners()};kl(Nt,b,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(u){this.handleScroll(u,10*(u.wheelDelta/40))},handle_DOMMouseScroll:function(U){this.handleScroll(U,10*-U.detail)},handleScroll:function(x,V){Lk(x);var t=this.tv,b=t._tabPosition;!t._40o()||b!==Fc&&b!==ab||t.tx(this.tv.tx()+V),!t._41o()||b!==re&&b!==ln&&b!==re+"-vertical"&&b!==ln+"-vertical"||t.ty(this.tv.ty()+V)},_8Q:function(q){var b,c,C=this.tv,d=C._tabPosition,L=C._7o;if(d===Fc||d===ab){var u=C.lp(q).x;for(b=0;b<L.size();b++)if(c=L.get(b),c.startX<=u&&u<=c.endX)return c}else if(d===re||d===ln||d===re+"-vertical"||d===ln+"-vertical"){var t=C.lp(q).y;for(b=0;b<L.size();b++)if(c=L.get(b),c.startY<=t&&t<=c.endY)return c}return f},isClickable:function(P){var l=this.tv,j=l._tabPosition,b=this._73o=this._8Q(P);return!l._40o()||j!==Fc&&j!==ab?!l._41o()||j!==re&&j!==ln&&j!==re+"-vertical"&&j!==ln+"-vertical"?b&&(!b.tab.isDisabled()||l.isMovable()):!0:!0},handle_mousemove:function(W){var G=this;gk?G._74o=G._8Q(W):G.getView().style.cursor=G.isClickable(W)?ig:""},handle_mousedown:function(E){this.handle_mousemove(E),this.handle_touchstart(E)},handle_touchstart:function(L){var T=this,x=T.tv,d=x._tabPosition;Lk(L),zj(L)&&T.isClickable(L)&&(d===Fc||d===ab?(T.x=dg(L).x,T.lp=x.lp(L),T.tx=x.tx()):(T.y=dg(L).y,T.lp=x.lp(L),T.ty=x.ty()),bg(T,L))},handle_mouseup:function(W){this.handle_touchend(W)},handle_touchend:function(d){if(Jl(d)){var n=this._73o;if(!n)return;var R=this.tv,g=R.getTabModel(),A=n.tab;if(!A.isDisabled()&&A.isClosable()){var U=function(){var k=g._roots.indexOf(A);g.remove(A),R.onTabClosed(A,k)};R.onTabClosing(A,U)&&U()}}},handleWindowMouseMove:function(n){this.handleWindowTouchMove(n)},handleWindowTouchMove:function(X){var Z,o=this,A=o.tv,O=A._tabPosition,Y=o._73o;if(O===Fc||O===ab){if(Z=dg(X).x-o.x,!o._25o&&!o.moving&&a(Z)>2&&(A._40o()&&!vf(X)?o._25o=1:Y&&A.isMovable()&&(o.moving=1)),o._25o)A.tx(o.tx+Z);else if(o.moving){var L=o.lp.x+Z,y=A._tabGap/2;A._7o.each(function(I){var U=I.endX,D=L-I.startX<U-L;L>=I.startX&&U>=L&&A._7Q({tab:Y.tab,startX:Y.startX+Z,width:Y.width,front:D,insertTab:I.tab,position:D?p(0,I.startX-y):h(A._64I,U+y)})})}}else if(Z=dg(X).y-o.y,!o._25o&&!o.moving&&a(Z)>2&&(A._41o()&&!vf(X)?o._25o=1:Y&&A.isMovable()&&(o.moving=1)),o._25o)A.ty(o.ty+Z);else if(o.moving){var w=o.lp.y+Z,y=A._tabGap/2;A._7o.each(function(X){var g=X.endY,Q=w-X.startY<g-w;w>=X.startY&&g>=w&&A._7Q({tab:Y.tab,startY:Y.startY+Z,height:Y.height,front:Q,insertTab:X.tab,position:Q?p(0,X.startY-y):h(A._23Q,g+y)})})}},handleWindowMouseUp:function(e){this.handleWindowTouchEnd(e)},handleWindowTouchEnd:function(){var H=this,X=H.tv,E=X._tabPosition,b=X.getTabModel(),g=b._roots,A=H._73o;if(H.moving){var W=X._23o;if(W&&W.insertTab!==W.tab){var d=W.tab,V=g.remove(d),j=g.indexOf(W.insertTab);j>=0&&(W.front||j++,j<=g.size()&&(g.add(d,j),b._38I(d,V,j)))}X._7Q(f),delete H.moving}else if(!H._25o&&A){d=A.tab;var Y=H._74o;if(!Y||Y.tab===d)if(!d.isDisabled()&&Sj(A._75o,H.lp)){var h=function(){var T=g.indexOf(d);b.remove(d),X.onTabClosed(d,T)};X.onTabClosing(d,h)&&h()}else d.isDisabled()||X._8o===d||b.sm().ss(d)}H._25o=H._73o=H._74o=E===Fc||E===ab?H.x=H.lp=H.tx=f:H.y=H.lp=H.ty=f}}),Ht.PropertyView=function(L){var u=this;u._view=Cg(1,u),u._canvas=Vq(u._view),Zg(u._view,u._79O=Rq()),u._rows=new zp,u._28o=new zp,u._26o={},u._26Q={};var h=u._propertyModel=new Wo,Y=u.ivm;h.mm(Y,u),h.md(Y,u),h.mh(Y,u),u.dm(L?L:new Wo),new Ot(u)},It("PropertyView",b,{ms_ac:[Cr,Fe,vh,Gh,ir,"categorizable",lk,ib,hp,wg,dj,Bf,We,Sh,"selectRowIndex",$m,"background",qk,Qg,ub,Qo,Ho],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:hq,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:hj,_background:L.propertyViewBackground,_expandIcon:L.propertyViewExpandIcon,_collapseIcon:L.propertyViewCollapseIcon,_scrollBarColor:gn,_scrollBarSize:qm,_autoHideScrollBar:Pp,_selectBackground:L.propertyViewSelectBackground,_rowHeight:ip,_rowLineVisible:L.propertyViewRowLineVisible,_rowLineColor:L.propertyViewRowLineColor,_10I:.5,_columnLineVisible:L.propertyViewColumnLineVisible,_columnLineColor:L.propertyViewColumnLineColor,_labelColor:L.propertyViewLabelColor,_labelSelectColor:L.propertyViewLabelSelectColor,_labelFont:L.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(r){0>r&&(r=0),r>1&&(r=1);var G=this,A=G._10I;G._10I=r,G.fp("columnPosition",A,r)},getPropertyName:function(Y){return Y.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(k,n,x){return x===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(x,$){return $===this._selectRowIndex?this._labelSelectColor:x.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(X){var y=this.getHeight()-this._59I;return y>X&&(X=y),X>0?0:P(X)},isExpanded:function(o){if(!o)return!0;var Y=this._26o[o];return Y?Y.isExpanded:!(this._26Q[o]===!1)},toggle:function(J){var Z=this;Z.isExpanded(J)?Z.collapse(J):Z.expand(J)},expandAll:function(){this.validate();for(var B in this._26o)this.expand(B)},expand:function(S){if(S&&S!==ae){var z=this,i=z._26o[S];i&&!i.isExpanded&&(i.isExpanded=!0,z.onExpanded(S),z.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var c in this._26o)this.collapse(c)},collapse:function(y){if(y&&y!==ae){var g=this,V=g._26o[y];V&&V.isExpanded&&(V.isExpanded=!1,g.onCollapsed(y),g.ivm())}},onCollapsed:function(){},getCategoryName:function(A){if(!this.isCategorizable())return ae;var J=A.getCategoryName();return J?J:ae},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(N){var j=this,X=j._dataModel;X!==N&&(X&&(X.umd(j.handlePropertyChange,j),j._selectionModel||X.sm().ums(j.handleSelectionChange,j)),j._dataModel=N,N.md(j.handlePropertyChange,j),j._selectionModel?j._selectionModel._21I(N):N.sm().ms(j.handleSelectionChange,j),j.fp(Yk,X,N))},isVisible:function(H){return this._visibleFunc?this._visibleFunc(H):!0},onPropertyChanged:function(J){var C=this,x=J.property;Ct[x]?C.ivm():C.iv(),x===Gq&&C._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Qp},handlePropertyChange:function(Z){this._27o===Z.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var O=this;O._96I||(O.setSelectRowIndex(-1),O._96I=1,O.iv())},redraw:function(){this.iv()},validateModel:function(){var w=this,q=w._rows,v=w._28o,Y={},S=new zp,f=w._27o;w.updateCurrentData(),f!==w._27o&&w.endEditing(),q.clear(),v.clear(),w.getRawProperties().each(function(M){if(w.isVisible(M)){S.add(M);var F=w.getCategoryName(M);Y[F]||(v.add(F,F===ae?0:E),Y[F]={isExpanded:w.isExpanded(F),properties:new zp})}}),w._sortFunc&&S.sort(w._sortFunc);for(var P in w._26o)w._26Q[P]=w.isExpanded(P);w._26o=Y,v.each(function(X){X!==ae&&q.add(X);var K=Y[X];K.isExpanded&&S.each(function(W){w.getCategoryName(W)===X&&(K.properties.add(W),q.add({property:W,data:w._27o}))},w)})},validateImpl:function(){var $=this;$._76o(),$._96I&&($.validateModel(),delete $._96I);var b=$._canvas,W=$.getWidth(),N=$.getHeight(),y=-$.ty(),v=$._rowHeight,u=$._indent,I=W-u,D=$._rows,x=D.size(),t=$._9I=u+I*$._10I,e=$._59I=x*v;Zq(b,W,N),$._29I={x:0,y:y,width:W,height:N},$._31I=j(y/v),$._14I=q((y+N)/v),$._31I<0&&($._31I=0),$._14I>x&&($._14I=x);var r,H=Xn(b),M=$._background;ji(H,0,-y,1),H.beginPath(),H.rect(0,y,W,N),H.clip(),H.clearRect(0,y,W,N),$._93db(H),M&&Nj(H,0,0,u,e,M);for(var A=$._31I;A<$._14I;A++){var l=D.get(A),y=v*A;if(Vn(l))M&&Nj(H,u,y,I,v,M),r=mr($.isExpanded(l)?$._expandIcon:$._collapseIcon),r&&Tc(H,r,kp,0,y,u,v),H.save(),H.beginPath(),H.rect(u,y,I,v),H.clip(),$.drawCategoryName(H,l,A,u,y,I,v),H.restore();else{var G=l.property,d=l.data,r=mr(G.getIcon()),m=$._selectRowIndex===A?$.getSelectBackground():f;if(r&&Tc(H,r,kp,0,y,u,v),m&&Nj(H,u,y,I,v,m),H.save(),H.beginPath(),H.rect(u,y,t-u,v),H.clip(),$.drawPropertyName(H,G,A,u,y,t-u,v),H.restore(),!$.isEditing(d,G)){var E=t+1,g=W-t-1;H.save(),H.beginPath(),H.rect(E,y,g,v),H.clip(),$._87o($.drawPropertyValue(H,G,$.getValue(d,G),A,E,y,g,v,d),A,E,y,g,v),H.restore()}}$._rowLineVisible&&Nj(H,u,y+v-1,I,1,$._rowLineColor)}$._columnLineVisible&&(Nj(H,t,0,1,e,$._columnLineColor),Nj(H,W-1,0,1,e)),$._92db(H),$._93I(),H.restore(),$.ty($.ty())},drawCategoryName:function(P,e,r,d,Y,M,R){rq(P,e,this.getCategoryFont(e),this.getCategoryColor(e),d,Y,M,R)},drawPropertyName:function(j,I,H,T,C,O,N){return I.drawPropertyName?(I.drawPropertyName(j,I,H,T,C,O,N,this),void 0):(rq(j,this.getPropertyName(I),this.getPropertyFont(I,H),this.getPropertyColor(I,H),T,C,O,N),void 0)},drawPropertyValue:function(l,k,_,O,x,t,X,j,Z){return k.drawPropertyValue?k.drawPropertyValue(l,k,_,O,x,t,X,j,Z,this):(Et(l,_,k,this.getLabelFont(k,_,O),this.getLabelColor(k,_,O),x,t,X,j,Z,this),void 0)},isPropertyEditable:function(e){return e.isEditable()&&this.isEditable()},setProperties:function(m){this._propertyModel.clear(),this.addProperties(m)},addProperties:function(z){if(z){var A=this._propertyModel;z.forEach(function(J){if(!(J instanceof Lt)){var y=jk(J.className);J=dq(y?y:Lt,J)}A.add(J)})}},getRowIndexAt:function(i){var g=this,R=j(g.lp(i).y/g._rowHeight);return R>=0&&R<g._rows.size()?R:-1},getPropertyAt:function(N){var L=this,t=L.getRowIndexAt(N);return t>=0?L._rows.get(t).property:f},getToolTip:function(z){var S=this,W=S.getPropertyAt(z),E=S._27o;return W&&E?W.getToolTip(E,S._9I<S.lp(z).x,S):f}});var Ot=function(O){this.pv=O,this.addListeners()};kl(Ot,b,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(F){this.getView().style.cursor=F},clear:function(){var C=this;C._62O=C.cp=C.ty=C.p=f,C.setCursor(yd)},handle_mousedown:function(j){this.handle_touchstart(j)},handle_touchstart:function(S){var s=this,X=s.pv;Lk(S),X.setFocus(S)&&(zj(S)?(s.cp=dg(S),s.ty=X.ty(),s.p=X.getColumnPosition(),s.handle_touchmove(S)):X.setSelectRowIndex(X.getRowIndexAt(S)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(t){this.handle_touchend(t)},handle_touchend:function(v){var T=this;if(T.cp&&!T._62O){var i=T.pv,S=i.lp(v),c=S.x,j=S.y,D=i._indent,s=i.getRowIndexAt(v),V=i._9I;if(s>=0){var e=i._rowHeight,y=e*s,$=i._rows.get(s),L=$.property;if(Vn($))mr(i.isExpanded($)?i._expandIcon:i._collapseIcon)&&c>=0&&D>=c&&j>=y&&y+e>=j?i.toggle($):Md(v)&&i.toggle($);else if(c>V&&i.isPropertyEditable(L,v)){var N={x:V+1,y:y,width:i.getWidth()-V-1,height:e},Y={x:N.x+i.tx(),y:N.y+i.ty(),width:N.width,height:N.height},J=0,z=i._29I;N.y<z.y?J=N.y-z.y:N.y+e>z.y+z.height&&(J=N.y+e-z.y-z.height),J&&(i.ty(i.ty()-J),Y.y-=J),i.beginEditing({data:$.data,property:L,value:i.getValue($.data,L),event:v,rect:N,editorRect:Y,view:i})}}i.setSelectRowIndex(s)}T.clear()},handleWindowMouseMove:function(u){this.handleWindowTouchMove(u)},handleWindowTouchMove:function(v){var P=this,J=P.pv,x=P.ty,W=P.cp,q=dg(v),u=P._62O;if("p"===u)J.setTranslateY(x+q.y-W.y);else if("c"===u){var K=J.getWidth()-J._indent;if(K>16){var z=P.p-(W.x-q.x)/K,r=16/K;r>z&&(z=r),z>1-r&&(z=1-r),J.setColumnPosition(z)}}else"s"===u&&J.setTranslateY(x+(W.y-q.y)*J._59I/J._29I.height)},handle_mousemove:function(h){this.handle_touchmove(h)},handle_touchmove:function(T){if(!gk&&zj(T)){var t=this,N=t.pv,K=a(N.lp(T).x-N._9I)<=(dn?8:3);t.cp?t._62O||(K?(t._62O="c",bg(t,T)):a(dg(T).y-t.cp.y)>=2&&(t._62O=t.isV(T)?"s":"p",bg(t,T))):(K?t.setCursor(Ek):t.setCursor(yd),t.isV(T)&&N._43o())}},isV:function($){var p=this.pv,e=p._29I;return p._41o()&&e.x+e.width-p.lp($).x<Qn},handle_mousewheel:function(U){this.handleScroll(U,U.wheelDelta/40)},handle_DOMMouseScroll:function(R){2===R.axis&&this.handleScroll(R,-R.detail)},handleScroll:function(S,y){var d=this.pv;Lk(S),d.endEditing(),d.translate(0,y*d.getRowHeight())},handle_keydown:function(R){var n=this.pv,h=n._rows.size(),l=n._selectRowIndex+(Tf(R)?-1:1);(Tf(R)||rl(R))&&(0>l&&(l=0),l>=h&&(l=h-1),n.setSelectRowIndex(l))}}),Ht.ListView=function(S){this._5o(S),new Pt(this)},It("ListView",b,{ms_ac:[Cr,Fe,vh,qk,lk,Qg,ub,ib,hp,Bf,We,Sh,Co,$m],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:hj,_rowHeight:ip,_rowLineVisible:L.listViewRowLineVisible,_rowLineColor:L.listViewRowLineColor,_scrollBarColor:gn,_scrollBarSize:qm,_autoMakeVisible:Po,_autoHideScrollBar:Pp,_selectBackground:L.listViewSelectBackground,_labelColor:L.listViewLabelColor,_labelSelectColor:L.listViewLabelSelectColor,_labelFont:L.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(d){var X=this,F=X._checkMode;X._checkMode=d,X.fp(gq,F,d)},drawRow:function(x,Z,l,h,Y,N,s){var i=this,B=0,t=i._indent,V=i.getIconWidth(Z);i.drawRowBackground(x,Z,l,h,Y,N,s),i._checkMode&&(Vj(x,mr(i.getCheckIcon(Z)),B+t/2,Y+s/2,Z,i),B+=t),i.drawIcon(x,Z,B,Y,V,s),i.drawLabel(x,Z,B+V,Y,s)}});var Pt=function(d){this.list=d,this.addListeners()};kl(Pt,b,{ms_listener:1,getView:function(){return this.list._view},clear:function(v){var F=this,s=F.list;v&&"d"===F._62O&&!F.dragCancel&&s.handleDragAndDrop(v,"end"),s.draggingData&&(s.draggingData=null,s.redraw()),F.dragCancel=F._62O=F._isV=F._isH=F.cp=F.tx=F.ty=f},handle_mousedown:function(F){this.handle_touchstart(F)},handle_touchstart:function(h){var T=this,Y=T.list;if(Lk(h),Y.setFocus(h)){var c=Y.getDataAt(h);T.cp=dg(h),T.tx=Y.tx(),T.ty=Y.ty(),zj(h)?c&&Y.handleDragAndDrop&&!T.isV(h)&&!T.isH(h)&&(Y.draggingData=c,Y.redraw(),Y.handleDragAndDrop(h,"prepare")):(c?T._33o(h,c):this._cancelDataDoubleSelect(),T.clear(h))}},handleWindowMouseUp:function(S){this.clear(S)},handleWindowTouchEnd:function($){this.clear($)},handle_mouseup:function(s){this.handle_touchend(s)},handle_touchend:function(D){var f=this,T=f.list;if(!f._isV&&!f._isH&&f.cp&&!f._62O){var U=T.getDataAt(D);U?(T.isCheckMode()?f._34o(D,U):f._33o(D,U),Md(D)?T.onDataDoubleClicked(U,D):T.onDataClicked(U,D)):(f._cancelDataDoubleSelect(),T.handleBackgroundClick(D))}f.clear(D)},handleWindowMouseMove:function(H){this.handleWindowTouchMove(H)},handleWindowTouchMove:function(L){var T=this,P=T.list,A=T._62O,C=T.tx,Z=T.ty,m=T.cp,B=dg(L),d=P._29I;"p"===A?P.setTranslate(C+B.x-m.x,Z+B.y-m.y):"v"===A?P.ty(Z+(m.y-B.y)*P._59I/d.height):"h"===A?P.tx(C+(m.x-B.x)*P._91I/d.width):"d"===A&&(T.dragCancel||P.handleDragAndDrop(L,"between"))},handle_mousemove:function(d){this.handle_touchmove(d)},handle_touchmove:function(m){if(!gk&&zj(m)){var G=this,g=G.list;if(G._isV=G.isV(m),G._isH=G.isH(m),G.cp){if(!G._62O){if(Mp(dg(m),G.cp)<2)return;G._isV?G._62O="v":G._isH?G._62O="h":g.draggingData&&!this.dragCancel?(G._62O="d",g.handleDragAndDrop(m,"begin")):G._62O="p",G._62O&&"d"!==G._62O&&g.draggingData&&(g.draggingData=null,g.redraw()),bg(G,m)}}else G._isV&&g._43o(),G._isH&&g._42o()}},isV:function(S){var n=this.list,U=n._29I;return n._41o()&&U.x+U.width-n.lp(S).x<Qn},isH:function(Y){var W=this.list,v=W._29I;return W._40o()&&v.y+v.height-W.lp(Y).y<Qn},handle_mousewheel:function(B){this.handleScroll(B,B.wheelDelta/40,B.wheelDelta!==B.wheelDeltaX)},handle_DOMMouseScroll:function(R){this.handleScroll(R,-R.detail,1)},handleScroll:function(u,y,$){var M=this.list;Lk(u),M.endEditing&&M.endEditing(),$&&M._41o()?M.translate(0,y*M.getRowHeight()):M._40o()&&M.translate(10*y,0)},handle_keydown:function(f){if(!L.isInput(f.target)){var o,B=this.list,P=B.sm(),d=B._rows,U=d.size();if(Qq(f))B.selectAll();else if(xh(f))B.handleDelete&&B.handleDelete(f);else if(le(f))"d"!==this._62O||this.dragCancel||(B.handleDragAndDrop(f,"cancel"),this.dragCancel=!0);else if(Xc(f))B.isCheckMode()&&(o=B.getFocusData(),o&&B.checkData(o));else if(Tf(f)||rl(f)){var I=B.isCheckMode();if(o=I?B.getFocusData():P.ld()){var b=B.getRowIndex(o);b>=0&&(Tf(f)?0!==b&&(o=d.get(b-1),I?B.setFocusData(o):P.ss(o)):b!==U-1&&(o=d.get(b+1),I?B.setFocusData(o):P.ss(o)))}else U>0&&(o=d.get(0),I?B.setFocusData(o):P.ss(o))}}},_34o:function(L,q){var h=this.list,b=h.lp(L).x;return b>=0&&b<=h._indent?(h.checkData(q),void 0):(h.setFocusData(q),void 0)},_33o:function(x,Y){var K=this.list,J=K.sm(),l=J.ld();if(!K.canHandleSelectMode(x,Y))return this._cancelDataDoubleSelect(),void 0;if(vf(x))K.isSelected(Y)?J.rs(Y):J.as(Y);else if(An(x))if(l)for(var d=K.getRowIndex(l),m=K.getRowIndex(Y);d!==m;)d+=m>d?1:-1,J.as(K._rows.get(d));else J.ss(Y);else zj(x)?(J.contains(Y)?K.handleDataDoubleSelect&&(this._handleDataDoubleSelect(x,Y),Md(x)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),J.ss(Y)):J.contains(Y)||J.ss(Y)},_handleDataDoubleSelect:function(c,S){this._cancelDataDoubleSelect(),this._doubleSelectTimer=On(function(){this.list.handleDataDoubleSelect(c,S),this._doubleSelectTimer=E}.bind(this),L.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(Zh(this._doubleSelectTimer),this._doubleSelectTimer=E)}}),Ht.TreeView=function(X){var w=this;w._35o(),w._5o(X),new Qt(w)},It("TreeView",b,{ms_ac:[Cr,Fe,vh,"rootVisible",gq,"rootData",ib,hp,Bf,We,Sh,lk,qk,Qg,ub,wg,dj,Co,$m,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:f,_indent:hj,_rowHeight:ip,_rowLineVisible:L.treeViewRowLineVisible,_rowLineColor:L.treeViewRowLineColor,_scrollBarColor:gn,_scrollBarSize:qm,_autoHideScrollBar:Pp,_expandIcon:L.treeViewExpandIcon,_collapseIcon:L.treeViewCollapseIcon,_autoMakeVisible:Po,_selectBackground:L.treeViewSelectBackground,_labelColor:L.treeViewLabelColor,_labelSelectColor:L.treeViewLabelSelectColor,_labelFont:L.treeViewLabelFont,_doubleClickToToggle:L.treeViewDoubleClickToToggle,drawRow:function(V,u,X,r,H,F,S){var O=this;O.drawRowBackground(V,u,X,r,H,F,S),O.drawTree(V,u,X,0,H,F,S)},isOnToggleIcon:function(t){var B=this.getDataAt(t);if(B){var V=this.getIndent(),k=this.lp(t).x;if(mr(this.getToggleIcon(B))){var F=V*this.getLevel(B);if(k>=F&&F+V>=k)return!0}}return!1}});var Qt=function(B){Hm(Qt,this,[B])};kl(Qt,Pt,{toggle:function(t,R,i,f){var d=this.list,n=d.lp(t).x;if(mr(d.getToggleIcon(R))){var O=i*f;if(n>=O&&O+i>=n)return d.toggle(R),!0}return d.isDoubleClickToToggle()&&Md(t)?(d.toggle(R),!0):!1},_34o:function(a,G){var x=this.list,L=x.lp(a).x,O=x._levelMap[G._id],Q=x._indent,D=Q*(O+1);return L>=D&&D+Q>=L?(x.checkData(G),void 0):(this.toggle(a,G,Q,O)||x.setFocusData(G),void 0)},_33o:function(n,E){var N=this,L=N.list;if(!N.toggle(n,E,L._indent,L.getLevel(E)))if(An(n)){var v=L.sm();if(v.size()>0){for(var t=L._rows,d=null,l=0,M=t.size();M>l;l++)if(L.isSelected(t.get(l))){d=l;break}for(var D=null,l=t.size()-1;l>=0;l--)if(L.isSelected(t.get(l))){D=l;break}var z,w,G=L.getRowIndex(E);for(d>G?(z=G-1,w=d):G>D?(z=D,w=G):(z=d,w=D);z!==w;)z++,v.as(L._rows.get(z))}else v.ss(E)}else Qt.superClass._33o.call(N,n,E)},handle_keydown:function(u){if(Ff(u)||Te(u)){var g=this.list,X=g._rows,U=g.isCheckMode(),c=g.sm(),r=U?g.getFocusData():c.ld();r?r.hasChildren()&&(Ff(u)?g.collapse(r):g.expand(r)):X.size()>0&&(r=X.get(0),U?g.setFocusData(r):c.ss(r))}else Qt.superClass.handle_keydown.call(this,u)}});var Rt=Ht.TableView=function(u){this._98I(),this._5o(u),new St(this)};It("TableView",b,{ms_ac:[Cr,Fe,vh,"sortMode",Gh,ir,qk,Qg,ub,Qo,Ho,"sortColumn",ib,hp,Bf,We,Sh,Co,$m],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:mc,_editable:!0,_batchEditable:!1,_rowHeight:ip,_rowLineVisible:L.tableViewRowLineVisible,_rowLineColor:L.tableViewRowLineColor,_columnLineVisible:L.tableViewColumnLineVisible,_columnLineColor:L.tableViewColumnLineColor,_scrollBarColor:gn,_scrollBarSize:qm,_autoHideScrollBar:Pp,_autoMakeVisible:Po,_selectBackground:L.tableViewSelectBackground,_labelColor:L.tableViewLabelColor,_labelSelectColor:L.tableViewLabelSelectColor,_labelFont:L.tableViewLabelFont,getCheckColumn:function(){var i=this;if(!i._31o){var F=i._31o=new Kt;F.setEditable(!0),F.setWidth(40),F.getValue=i.getCheckColumValue,F.drawCell=i.drawCheckColumnCell}return i._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(s){var q=this,b=q._39o,B=q.getCheckColumn();s!==q.isCheckMode()&&(s?b.add(B,0):b.remove(B),q.fp(gq,!s,s))},getCheckColumValue:function(k,o,C){return C.isSelected(k)},drawCheckColumnCell:function(O,E,y,P,v,s,K,R,Y){Vj(O,Y.getCheckIcon(E),v+K/2,s+R/2,E,Y)}});var St=function(X){Hm(St,this,[X])};kl(St,Pt,{_34o:function(Y,y){var w=this.list,M=w._31o;if(w.isCellEditable(y,M,Y)){var Z=w._3Q(M),D=w.lp(Y).x;if(Z&&D>=Z.startX&&D<Z.startX+M.getWidth())return w.checkData(y),void 0}w._37O(y,Y),w.setFocusData(y)},_33o:function(I,E){this.list._37O(E,I),St.superClass._33o.apply(this,arguments)}});var Tt=Ht.TreeTableView=function(g){var w=this,U=w._4o=new Kt;w._35o(),w._98I(),w._5o(g),U.setDisplayName("Name"),U.setEditable(!0),U.setWidth(180),U.drawCell=Ut,U.getValue=Vt,w._39o.add(U),new Wt(w)},Ut=function(i,D,g,U,y,W,t,e,f){f.drawTree(i,D,g,y,W,t,e)},Vt=function(g,w,S){return S.getLabel(g)};It("TreeTableView",b,{ms_ac:[Cr,Fe,vh,"sortMode",Gh,ir,lk,gq,"rootData","rootVisible",ib,hp,"sortColumn",wg,dj,Bf,We,Sh,Co,ub,qk,Qg,Qo,Ho,$m,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:mc,_checkMode:f,_editable:!0,_batchEditable:!1,_indent:hj,_rowHeight:ip,_rowLineVisible:L.treeTableViewRowLineVisible,_rowLineColor:L.treeTableViewRowLineColor,_columnLineVisible:L.treeTableViewColumnLineVisible,_columnLineColor:L.treeTableViewColumnLineColor,_expandIcon:L.treeTableViewExpandIcon,_collapseIcon:L.treeTableViewCollapseIcon,_scrollBarColor:gn,_scrollBarSize:qm,_autoHideScrollBar:Pp,_autoMakeVisible:Po,_selectBackground:L.treeTableViewSelectBackground,_labelColor:L.treeTableViewLabelColor,_labelSelectColor:L.treeTableViewLabelSelectColor,_labelFont:L.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Wt=function(H){Hm(Wt,this,[H])};kl(Wt,Pt,{_34o:function(w,l){var E=this.list,b=E._4o,F=E._3Q(b),u=E.lp(w).x;if(F){var k=E._indent,s=F.startX+k*E.getLevel(l);if(mr(E.getToggleIcon(l))&&u>=s&&s+k>=u)return E.toggle(l),void 0;if(E.isCellEditable(l,b)&&(s+=k,u>=s&&s+k>=u))return E.checkData(l),void 0}E._37O(l,w),E.setFocusData(l)},_33o:function(D,G){var M=this.list,Q=M.lp(D).x;if(mr(M.getToggleIcon(G))){var r=M._3Q(M._4o);if(r){var O=M._indent,B=r.startX+O*M.getLevel(G);if(Q>=B&&B+O>=Q)return M.toggle(G),void 0}}M._37O(G,D),Wt.superClass._33o.apply(this,arguments)}});var Xt=Ht.TableHeader=function(K){var A=this,y=A._view=Cg(1,A),N=A._39o=K.getColumnModel(),x=A.iv;A.tv=A._tableView=K,A._60I=new zp,A._canvas=Vq(y),y.style.background=L.tableHeaderBackground||"",y.style.height=mg+qf,N.mm(x,A),N.md(x,A),N.mh(x,A),K.mp(function(x){yt[x.property]&&A.iv()},A),new Yt(A),A.iv()};It("TableHeader",b,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Cr,vh,lk,"moveBackground","insertColor",Qo,Ho,"resizable","movable"],_checkIcon:Mo,_movable:!0,_resizable:!0,_labelColor:L.tableHeaderLabelColor,_labelFont:L.tableHeaderLabelFont,_columnLineColor:L.tableHeaderColumnLineColor,_columnLineVisible:L.tableHeaderColumnLineVisible,_sortDescIcon:L.tableHeaderSortDescIcon,_sortAscIcon:L.tableHeaderSortAscIcon,_moveBackground:L.tableHeaderMoveBackground,_insertColor:L.tableHeaderInsertColor,_indent:hj,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(T){return T.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(t){return t.getColor()||this._labelColor},getLabelAlign:function(J){return J._align},onPropertyChanged:function(){this.iv()},_5Q:function(n){this._61I=n,this.iv()},getLogicalPoint:function(a){return Gm(a,this._canvas,this.tv.tx())},validateImpl:function(){var a=this,E=a._canvas,$=a.getWidth(),A=a.getHeight(),h=a.tv,P=a._60I,K=a._61I,O=-h.tx(),G=0;($!==E.clientWidth||A!==E.clientHeight)&&Zq(E,$,A),P.clear(),a._39o._roots.each(function(K){if(K.isVisible()){var N=G+K.getWidth();O+$>=G&&N>=O&&P.add({column:K,startX:G}),G=N}});var b=Xn(E);if(ji(b,-O,0,1),b.beginPath(),b.rect(O,0,$,A),b.clip(),b.clearRect(O,0,$,A),P.each(function(u){var W=u.column,B=u.startX,H=W.getWidth();H>0&&(b.save(),b.beginPath(),b.rect(B,0,H,A),b.clip(),K&&K.column===W||a.drawColumn(b,W,B,0,H,A),a._columnLineVisible&&Nj(b,B+H-1,0,1,A,a._columnLineColor),b.restore())}),K){var Q=K.column,G=K.startX,k=K.position,z=Q.getWidth();b.save(),b.beginPath(),b.rect(G,0,z,A),b.clip(),b.fillStyle=a._moveBackground,b.fill(),a.drawColumn(b,Q,G,0,z,A),b.restore(),tq(b,a._insertColor,k,0,A)}b.restore()},_6Q:function(O){var P=this.tv;return P._31o===O&&P.sm().getSelectionMode()===ul},drawColumn:function(S,m,r,C,G,v){var d=this,a=d.tv,V=mr(m.getIcon()),N=d.getLabelAlign(m);if(d._6Q(m)){var J=mr(d._checkIcon);Vj(S,J,r+G/2,C+v/2,m,d)}else{var y=d.getLabel(m),M=d.getLabelFont(m),p=d.getLabelColor(m),t=vm(M,y).width,F=V?d._indent:0;N===re?(V&&Tc(S,V,kp,r,C,F,v),rq(S,y,M,p,r+F,C,G,v,re)):N===ln?(V&&Tc(S,V,kp,r+G-t-F,C,F,v),rq(S,y,M,p,r,C,G,v,ln)):(V&&Tc(S,V,kp,r+(G-t-F)/2,C,F,v),rq(S,y,M,p,r+(G-t+F)/2,C,0,v,re))}if(m.isSortable()&&a.getSortColumn()===m&&(V=mr(m.getSortOrder()===Gk?d._sortAscIcon:d._sortDescIcon))){var i=Bb(V,m)/2+2;Vj(S,V,N===ln?r+i:r+G-i,C+v/2,m,a)}}});var Yt=function(F){var t=this;t.th=F,t.tv=F._tableView,t.addListeners()};kl(Yt,b,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(M){this.getView().style.cursor=M},handle_mousemove:function(K){if(!gk){var D=this;delete D._29o,D.setCursor(yd);for(var r=D.th,b=r._60I,I=r.lp(K).x,f=b.size()-1;f>=0;f--){var V=b.get(f),$=V.column,x=V.startX+$.getWidth();if(r.isResizable()&&a(x-I)<=(dn?10:3))return D._29o=V,D.setCursor(Ek),void 0;I>V.startX&&x>I&&(D._29o=V),($.isClickable()||$.isSortable()||r.isMovable()||D.tv.getCheckColumn&&$===D.tv.getCheckColumn())&&I>V.startX&&x>I&&D.setCursor(ig)}}},handle_mousedown:function(n){this.handle_touchstart(n)},handle_touchstart:function($){var W=this;Lk($),W.tv.endEditing(),W.handle_mousemove($),W._29o&&(W.x=dg($).x,W.lx=W.th.lp($).x,W.w=W._29o.column.getWidth(),bg(W,$))},handleWindowMouseMove:function(L){this.handleWindowTouchMove(L)},handleWindowTouchMove:function(A){var W=this,L=W.th,K=W.getView().style.cursor,u=W._29o,x=dg(A).x-W.x;if(W.resizing||W.moving||(K===Ek?W.resizing=1:L.isMovable()&&K===ig&&a(x)>2&&(W.moving=1)),W.resizing)u.column.setWidth(W.w+x);else if(W.moving){var D=W.lx+x;L._60I.each(function(e){var n=e.startX,m=n+e.column.getWidth();if(D>=n&&m>=D){var q={column:u.column,startX:u.startX+x,front:m-D>D-n,insertColumn:e.column};q.position=q.front?n:m,L._5Q(q)}})}},_16Q:function(x,h){var r=this,p=r.tv,D=r.th,B=D._checkIcon;if(D._6Q(x)){var j=mr(B),b=r.lx,f=x.getWidth(),y=Bb(j,x);if(b>=h+f/2-y&&h+f/2+y>=b){D.setCheckIcon(B===eb?Mo:eb);var d=p.sm(),v=p._rows;return B===eb?d.rs(v):d.ss(v),p.onCheckColumnClicked(x),!0}}return!1},handleWindowMouseUp:function(_){this.handleWindowTouchEnd(_)},handleWindowTouchEnd:function(j){var t=this,G=t.tv,V=t.th,M=t._29o;
if(t.moving){var y=V._61I;if(y&&y.insertColumn!==y.column){var z=y.column,p=G.getColumnModel()._roots,u=p.remove(z),$=p.indexOf(y.insertColumn);$>=0&&(y.front||$++,$<=p.size()&&(p.add(z,$),G.getColumnModel()._38I(z,u,$)))}V._5Q(f),delete t.moving}else if(!t.resizing&&M){z=M.column;var d=V.lp(j).x,B=M.startX,W=!0;if(V.onColumnClicked){var O=V.onColumnClicked(z,j,B);O===!1&&(W=!1)}if(W&&d>=B&&d<=B+z.getWidth()&&!t._16Q(z,B)){if(z.isSortable()){var Y=G.getSortMode(),S=z.getSortOrder();Y===mc?G.getSortColumn()===z?(S===Yc&&G.setSortColumn(f),z.setSortOrder(S===Gk?Yc:Gk)):G.setSortColumn(z):"bistate"===Y&&(G.getSortColumn()===z?z.setSortOrder(S===Gk?Yc:Gk):G.setSortColumn(z))}G.onColumnClicked(z,j,B)}}t._29o=t.resizing=t.x=t.lx=t.w=f}}),Ht.TablePane=function(n){this.init(new Rt(n))},It("TablePane",b,{ms_v:1,_44o:1}),Ht.TreeTablePane=function(J){this.init(new Tt(J))},It("TreeTablePane",b,{ms_v:1,_44o:1}),Ht.Toolbar=function(z){var G=this,R=G._view=Cg(1,G),n=R.style;n.background=L.toolbarBackground||"",n.height=Ic+qf,G._canvas=Vq(R),G._30o=new zp,G._90I=new zp,G.setItems(z||[]),R.handleGroupSelectedChanged=function(U){if(U.isSelected()){var x=U.getGroupId();null!=x&&G._items.forEach(function(T){var P=T.element;P&&P!==U&&P.setSelected&&P.getGroupId&&P.getGroupId()===x&&P.setSelected(!1)})}},new Zt(G)},It("Toolbar",b,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[bm,Cr,vh,Fe,$m,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:L.toolbarLabelColor,_labelSelectColor:L.toolbarLabelSelectColor,_labelFont:L.toolbarLabelFont,_selectBackground:L.toolbarSelectBackground,_itemGap:L.toolbarItemGap,_separatorColor:L.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(t){var T=this.getItemInfoAt(t);return T?T.item.toolTip:f},getLabelColor:function(j){return j&&j.selected&&j.type!==eb&&j.type!==Ug?this._labelSelectColor:this._labelColor},onPropertyChanged:function(h){this.iv(),h.property===bm&&this._items.forEach(function(r){ao(r)})},redraw:function(){this.iv()},addItem:function(B,q){var J=this._items;q==f?J.push(B):J.splice(q,0,B),this.fp(bm,f,J)},removeItem:function(o){if(o)for(var i=this._items,x=0;x<i.length;x++)o===i[x]&&(i.splice(x,1),this.fp(bm,f,i))},removeItemById:function(o){if(o!=f)for(var x=this._items,M=0;M<x.length;M++)if(o===x[M].id){var q=x.splice(M,1)[0];return this.fp(bm,f,x),q}},getItemById:function(B){if(B!=f)for(var X=this._items,G=0;G<X.length;G++){var m=X[G];if(B===m.id)return m}},setItemVisible:function(e,o){var E=this.getItemById(e);E&&(E.visible=o)},getItemInfos:function(){return this._30o},getItemInfoAt:function(k){var G=this,I=0,V=G._30o,y=G.lp(k),Z=y.x,O=y.y;if(O>=0&&O<=G.getHeight())for(;I<V.size();I++){var N=V.get(I);if(N.startX<=Z&&Z<=N.endX)return N}return f},drawItem:function(c,J,A,S,_){if(J.visible===!1)return 0;if(fi(J.visible)&&!J.visible())return 0;var m=this,Z=J.disabled;Z&&(c.globalAlpha=Zm);var v=m.drawItemImpl(c,J,A,S,_),d=m._itemGap;return Z&&(c.globalAlpha=1),this._currentItem!==J||"separator"===J||J.separator===!0||J.unfocusable||Df(c,m._separatorColor,A-d/2,0,v+d,S),v},drawItemImpl:function(g,D,n,y,u){var k=this,X=k._view,O=k._itemGap,l=y/2,s=D.type,W=D.element,L=D.label;Vn(W)&&(L=W,W=f);var z,H=k.getLabelFont(D),x=k.getLabelColor(D),d=D.selected,b=mr(D.icon),B=Bb(b,D),E=0,V=B+(L?vm(H,L).width:0);if("separator"===D||D.separator===!0)return tq(g,k._separatorColor,n,y/4,l),1;if(W){b&&Vj(g,b,n+B/2,l,D,k),rq(g,L,H,x,n+B,0,0,y);var U=kn(W);u||k._90I.add(U),U.parentNode!==X&&Zg(X,U),W.iv&&W.iv(),W.validate&&W.validate();var N=U.getBoundingClientRect(),J=N.width,Z=U.style;return Eq(U),Z.left=k.tx()+n+V+qf,Z.top=(y-N.height)/2+qf,V+J}return s===Ug?z=mr(d?fg:Ym):s===eb&&(z=mr(d?eb:Mo)),z?(E=Bb(z,D),Vj(g,z,n+E/2,l,D,k),n+=E,V+=E):d&&Nj(g,n-O/2,0,V+O,y,k.getSelectBackground(D)),b&&Vj(g,b,n+B/2,l,D,k),rq(g,L,H,x,n+B,0,0,y),V},validateImpl:function(){var V=this,r=V._canvas,f=V.getWidth(),q=V.getHeight(),j=V._30o,O=V._items;Zq(r,f,q);var M=Xn(r),$=V._itemGap,E=$/2;ji(M,V.tx(),0,1),M.clearRect(0,0,f,q);var R=V._90I;V._90I=new zp,j.clear(),O.forEach(function(G){var A=V.drawItem(M,G,E,q);j.add({item:G,startX:E,endX:E+A,width:A}),A&&(E+=A+$)}),R.each(function(f){V._90I.contains(f)||bn(f)});var d=V._64I;V._64I=p(0,E-$/2),M.restore(),V._stickToRight?(V._65O=0,M=Xn(r),E=f-V._64I+$/2,ji(M,0,0,1),M.clearRect(0,0,f,q),j.clear(),O.forEach(function(l){var u=V.drawItem(M,l,E,q,!0);j.add({item:l,startX:E,endX:E+u,width:u}),u&&(E+=u+$)}),M.restore()):V.tx(V.tx()),d!==V._64I&&V.onSumWidthChanged(d,V._64I)},onSumWidthChanged:function(){},handleClick:function(c,Q){var R=this,V=c.type,S=c.action,K=c.groupId,x=c.selected;c.disabled||(K!=f?x||(c.selected=!0,this._items.forEach(function(D){D.groupId===K&&c!==D&&(D.selected=!1)}),S&&c.action(c,R,Q)):V===eb||"toggle"===V?(c.selected=!x,S&&c.action(c,R,Q)):S&&c.action(c,R,Q)),Dq(),R.iv()}});var Zt=function(C){this.tb=C,this.addListeners()};kl(Zt,b,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(g){this.handleScroll(g,10*(g.wheelDelta/40))},handle_DOMMouseScroll:function(U){this.handleScroll(U,10*-U.detail)},handleScroll:function(g,t){Lk(g);var P=this.tb;P.isScrollable()&&!P._stickToRight&&(P.tx(P.tx()+t),io())},handle_mousemove:function(d){var E=this;gk||E.setItem(d)},handle_mouseout:function(H){var P=this;H.target===P.getView()?P.tb.setCurrentItem(f):P.handle_mousemove(H)},handle_mousedown:function(t){this.handle_mousemove(t),this.handle_touchstart(t)},handle_touchstart:function(c){var S=this,m=S.tb,t=c.target;zj(c)&&(t===S.getView()||t===m._canvas)&&(Lk(c),m.setFocus(c)&&(this.setItem(c,!0),(m.isScrollable()||S.info&&!S.info.item.disabled)&&(S.x=dg(c).x,S.tx=m.tx(),bg(S,c))))},handleWindowMouseMove:function($){this.handleWindowTouchMove($)},handleWindowTouchMove:function(W){var Q=this,g=Q.tb;if(!g._stickToRight){var n=dg(W).x-Q.x;!Q._25o&&a(n)>2&&g.isScrollable()&&(Q._25o=1),Q._25o&&g.tx(Q.tx+n)}},handleWindowMouseUp:function(t){this.handleWindowTouchEnd(t)},handleWindowTouchEnd:function(r){var y=this,T=y.tb,O=y.info,k=y.tb.getItemInfoAt(r);if(!y._25o&&O){var G=O.item;k&&k.item===G&&T.handleClick(G,r)}y._25o=y.x=y.tx=f,y.setItem()},setItem:function($,D){var d=this,w=d.tb,h=d.info=$?w.getItemInfoAt($):f,b=h?h.item:f;w.setCurrentItem(b),D&&b&&fi(b.onDown)&&b.onDown($)}}),Ht.BorderPane=function(){this._view=Cg(1,this),this.iv()},It("BorderPane",b,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(g,l){this._12o("leftView",g),l!=f&&this.setLeftWidth(l)},getRightView:function(){return this._rightView},setRightView:function(q,E){this._12o("rightView",q),E!=f&&this.setRightWidth(E)},getTopView:function(){return this._topView},setTopView:function(e,i){this._12o("topView",e),i!=f&&this.setTopHeight(i)},getBottomView:function(){return this._bottomView},setBottomView:function(K,m){this._12o("bottomView",K),m!=f&&this.setBottomHeight(m)},getCenterView:function(){return this._centerView},setCenterView:function(x){this._12o("centerView",x)},_12o:function(B,$){var R=this,f="_"+B,P=R._view,b=R[f];b!==$&&(b&&(b.getView?bn(b.getView()):bn(b)),R[f]=$,$&&($.getView?Zg(P,$.getView(),1):Zg(P,$,1)),R.fp(B,b,$))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var T=this,F=T._topView,c=T._bottomView,Y=T._leftView,z=T._rightView,$=T._centerView,G=T.getWidth(),e=T.getHeight(),y=0,A=0,U=G,x=e,C=0,n=0,W=0,I=0;F&&(C=T._topHeight==f?yg(F):T._topHeight,A=C),c&&(n=T._bottomHeight==f?yg(c):T._bottomHeight,x=e-n),Y&&(W=T._leftWidth==f?fn(Y):T._leftWidth,y=W),z&&(I=T._rightWidth==f?fn(z):T._rightWidth,U=G-I);var D=p(0,U-y),R=p(0,x-A);F&&kq(F,0,0,G,C),c&&kq(c,0,x,G,n),Y&&kq(Y,0,A,W,R),z&&kq(z,U,A,I,R),$&&kq($,y,A,D,R)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);